!function(){var t,n,e,r,i={37823:function(t){"use strict";t.exports=JSON.parse('["af","am-et","ar","as-in","az-latn-az","be","bg","bn-in","bs-latn-ba","ca-es-valencia","ca","cs","cy-gb","da","de","el","en-gb","en-us","es-mx","es","et","eu","fa","fi","fil-ph","fr-ca","fr","ga-ie","gd","gl","gu","he","hi","hr","hu","hy","id","is","it","ja","ka","kk","km-kh","kn","ko","kok","lb-lu","lo","lt","lv","mi-nz","mk","ml","mr","ms","mt-mt","nb-no","ne-np","nl","nn-no","or-in","pa","pl","pt-br","pt-pt","quz-pe","","ro","ru","sk","sl","sq","sr-cyrl-ba","sr-cyrl-rs","sr-latn-rs","sv","ta","te","th","tr","tt","ug","uk","ur","uz-latn-uz","vi","zh-cn","zh-tw"]')},56117:function(){function t(t){return $.expr.filters.visible(t)&&!$(t).parents().addBack().filter((function(){return"hidden"===$.css(this,"visibility")})).length}$.extend($.expr[":"],{focusable:function(n){
/*!
 * jQuery UI Core @VERSION
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */
return function(n,e){var r,i,o,s=n.nodeName.toLowerCase();return"area"===s?(i=(r=n.parentNode).name,!(!n.href||!i||"map"!==r.nodeName.toLowerCase())&&!!(o=$("img[usemap=#"+i+"]")[0])&&t(o)):(/input|select|textarea|button|object/.test(s)?!n.disabled:"a"===s&&n.href||e)&&t(n)}(n,!isNaN($.attr(n,"tabindex")))}})},31699:function(t){
/*! @license DOMPurify | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.0.8/LICENSE */
t.exports=function(){"use strict";function t(t){if(Array.isArray(t)){for(var n=0,e=Array(t.length);n<t.length;n++)e[n]=t[n];return e}return Array.from(t)}var n=Object.hasOwnProperty,e=Object.setPrototypeOf,r=Object.isFrozen,i=Object.freeze,o=Object.seal,s=Object.create,u="undefined"!=typeof Reflect&&Reflect,a=u.apply,c=u.construct;a||(a=function(t,n,e){return t.apply(n,e)}),i||(i=function(t){return t}),o||(o=function(t){return t}),c||(c=function(n,e){return new(Function.prototype.bind.apply(n,[null].concat(t(e))))});var l=y(Array.prototype.forEach),f=y(Array.prototype.pop),h=y(Array.prototype.push),d=y(String.prototype.toLowerCase),m=y(String.prototype.match),v=y(String.prototype.replace),p=y(String.prototype.indexOf),g=y(String.prototype.trim),b=y(RegExp.prototype.test),w=I(TypeError);function y(t){return function(n){for(var e=arguments.length,r=Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return a(t,n,r)}}function I(t){return function(){for(var n=arguments.length,e=Array(n),r=0;r<n;r++)e[r]=arguments[r];return c(t,e)}}function S(t,n){e&&e(t,null);for(var i=n.length;i--;){var o=n[i];if("string"==typeof o){var s=d(o);s!==o&&(r(n)||(n[i]=s),o=s)}t[o]=!0}return t}function C(t){var e=s(null),r=void 0;for(r in t)a(n,t,[r])&&(e[r]=t[r]);return e}var F=i(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),N=i(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","audio","canvas","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","video","view","vkern"]),T=i(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),k=i(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),x=i(["#text"]),P=i(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns"]),D=i(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),E=i(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),R=i(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),L=o(/\{\{[\s\S]*|[\s\S]*\}\}/gm),A=o(/<%[\s\S]*|[\s\S]*%>/gm),q=o(/^data-[\-\w.\u00B7-\uFFFF]/),O=o(/^aria-[\-\w]+$/),M=o(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),U=o(/^(?:\w+script|data):/i),V=o(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function G(t){if(Array.isArray(t)){for(var n=0,e=Array(t.length);n<t.length;n++)e[n]=t[n];return e}return Array.from(t)}var B=function(){return"undefined"==typeof window?null:window},z=function(t,n){if("object"!==(void 0===t?"undefined":_(t))||"function"!=typeof t.createPolicy)return null;var e=null,r="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(r)&&(e=n.currentScript.getAttribute(r));var i="dompurify"+(e?"#"+e:"");try{return t.createPolicy(i,{createHTML:function(t){return t}})}catch(t){return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function Q(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B(),n=function(t){return Q(t)};if(n.version="2.2.2",n.removed=[],!t||!t.document||9!==t.document.nodeType)return n.isSupported=!1,n;var e=t.document,r=t.document,o=t.DocumentFragment,s=t.HTMLTemplateElement,u=t.Node,a=t.NodeFilter,c=t.NamedNodeMap,y=void 0===c?t.NamedNodeMap||t.MozNamedAttrMap:c,I=t.Text,H=t.Comment,j=t.DOMParser,$=t.trustedTypes;if("function"==typeof s){var W=r.createElement("template");W.content&&W.content.ownerDocument&&(r=W.content.ownerDocument)}var J=z($,e),K=J&&xt?J.createHTML(""):"",X=r,Y=X.implementation,Z=X.createNodeIterator,tt=X.getElementsByTagName,nt=X.createDocumentFragment,et=e.importNode,rt={};try{rt=C(r).documentMode?r.documentMode:{}}catch(t){}var it={};n.isSupported=Y&&void 0!==Y.createHTMLDocument&&9!==rt;var ot=L,st=A,ut=q,at=O,ct=U,lt=V,ft=M,ht=null,dt=S({},[].concat(G(F),G(N),G(T),G(k),G(x))),mt=null,vt=S({},[].concat(G(P),G(D),G(E),G(R))),pt=null,gt=null,bt=!0,wt=!0,yt=!1,It=!1,St=!1,Ct=!1,Ft=!1,Nt=!1,Tt=!1,kt=!0,xt=!1,Pt=!0,Dt=!0,Et=!1,Rt={},Lt=S({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","plaintext","script","style","svg","template","thead","title","video","xmp"]),At=null,qt=S({},["audio","video","img","source","image","track"]),Ot=null,Mt=S({},["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"]),Ut=null,Vt=r.createElement("form"),_t=function(t){Ut&&Ut===t||(t&&"object"===(void 0===t?"undefined":_(t))||(t={}),t=C(t),ht="ALLOWED_TAGS"in t?S({},t.ALLOWED_TAGS):dt,mt="ALLOWED_ATTR"in t?S({},t.ALLOWED_ATTR):vt,Ot="ADD_URI_SAFE_ATTR"in t?S(C(Mt),t.ADD_URI_SAFE_ATTR):Mt,At="ADD_DATA_URI_TAGS"in t?S(C(qt),t.ADD_DATA_URI_TAGS):qt,pt="FORBID_TAGS"in t?S({},t.FORBID_TAGS):{},gt="FORBID_ATTR"in t?S({},t.FORBID_ATTR):{},Rt="USE_PROFILES"in t&&t.USE_PROFILES,bt=!1!==t.ALLOW_ARIA_ATTR,wt=!1!==t.ALLOW_DATA_ATTR,yt=t.ALLOW_UNKNOWN_PROTOCOLS||!1,It=t.SAFE_FOR_TEMPLATES||!1,St=t.WHOLE_DOCUMENT||!1,Nt=t.RETURN_DOM||!1,Tt=t.RETURN_DOM_FRAGMENT||!1,kt=!1!==t.RETURN_DOM_IMPORT,xt=t.RETURN_TRUSTED_TYPE||!1,Ft=t.FORCE_BODY||!1,Pt=!1!==t.SANITIZE_DOM,Dt=!1!==t.KEEP_CONTENT,Et=t.IN_PLACE||!1,ft=t.ALLOWED_URI_REGEXP||ft,It&&(wt=!1),Tt&&(Nt=!0),Rt&&(ht=S({},[].concat(G(x))),mt=[],!0===Rt.html&&(S(ht,F),S(mt,P)),!0===Rt.svg&&(S(ht,N),S(mt,D),S(mt,R)),!0===Rt.svgFilters&&(S(ht,T),S(mt,D),S(mt,R)),!0===Rt.mathMl&&(S(ht,k),S(mt,E),S(mt,R))),t.ADD_TAGS&&(ht===dt&&(ht=C(ht)),S(ht,t.ADD_TAGS)),t.ADD_ATTR&&(mt===vt&&(mt=C(mt)),S(mt,t.ADD_ATTR)),t.ADD_URI_SAFE_ATTR&&S(Ot,t.ADD_URI_SAFE_ATTR),Dt&&(ht["#text"]=!0),St&&S(ht,["html","head","body"]),ht.table&&(S(ht,["tbody"]),delete pt.tbody),i&&i(t),Ut=t)},Gt=function(t){h(n.removed,{element:t});try{t.parentNode.removeChild(t)}catch(n){t.outerHTML=K}},Bt=function(t,e){try{h(n.removed,{attribute:e.getAttributeNode(t),from:e})}catch(t){h(n.removed,{attribute:null,from:e})}e.removeAttribute(t)},zt=function(t){var n=void 0,e=void 0;if(Ft)t="<remove></remove>"+t;else{var i=m(t,/^[\r\n\t ]+/);e=i&&i[0]}var o=J?J.createHTML(t):t;try{n=(new j).parseFromString(o,"text/html")}catch(t){}if(!n||!n.documentElement){var s=(n=Y.createHTMLDocument("")).body;s.parentNode.removeChild(s.parentNode.firstElementChild),s.outerHTML=o}return t&&e&&n.body.insertBefore(r.createTextNode(e),n.body.childNodes[0]||null),tt.call(n,St?"html":"body")[0]},Qt=function(t){return Z.call(t.ownerDocument||t,t,a.SHOW_ELEMENT|a.SHOW_COMMENT|a.SHOW_TEXT,(function(){return a.FILTER_ACCEPT}),!1)},Ht=function(t){return!(t instanceof I||t instanceof H||"string"==typeof t.nodeName&&"string"==typeof t.textContent&&"function"==typeof t.removeChild&&t.attributes instanceof y&&"function"==typeof t.removeAttribute&&"function"==typeof t.setAttribute&&"string"==typeof t.namespaceURI)},jt=function(t){return"object"===(void 0===u?"undefined":_(u))?t instanceof u:t&&"object"===(void 0===t?"undefined":_(t))&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},$t=function(t,e,r){it[t]&&l(it[t],(function(t){t.call(n,e,r,Ut)}))},Wt=function(t){var e=void 0;if($t("beforeSanitizeElements",t,null),Ht(t))return Gt(t),!0;if(m(t.nodeName,/[\u0080-\uFFFF]/))return Gt(t),!0;var r=d(t.nodeName);if($t("uponSanitizeElement",t,{tagName:r,allowedTags:ht}),("svg"===r||"math"===r)&&0!==t.querySelectorAll("p, br, form, table").length)return Gt(t),!0;if(!jt(t.firstElementChild)&&(!jt(t.content)||!jt(t.content.firstElementChild))&&b(/<[!/\w]/g,t.innerHTML)&&b(/<[!/\w]/g,t.textContent))return Gt(t),!0;if(!ht[r]||pt[r]){if(Dt&&!Lt[r]&&"function"==typeof t.insertAdjacentHTML)try{var i=t.innerHTML;t.insertAdjacentHTML("AfterEnd",J?J.createHTML(i):i)}catch(t){}return Gt(t),!0}return"noscript"!==r&&"noembed"!==r||!b(/<\/no(script|embed)/i,t.innerHTML)?(It&&3===t.nodeType&&(e=t.textContent,e=v(e,ot," "),e=v(e,st," "),t.textContent!==e&&(h(n.removed,{element:t.cloneNode()}),t.textContent=e)),$t("afterSanitizeElements",t,null),!1):(Gt(t),!0)},Jt=function(t,n,e){if(Pt&&("id"===n||"name"===n)&&(e in r||e in Vt))return!1;if(wt&&b(ut,n));else if(bt&&b(at,n));else{if(!mt[n]||gt[n])return!1;if(Ot[n]);else if(b(ft,v(e,lt,"")));else if("src"!==n&&"xlink:href"!==n&&"href"!==n||"script"===t||0!==p(e,"data:")||!At[t])if(yt&&!b(ct,v(e,lt,"")));else if(e)return!1}return!0},Kt=function(t){var e=void 0,r=void 0,i=void 0,o=void 0;$t("beforeSanitizeAttributes",t,null);var s=t.attributes;if(s){var u={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:mt};for(o=s.length;o--;){var a=e=s[o],c=a.name,l=a.namespaceURI;if(r=g(e.value),i=d(c),u.attrName=i,u.attrValue=r,u.keepAttr=!0,u.forceKeepAttr=void 0,$t("uponSanitizeAttribute",t,u),r=u.attrValue,!u.forceKeepAttr&&(Bt(c,t),u.keepAttr))if(b(/\/>/i,r))Bt(c,t);else{It&&(r=v(r,ot," "),r=v(r,st," "));var h=t.nodeName.toLowerCase();if(Jt(h,i,r))try{l?t.setAttributeNS(l,c,r):t.setAttribute(c,r),f(n.removed)}catch(t){}}}$t("afterSanitizeAttributes",t,null)}},Xt=function t(n){var e=void 0,r=Qt(n);for($t("beforeSanitizeShadowDOM",n,null);e=r.nextNode();)$t("uponSanitizeShadowNode",e,null),Wt(e)||(e.content instanceof o&&t(e.content),Kt(e));$t("afterSanitizeShadowDOM",n,null)};return n.sanitize=function(r,i){var s=void 0,a=void 0,c=void 0,l=void 0,f=void 0;if(r||(r="\x3c!--\x3e"),"string"!=typeof r&&!jt(r)){if("function"!=typeof r.toString)throw w("toString is not a function");if("string"!=typeof(r=r.toString()))throw w("dirty is not a string, aborting")}if(!n.isSupported){if("object"===_(t.toStaticHTML)||"function"==typeof t.toStaticHTML){if("string"==typeof r)return t.toStaticHTML(r);if(jt(r))return t.toStaticHTML(r.outerHTML)}return r}if(Ct||_t(i),n.removed=[],"string"==typeof r&&(Et=!1),Et);else if(r instanceof u)1===(a=(s=zt("\x3c!----\x3e")).ownerDocument.importNode(r,!0)).nodeType&&"BODY"===a.nodeName||"HTML"===a.nodeName?s=a:s.appendChild(a);else{if(!Nt&&!It&&!St&&-1===r.indexOf("<"))return J&&xt?J.createHTML(r):r;if(!(s=zt(r)))return Nt?null:K}s&&Ft&&Gt(s.firstChild);for(var h=Qt(Et?r:s);c=h.nextNode();)3===c.nodeType&&c===l||Wt(c)||(c.content instanceof o&&Xt(c.content),Kt(c),l=c);if(l=null,Et)return r;if(Nt){if(Tt)for(f=nt.call(s.ownerDocument);s.firstChild;)f.appendChild(s.firstChild);else f=s;return kt&&(f=et.call(e,f,!0)),f}var d=St?s.outerHTML:s.innerHTML;return It&&(d=v(d,ot," "),d=v(d,st," ")),J&&xt?J.createHTML(d):d},n.setConfig=function(t){_t(t),Ct=!0},n.clearConfig=function(){Ut=null,Ct=!1},n.isValidAttribute=function(t,n,e){Ut||_t({});var r=d(t),i=d(n);return Jt(r,i,e)},n.addHook=function(t,n){"function"==typeof n&&(it[t]=it[t]||[],h(it[t],n))},n.removeHook=function(t){it[t]&&f(it[t])},n.removeHooks=function(t){it[t]&&(it[t]=[])},n.removeAllHooks=function(){it={}},n}return Q()}()},93641:function(t,n,e){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */
t.exports=function(){"use strict";function t(t){var n=typeof t;return null!==t&&("object"===n||"function"===n)}function n(t){return"function"==typeof t}var r=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},i=0,o=void 0,s=void 0,u=function(t,n){y[i]=t,y[i+1]=n,2===(i+=2)&&(s?s(I):C())};function a(t){s=t}function c(t){u=t}var l="undefined"!=typeof window?window:void 0,f=l||{},h=f.MutationObserver||f.WebKitMutationObserver,d="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),m="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function v(){return function(){return process.nextTick(I)}}function p(){return void 0!==o?function(){o(I)}:w()}function g(){var t=0,n=new h(I),e=document.createTextNode("");return n.observe(e,{characterData:!0}),function(){e.data=t=++t%2}}function b(){var t=new MessageChannel;return t.port1.onmessage=I,function(){return t.port2.postMessage(0)}}function w(){var t=setTimeout;return function(){return t(I,1)}}var y=new Array(1e3);function I(){for(var t=0;t<i;t+=2)(0,y[t])(y[t+1]),y[t]=void 0,y[t+1]=void 0;i=0}function S(){try{var t=Function("return this")().require("vertx");return o=t.runOnLoop||t.runOnContext,p()}catch(t){return w()}}var C=void 0;function F(t,n){var e=this,r=new this.constructor(k);void 0===r[T]&&$(r);var i=e._state;if(i){var o=arguments[i-1];u((function(){return z(i,r,o,e._result)}))}else G(e,r,t,n);return r}function N(t){var n=this;if(t&&"object"==typeof t&&t.constructor===n)return t;var e=new n(k);return M(e,t),e}C=d?v():h?g():m?b():void 0===l?S():w();var T=Math.random().toString(36).substring(2);function k(){}var x=void 0,P=1,D=2;function E(){return new TypeError("You cannot resolve a promise with itself")}function R(){return new TypeError("A promises callback cannot return that same promise.")}function L(t,n,e,r){try{t.call(n,e,r)}catch(t){return t}}function A(t,n,e){u((function(t){var r=!1,i=L(e,n,(function(e){r||(r=!0,n!==e?M(t,e):V(t,e))}),(function(n){r||(r=!0,_(t,n))}),"Settle: "+(t._label||" unknown promise"));!r&&i&&(r=!0,_(t,i))}),t)}function q(t,n){n._state===P?V(t,n._result):n._state===D?_(t,n._result):G(n,void 0,(function(n){return M(t,n)}),(function(n){return _(t,n)}))}function O(t,e,r){e.constructor===t.constructor&&r===F&&e.constructor.resolve===N?q(t,e):void 0===r?V(t,e):n(r)?A(t,e,r):V(t,e)}function M(n,e){if(n===e)_(n,E());else if(t(e)){var r=void 0;try{r=e.then}catch(t){return void _(n,t)}O(n,e,r)}else V(n,e)}function U(t){t._onerror&&t._onerror(t._result),B(t)}function V(t,n){t._state===x&&(t._result=n,t._state=P,0!==t._subscribers.length&&u(B,t))}function _(t,n){t._state===x&&(t._state=D,t._result=n,u(U,t))}function G(t,n,e,r){var i=t._subscribers,o=i.length;t._onerror=null,i[o]=n,i[o+P]=e,i[o+D]=r,0===o&&t._state&&u(B,t)}function B(t){var n=t._subscribers,e=t._state;if(0!==n.length){for(var r=void 0,i=void 0,o=t._result,s=0;s<n.length;s+=3)r=n[s],i=n[s+e],r?z(e,r,i,o):i(o);t._subscribers.length=0}}function z(t,e,r,i){var o=n(r),s=void 0,u=void 0,a=!0;if(o){try{s=r(i)}catch(t){a=!1,u=t}if(e===s)return void _(e,R())}else s=i;e._state!==x||(o&&a?M(e,s):!1===a?_(e,u):t===P?V(e,s):t===D&&_(e,s))}function Q(t,n){try{n((function(n){M(t,n)}),(function(n){_(t,n)}))}catch(n){_(t,n)}}var H=0;function j(){return H++}function $(t){t[T]=H++,t._state=void 0,t._result=void 0,t._subscribers=[]}function W(){return new Error("Array Methods must be provided an Array")}var J=function(){function t(t,n){this._instanceConstructor=t,this.promise=new t(k),this.promise[T]||$(this.promise),r(n)?(this.length=n.length,this._remaining=n.length,this._result=new Array(this.length),0===this.length?V(this.promise,this._result):(this.length=this.length||0,this._enumerate(n),0===this._remaining&&V(this.promise,this._result))):_(this.promise,W())}return t.prototype._enumerate=function(t){for(var n=0;this._state===x&&n<t.length;n++)this._eachEntry(t[n],n)},t.prototype._eachEntry=function(t,n){var e=this._instanceConstructor,r=e.resolve;if(r===N){var i=void 0,o=void 0,s=!1;try{i=t.then}catch(t){s=!0,o=t}if(i===F&&t._state!==x)this._settledAt(t._state,n,t._result);else if("function"!=typeof i)this._remaining--,this._result[n]=t;else if(e===nt){var u=new e(k);s?_(u,o):O(u,t,i),this._willSettleAt(u,n)}else this._willSettleAt(new e((function(n){return n(t)})),n)}else this._willSettleAt(r(t),n)},t.prototype._settledAt=function(t,n,e){var r=this.promise;r._state===x&&(this._remaining--,t===D?_(r,e):this._result[n]=e),0===this._remaining&&V(r,this._result)},t.prototype._willSettleAt=function(t,n){var e=this;G(t,void 0,(function(t){return e._settledAt(P,n,t)}),(function(t){return e._settledAt(D,n,t)}))},t}();function K(t){return new J(this,t).promise}function X(t){var n=this;return r(t)?new n((function(e,r){for(var i=t.length,o=0;o<i;o++)n.resolve(t[o]).then(e,r)})):new n((function(t,n){return n(new TypeError("You must pass an array to race."))}))}function Y(t){var n=new this(k);return _(n,t),n}function Z(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function tt(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var nt=function(){function t(n){this[T]=j(),this._result=this._state=void 0,this._subscribers=[],k!==n&&("function"!=typeof n&&Z(),this instanceof t?Q(this,n):tt())}return t.prototype.catch=function(t){return this.then(null,t)},t.prototype.finally=function(t){var e=this,r=e.constructor;return n(t)?e.then((function(n){return r.resolve(t()).then((function(){return n}))}),(function(n){return r.resolve(t()).then((function(){throw n}))})):e.then(t,t)},t}();function et(){var t=void 0;if(void 0!==e.g)t=e.g;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;if(n){var r=null;try{r=Object.prototype.toString.call(n.resolve())}catch(t){}if("[object Promise]"===r&&!n.cast)return}t.Promise=nt}return nt.prototype.then=F,nt.all=K,nt.race=X,nt.resolve=N,nt.reject=Y,nt._setScheduler=a,nt._setAsap=c,nt._asap=u,nt.polyfill=et,nt.Promise=nt,nt}()},6462:function(t,n,e){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0});var i=e(91356),o=e(41592),s=e(53039),u=r(r({},i.namedReferences),{all:i.namedReferences.html5}),a={specialChars:/[<>'"&]/g,nonAscii:/(?:[<>'"&\u0080-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/g,nonAsciiPrintable:/(?:[<>'"&\x01-\x08\x11-\x15\x17-\x1F\x7f-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/g,extensive:/(?:[\x01-\x0c\x0e-\x1f\x21-\x2c\x2e-\x2f\x3a-\x40\x5b-\x60\x7b-\x7d\x7f-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/g},c={mode:"specialChars",level:"all",numeric:"decimal"};n.encode=function(t,n){var e=void 0===(l=(o=void 0===n?c:n).mode)?"specialChars":l,r=void 0===(m=o.numeric)?"decimal":m,i=o.level;if(!t)return"";var o,l,f=a[e],h=u[void 0===i?"all":i].characters,d="hexadecimal"===r;if(f.lastIndex=0,o=f.exec(t)){l="";var m=0;do{m!==o.index&&(l+=t.substring(m,o.index));var v=h[i=o[0]];if(!v){var p=i.length>1?s.getCodePoint(i,0):i.charCodeAt(0);v=(d?"&#x"+p.toString(16):"&#"+p)+";"}l+=v,m=o.index+i.length}while(o=f.exec(t));m!==t.length&&(l+=t.substring(m))}else l=t;return l};var l={scope:"body",level:"all"},f=/&(?:#\d+|#[xX][\da-fA-F]+|[0-9a-zA-Z]+);/g,h=/&(?:#\d+|#[xX][\da-fA-F]+|[0-9a-zA-Z]+)[;=]?/g,d={xml:{strict:f,attribute:h,body:i.bodyRegExps.xml},html4:{strict:f,attribute:h,body:i.bodyRegExps.html4},html5:{strict:f,attribute:h,body:i.bodyRegExps.html5}},m=r(r({},d),{all:d.html5}),v=String.fromCharCode,p=v(65533),g={level:"all"};n.decodeEntity=function(t,n){var e=void 0===(r=(void 0===n?g:n).level)?"all":r;if(!t)return"";var r=t,i=(t[t.length-1],u[e].entities[t]);if(i)r=i;else if("&"===t[0]&&"#"===t[1]){var a=t[2],c="x"==a||"X"==a?parseInt(t.substr(3),16):parseInt(t.substr(2));r=c>=1114111?p:c>65535?s.fromCodePoint(c):v(o.numericUnicodeMap[c]||c)}return r},n.decode=function(t,n){var e=void 0===n?l:n,r=e.level,i=void 0===r?"all":r,a=e.scope,c=void 0===a?"xml"===i?"strict":"body":a;if(!t)return"";var f=m[i][c],h=u[i].entities,d="attribute"===c,g="strict"===c;f.lastIndex=0;var b,w=f.exec(t);if(w){b="";var y=0;do{y!==w.index&&(b+=t.substring(y,w.index));var I=w[0],S=I,C=I[I.length-1];if(d&&"="===C)S=I;else if(g&&";"!==C)S=I;else{var F=h[I];if(F)S=F;else if("&"===I[0]&&"#"===I[1]){var N=I[2],T="x"==N||"X"==N?parseInt(I.substr(3),16):parseInt(I.substr(2));S=T>=1114111?p:T>65535?s.fromCodePoint(T):v(o.numericUnicodeMap[T]||T)}}b+=S,y=w.index+I.length}while(w=f.exec(t));y!==t.length&&(b+=t.substring(y))}else b=t;return b}},91356:function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.bodyRegExps={xml:/&(?:#\d+|#[xX][\da-fA-F]+|[0-9a-zA-Z]+);?/g,html4:/&(?:nbsp|iexcl|cent|pound|curren|yen|brvbar|sect|uml|copy|ordf|laquo|not|shy|reg|macr|deg|plusmn|sup2|sup3|acute|micro|para|middot|cedil|sup1|ordm|raquo|frac14|frac12|frac34|iquest|Agrave|Aacute|Acirc|Atilde|Auml|Aring|AElig|Ccedil|Egrave|Eacute|Ecirc|Euml|Igrave|Iacute|Icirc|Iuml|ETH|Ntilde|Ograve|Oacute|Ocirc|Otilde|Ouml|times|Oslash|Ugrave|Uacute|Ucirc|Uuml|Yacute|THORN|szlig|agrave|aacute|acirc|atilde|auml|aring|aelig|ccedil|egrave|eacute|ecirc|euml|igrave|iacute|icirc|iuml|eth|ntilde|ograve|oacute|ocirc|otilde|ouml|divide|oslash|ugrave|uacute|ucirc|uuml|yacute|thorn|yuml|quot|amp|lt|gt|#\d+|#[xX][\da-fA-F]+|[0-9a-zA-Z]+);?/g,html5:/&(?:AElig|AMP|Aacute|Acirc|Agrave|Aring|Atilde|Auml|COPY|Ccedil|ETH|Eacute|Ecirc|Egrave|Euml|GT|Iacute|Icirc|Igrave|Iuml|LT|Ntilde|Oacute|Ocirc|Ograve|Oslash|Otilde|Ouml|QUOT|REG|THORN|Uacute|Ucirc|Ugrave|Uuml|Yacute|aacute|acirc|acute|aelig|agrave|amp|aring|atilde|auml|brvbar|ccedil|cedil|cent|copy|curren|deg|divide|eacute|ecirc|egrave|eth|euml|frac12|frac14|frac34|gt|iacute|icirc|iexcl|igrave|iquest|iuml|laquo|lt|macr|micro|middot|nbsp|not|ntilde|oacute|ocirc|ograve|ordf|ordm|oslash|otilde|ouml|para|plusmn|pound|quot|raquo|reg|sect|shy|sup1|sup2|sup3|szlig|thorn|times|uacute|ucirc|ugrave|uml|uuml|yacute|yen|yuml|#\d+|#[xX][\da-fA-F]+|[0-9a-zA-Z]+);?/g},n.namedReferences={xml:{entities:{"&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'","&amp;":"&"},characters:{"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;","&":"&amp;"}},html4:{entities:{"&apos;":"'","&nbsp":" ","&nbsp;":" ","&iexcl":"¡","&iexcl;":"¡","&cent":"¢","&cent;":"¢","&pound":"£","&pound;":"£","&curren":"¤","&curren;":"¤","&yen":"¥","&yen;":"¥","&brvbar":"¦","&brvbar;":"¦","&sect":"§","&sect;":"§","&uml":"¨","&uml;":"¨","&copy":"©","&copy;":"©","&ordf":"ª","&ordf;":"ª","&laquo":"«","&laquo;":"«","&not":"¬","&not;":"¬","&shy":"­","&shy;":"­","&reg":"®","&reg;":"®","&macr":"¯","&macr;":"¯","&deg":"°","&deg;":"°","&plusmn":"±","&plusmn;":"±","&sup2":"²","&sup2;":"²","&sup3":"³","&sup3;":"³","&acute":"´","&acute;":"´","&micro":"µ","&micro;":"µ","&para":"¶","&para;":"¶","&middot":"·","&middot;":"·","&cedil":"¸","&cedil;":"¸","&sup1":"¹","&sup1;":"¹","&ordm":"º","&ordm;":"º","&raquo":"»","&raquo;":"»","&frac14":"¼","&frac14;":"¼","&frac12":"½","&frac12;":"½","&frac34":"¾","&frac34;":"¾","&iquest":"¿","&iquest;":"¿","&Agrave":"À","&Agrave;":"À","&Aacute":"Á","&Aacute;":"Á","&Acirc":"Â","&Acirc;":"Â","&Atilde":"Ã","&Atilde;":"Ã","&Auml":"Ä","&Auml;":"Ä","&Aring":"Å","&Aring;":"Å","&AElig":"Æ","&AElig;":"Æ","&Ccedil":"Ç","&Ccedil;":"Ç","&Egrave":"È","&Egrave;":"È","&Eacute":"É","&Eacute;":"É","&Ecirc":"Ê","&Ecirc;":"Ê","&Euml":"Ë","&Euml;":"Ë","&Igrave":"Ì","&Igrave;":"Ì","&Iacute":"Í","&Iacute;":"Í","&Icirc":"Î","&Icirc;":"Î","&Iuml":"Ï","&Iuml;":"Ï","&ETH":"Ð","&ETH;":"Ð","&Ntilde":"Ñ","&Ntilde;":"Ñ","&Ograve":"Ò","&Ograve;":"Ò","&Oacute":"Ó","&Oacute;":"Ó","&Ocirc":"Ô","&Ocirc;":"Ô","&Otilde":"Õ","&Otilde;":"Õ","&Ouml":"Ö","&Ouml;":"Ö","&times":"×","&times;":"×","&Oslash":"Ø","&Oslash;":"Ø","&Ugrave":"Ù","&Ugrave;":"Ù","&Uacute":"Ú","&Uacute;":"Ú","&Ucirc":"Û","&Ucirc;":"Û","&Uuml":"Ü","&Uuml;":"Ü","&Yacute":"Ý","&Yacute;":"Ý","&THORN":"Þ","&THORN;":"Þ","&szlig":"ß","&szlig;":"ß","&agrave":"à","&agrave;":"à","&aacute":"á","&aacute;":"á","&acirc":"â","&acirc;":"â","&atilde":"ã","&atilde;":"ã","&auml":"ä","&auml;":"ä","&aring":"å","&aring;":"å","&aelig":"æ","&aelig;":"æ","&ccedil":"ç","&ccedil;":"ç","&egrave":"è","&egrave;":"è","&eacute":"é","&eacute;":"é","&ecirc":"ê","&ecirc;":"ê","&euml":"ë","&euml;":"ë","&igrave":"ì","&igrave;":"ì","&iacute":"í","&iacute;":"í","&icirc":"î","&icirc;":"î","&iuml":"ï","&iuml;":"ï","&eth":"ð","&eth;":"ð","&ntilde":"ñ","&ntilde;":"ñ","&ograve":"ò","&ograve;":"ò","&oacute":"ó","&oacute;":"ó","&ocirc":"ô","&ocirc;":"ô","&otilde":"õ","&otilde;":"õ","&ouml":"ö","&ouml;":"ö","&divide":"÷","&divide;":"÷","&oslash":"ø","&oslash;":"ø","&ugrave":"ù","&ugrave;":"ù","&uacute":"ú","&uacute;":"ú","&ucirc":"û","&ucirc;":"û","&uuml":"ü","&uuml;":"ü","&yacute":"ý","&yacute;":"ý","&thorn":"þ","&thorn;":"þ","&yuml":"ÿ","&yuml;":"ÿ","&quot":'"',"&quot;":'"',"&amp":"&","&amp;":"&","&lt":"<","&lt;":"<","&gt":">","&gt;":">","&OElig;":"Œ","&oelig;":"œ","&Scaron;":"Š","&scaron;":"š","&Yuml;":"Ÿ","&circ;":"ˆ","&tilde;":"˜","&ensp;":" ","&emsp;":" ","&thinsp;":" ","&zwnj;":"‌","&zwj;":"‍","&lrm;":"‎","&rlm;":"‏","&ndash;":"–","&mdash;":"—","&lsquo;":"‘","&rsquo;":"’","&sbquo;":"‚","&ldquo;":"“","&rdquo;":"”","&bdquo;":"„","&dagger;":"†","&Dagger;":"‡","&permil;":"‰","&lsaquo;":"‹","&rsaquo;":"›","&euro;":"€","&fnof;":"ƒ","&Alpha;":"Α","&Beta;":"Β","&Gamma;":"Γ","&Delta;":"Δ","&Epsilon;":"Ε","&Zeta;":"Ζ","&Eta;":"Η","&Theta;":"Θ","&Iota;":"Ι","&Kappa;":"Κ","&Lambda;":"Λ","&Mu;":"Μ","&Nu;":"Ν","&Xi;":"Ξ","&Omicron;":"Ο","&Pi;":"Π","&Rho;":"Ρ","&Sigma;":"Σ","&Tau;":"Τ","&Upsilon;":"Υ","&Phi;":"Φ","&Chi;":"Χ","&Psi;":"Ψ","&Omega;":"Ω","&alpha;":"α","&beta;":"β","&gamma;":"γ","&delta;":"δ","&epsilon;":"ε","&zeta;":"ζ","&eta;":"η","&theta;":"θ","&iota;":"ι","&kappa;":"κ","&lambda;":"λ","&mu;":"μ","&nu;":"ν","&xi;":"ξ","&omicron;":"ο","&pi;":"π","&rho;":"ρ","&sigmaf;":"ς","&sigma;":"σ","&tau;":"τ","&upsilon;":"υ","&phi;":"φ","&chi;":"χ","&psi;":"ψ","&omega;":"ω","&thetasym;":"ϑ","&upsih;":"ϒ","&piv;":"ϖ","&bull;":"•","&hellip;":"…","&prime;":"′","&Prime;":"″","&oline;":"‾","&frasl;":"⁄","&weierp;":"℘","&image;":"ℑ","&real;":"ℜ","&trade;":"™","&alefsym;":"ℵ","&larr;":"←","&uarr;":"↑","&rarr;":"→","&darr;":"↓","&harr;":"↔","&crarr;":"↵","&lArr;":"⇐","&uArr;":"⇑","&rArr;":"⇒","&dArr;":"⇓","&hArr;":"⇔","&forall;":"∀","&part;":"∂","&exist;":"∃","&empty;":"∅","&nabla;":"∇","&isin;":"∈","&notin;":"∉","&ni;":"∋","&prod;":"∏","&sum;":"∑","&minus;":"−","&lowast;":"∗","&radic;":"√","&prop;":"∝","&infin;":"∞","&ang;":"∠","&and;":"∧","&or;":"∨","&cap;":"∩","&cup;":"∪","&int;":"∫","&there4;":"∴","&sim;":"∼","&cong;":"≅","&asymp;":"≈","&ne;":"≠","&equiv;":"≡","&le;":"≤","&ge;":"≥","&sub;":"⊂","&sup;":"⊃","&nsub;":"⊄","&sube;":"⊆","&supe;":"⊇","&oplus;":"⊕","&otimes;":"⊗","&perp;":"⊥","&sdot;":"⋅","&lceil;":"⌈","&rceil;":"⌉","&lfloor;":"⌊","&rfloor;":"⌋","&lang;":"〈","&rang;":"〉","&loz;":"◊","&spades;":"♠","&clubs;":"♣","&hearts;":"♥","&diams;":"♦"},characters:{"'":"&apos;"," ":"&nbsp;","¡":"&iexcl;","¢":"&cent;","£":"&pound;","¤":"&curren;","¥":"&yen;","¦":"&brvbar;","§":"&sect;","¨":"&uml;","©":"&copy;","ª":"&ordf;","«":"&laquo;","¬":"&not;","­":"&shy;","®":"&reg;","¯":"&macr;","°":"&deg;","±":"&plusmn;","²":"&sup2;","³":"&sup3;","´":"&acute;","µ":"&micro;","¶":"&para;","·":"&middot;","¸":"&cedil;","¹":"&sup1;","º":"&ordm;","»":"&raquo;","¼":"&frac14;","½":"&frac12;","¾":"&frac34;","¿":"&iquest;","À":"&Agrave;","Á":"&Aacute;","Â":"&Acirc;","Ã":"&Atilde;","Ä":"&Auml;","Å":"&Aring;","Æ":"&AElig;","Ç":"&Ccedil;","È":"&Egrave;","É":"&Eacute;","Ê":"&Ecirc;","Ë":"&Euml;","Ì":"&Igrave;","Í":"&Iacute;","Î":"&Icirc;","Ï":"&Iuml;","Ð":"&ETH;","Ñ":"&Ntilde;","Ò":"&Ograve;","Ó":"&Oacute;","Ô":"&Ocirc;","Õ":"&Otilde;","Ö":"&Ouml;","×":"&times;","Ø":"&Oslash;","Ù":"&Ugrave;","Ú":"&Uacute;","Û":"&Ucirc;","Ü":"&Uuml;","Ý":"&Yacute;","Þ":"&THORN;","ß":"&szlig;","à":"&agrave;","á":"&aacute;","â":"&acirc;","ã":"&atilde;","ä":"&auml;","å":"&aring;","æ":"&aelig;","ç":"&ccedil;","è":"&egrave;","é":"&eacute;","ê":"&ecirc;","ë":"&euml;","ì":"&igrave;","í":"&iacute;","î":"&icirc;","ï":"&iuml;","ð":"&eth;","ñ":"&ntilde;","ò":"&ograve;","ó":"&oacute;","ô":"&ocirc;","õ":"&otilde;","ö":"&ouml;","÷":"&divide;","ø":"&oslash;","ù":"&ugrave;","ú":"&uacute;","û":"&ucirc;","ü":"&uuml;","ý":"&yacute;","þ":"&thorn;","ÿ":"&yuml;",'"':"&quot;","&":"&amp;","<":"&lt;",">":"&gt;","Œ":"&OElig;","œ":"&oelig;","Š":"&Scaron;","š":"&scaron;","Ÿ":"&Yuml;","ˆ":"&circ;","˜":"&tilde;"," ":"&ensp;"," ":"&emsp;"," ":"&thinsp;","‌":"&zwnj;","‍":"&zwj;","‎":"&lrm;","‏":"&rlm;","–":"&ndash;","—":"&mdash;","‘":"&lsquo;","’":"&rsquo;","‚":"&sbquo;","“":"&ldquo;","”":"&rdquo;","„":"&bdquo;","†":"&dagger;","‡":"&Dagger;","‰":"&permil;","‹":"&lsaquo;","›":"&rsaquo;","€":"&euro;","ƒ":"&fnof;","Α":"&Alpha;","Β":"&Beta;","Γ":"&Gamma;","Δ":"&Delta;","Ε":"&Epsilon;","Ζ":"&Zeta;","Η":"&Eta;","Θ":"&Theta;","Ι":"&Iota;","Κ":"&Kappa;","Λ":"&Lambda;","Μ":"&Mu;","Ν":"&Nu;","Ξ":"&Xi;","Ο":"&Omicron;","Π":"&Pi;","Ρ":"&Rho;","Σ":"&Sigma;","Τ":"&Tau;","Υ":"&Upsilon;","Φ":"&Phi;","Χ":"&Chi;","Ψ":"&Psi;","Ω":"&Omega;","α":"&alpha;","β":"&beta;","γ":"&gamma;","δ":"&delta;","ε":"&epsilon;","ζ":"&zeta;","η":"&eta;","θ":"&theta;","ι":"&iota;","κ":"&kappa;","λ":"&lambda;","μ":"&mu;","ν":"&nu;","ξ":"&xi;","ο":"&omicron;","π":"&pi;","ρ":"&rho;","ς":"&sigmaf;","σ":"&sigma;","τ":"&tau;","υ":"&upsilon;","φ":"&phi;","χ":"&chi;","ψ":"&psi;","ω":"&omega;","ϑ":"&thetasym;","ϒ":"&upsih;","ϖ":"&piv;","•":"&bull;","…":"&hellip;","′":"&prime;","″":"&Prime;","‾":"&oline;","⁄":"&frasl;","℘":"&weierp;","ℑ":"&image;","ℜ":"&real;","™":"&trade;","ℵ":"&alefsym;","←":"&larr;","↑":"&uarr;","→":"&rarr;","↓":"&darr;","↔":"&harr;","↵":"&crarr;","⇐":"&lArr;","⇑":"&uArr;","⇒":"&rArr;","⇓":"&dArr;","⇔":"&hArr;","∀":"&forall;","∂":"&part;","∃":"&exist;","∅":"&empty;","∇":"&nabla;","∈":"&isin;","∉":"&notin;","∋":"&ni;","∏":"&prod;","∑":"&sum;","−":"&minus;","∗":"&lowast;","√":"&radic;","∝":"&prop;","∞":"&infin;","∠":"&ang;","∧":"&and;","∨":"&or;","∩":"&cap;","∪":"&cup;","∫":"&int;","∴":"&there4;","∼":"&sim;","≅":"&cong;","≈":"&asymp;","≠":"&ne;","≡":"&equiv;","≤":"&le;","≥":"&ge;","⊂":"&sub;","⊃":"&sup;","⊄":"&nsub;","⊆":"&sube;","⊇":"&supe;","⊕":"&oplus;","⊗":"&otimes;","⊥":"&perp;","⋅":"&sdot;","⌈":"&lceil;","⌉":"&rceil;","⌊":"&lfloor;","⌋":"&rfloor;","〈":"&lang;","〉":"&rang;","◊":"&loz;","♠":"&spades;","♣":"&clubs;","♥":"&hearts;","♦":"&diams;"}},html5:{entities:{"&AElig":"Æ","&AElig;":"Æ","&AMP":"&","&AMP;":"&","&Aacute":"Á","&Aacute;":"Á","&Abreve;":"Ă","&Acirc":"Â","&Acirc;":"Â","&Acy;":"А","&Afr;":"𝔄","&Agrave":"À","&Agrave;":"À","&Alpha;":"Α","&Amacr;":"Ā","&And;":"⩓","&Aogon;":"Ą","&Aopf;":"𝔸","&ApplyFunction;":"⁡","&Aring":"Å","&Aring;":"Å","&Ascr;":"𝒜","&Assign;":"≔","&Atilde":"Ã","&Atilde;":"Ã","&Auml":"Ä","&Auml;":"Ä","&Backslash;":"∖","&Barv;":"⫧","&Barwed;":"⌆","&Bcy;":"Б","&Because;":"∵","&Bernoullis;":"ℬ","&Beta;":"Β","&Bfr;":"𝔅","&Bopf;":"𝔹","&Breve;":"˘","&Bscr;":"ℬ","&Bumpeq;":"≎","&CHcy;":"Ч","&COPY":"©","&COPY;":"©","&Cacute;":"Ć","&Cap;":"⋒","&CapitalDifferentialD;":"ⅅ","&Cayleys;":"ℭ","&Ccaron;":"Č","&Ccedil":"Ç","&Ccedil;":"Ç","&Ccirc;":"Ĉ","&Cconint;":"∰","&Cdot;":"Ċ","&Cedilla;":"¸","&CenterDot;":"·","&Cfr;":"ℭ","&Chi;":"Χ","&CircleDot;":"⊙","&CircleMinus;":"⊖","&CirclePlus;":"⊕","&CircleTimes;":"⊗","&ClockwiseContourIntegral;":"∲","&CloseCurlyDoubleQuote;":"”","&CloseCurlyQuote;":"’","&Colon;":"∷","&Colone;":"⩴","&Congruent;":"≡","&Conint;":"∯","&ContourIntegral;":"∮","&Copf;":"ℂ","&Coproduct;":"∐","&CounterClockwiseContourIntegral;":"∳","&Cross;":"⨯","&Cscr;":"𝒞","&Cup;":"⋓","&CupCap;":"≍","&DD;":"ⅅ","&DDotrahd;":"⤑","&DJcy;":"Ђ","&DScy;":"Ѕ","&DZcy;":"Џ","&Dagger;":"‡","&Darr;":"↡","&Dashv;":"⫤","&Dcaron;":"Ď","&Dcy;":"Д","&Del;":"∇","&Delta;":"Δ","&Dfr;":"𝔇","&DiacriticalAcute;":"´","&DiacriticalDot;":"˙","&DiacriticalDoubleAcute;":"˝","&DiacriticalGrave;":"`","&DiacriticalTilde;":"˜","&Diamond;":"⋄","&DifferentialD;":"ⅆ","&Dopf;":"𝔻","&Dot;":"¨","&DotDot;":"⃜","&DotEqual;":"≐","&DoubleContourIntegral;":"∯","&DoubleDot;":"¨","&DoubleDownArrow;":"⇓","&DoubleLeftArrow;":"⇐","&DoubleLeftRightArrow;":"⇔","&DoubleLeftTee;":"⫤","&DoubleLongLeftArrow;":"⟸","&DoubleLongLeftRightArrow;":"⟺","&DoubleLongRightArrow;":"⟹","&DoubleRightArrow;":"⇒","&DoubleRightTee;":"⊨","&DoubleUpArrow;":"⇑","&DoubleUpDownArrow;":"⇕","&DoubleVerticalBar;":"∥","&DownArrow;":"↓","&DownArrowBar;":"⤓","&DownArrowUpArrow;":"⇵","&DownBreve;":"̑","&DownLeftRightVector;":"⥐","&DownLeftTeeVector;":"⥞","&DownLeftVector;":"↽","&DownLeftVectorBar;":"⥖","&DownRightTeeVector;":"⥟","&DownRightVector;":"⇁","&DownRightVectorBar;":"⥗","&DownTee;":"⊤","&DownTeeArrow;":"↧","&Downarrow;":"⇓","&Dscr;":"𝒟","&Dstrok;":"Đ","&ENG;":"Ŋ","&ETH":"Ð","&ETH;":"Ð","&Eacute":"É","&Eacute;":"É","&Ecaron;":"Ě","&Ecirc":"Ê","&Ecirc;":"Ê","&Ecy;":"Э","&Edot;":"Ė","&Efr;":"𝔈","&Egrave":"È","&Egrave;":"È","&Element;":"∈","&Emacr;":"Ē","&EmptySmallSquare;":"◻","&EmptyVerySmallSquare;":"▫","&Eogon;":"Ę","&Eopf;":"𝔼","&Epsilon;":"Ε","&Equal;":"⩵","&EqualTilde;":"≂","&Equilibrium;":"⇌","&Escr;":"ℰ","&Esim;":"⩳","&Eta;":"Η","&Euml":"Ë","&Euml;":"Ë","&Exists;":"∃","&ExponentialE;":"ⅇ","&Fcy;":"Ф","&Ffr;":"𝔉","&FilledSmallSquare;":"◼","&FilledVerySmallSquare;":"▪","&Fopf;":"𝔽","&ForAll;":"∀","&Fouriertrf;":"ℱ","&Fscr;":"ℱ","&GJcy;":"Ѓ","&GT":">","&GT;":">","&Gamma;":"Γ","&Gammad;":"Ϝ","&Gbreve;":"Ğ","&Gcedil;":"Ģ","&Gcirc;":"Ĝ","&Gcy;":"Г","&Gdot;":"Ġ","&Gfr;":"𝔊","&Gg;":"⋙","&Gopf;":"𝔾","&GreaterEqual;":"≥","&GreaterEqualLess;":"⋛","&GreaterFullEqual;":"≧","&GreaterGreater;":"⪢","&GreaterLess;":"≷","&GreaterSlantEqual;":"⩾","&GreaterTilde;":"≳","&Gscr;":"𝒢","&Gt;":"≫","&HARDcy;":"Ъ","&Hacek;":"ˇ","&Hat;":"^","&Hcirc;":"Ĥ","&Hfr;":"ℌ","&HilbertSpace;":"ℋ","&Hopf;":"ℍ","&HorizontalLine;":"─","&Hscr;":"ℋ","&Hstrok;":"Ħ","&HumpDownHump;":"≎","&HumpEqual;":"≏","&IEcy;":"Е","&IJlig;":"Ĳ","&IOcy;":"Ё","&Iacute":"Í","&Iacute;":"Í","&Icirc":"Î","&Icirc;":"Î","&Icy;":"И","&Idot;":"İ","&Ifr;":"ℑ","&Igrave":"Ì","&Igrave;":"Ì","&Im;":"ℑ","&Imacr;":"Ī","&ImaginaryI;":"ⅈ","&Implies;":"⇒","&Int;":"∬","&Integral;":"∫","&Intersection;":"⋂","&InvisibleComma;":"⁣","&InvisibleTimes;":"⁢","&Iogon;":"Į","&Iopf;":"𝕀","&Iota;":"Ι","&Iscr;":"ℐ","&Itilde;":"Ĩ","&Iukcy;":"І","&Iuml":"Ï","&Iuml;":"Ï","&Jcirc;":"Ĵ","&Jcy;":"Й","&Jfr;":"𝔍","&Jopf;":"𝕁","&Jscr;":"𝒥","&Jsercy;":"Ј","&Jukcy;":"Є","&KHcy;":"Х","&KJcy;":"Ќ","&Kappa;":"Κ","&Kcedil;":"Ķ","&Kcy;":"К","&Kfr;":"𝔎","&Kopf;":"𝕂","&Kscr;":"𝒦","&LJcy;":"Љ","&LT":"<","&LT;":"<","&Lacute;":"Ĺ","&Lambda;":"Λ","&Lang;":"⟪","&Laplacetrf;":"ℒ","&Larr;":"↞","&Lcaron;":"Ľ","&Lcedil;":"Ļ","&Lcy;":"Л","&LeftAngleBracket;":"⟨","&LeftArrow;":"←","&LeftArrowBar;":"⇤","&LeftArrowRightArrow;":"⇆","&LeftCeiling;":"⌈","&LeftDoubleBracket;":"⟦","&LeftDownTeeVector;":"⥡","&LeftDownVector;":"⇃","&LeftDownVectorBar;":"⥙","&LeftFloor;":"⌊","&LeftRightArrow;":"↔","&LeftRightVector;":"⥎","&LeftTee;":"⊣","&LeftTeeArrow;":"↤","&LeftTeeVector;":"⥚","&LeftTriangle;":"⊲","&LeftTriangleBar;":"⧏","&LeftTriangleEqual;":"⊴","&LeftUpDownVector;":"⥑","&LeftUpTeeVector;":"⥠","&LeftUpVector;":"↿","&LeftUpVectorBar;":"⥘","&LeftVector;":"↼","&LeftVectorBar;":"⥒","&Leftarrow;":"⇐","&Leftrightarrow;":"⇔","&LessEqualGreater;":"⋚","&LessFullEqual;":"≦","&LessGreater;":"≶","&LessLess;":"⪡","&LessSlantEqual;":"⩽","&LessTilde;":"≲","&Lfr;":"𝔏","&Ll;":"⋘","&Lleftarrow;":"⇚","&Lmidot;":"Ŀ","&LongLeftArrow;":"⟵","&LongLeftRightArrow;":"⟷","&LongRightArrow;":"⟶","&Longleftarrow;":"⟸","&Longleftrightarrow;":"⟺","&Longrightarrow;":"⟹","&Lopf;":"𝕃","&LowerLeftArrow;":"↙","&LowerRightArrow;":"↘","&Lscr;":"ℒ","&Lsh;":"↰","&Lstrok;":"Ł","&Lt;":"≪","&Map;":"⤅","&Mcy;":"М","&MediumSpace;":" ","&Mellintrf;":"ℳ","&Mfr;":"𝔐","&MinusPlus;":"∓","&Mopf;":"𝕄","&Mscr;":"ℳ","&Mu;":"Μ","&NJcy;":"Њ","&Nacute;":"Ń","&Ncaron;":"Ň","&Ncedil;":"Ņ","&Ncy;":"Н","&NegativeMediumSpace;":"​","&NegativeThickSpace;":"​","&NegativeThinSpace;":"​","&NegativeVeryThinSpace;":"​","&NestedGreaterGreater;":"≫","&NestedLessLess;":"≪","&NewLine;":"\n","&Nfr;":"𝔑","&NoBreak;":"⁠","&NonBreakingSpace;":" ","&Nopf;":"ℕ","&Not;":"⫬","&NotCongruent;":"≢","&NotCupCap;":"≭","&NotDoubleVerticalBar;":"∦","&NotElement;":"∉","&NotEqual;":"≠","&NotEqualTilde;":"≂̸","&NotExists;":"∄","&NotGreater;":"≯","&NotGreaterEqual;":"≱","&NotGreaterFullEqual;":"≧̸","&NotGreaterGreater;":"≫̸","&NotGreaterLess;":"≹","&NotGreaterSlantEqual;":"⩾̸","&NotGreaterTilde;":"≵","&NotHumpDownHump;":"≎̸","&NotHumpEqual;":"≏̸","&NotLeftTriangle;":"⋪","&NotLeftTriangleBar;":"⧏̸","&NotLeftTriangleEqual;":"⋬","&NotLess;":"≮","&NotLessEqual;":"≰","&NotLessGreater;":"≸","&NotLessLess;":"≪̸","&NotLessSlantEqual;":"⩽̸","&NotLessTilde;":"≴","&NotNestedGreaterGreater;":"⪢̸","&NotNestedLessLess;":"⪡̸","&NotPrecedes;":"⊀","&NotPrecedesEqual;":"⪯̸","&NotPrecedesSlantEqual;":"⋠","&NotReverseElement;":"∌","&NotRightTriangle;":"⋫","&NotRightTriangleBar;":"⧐̸","&NotRightTriangleEqual;":"⋭","&NotSquareSubset;":"⊏̸","&NotSquareSubsetEqual;":"⋢","&NotSquareSuperset;":"⊐̸","&NotSquareSupersetEqual;":"⋣","&NotSubset;":"⊂⃒","&NotSubsetEqual;":"⊈","&NotSucceeds;":"⊁","&NotSucceedsEqual;":"⪰̸","&NotSucceedsSlantEqual;":"⋡","&NotSucceedsTilde;":"≿̸","&NotSuperset;":"⊃⃒","&NotSupersetEqual;":"⊉","&NotTilde;":"≁","&NotTildeEqual;":"≄","&NotTildeFullEqual;":"≇","&NotTildeTilde;":"≉","&NotVerticalBar;":"∤","&Nscr;":"𝒩","&Ntilde":"Ñ","&Ntilde;":"Ñ","&Nu;":"Ν","&OElig;":"Œ","&Oacute":"Ó","&Oacute;":"Ó","&Ocirc":"Ô","&Ocirc;":"Ô","&Ocy;":"О","&Odblac;":"Ő","&Ofr;":"𝔒","&Ograve":"Ò","&Ograve;":"Ò","&Omacr;":"Ō","&Omega;":"Ω","&Omicron;":"Ο","&Oopf;":"𝕆","&OpenCurlyDoubleQuote;":"“","&OpenCurlyQuote;":"‘","&Or;":"⩔","&Oscr;":"𝒪","&Oslash":"Ø","&Oslash;":"Ø","&Otilde":"Õ","&Otilde;":"Õ","&Otimes;":"⨷","&Ouml":"Ö","&Ouml;":"Ö","&OverBar;":"‾","&OverBrace;":"⏞","&OverBracket;":"⎴","&OverParenthesis;":"⏜","&PartialD;":"∂","&Pcy;":"П","&Pfr;":"𝔓","&Phi;":"Φ","&Pi;":"Π","&PlusMinus;":"±","&Poincareplane;":"ℌ","&Popf;":"ℙ","&Pr;":"⪻","&Precedes;":"≺","&PrecedesEqual;":"⪯","&PrecedesSlantEqual;":"≼","&PrecedesTilde;":"≾","&Prime;":"″","&Product;":"∏","&Proportion;":"∷","&Proportional;":"∝","&Pscr;":"𝒫","&Psi;":"Ψ","&QUOT":'"',"&QUOT;":'"',"&Qfr;":"𝔔","&Qopf;":"ℚ","&Qscr;":"𝒬","&RBarr;":"⤐","&REG":"®","&REG;":"®","&Racute;":"Ŕ","&Rang;":"⟫","&Rarr;":"↠","&Rarrtl;":"⤖","&Rcaron;":"Ř","&Rcedil;":"Ŗ","&Rcy;":"Р","&Re;":"ℜ","&ReverseElement;":"∋","&ReverseEquilibrium;":"⇋","&ReverseUpEquilibrium;":"⥯","&Rfr;":"ℜ","&Rho;":"Ρ","&RightAngleBracket;":"⟩","&RightArrow;":"→","&RightArrowBar;":"⇥","&RightArrowLeftArrow;":"⇄","&RightCeiling;":"⌉","&RightDoubleBracket;":"⟧","&RightDownTeeVector;":"⥝","&RightDownVector;":"⇂","&RightDownVectorBar;":"⥕","&RightFloor;":"⌋","&RightTee;":"⊢","&RightTeeArrow;":"↦","&RightTeeVector;":"⥛","&RightTriangle;":"⊳","&RightTriangleBar;":"⧐","&RightTriangleEqual;":"⊵","&RightUpDownVector;":"⥏","&RightUpTeeVector;":"⥜","&RightUpVector;":"↾","&RightUpVectorBar;":"⥔","&RightVector;":"⇀","&RightVectorBar;":"⥓","&Rightarrow;":"⇒","&Ropf;":"ℝ","&RoundImplies;":"⥰","&Rrightarrow;":"⇛","&Rscr;":"ℛ","&Rsh;":"↱","&RuleDelayed;":"⧴","&SHCHcy;":"Щ","&SHcy;":"Ш","&SOFTcy;":"Ь","&Sacute;":"Ś","&Sc;":"⪼","&Scaron;":"Š","&Scedil;":"Ş","&Scirc;":"Ŝ","&Scy;":"С","&Sfr;":"𝔖","&ShortDownArrow;":"↓","&ShortLeftArrow;":"←","&ShortRightArrow;":"→","&ShortUpArrow;":"↑","&Sigma;":"Σ","&SmallCircle;":"∘","&Sopf;":"𝕊","&Sqrt;":"√","&Square;":"□","&SquareIntersection;":"⊓","&SquareSubset;":"⊏","&SquareSubsetEqual;":"⊑","&SquareSuperset;":"⊐","&SquareSupersetEqual;":"⊒","&SquareUnion;":"⊔","&Sscr;":"𝒮","&Star;":"⋆","&Sub;":"⋐","&Subset;":"⋐","&SubsetEqual;":"⊆","&Succeeds;":"≻","&SucceedsEqual;":"⪰","&SucceedsSlantEqual;":"≽","&SucceedsTilde;":"≿","&SuchThat;":"∋","&Sum;":"∑","&Sup;":"⋑","&Superset;":"⊃","&SupersetEqual;":"⊇","&Supset;":"⋑","&THORN":"Þ","&THORN;":"Þ","&TRADE;":"™","&TSHcy;":"Ћ","&TScy;":"Ц","&Tab;":"\t","&Tau;":"Τ","&Tcaron;":"Ť","&Tcedil;":"Ţ","&Tcy;":"Т","&Tfr;":"𝔗","&Therefore;":"∴","&Theta;":"Θ","&ThickSpace;":"  ","&ThinSpace;":" ","&Tilde;":"∼","&TildeEqual;":"≃","&TildeFullEqual;":"≅","&TildeTilde;":"≈","&Topf;":"𝕋","&TripleDot;":"⃛","&Tscr;":"𝒯","&Tstrok;":"Ŧ","&Uacute":"Ú","&Uacute;":"Ú","&Uarr;":"↟","&Uarrocir;":"⥉","&Ubrcy;":"Ў","&Ubreve;":"Ŭ","&Ucirc":"Û","&Ucirc;":"Û","&Ucy;":"У","&Udblac;":"Ű","&Ufr;":"𝔘","&Ugrave":"Ù","&Ugrave;":"Ù","&Umacr;":"Ū","&UnderBar;":"_","&UnderBrace;":"⏟","&UnderBracket;":"⎵","&UnderParenthesis;":"⏝","&Union;":"⋃","&UnionPlus;":"⊎","&Uogon;":"Ų","&Uopf;":"𝕌","&UpArrow;":"↑","&UpArrowBar;":"⤒","&UpArrowDownArrow;":"⇅","&UpDownArrow;":"↕","&UpEquilibrium;":"⥮","&UpTee;":"⊥","&UpTeeArrow;":"↥","&Uparrow;":"⇑","&Updownarrow;":"⇕","&UpperLeftArrow;":"↖","&UpperRightArrow;":"↗","&Upsi;":"ϒ","&Upsilon;":"Υ","&Uring;":"Ů","&Uscr;":"𝒰","&Utilde;":"Ũ","&Uuml":"Ü","&Uuml;":"Ü","&VDash;":"⊫","&Vbar;":"⫫","&Vcy;":"В","&Vdash;":"⊩","&Vdashl;":"⫦","&Vee;":"⋁","&Verbar;":"‖","&Vert;":"‖","&VerticalBar;":"∣","&VerticalLine;":"|","&VerticalSeparator;":"❘","&VerticalTilde;":"≀","&VeryThinSpace;":" ","&Vfr;":"𝔙","&Vopf;":"𝕍","&Vscr;":"𝒱","&Vvdash;":"⊪","&Wcirc;":"Ŵ","&Wedge;":"⋀","&Wfr;":"𝔚","&Wopf;":"𝕎","&Wscr;":"𝒲","&Xfr;":"𝔛","&Xi;":"Ξ","&Xopf;":"𝕏","&Xscr;":"𝒳","&YAcy;":"Я","&YIcy;":"Ї","&YUcy;":"Ю","&Yacute":"Ý","&Yacute;":"Ý","&Ycirc;":"Ŷ","&Ycy;":"Ы","&Yfr;":"𝔜","&Yopf;":"𝕐","&Yscr;":"𝒴","&Yuml;":"Ÿ","&ZHcy;":"Ж","&Zacute;":"Ź","&Zcaron;":"Ž","&Zcy;":"З","&Zdot;":"Ż","&ZeroWidthSpace;":"​","&Zeta;":"Ζ","&Zfr;":"ℨ","&Zopf;":"ℤ","&Zscr;":"𝒵","&aacute":"á","&aacute;":"á","&abreve;":"ă","&ac;":"∾","&acE;":"∾̳","&acd;":"∿","&acirc":"â","&acirc;":"â","&acute":"´","&acute;":"´","&acy;":"а","&aelig":"æ","&aelig;":"æ","&af;":"⁡","&afr;":"𝔞","&agrave":"à","&agrave;":"à","&alefsym;":"ℵ","&aleph;":"ℵ","&alpha;":"α","&amacr;":"ā","&amalg;":"⨿","&amp":"&","&amp;":"&","&and;":"∧","&andand;":"⩕","&andd;":"⩜","&andslope;":"⩘","&andv;":"⩚","&ang;":"∠","&ange;":"⦤","&angle;":"∠","&angmsd;":"∡","&angmsdaa;":"⦨","&angmsdab;":"⦩","&angmsdac;":"⦪","&angmsdad;":"⦫","&angmsdae;":"⦬","&angmsdaf;":"⦭","&angmsdag;":"⦮","&angmsdah;":"⦯","&angrt;":"∟","&angrtvb;":"⊾","&angrtvbd;":"⦝","&angsph;":"∢","&angst;":"Å","&angzarr;":"⍼","&aogon;":"ą","&aopf;":"𝕒","&ap;":"≈","&apE;":"⩰","&apacir;":"⩯","&ape;":"≊","&apid;":"≋","&apos;":"'","&approx;":"≈","&approxeq;":"≊","&aring":"å","&aring;":"å","&ascr;":"𝒶","&ast;":"*","&asymp;":"≈","&asympeq;":"≍","&atilde":"ã","&atilde;":"ã","&auml":"ä","&auml;":"ä","&awconint;":"∳","&awint;":"⨑","&bNot;":"⫭","&backcong;":"≌","&backepsilon;":"϶","&backprime;":"‵","&backsim;":"∽","&backsimeq;":"⋍","&barvee;":"⊽","&barwed;":"⌅","&barwedge;":"⌅","&bbrk;":"⎵","&bbrktbrk;":"⎶","&bcong;":"≌","&bcy;":"б","&bdquo;":"„","&becaus;":"∵","&because;":"∵","&bemptyv;":"⦰","&bepsi;":"϶","&bernou;":"ℬ","&beta;":"β","&beth;":"ℶ","&between;":"≬","&bfr;":"𝔟","&bigcap;":"⋂","&bigcirc;":"◯","&bigcup;":"⋃","&bigodot;":"⨀","&bigoplus;":"⨁","&bigotimes;":"⨂","&bigsqcup;":"⨆","&bigstar;":"★","&bigtriangledown;":"▽","&bigtriangleup;":"△","&biguplus;":"⨄","&bigvee;":"⋁","&bigwedge;":"⋀","&bkarow;":"⤍","&blacklozenge;":"⧫","&blacksquare;":"▪","&blacktriangle;":"▴","&blacktriangledown;":"▾","&blacktriangleleft;":"◂","&blacktriangleright;":"▸","&blank;":"␣","&blk12;":"▒","&blk14;":"░","&blk34;":"▓","&block;":"█","&bne;":"=⃥","&bnequiv;":"≡⃥","&bnot;":"⌐","&bopf;":"𝕓","&bot;":"⊥","&bottom;":"⊥","&bowtie;":"⋈","&boxDL;":"╗","&boxDR;":"╔","&boxDl;":"╖","&boxDr;":"╓","&boxH;":"═","&boxHD;":"╦","&boxHU;":"╩","&boxHd;":"╤","&boxHu;":"╧","&boxUL;":"╝","&boxUR;":"╚","&boxUl;":"╜","&boxUr;":"╙","&boxV;":"║","&boxVH;":"╬","&boxVL;":"╣","&boxVR;":"╠","&boxVh;":"╫","&boxVl;":"╢","&boxVr;":"╟","&boxbox;":"⧉","&boxdL;":"╕","&boxdR;":"╒","&boxdl;":"┐","&boxdr;":"┌","&boxh;":"─","&boxhD;":"╥","&boxhU;":"╨","&boxhd;":"┬","&boxhu;":"┴","&boxminus;":"⊟","&boxplus;":"⊞","&boxtimes;":"⊠","&boxuL;":"╛","&boxuR;":"╘","&boxul;":"┘","&boxur;":"└","&boxv;":"│","&boxvH;":"╪","&boxvL;":"╡","&boxvR;":"╞","&boxvh;":"┼","&boxvl;":"┤","&boxvr;":"├","&bprime;":"‵","&breve;":"˘","&brvbar":"¦","&brvbar;":"¦","&bscr;":"𝒷","&bsemi;":"⁏","&bsim;":"∽","&bsime;":"⋍","&bsol;":"\\","&bsolb;":"⧅","&bsolhsub;":"⟈","&bull;":"•","&bullet;":"•","&bump;":"≎","&bumpE;":"⪮","&bumpe;":"≏","&bumpeq;":"≏","&cacute;":"ć","&cap;":"∩","&capand;":"⩄","&capbrcup;":"⩉","&capcap;":"⩋","&capcup;":"⩇","&capdot;":"⩀","&caps;":"∩︀","&caret;":"⁁","&caron;":"ˇ","&ccaps;":"⩍","&ccaron;":"č","&ccedil":"ç","&ccedil;":"ç","&ccirc;":"ĉ","&ccups;":"⩌","&ccupssm;":"⩐","&cdot;":"ċ","&cedil":"¸","&cedil;":"¸","&cemptyv;":"⦲","&cent":"¢","&cent;":"¢","&centerdot;":"·","&cfr;":"𝔠","&chcy;":"ч","&check;":"✓","&checkmark;":"✓","&chi;":"χ","&cir;":"○","&cirE;":"⧃","&circ;":"ˆ","&circeq;":"≗","&circlearrowleft;":"↺","&circlearrowright;":"↻","&circledR;":"®","&circledS;":"Ⓢ","&circledast;":"⊛","&circledcirc;":"⊚","&circleddash;":"⊝","&cire;":"≗","&cirfnint;":"⨐","&cirmid;":"⫯","&cirscir;":"⧂","&clubs;":"♣","&clubsuit;":"♣","&colon;":":","&colone;":"≔","&coloneq;":"≔","&comma;":",","&commat;":"@","&comp;":"∁","&compfn;":"∘","&complement;":"∁","&complexes;":"ℂ","&cong;":"≅","&congdot;":"⩭","&conint;":"∮","&copf;":"𝕔","&coprod;":"∐","&copy":"©","&copy;":"©","&copysr;":"℗","&crarr;":"↵","&cross;":"✗","&cscr;":"𝒸","&csub;":"⫏","&csube;":"⫑","&csup;":"⫐","&csupe;":"⫒","&ctdot;":"⋯","&cudarrl;":"⤸","&cudarrr;":"⤵","&cuepr;":"⋞","&cuesc;":"⋟","&cularr;":"↶","&cularrp;":"⤽","&cup;":"∪","&cupbrcap;":"⩈","&cupcap;":"⩆","&cupcup;":"⩊","&cupdot;":"⊍","&cupor;":"⩅","&cups;":"∪︀","&curarr;":"↷","&curarrm;":"⤼","&curlyeqprec;":"⋞","&curlyeqsucc;":"⋟","&curlyvee;":"⋎","&curlywedge;":"⋏","&curren":"¤","&curren;":"¤","&curvearrowleft;":"↶","&curvearrowright;":"↷","&cuvee;":"⋎","&cuwed;":"⋏","&cwconint;":"∲","&cwint;":"∱","&cylcty;":"⌭","&dArr;":"⇓","&dHar;":"⥥","&dagger;":"†","&daleth;":"ℸ","&darr;":"↓","&dash;":"‐","&dashv;":"⊣","&dbkarow;":"⤏","&dblac;":"˝","&dcaron;":"ď","&dcy;":"д","&dd;":"ⅆ","&ddagger;":"‡","&ddarr;":"⇊","&ddotseq;":"⩷","&deg":"°","&deg;":"°","&delta;":"δ","&demptyv;":"⦱","&dfisht;":"⥿","&dfr;":"𝔡","&dharl;":"⇃","&dharr;":"⇂","&diam;":"⋄","&diamond;":"⋄","&diamondsuit;":"♦","&diams;":"♦","&die;":"¨","&digamma;":"ϝ","&disin;":"⋲","&div;":"÷","&divide":"÷","&divide;":"÷","&divideontimes;":"⋇","&divonx;":"⋇","&djcy;":"ђ","&dlcorn;":"⌞","&dlcrop;":"⌍","&dollar;":"$","&dopf;":"𝕕","&dot;":"˙","&doteq;":"≐","&doteqdot;":"≑","&dotminus;":"∸","&dotplus;":"∔","&dotsquare;":"⊡","&doublebarwedge;":"⌆","&downarrow;":"↓","&downdownarrows;":"⇊","&downharpoonleft;":"⇃","&downharpoonright;":"⇂","&drbkarow;":"⤐","&drcorn;":"⌟","&drcrop;":"⌌","&dscr;":"𝒹","&dscy;":"ѕ","&dsol;":"⧶","&dstrok;":"đ","&dtdot;":"⋱","&dtri;":"▿","&dtrif;":"▾","&duarr;":"⇵","&duhar;":"⥯","&dwangle;":"⦦","&dzcy;":"џ","&dzigrarr;":"⟿","&eDDot;":"⩷","&eDot;":"≑","&eacute":"é","&eacute;":"é","&easter;":"⩮","&ecaron;":"ě","&ecir;":"≖","&ecirc":"ê","&ecirc;":"ê","&ecolon;":"≕","&ecy;":"э","&edot;":"ė","&ee;":"ⅇ","&efDot;":"≒","&efr;":"𝔢","&eg;":"⪚","&egrave":"è","&egrave;":"è","&egs;":"⪖","&egsdot;":"⪘","&el;":"⪙","&elinters;":"⏧","&ell;":"ℓ","&els;":"⪕","&elsdot;":"⪗","&emacr;":"ē","&empty;":"∅","&emptyset;":"∅","&emptyv;":"∅","&emsp13;":" ","&emsp14;":" ","&emsp;":" ","&eng;":"ŋ","&ensp;":" ","&eogon;":"ę","&eopf;":"𝕖","&epar;":"⋕","&eparsl;":"⧣","&eplus;":"⩱","&epsi;":"ε","&epsilon;":"ε","&epsiv;":"ϵ","&eqcirc;":"≖","&eqcolon;":"≕","&eqsim;":"≂","&eqslantgtr;":"⪖","&eqslantless;":"⪕","&equals;":"=","&equest;":"≟","&equiv;":"≡","&equivDD;":"⩸","&eqvparsl;":"⧥","&erDot;":"≓","&erarr;":"⥱","&escr;":"ℯ","&esdot;":"≐","&esim;":"≂","&eta;":"η","&eth":"ð","&eth;":"ð","&euml":"ë","&euml;":"ë","&euro;":"€","&excl;":"!","&exist;":"∃","&expectation;":"ℰ","&exponentiale;":"ⅇ","&fallingdotseq;":"≒","&fcy;":"ф","&female;":"♀","&ffilig;":"ﬃ","&fflig;":"ﬀ","&ffllig;":"ﬄ","&ffr;":"𝔣","&filig;":"ﬁ","&fjlig;":"fj","&flat;":"♭","&fllig;":"ﬂ","&fltns;":"▱","&fnof;":"ƒ","&fopf;":"𝕗","&forall;":"∀","&fork;":"⋔","&forkv;":"⫙","&fpartint;":"⨍","&frac12":"½","&frac12;":"½","&frac13;":"⅓","&frac14":"¼","&frac14;":"¼","&frac15;":"⅕","&frac16;":"⅙","&frac18;":"⅛","&frac23;":"⅔","&frac25;":"⅖","&frac34":"¾","&frac34;":"¾","&frac35;":"⅗","&frac38;":"⅜","&frac45;":"⅘","&frac56;":"⅚","&frac58;":"⅝","&frac78;":"⅞","&frasl;":"⁄","&frown;":"⌢","&fscr;":"𝒻","&gE;":"≧","&gEl;":"⪌","&gacute;":"ǵ","&gamma;":"γ","&gammad;":"ϝ","&gap;":"⪆","&gbreve;":"ğ","&gcirc;":"ĝ","&gcy;":"г","&gdot;":"ġ","&ge;":"≥","&gel;":"⋛","&geq;":"≥","&geqq;":"≧","&geqslant;":"⩾","&ges;":"⩾","&gescc;":"⪩","&gesdot;":"⪀","&gesdoto;":"⪂","&gesdotol;":"⪄","&gesl;":"⋛︀","&gesles;":"⪔","&gfr;":"𝔤","&gg;":"≫","&ggg;":"⋙","&gimel;":"ℷ","&gjcy;":"ѓ","&gl;":"≷","&glE;":"⪒","&gla;":"⪥","&glj;":"⪤","&gnE;":"≩","&gnap;":"⪊","&gnapprox;":"⪊","&gne;":"⪈","&gneq;":"⪈","&gneqq;":"≩","&gnsim;":"⋧","&gopf;":"𝕘","&grave;":"`","&gscr;":"ℊ","&gsim;":"≳","&gsime;":"⪎","&gsiml;":"⪐","&gt":">","&gt;":">","&gtcc;":"⪧","&gtcir;":"⩺","&gtdot;":"⋗","&gtlPar;":"⦕","&gtquest;":"⩼","&gtrapprox;":"⪆","&gtrarr;":"⥸","&gtrdot;":"⋗","&gtreqless;":"⋛","&gtreqqless;":"⪌","&gtrless;":"≷","&gtrsim;":"≳","&gvertneqq;":"≩︀","&gvnE;":"≩︀","&hArr;":"⇔","&hairsp;":" ","&half;":"½","&hamilt;":"ℋ","&hardcy;":"ъ","&harr;":"↔","&harrcir;":"⥈","&harrw;":"↭","&hbar;":"ℏ","&hcirc;":"ĥ","&hearts;":"♥","&heartsuit;":"♥","&hellip;":"…","&hercon;":"⊹","&hfr;":"𝔥","&hksearow;":"⤥","&hkswarow;":"⤦","&hoarr;":"⇿","&homtht;":"∻","&hookleftarrow;":"↩","&hookrightarrow;":"↪","&hopf;":"𝕙","&horbar;":"―","&hscr;":"𝒽","&hslash;":"ℏ","&hstrok;":"ħ","&hybull;":"⁃","&hyphen;":"‐","&iacute":"í","&iacute;":"í","&ic;":"⁣","&icirc":"î","&icirc;":"î","&icy;":"и","&iecy;":"е","&iexcl":"¡","&iexcl;":"¡","&iff;":"⇔","&ifr;":"𝔦","&igrave":"ì","&igrave;":"ì","&ii;":"ⅈ","&iiiint;":"⨌","&iiint;":"∭","&iinfin;":"⧜","&iiota;":"℩","&ijlig;":"ĳ","&imacr;":"ī","&image;":"ℑ","&imagline;":"ℐ","&imagpart;":"ℑ","&imath;":"ı","&imof;":"⊷","&imped;":"Ƶ","&in;":"∈","&incare;":"℅","&infin;":"∞","&infintie;":"⧝","&inodot;":"ı","&int;":"∫","&intcal;":"⊺","&integers;":"ℤ","&intercal;":"⊺","&intlarhk;":"⨗","&intprod;":"⨼","&iocy;":"ё","&iogon;":"į","&iopf;":"𝕚","&iota;":"ι","&iprod;":"⨼","&iquest":"¿","&iquest;":"¿","&iscr;":"𝒾","&isin;":"∈","&isinE;":"⋹","&isindot;":"⋵","&isins;":"⋴","&isinsv;":"⋳","&isinv;":"∈","&it;":"⁢","&itilde;":"ĩ","&iukcy;":"і","&iuml":"ï","&iuml;":"ï","&jcirc;":"ĵ","&jcy;":"й","&jfr;":"𝔧","&jmath;":"ȷ","&jopf;":"𝕛","&jscr;":"𝒿","&jsercy;":"ј","&jukcy;":"є","&kappa;":"κ","&kappav;":"ϰ","&kcedil;":"ķ","&kcy;":"к","&kfr;":"𝔨","&kgreen;":"ĸ","&khcy;":"х","&kjcy;":"ќ","&kopf;":"𝕜","&kscr;":"𝓀","&lAarr;":"⇚","&lArr;":"⇐","&lAtail;":"⤛","&lBarr;":"⤎","&lE;":"≦","&lEg;":"⪋","&lHar;":"⥢","&lacute;":"ĺ","&laemptyv;":"⦴","&lagran;":"ℒ","&lambda;":"λ","&lang;":"⟨","&langd;":"⦑","&langle;":"⟨","&lap;":"⪅","&laquo":"«","&laquo;":"«","&larr;":"←","&larrb;":"⇤","&larrbfs;":"⤟","&larrfs;":"⤝","&larrhk;":"↩","&larrlp;":"↫","&larrpl;":"⤹","&larrsim;":"⥳","&larrtl;":"↢","&lat;":"⪫","&latail;":"⤙","&late;":"⪭","&lates;":"⪭︀","&lbarr;":"⤌","&lbbrk;":"❲","&lbrace;":"{","&lbrack;":"[","&lbrke;":"⦋","&lbrksld;":"⦏","&lbrkslu;":"⦍","&lcaron;":"ľ","&lcedil;":"ļ","&lceil;":"⌈","&lcub;":"{","&lcy;":"л","&ldca;":"⤶","&ldquo;":"“","&ldquor;":"„","&ldrdhar;":"⥧","&ldrushar;":"⥋","&ldsh;":"↲","&le;":"≤","&leftarrow;":"←","&leftarrowtail;":"↢","&leftharpoondown;":"↽","&leftharpoonup;":"↼","&leftleftarrows;":"⇇","&leftrightarrow;":"↔","&leftrightarrows;":"⇆","&leftrightharpoons;":"⇋","&leftrightsquigarrow;":"↭","&leftthreetimes;":"⋋","&leg;":"⋚","&leq;":"≤","&leqq;":"≦","&leqslant;":"⩽","&les;":"⩽","&lescc;":"⪨","&lesdot;":"⩿","&lesdoto;":"⪁","&lesdotor;":"⪃","&lesg;":"⋚︀","&lesges;":"⪓","&lessapprox;":"⪅","&lessdot;":"⋖","&lesseqgtr;":"⋚","&lesseqqgtr;":"⪋","&lessgtr;":"≶","&lesssim;":"≲","&lfisht;":"⥼","&lfloor;":"⌊","&lfr;":"𝔩","&lg;":"≶","&lgE;":"⪑","&lhard;":"↽","&lharu;":"↼","&lharul;":"⥪","&lhblk;":"▄","&ljcy;":"љ","&ll;":"≪","&llarr;":"⇇","&llcorner;":"⌞","&llhard;":"⥫","&lltri;":"◺","&lmidot;":"ŀ","&lmoust;":"⎰","&lmoustache;":"⎰","&lnE;":"≨","&lnap;":"⪉","&lnapprox;":"⪉","&lne;":"⪇","&lneq;":"⪇","&lneqq;":"≨","&lnsim;":"⋦","&loang;":"⟬","&loarr;":"⇽","&lobrk;":"⟦","&longleftarrow;":"⟵","&longleftrightarrow;":"⟷","&longmapsto;":"⟼","&longrightarrow;":"⟶","&looparrowleft;":"↫","&looparrowright;":"↬","&lopar;":"⦅","&lopf;":"𝕝","&loplus;":"⨭","&lotimes;":"⨴","&lowast;":"∗","&lowbar;":"_","&loz;":"◊","&lozenge;":"◊","&lozf;":"⧫","&lpar;":"(","&lparlt;":"⦓","&lrarr;":"⇆","&lrcorner;":"⌟","&lrhar;":"⇋","&lrhard;":"⥭","&lrm;":"‎","&lrtri;":"⊿","&lsaquo;":"‹","&lscr;":"𝓁","&lsh;":"↰","&lsim;":"≲","&lsime;":"⪍","&lsimg;":"⪏","&lsqb;":"[","&lsquo;":"‘","&lsquor;":"‚","&lstrok;":"ł","&lt":"<","&lt;":"<","&ltcc;":"⪦","&ltcir;":"⩹","&ltdot;":"⋖","&lthree;":"⋋","&ltimes;":"⋉","&ltlarr;":"⥶","&ltquest;":"⩻","&ltrPar;":"⦖","&ltri;":"◃","&ltrie;":"⊴","&ltrif;":"◂","&lurdshar;":"⥊","&luruhar;":"⥦","&lvertneqq;":"≨︀","&lvnE;":"≨︀","&mDDot;":"∺","&macr":"¯","&macr;":"¯","&male;":"♂","&malt;":"✠","&maltese;":"✠","&map;":"↦","&mapsto;":"↦","&mapstodown;":"↧","&mapstoleft;":"↤","&mapstoup;":"↥","&marker;":"▮","&mcomma;":"⨩","&mcy;":"м","&mdash;":"—","&measuredangle;":"∡","&mfr;":"𝔪","&mho;":"℧","&micro":"µ","&micro;":"µ","&mid;":"∣","&midast;":"*","&midcir;":"⫰","&middot":"·","&middot;":"·","&minus;":"−","&minusb;":"⊟","&minusd;":"∸","&minusdu;":"⨪","&mlcp;":"⫛","&mldr;":"…","&mnplus;":"∓","&models;":"⊧","&mopf;":"𝕞","&mp;":"∓","&mscr;":"𝓂","&mstpos;":"∾","&mu;":"μ","&multimap;":"⊸","&mumap;":"⊸","&nGg;":"⋙̸","&nGt;":"≫⃒","&nGtv;":"≫̸","&nLeftarrow;":"⇍","&nLeftrightarrow;":"⇎","&nLl;":"⋘̸","&nLt;":"≪⃒","&nLtv;":"≪̸","&nRightarrow;":"⇏","&nVDash;":"⊯","&nVdash;":"⊮","&nabla;":"∇","&nacute;":"ń","&nang;":"∠⃒","&nap;":"≉","&napE;":"⩰̸","&napid;":"≋̸","&napos;":"ŉ","&napprox;":"≉","&natur;":"♮","&natural;":"♮","&naturals;":"ℕ","&nbsp":" ","&nbsp;":" ","&nbump;":"≎̸","&nbumpe;":"≏̸","&ncap;":"⩃","&ncaron;":"ň","&ncedil;":"ņ","&ncong;":"≇","&ncongdot;":"⩭̸","&ncup;":"⩂","&ncy;":"н","&ndash;":"–","&ne;":"≠","&neArr;":"⇗","&nearhk;":"⤤","&nearr;":"↗","&nearrow;":"↗","&nedot;":"≐̸","&nequiv;":"≢","&nesear;":"⤨","&nesim;":"≂̸","&nexist;":"∄","&nexists;":"∄","&nfr;":"𝔫","&ngE;":"≧̸","&nge;":"≱","&ngeq;":"≱","&ngeqq;":"≧̸","&ngeqslant;":"⩾̸","&nges;":"⩾̸","&ngsim;":"≵","&ngt;":"≯","&ngtr;":"≯","&nhArr;":"⇎","&nharr;":"↮","&nhpar;":"⫲","&ni;":"∋","&nis;":"⋼","&nisd;":"⋺","&niv;":"∋","&njcy;":"њ","&nlArr;":"⇍","&nlE;":"≦̸","&nlarr;":"↚","&nldr;":"‥","&nle;":"≰","&nleftarrow;":"↚","&nleftrightarrow;":"↮","&nleq;":"≰","&nleqq;":"≦̸","&nleqslant;":"⩽̸","&nles;":"⩽̸","&nless;":"≮","&nlsim;":"≴","&nlt;":"≮","&nltri;":"⋪","&nltrie;":"⋬","&nmid;":"∤","&nopf;":"𝕟","&not":"¬","&not;":"¬","&notin;":"∉","&notinE;":"⋹̸","&notindot;":"⋵̸","&notinva;":"∉","&notinvb;":"⋷","&notinvc;":"⋶","&notni;":"∌","&notniva;":"∌","&notnivb;":"⋾","&notnivc;":"⋽","&npar;":"∦","&nparallel;":"∦","&nparsl;":"⫽⃥","&npart;":"∂̸","&npolint;":"⨔","&npr;":"⊀","&nprcue;":"⋠","&npre;":"⪯̸","&nprec;":"⊀","&npreceq;":"⪯̸","&nrArr;":"⇏","&nrarr;":"↛","&nrarrc;":"⤳̸","&nrarrw;":"↝̸","&nrightarrow;":"↛","&nrtri;":"⋫","&nrtrie;":"⋭","&nsc;":"⊁","&nsccue;":"⋡","&nsce;":"⪰̸","&nscr;":"𝓃","&nshortmid;":"∤","&nshortparallel;":"∦","&nsim;":"≁","&nsime;":"≄","&nsimeq;":"≄","&nsmid;":"∤","&nspar;":"∦","&nsqsube;":"⋢","&nsqsupe;":"⋣","&nsub;":"⊄","&nsubE;":"⫅̸","&nsube;":"⊈","&nsubset;":"⊂⃒","&nsubseteq;":"⊈","&nsubseteqq;":"⫅̸","&nsucc;":"⊁","&nsucceq;":"⪰̸","&nsup;":"⊅","&nsupE;":"⫆̸","&nsupe;":"⊉","&nsupset;":"⊃⃒","&nsupseteq;":"⊉","&nsupseteqq;":"⫆̸","&ntgl;":"≹","&ntilde":"ñ","&ntilde;":"ñ","&ntlg;":"≸","&ntriangleleft;":"⋪","&ntrianglelefteq;":"⋬","&ntriangleright;":"⋫","&ntrianglerighteq;":"⋭","&nu;":"ν","&num;":"#","&numero;":"№","&numsp;":" ","&nvDash;":"⊭","&nvHarr;":"⤄","&nvap;":"≍⃒","&nvdash;":"⊬","&nvge;":"≥⃒","&nvgt;":">⃒","&nvinfin;":"⧞","&nvlArr;":"⤂","&nvle;":"≤⃒","&nvlt;":"<⃒","&nvltrie;":"⊴⃒","&nvrArr;":"⤃","&nvrtrie;":"⊵⃒","&nvsim;":"∼⃒","&nwArr;":"⇖","&nwarhk;":"⤣","&nwarr;":"↖","&nwarrow;":"↖","&nwnear;":"⤧","&oS;":"Ⓢ","&oacute":"ó","&oacute;":"ó","&oast;":"⊛","&ocir;":"⊚","&ocirc":"ô","&ocirc;":"ô","&ocy;":"о","&odash;":"⊝","&odblac;":"ő","&odiv;":"⨸","&odot;":"⊙","&odsold;":"⦼","&oelig;":"œ","&ofcir;":"⦿","&ofr;":"𝔬","&ogon;":"˛","&ograve":"ò","&ograve;":"ò","&ogt;":"⧁","&ohbar;":"⦵","&ohm;":"Ω","&oint;":"∮","&olarr;":"↺","&olcir;":"⦾","&olcross;":"⦻","&oline;":"‾","&olt;":"⧀","&omacr;":"ō","&omega;":"ω","&omicron;":"ο","&omid;":"⦶","&ominus;":"⊖","&oopf;":"𝕠","&opar;":"⦷","&operp;":"⦹","&oplus;":"⊕","&or;":"∨","&orarr;":"↻","&ord;":"⩝","&order;":"ℴ","&orderof;":"ℴ","&ordf":"ª","&ordf;":"ª","&ordm":"º","&ordm;":"º","&origof;":"⊶","&oror;":"⩖","&orslope;":"⩗","&orv;":"⩛","&oscr;":"ℴ","&oslash":"ø","&oslash;":"ø","&osol;":"⊘","&otilde":"õ","&otilde;":"õ","&otimes;":"⊗","&otimesas;":"⨶","&ouml":"ö","&ouml;":"ö","&ovbar;":"⌽","&par;":"∥","&para":"¶","&para;":"¶","&parallel;":"∥","&parsim;":"⫳","&parsl;":"⫽","&part;":"∂","&pcy;":"п","&percnt;":"%","&period;":".","&permil;":"‰","&perp;":"⊥","&pertenk;":"‱","&pfr;":"𝔭","&phi;":"φ","&phiv;":"ϕ","&phmmat;":"ℳ","&phone;":"☎","&pi;":"π","&pitchfork;":"⋔","&piv;":"ϖ","&planck;":"ℏ","&planckh;":"ℎ","&plankv;":"ℏ","&plus;":"+","&plusacir;":"⨣","&plusb;":"⊞","&pluscir;":"⨢","&plusdo;":"∔","&plusdu;":"⨥","&pluse;":"⩲","&plusmn":"±","&plusmn;":"±","&plussim;":"⨦","&plustwo;":"⨧","&pm;":"±","&pointint;":"⨕","&popf;":"𝕡","&pound":"£","&pound;":"£","&pr;":"≺","&prE;":"⪳","&prap;":"⪷","&prcue;":"≼","&pre;":"⪯","&prec;":"≺","&precapprox;":"⪷","&preccurlyeq;":"≼","&preceq;":"⪯","&precnapprox;":"⪹","&precneqq;":"⪵","&precnsim;":"⋨","&precsim;":"≾","&prime;":"′","&primes;":"ℙ","&prnE;":"⪵","&prnap;":"⪹","&prnsim;":"⋨","&prod;":"∏","&profalar;":"⌮","&profline;":"⌒","&profsurf;":"⌓","&prop;":"∝","&propto;":"∝","&prsim;":"≾","&prurel;":"⊰","&pscr;":"𝓅","&psi;":"ψ","&puncsp;":" ","&qfr;":"𝔮","&qint;":"⨌","&qopf;":"𝕢","&qprime;":"⁗","&qscr;":"𝓆","&quaternions;":"ℍ","&quatint;":"⨖","&quest;":"?","&questeq;":"≟","&quot":'"',"&quot;":'"',"&rAarr;":"⇛","&rArr;":"⇒","&rAtail;":"⤜","&rBarr;":"⤏","&rHar;":"⥤","&race;":"∽̱","&racute;":"ŕ","&radic;":"√","&raemptyv;":"⦳","&rang;":"⟩","&rangd;":"⦒","&range;":"⦥","&rangle;":"⟩","&raquo":"»","&raquo;":"»","&rarr;":"→","&rarrap;":"⥵","&rarrb;":"⇥","&rarrbfs;":"⤠","&rarrc;":"⤳","&rarrfs;":"⤞","&rarrhk;":"↪","&rarrlp;":"↬","&rarrpl;":"⥅","&rarrsim;":"⥴","&rarrtl;":"↣","&rarrw;":"↝","&ratail;":"⤚","&ratio;":"∶","&rationals;":"ℚ","&rbarr;":"⤍","&rbbrk;":"❳","&rbrace;":"}","&rbrack;":"]","&rbrke;":"⦌","&rbrksld;":"⦎","&rbrkslu;":"⦐","&rcaron;":"ř","&rcedil;":"ŗ","&rceil;":"⌉","&rcub;":"}","&rcy;":"р","&rdca;":"⤷","&rdldhar;":"⥩","&rdquo;":"”","&rdquor;":"”","&rdsh;":"↳","&real;":"ℜ","&realine;":"ℛ","&realpart;":"ℜ","&reals;":"ℝ","&rect;":"▭","&reg":"®","&reg;":"®","&rfisht;":"⥽","&rfloor;":"⌋","&rfr;":"𝔯","&rhard;":"⇁","&rharu;":"⇀","&rharul;":"⥬","&rho;":"ρ","&rhov;":"ϱ","&rightarrow;":"→","&rightarrowtail;":"↣","&rightharpoondown;":"⇁","&rightharpoonup;":"⇀","&rightleftarrows;":"⇄","&rightleftharpoons;":"⇌","&rightrightarrows;":"⇉","&rightsquigarrow;":"↝","&rightthreetimes;":"⋌","&ring;":"˚","&risingdotseq;":"≓","&rlarr;":"⇄","&rlhar;":"⇌","&rlm;":"‏","&rmoust;":"⎱","&rmoustache;":"⎱","&rnmid;":"⫮","&roang;":"⟭","&roarr;":"⇾","&robrk;":"⟧","&ropar;":"⦆","&ropf;":"𝕣","&roplus;":"⨮","&rotimes;":"⨵","&rpar;":")","&rpargt;":"⦔","&rppolint;":"⨒","&rrarr;":"⇉","&rsaquo;":"›","&rscr;":"𝓇","&rsh;":"↱","&rsqb;":"]","&rsquo;":"’","&rsquor;":"’","&rthree;":"⋌","&rtimes;":"⋊","&rtri;":"▹","&rtrie;":"⊵","&rtrif;":"▸","&rtriltri;":"⧎","&ruluhar;":"⥨","&rx;":"℞","&sacute;":"ś","&sbquo;":"‚","&sc;":"≻","&scE;":"⪴","&scap;":"⪸","&scaron;":"š","&sccue;":"≽","&sce;":"⪰","&scedil;":"ş","&scirc;":"ŝ","&scnE;":"⪶","&scnap;":"⪺","&scnsim;":"⋩","&scpolint;":"⨓","&scsim;":"≿","&scy;":"с","&sdot;":"⋅","&sdotb;":"⊡","&sdote;":"⩦","&seArr;":"⇘","&searhk;":"⤥","&searr;":"↘","&searrow;":"↘","&sect":"§","&sect;":"§","&semi;":";","&seswar;":"⤩","&setminus;":"∖","&setmn;":"∖","&sext;":"✶","&sfr;":"𝔰","&sfrown;":"⌢","&sharp;":"♯","&shchcy;":"щ","&shcy;":"ш","&shortmid;":"∣","&shortparallel;":"∥","&shy":"­","&shy;":"­","&sigma;":"σ","&sigmaf;":"ς","&sigmav;":"ς","&sim;":"∼","&simdot;":"⩪","&sime;":"≃","&simeq;":"≃","&simg;":"⪞","&simgE;":"⪠","&siml;":"⪝","&simlE;":"⪟","&simne;":"≆","&simplus;":"⨤","&simrarr;":"⥲","&slarr;":"←","&smallsetminus;":"∖","&smashp;":"⨳","&smeparsl;":"⧤","&smid;":"∣","&smile;":"⌣","&smt;":"⪪","&smte;":"⪬","&smtes;":"⪬︀","&softcy;":"ь","&sol;":"/","&solb;":"⧄","&solbar;":"⌿","&sopf;":"𝕤","&spades;":"♠","&spadesuit;":"♠","&spar;":"∥","&sqcap;":"⊓","&sqcaps;":"⊓︀","&sqcup;":"⊔","&sqcups;":"⊔︀","&sqsub;":"⊏","&sqsube;":"⊑","&sqsubset;":"⊏","&sqsubseteq;":"⊑","&sqsup;":"⊐","&sqsupe;":"⊒","&sqsupset;":"⊐","&sqsupseteq;":"⊒","&squ;":"□","&square;":"□","&squarf;":"▪","&squf;":"▪","&srarr;":"→","&sscr;":"𝓈","&ssetmn;":"∖","&ssmile;":"⌣","&sstarf;":"⋆","&star;":"☆","&starf;":"★","&straightepsilon;":"ϵ","&straightphi;":"ϕ","&strns;":"¯","&sub;":"⊂","&subE;":"⫅","&subdot;":"⪽","&sube;":"⊆","&subedot;":"⫃","&submult;":"⫁","&subnE;":"⫋","&subne;":"⊊","&subplus;":"⪿","&subrarr;":"⥹","&subset;":"⊂","&subseteq;":"⊆","&subseteqq;":"⫅","&subsetneq;":"⊊","&subsetneqq;":"⫋","&subsim;":"⫇","&subsub;":"⫕","&subsup;":"⫓","&succ;":"≻","&succapprox;":"⪸","&succcurlyeq;":"≽","&succeq;":"⪰","&succnapprox;":"⪺","&succneqq;":"⪶","&succnsim;":"⋩","&succsim;":"≿","&sum;":"∑","&sung;":"♪","&sup1":"¹","&sup1;":"¹","&sup2":"²","&sup2;":"²","&sup3":"³","&sup3;":"³","&sup;":"⊃","&supE;":"⫆","&supdot;":"⪾","&supdsub;":"⫘","&supe;":"⊇","&supedot;":"⫄","&suphsol;":"⟉","&suphsub;":"⫗","&suplarr;":"⥻","&supmult;":"⫂","&supnE;":"⫌","&supne;":"⊋","&supplus;":"⫀","&supset;":"⊃","&supseteq;":"⊇","&supseteqq;":"⫆","&supsetneq;":"⊋","&supsetneqq;":"⫌","&supsim;":"⫈","&supsub;":"⫔","&supsup;":"⫖","&swArr;":"⇙","&swarhk;":"⤦","&swarr;":"↙","&swarrow;":"↙","&swnwar;":"⤪","&szlig":"ß","&szlig;":"ß","&target;":"⌖","&tau;":"τ","&tbrk;":"⎴","&tcaron;":"ť","&tcedil;":"ţ","&tcy;":"т","&tdot;":"⃛","&telrec;":"⌕","&tfr;":"𝔱","&there4;":"∴","&therefore;":"∴","&theta;":"θ","&thetasym;":"ϑ","&thetav;":"ϑ","&thickapprox;":"≈","&thicksim;":"∼","&thinsp;":" ","&thkap;":"≈","&thksim;":"∼","&thorn":"þ","&thorn;":"þ","&tilde;":"˜","&times":"×","&times;":"×","&timesb;":"⊠","&timesbar;":"⨱","&timesd;":"⨰","&tint;":"∭","&toea;":"⤨","&top;":"⊤","&topbot;":"⌶","&topcir;":"⫱","&topf;":"𝕥","&topfork;":"⫚","&tosa;":"⤩","&tprime;":"‴","&trade;":"™","&triangle;":"▵","&triangledown;":"▿","&triangleleft;":"◃","&trianglelefteq;":"⊴","&triangleq;":"≜","&triangleright;":"▹","&trianglerighteq;":"⊵","&tridot;":"◬","&trie;":"≜","&triminus;":"⨺","&triplus;":"⨹","&trisb;":"⧍","&tritime;":"⨻","&trpezium;":"⏢","&tscr;":"𝓉","&tscy;":"ц","&tshcy;":"ћ","&tstrok;":"ŧ","&twixt;":"≬","&twoheadleftarrow;":"↞","&twoheadrightarrow;":"↠","&uArr;":"⇑","&uHar;":"⥣","&uacute":"ú","&uacute;":"ú","&uarr;":"↑","&ubrcy;":"ў","&ubreve;":"ŭ","&ucirc":"û","&ucirc;":"û","&ucy;":"у","&udarr;":"⇅","&udblac;":"ű","&udhar;":"⥮","&ufisht;":"⥾","&ufr;":"𝔲","&ugrave":"ù","&ugrave;":"ù","&uharl;":"↿","&uharr;":"↾","&uhblk;":"▀","&ulcorn;":"⌜","&ulcorner;":"⌜","&ulcrop;":"⌏","&ultri;":"◸","&umacr;":"ū","&uml":"¨","&uml;":"¨","&uogon;":"ų","&uopf;":"𝕦","&uparrow;":"↑","&updownarrow;":"↕","&upharpoonleft;":"↿","&upharpoonright;":"↾","&uplus;":"⊎","&upsi;":"υ","&upsih;":"ϒ","&upsilon;":"υ","&upuparrows;":"⇈","&urcorn;":"⌝","&urcorner;":"⌝","&urcrop;":"⌎","&uring;":"ů","&urtri;":"◹","&uscr;":"𝓊","&utdot;":"⋰","&utilde;":"ũ","&utri;":"▵","&utrif;":"▴","&uuarr;":"⇈","&uuml":"ü","&uuml;":"ü","&uwangle;":"⦧","&vArr;":"⇕","&vBar;":"⫨","&vBarv;":"⫩","&vDash;":"⊨","&vangrt;":"⦜","&varepsilon;":"ϵ","&varkappa;":"ϰ","&varnothing;":"∅","&varphi;":"ϕ","&varpi;":"ϖ","&varpropto;":"∝","&varr;":"↕","&varrho;":"ϱ","&varsigma;":"ς","&varsubsetneq;":"⊊︀","&varsubsetneqq;":"⫋︀","&varsupsetneq;":"⊋︀","&varsupsetneqq;":"⫌︀","&vartheta;":"ϑ","&vartriangleleft;":"⊲","&vartriangleright;":"⊳","&vcy;":"в","&vdash;":"⊢","&vee;":"∨","&veebar;":"⊻","&veeeq;":"≚","&vellip;":"⋮","&verbar;":"|","&vert;":"|","&vfr;":"𝔳","&vltri;":"⊲","&vnsub;":"⊂⃒","&vnsup;":"⊃⃒","&vopf;":"𝕧","&vprop;":"∝","&vrtri;":"⊳","&vscr;":"𝓋","&vsubnE;":"⫋︀","&vsubne;":"⊊︀","&vsupnE;":"⫌︀","&vsupne;":"⊋︀","&vzigzag;":"⦚","&wcirc;":"ŵ","&wedbar;":"⩟","&wedge;":"∧","&wedgeq;":"≙","&weierp;":"℘","&wfr;":"𝔴","&wopf;":"𝕨","&wp;":"℘","&wr;":"≀","&wreath;":"≀","&wscr;":"𝓌","&xcap;":"⋂","&xcirc;":"◯","&xcup;":"⋃","&xdtri;":"▽","&xfr;":"𝔵","&xhArr;":"⟺","&xharr;":"⟷","&xi;":"ξ","&xlArr;":"⟸","&xlarr;":"⟵","&xmap;":"⟼","&xnis;":"⋻","&xodot;":"⨀","&xopf;":"𝕩","&xoplus;":"⨁","&xotime;":"⨂","&xrArr;":"⟹","&xrarr;":"⟶","&xscr;":"𝓍","&xsqcup;":"⨆","&xuplus;":"⨄","&xutri;":"△","&xvee;":"⋁","&xwedge;":"⋀","&yacute":"ý","&yacute;":"ý","&yacy;":"я","&ycirc;":"ŷ","&ycy;":"ы","&yen":"¥","&yen;":"¥","&yfr;":"𝔶","&yicy;":"ї","&yopf;":"𝕪","&yscr;":"𝓎","&yucy;":"ю","&yuml":"ÿ","&yuml;":"ÿ","&zacute;":"ź","&zcaron;":"ž","&zcy;":"з","&zdot;":"ż","&zeetrf;":"ℨ","&zeta;":"ζ","&zfr;":"𝔷","&zhcy;":"ж","&zigrarr;":"⇝","&zopf;":"𝕫","&zscr;":"𝓏","&zwj;":"‍","&zwnj;":"‌"},characters:{"Æ":"&AElig;","&":"&amp;","Á":"&Aacute;","Ă":"&Abreve;","Â":"&Acirc;","А":"&Acy;","𝔄":"&Afr;","À":"&Agrave;","Α":"&Alpha;","Ā":"&Amacr;","⩓":"&And;","Ą":"&Aogon;","𝔸":"&Aopf;","⁡":"&af;","Å":"&angst;","𝒜":"&Ascr;","≔":"&coloneq;","Ã":"&Atilde;","Ä":"&Auml;","∖":"&ssetmn;","⫧":"&Barv;","⌆":"&doublebarwedge;","Б":"&Bcy;","∵":"&because;","ℬ":"&bernou;","Β":"&Beta;","𝔅":"&Bfr;","𝔹":"&Bopf;","˘":"&breve;","≎":"&bump;","Ч":"&CHcy;","©":"&copy;","Ć":"&Cacute;","⋒":"&Cap;","ⅅ":"&DD;","ℭ":"&Cfr;","Č":"&Ccaron;","Ç":"&Ccedil;","Ĉ":"&Ccirc;","∰":"&Cconint;","Ċ":"&Cdot;","¸":"&cedil;","·":"&middot;","Χ":"&Chi;","⊙":"&odot;","⊖":"&ominus;","⊕":"&oplus;","⊗":"&otimes;","∲":"&cwconint;","”":"&rdquor;","’":"&rsquor;","∷":"&Proportion;","⩴":"&Colone;","≡":"&equiv;","∯":"&DoubleContourIntegral;","∮":"&oint;","ℂ":"&complexes;","∐":"&coprod;","∳":"&awconint;","⨯":"&Cross;","𝒞":"&Cscr;","⋓":"&Cup;","≍":"&asympeq;","⤑":"&DDotrahd;","Ђ":"&DJcy;","Ѕ":"&DScy;","Џ":"&DZcy;","‡":"&ddagger;","↡":"&Darr;","⫤":"&DoubleLeftTee;","Ď":"&Dcaron;","Д":"&Dcy;","∇":"&nabla;","Δ":"&Delta;","𝔇":"&Dfr;","´":"&acute;","˙":"&dot;","˝":"&dblac;","`":"&grave;","˜":"&tilde;","⋄":"&diamond;","ⅆ":"&dd;","𝔻":"&Dopf;","¨":"&uml;","⃜":"&DotDot;","≐":"&esdot;","⇓":"&dArr;","⇐":"&lArr;","⇔":"&iff;","⟸":"&xlArr;","⟺":"&xhArr;","⟹":"&xrArr;","⇒":"&rArr;","⊨":"&vDash;","⇑":"&uArr;","⇕":"&vArr;","∥":"&spar;","↓":"&downarrow;","⤓":"&DownArrowBar;","⇵":"&duarr;","̑":"&DownBreve;","⥐":"&DownLeftRightVector;","⥞":"&DownLeftTeeVector;","↽":"&lhard;","⥖":"&DownLeftVectorBar;","⥟":"&DownRightTeeVector;","⇁":"&rightharpoondown;","⥗":"&DownRightVectorBar;","⊤":"&top;","↧":"&mapstodown;","𝒟":"&Dscr;","Đ":"&Dstrok;","Ŋ":"&ENG;","Ð":"&ETH;","É":"&Eacute;","Ě":"&Ecaron;","Ê":"&Ecirc;","Э":"&Ecy;","Ė":"&Edot;","𝔈":"&Efr;","È":"&Egrave;","∈":"&isinv;","Ē":"&Emacr;","◻":"&EmptySmallSquare;","▫":"&EmptyVerySmallSquare;","Ę":"&Eogon;","𝔼":"&Eopf;","Ε":"&Epsilon;","⩵":"&Equal;","≂":"&esim;","⇌":"&rlhar;","ℰ":"&expectation;","⩳":"&Esim;","Η":"&Eta;","Ë":"&Euml;","∃":"&exist;","ⅇ":"&exponentiale;","Ф":"&Fcy;","𝔉":"&Ffr;","◼":"&FilledSmallSquare;","▪":"&squf;","𝔽":"&Fopf;","∀":"&forall;","ℱ":"&Fscr;","Ѓ":"&GJcy;",">":"&gt;","Γ":"&Gamma;","Ϝ":"&Gammad;","Ğ":"&Gbreve;","Ģ":"&Gcedil;","Ĝ":"&Gcirc;","Г":"&Gcy;","Ġ":"&Gdot;","𝔊":"&Gfr;","⋙":"&ggg;","𝔾":"&Gopf;","≥":"&geq;","⋛":"&gtreqless;","≧":"&geqq;","⪢":"&GreaterGreater;","≷":"&gtrless;","⩾":"&ges;","≳":"&gtrsim;","𝒢":"&Gscr;","≫":"&gg;","Ъ":"&HARDcy;","ˇ":"&caron;","^":"&Hat;","Ĥ":"&Hcirc;","ℌ":"&Poincareplane;","ℋ":"&hamilt;","ℍ":"&quaternions;","─":"&boxh;","Ħ":"&Hstrok;","≏":"&bumpeq;","Е":"&IEcy;","Ĳ":"&IJlig;","Ё":"&IOcy;","Í":"&Iacute;","Î":"&Icirc;","И":"&Icy;","İ":"&Idot;","ℑ":"&imagpart;","Ì":"&Igrave;","Ī":"&Imacr;","ⅈ":"&ii;","∬":"&Int;","∫":"&int;","⋂":"&xcap;","⁣":"&ic;","⁢":"&it;","Į":"&Iogon;","𝕀":"&Iopf;","Ι":"&Iota;","ℐ":"&imagline;","Ĩ":"&Itilde;","І":"&Iukcy;","Ï":"&Iuml;","Ĵ":"&Jcirc;","Й":"&Jcy;","𝔍":"&Jfr;","𝕁":"&Jopf;","𝒥":"&Jscr;","Ј":"&Jsercy;","Є":"&Jukcy;","Х":"&KHcy;","Ќ":"&KJcy;","Κ":"&Kappa;","Ķ":"&Kcedil;","К":"&Kcy;","𝔎":"&Kfr;","𝕂":"&Kopf;","𝒦":"&Kscr;","Љ":"&LJcy;","<":"&lt;","Ĺ":"&Lacute;","Λ":"&Lambda;","⟪":"&Lang;","ℒ":"&lagran;","↞":"&twoheadleftarrow;","Ľ":"&Lcaron;","Ļ":"&Lcedil;","Л":"&Lcy;","⟨":"&langle;","←":"&slarr;","⇤":"&larrb;","⇆":"&lrarr;","⌈":"&lceil;","⟦":"&lobrk;","⥡":"&LeftDownTeeVector;","⇃":"&downharpoonleft;","⥙":"&LeftDownVectorBar;","⌊":"&lfloor;","↔":"&leftrightarrow;","⥎":"&LeftRightVector;","⊣":"&dashv;","↤":"&mapstoleft;","⥚":"&LeftTeeVector;","⊲":"&vltri;","⧏":"&LeftTriangleBar;","⊴":"&trianglelefteq;","⥑":"&LeftUpDownVector;","⥠":"&LeftUpTeeVector;","↿":"&upharpoonleft;","⥘":"&LeftUpVectorBar;","↼":"&lharu;","⥒":"&LeftVectorBar;","⋚":"&lesseqgtr;","≦":"&leqq;","≶":"&lg;","⪡":"&LessLess;","⩽":"&les;","≲":"&lsim;","𝔏":"&Lfr;","⋘":"&Ll;","⇚":"&lAarr;","Ŀ":"&Lmidot;","⟵":"&xlarr;","⟷":"&xharr;","⟶":"&xrarr;","𝕃":"&Lopf;","↙":"&swarrow;","↘":"&searrow;","↰":"&lsh;","Ł":"&Lstrok;","≪":"&ll;","⤅":"&Map;","М":"&Mcy;"," ":"&MediumSpace;","ℳ":"&phmmat;","𝔐":"&Mfr;","∓":"&mp;","𝕄":"&Mopf;","Μ":"&Mu;","Њ":"&NJcy;","Ń":"&Nacute;","Ň":"&Ncaron;","Ņ":"&Ncedil;","Н":"&Ncy;","​":"&ZeroWidthSpace;","\n":"&NewLine;","𝔑":"&Nfr;","⁠":"&NoBreak;"," ":"&nbsp;","ℕ":"&naturals;","⫬":"&Not;","≢":"&nequiv;","≭":"&NotCupCap;","∦":"&nspar;","∉":"&notinva;","≠":"&ne;","≂̸":"&nesim;","∄":"&nexists;","≯":"&ngtr;","≱":"&ngeq;","≧̸":"&ngeqq;","≫̸":"&nGtv;","≹":"&ntgl;","⩾̸":"&nges;","≵":"&ngsim;","≎̸":"&nbump;","≏̸":"&nbumpe;","⋪":"&ntriangleleft;","⧏̸":"&NotLeftTriangleBar;","⋬":"&ntrianglelefteq;","≮":"&nlt;","≰":"&nleq;","≸":"&ntlg;","≪̸":"&nLtv;","⩽̸":"&nles;","≴":"&nlsim;","⪢̸":"&NotNestedGreaterGreater;","⪡̸":"&NotNestedLessLess;","⊀":"&nprec;","⪯̸":"&npreceq;","⋠":"&nprcue;","∌":"&notniva;","⋫":"&ntriangleright;","⧐̸":"&NotRightTriangleBar;","⋭":"&ntrianglerighteq;","⊏̸":"&NotSquareSubset;","⋢":"&nsqsube;","⊐̸":"&NotSquareSuperset;","⋣":"&nsqsupe;","⊂⃒":"&vnsub;","⊈":"&nsubseteq;","⊁":"&nsucc;","⪰̸":"&nsucceq;","⋡":"&nsccue;","≿̸":"&NotSucceedsTilde;","⊃⃒":"&vnsup;","⊉":"&nsupseteq;","≁":"&nsim;","≄":"&nsimeq;","≇":"&ncong;","≉":"&napprox;","∤":"&nsmid;","𝒩":"&Nscr;","Ñ":"&Ntilde;","Ν":"&Nu;","Œ":"&OElig;","Ó":"&Oacute;","Ô":"&Ocirc;","О":"&Ocy;","Ő":"&Odblac;","𝔒":"&Ofr;","Ò":"&Ograve;","Ō":"&Omacr;","Ω":"&ohm;","Ο":"&Omicron;","𝕆":"&Oopf;","“":"&ldquo;","‘":"&lsquo;","⩔":"&Or;","𝒪":"&Oscr;","Ø":"&Oslash;","Õ":"&Otilde;","⨷":"&Otimes;","Ö":"&Ouml;","‾":"&oline;","⏞":"&OverBrace;","⎴":"&tbrk;","⏜":"&OverParenthesis;","∂":"&part;","П":"&Pcy;","𝔓":"&Pfr;","Φ":"&Phi;","Π":"&Pi;","±":"&pm;","ℙ":"&primes;","⪻":"&Pr;","≺":"&prec;","⪯":"&preceq;","≼":"&preccurlyeq;","≾":"&prsim;","″":"&Prime;","∏":"&prod;","∝":"&vprop;","𝒫":"&Pscr;","Ψ":"&Psi;",'"':"&quot;","𝔔":"&Qfr;","ℚ":"&rationals;","𝒬":"&Qscr;","⤐":"&drbkarow;","®":"&reg;","Ŕ":"&Racute;","⟫":"&Rang;","↠":"&twoheadrightarrow;","⤖":"&Rarrtl;","Ř":"&Rcaron;","Ŗ":"&Rcedil;","Р":"&Rcy;","ℜ":"&realpart;","∋":"&niv;","⇋":"&lrhar;","⥯":"&duhar;","Ρ":"&Rho;","⟩":"&rangle;","→":"&srarr;","⇥":"&rarrb;","⇄":"&rlarr;","⌉":"&rceil;","⟧":"&robrk;","⥝":"&RightDownTeeVector;","⇂":"&downharpoonright;","⥕":"&RightDownVectorBar;","⌋":"&rfloor;","⊢":"&vdash;","↦":"&mapsto;","⥛":"&RightTeeVector;","⊳":"&vrtri;","⧐":"&RightTriangleBar;","⊵":"&trianglerighteq;","⥏":"&RightUpDownVector;","⥜":"&RightUpTeeVector;","↾":"&upharpoonright;","⥔":"&RightUpVectorBar;","⇀":"&rightharpoonup;","⥓":"&RightVectorBar;","ℝ":"&reals;","⥰":"&RoundImplies;","⇛":"&rAarr;","ℛ":"&realine;","↱":"&rsh;","⧴":"&RuleDelayed;","Щ":"&SHCHcy;","Ш":"&SHcy;","Ь":"&SOFTcy;","Ś":"&Sacute;","⪼":"&Sc;","Š":"&Scaron;","Ş":"&Scedil;","Ŝ":"&Scirc;","С":"&Scy;","𝔖":"&Sfr;","↑":"&uparrow;","Σ":"&Sigma;","∘":"&compfn;","𝕊":"&Sopf;","√":"&radic;","□":"&square;","⊓":"&sqcap;","⊏":"&sqsubset;","⊑":"&sqsubseteq;","⊐":"&sqsupset;","⊒":"&sqsupseteq;","⊔":"&sqcup;","𝒮":"&Sscr;","⋆":"&sstarf;","⋐":"&Subset;","⊆":"&subseteq;","≻":"&succ;","⪰":"&succeq;","≽":"&succcurlyeq;","≿":"&succsim;","∑":"&sum;","⋑":"&Supset;","⊃":"&supset;","⊇":"&supseteq;","Þ":"&THORN;","™":"&trade;","Ћ":"&TSHcy;","Ц":"&TScy;","\t":"&Tab;","Τ":"&Tau;","Ť":"&Tcaron;","Ţ":"&Tcedil;","Т":"&Tcy;","𝔗":"&Tfr;","∴":"&therefore;","Θ":"&Theta;","  ":"&ThickSpace;"," ":"&thinsp;","∼":"&thksim;","≃":"&simeq;","≅":"&cong;","≈":"&thkap;","𝕋":"&Topf;","⃛":"&tdot;","𝒯":"&Tscr;","Ŧ":"&Tstrok;","Ú":"&Uacute;","↟":"&Uarr;","⥉":"&Uarrocir;","Ў":"&Ubrcy;","Ŭ":"&Ubreve;","Û":"&Ucirc;","У":"&Ucy;","Ű":"&Udblac;","𝔘":"&Ufr;","Ù":"&Ugrave;","Ū":"&Umacr;",_:"&lowbar;","⏟":"&UnderBrace;","⎵":"&bbrk;","⏝":"&UnderParenthesis;","⋃":"&xcup;","⊎":"&uplus;","Ų":"&Uogon;","𝕌":"&Uopf;","⤒":"&UpArrowBar;","⇅":"&udarr;","↕":"&varr;","⥮":"&udhar;","⊥":"&perp;","↥":"&mapstoup;","↖":"&nwarrow;","↗":"&nearrow;","ϒ":"&upsih;","Υ":"&Upsilon;","Ů":"&Uring;","𝒰":"&Uscr;","Ũ":"&Utilde;","Ü":"&Uuml;","⊫":"&VDash;","⫫":"&Vbar;","В":"&Vcy;","⊩":"&Vdash;","⫦":"&Vdashl;","⋁":"&xvee;","‖":"&Vert;","∣":"&smid;","|":"&vert;","❘":"&VerticalSeparator;","≀":"&wreath;"," ":"&hairsp;","𝔙":"&Vfr;","𝕍":"&Vopf;","𝒱":"&Vscr;","⊪":"&Vvdash;","Ŵ":"&Wcirc;","⋀":"&xwedge;","𝔚":"&Wfr;","𝕎":"&Wopf;","𝒲":"&Wscr;","𝔛":"&Xfr;","Ξ":"&Xi;","𝕏":"&Xopf;","𝒳":"&Xscr;","Я":"&YAcy;","Ї":"&YIcy;","Ю":"&YUcy;","Ý":"&Yacute;","Ŷ":"&Ycirc;","Ы":"&Ycy;","𝔜":"&Yfr;","𝕐":"&Yopf;","𝒴":"&Yscr;","Ÿ":"&Yuml;","Ж":"&ZHcy;","Ź":"&Zacute;","Ž":"&Zcaron;","З":"&Zcy;","Ż":"&Zdot;","Ζ":"&Zeta;","ℨ":"&zeetrf;","ℤ":"&integers;","𝒵":"&Zscr;","á":"&aacute;","ă":"&abreve;","∾":"&mstpos;","∾̳":"&acE;","∿":"&acd;","â":"&acirc;","а":"&acy;","æ":"&aelig;","𝔞":"&afr;","à":"&agrave;","ℵ":"&aleph;","α":"&alpha;","ā":"&amacr;","⨿":"&amalg;","∧":"&wedge;","⩕":"&andand;","⩜":"&andd;","⩘":"&andslope;","⩚":"&andv;","∠":"&angle;","⦤":"&ange;","∡":"&measuredangle;","⦨":"&angmsdaa;","⦩":"&angmsdab;","⦪":"&angmsdac;","⦫":"&angmsdad;","⦬":"&angmsdae;","⦭":"&angmsdaf;","⦮":"&angmsdag;","⦯":"&angmsdah;","∟":"&angrt;","⊾":"&angrtvb;","⦝":"&angrtvbd;","∢":"&angsph;","⍼":"&angzarr;","ą":"&aogon;","𝕒":"&aopf;","⩰":"&apE;","⩯":"&apacir;","≊":"&approxeq;","≋":"&apid;","'":"&apos;","å":"&aring;","𝒶":"&ascr;","*":"&midast;","ã":"&atilde;","ä":"&auml;","⨑":"&awint;","⫭":"&bNot;","≌":"&bcong;","϶":"&bepsi;","‵":"&bprime;","∽":"&bsim;","⋍":"&bsime;","⊽":"&barvee;","⌅":"&barwedge;","⎶":"&bbrktbrk;","б":"&bcy;","„":"&ldquor;","⦰":"&bemptyv;","β":"&beta;","ℶ":"&beth;","≬":"&twixt;","𝔟":"&bfr;","◯":"&xcirc;","⨀":"&xodot;","⨁":"&xoplus;","⨂":"&xotime;","⨆":"&xsqcup;","★":"&starf;","▽":"&xdtri;","△":"&xutri;","⨄":"&xuplus;","⤍":"&rbarr;","⧫":"&lozf;","▴":"&utrif;","▾":"&dtrif;","◂":"&ltrif;","▸":"&rtrif;","␣":"&blank;","▒":"&blk12;","░":"&blk14;","▓":"&blk34;","█":"&block;","=⃥":"&bne;","≡⃥":"&bnequiv;","⌐":"&bnot;","𝕓":"&bopf;","⋈":"&bowtie;","╗":"&boxDL;","╔":"&boxDR;","╖":"&boxDl;","╓":"&boxDr;","═":"&boxH;","╦":"&boxHD;","╩":"&boxHU;","╤":"&boxHd;","╧":"&boxHu;","╝":"&boxUL;","╚":"&boxUR;","╜":"&boxUl;","╙":"&boxUr;","║":"&boxV;","╬":"&boxVH;","╣":"&boxVL;","╠":"&boxVR;","╫":"&boxVh;","╢":"&boxVl;","╟":"&boxVr;","⧉":"&boxbox;","╕":"&boxdL;","╒":"&boxdR;","┐":"&boxdl;","┌":"&boxdr;","╥":"&boxhD;","╨":"&boxhU;","┬":"&boxhd;","┴":"&boxhu;","⊟":"&minusb;","⊞":"&plusb;","⊠":"&timesb;","╛":"&boxuL;","╘":"&boxuR;","┘":"&boxul;","└":"&boxur;","│":"&boxv;","╪":"&boxvH;","╡":"&boxvL;","╞":"&boxvR;","┼":"&boxvh;","┤":"&boxvl;","├":"&boxvr;","¦":"&brvbar;","𝒷":"&bscr;","⁏":"&bsemi;","\\":"&bsol;","⧅":"&bsolb;","⟈":"&bsolhsub;","•":"&bullet;","⪮":"&bumpE;","ć":"&cacute;","∩":"&cap;","⩄":"&capand;","⩉":"&capbrcup;","⩋":"&capcap;","⩇":"&capcup;","⩀":"&capdot;","∩︀":"&caps;","⁁":"&caret;","⩍":"&ccaps;","č":"&ccaron;","ç":"&ccedil;","ĉ":"&ccirc;","⩌":"&ccups;","⩐":"&ccupssm;","ċ":"&cdot;","⦲":"&cemptyv;","¢":"&cent;","𝔠":"&cfr;","ч":"&chcy;","✓":"&checkmark;","χ":"&chi;","○":"&cir;","⧃":"&cirE;","ˆ":"&circ;","≗":"&cire;","↺":"&olarr;","↻":"&orarr;","Ⓢ":"&oS;","⊛":"&oast;","⊚":"&ocir;","⊝":"&odash;","⨐":"&cirfnint;","⫯":"&cirmid;","⧂":"&cirscir;","♣":"&clubsuit;",":":"&colon;",",":"&comma;","@":"&commat;","∁":"&complement;","⩭":"&congdot;","𝕔":"&copf;","℗":"&copysr;","↵":"&crarr;","✗":"&cross;","𝒸":"&cscr;","⫏":"&csub;","⫑":"&csube;","⫐":"&csup;","⫒":"&csupe;","⋯":"&ctdot;","⤸":"&cudarrl;","⤵":"&cudarrr;","⋞":"&curlyeqprec;","⋟":"&curlyeqsucc;","↶":"&curvearrowleft;","⤽":"&cularrp;","∪":"&cup;","⩈":"&cupbrcap;","⩆":"&cupcap;","⩊":"&cupcup;","⊍":"&cupdot;","⩅":"&cupor;","∪︀":"&cups;","↷":"&curvearrowright;","⤼":"&curarrm;","⋎":"&cuvee;","⋏":"&cuwed;","¤":"&curren;","∱":"&cwint;","⌭":"&cylcty;","⥥":"&dHar;","†":"&dagger;","ℸ":"&daleth;","‐":"&hyphen;","⤏":"&rBarr;","ď":"&dcaron;","д":"&dcy;","⇊":"&downdownarrows;","⩷":"&eDDot;","°":"&deg;","δ":"&delta;","⦱":"&demptyv;","⥿":"&dfisht;","𝔡":"&dfr;","♦":"&diams;","ϝ":"&gammad;","⋲":"&disin;","÷":"&divide;","⋇":"&divonx;","ђ":"&djcy;","⌞":"&llcorner;","⌍":"&dlcrop;",$:"&dollar;","𝕕":"&dopf;","≑":"&eDot;","∸":"&minusd;","∔":"&plusdo;","⊡":"&sdotb;","⌟":"&lrcorner;","⌌":"&drcrop;","𝒹":"&dscr;","ѕ":"&dscy;","⧶":"&dsol;","đ":"&dstrok;","⋱":"&dtdot;","▿":"&triangledown;","⦦":"&dwangle;","џ":"&dzcy;","⟿":"&dzigrarr;","é":"&eacute;","⩮":"&easter;","ě":"&ecaron;","≖":"&eqcirc;","ê":"&ecirc;","≕":"&eqcolon;","э":"&ecy;","ė":"&edot;","≒":"&fallingdotseq;","𝔢":"&efr;","⪚":"&eg;","è":"&egrave;","⪖":"&eqslantgtr;","⪘":"&egsdot;","⪙":"&el;","⏧":"&elinters;","ℓ":"&ell;","⪕":"&eqslantless;","⪗":"&elsdot;","ē":"&emacr;","∅":"&varnothing;"," ":"&emsp13;"," ":"&emsp14;"," ":"&emsp;","ŋ":"&eng;"," ":"&ensp;","ę":"&eogon;","𝕖":"&eopf;","⋕":"&epar;","⧣":"&eparsl;","⩱":"&eplus;","ε":"&epsilon;","ϵ":"&varepsilon;","=":"&equals;","≟":"&questeq;","⩸":"&equivDD;","⧥":"&eqvparsl;","≓":"&risingdotseq;","⥱":"&erarr;","ℯ":"&escr;","η":"&eta;","ð":"&eth;","ë":"&euml;","€":"&euro;","!":"&excl;","ф":"&fcy;","♀":"&female;","ﬃ":"&ffilig;","ﬀ":"&fflig;","ﬄ":"&ffllig;","𝔣":"&ffr;","ﬁ":"&filig;",fj:"&fjlig;","♭":"&flat;","ﬂ":"&fllig;","▱":"&fltns;","ƒ":"&fnof;","𝕗":"&fopf;","⋔":"&pitchfork;","⫙":"&forkv;","⨍":"&fpartint;","½":"&half;","⅓":"&frac13;","¼":"&frac14;","⅕":"&frac15;","⅙":"&frac16;","⅛":"&frac18;","⅔":"&frac23;","⅖":"&frac25;","¾":"&frac34;","⅗":"&frac35;","⅜":"&frac38;","⅘":"&frac45;","⅚":"&frac56;","⅝":"&frac58;","⅞":"&frac78;","⁄":"&frasl;","⌢":"&sfrown;","𝒻":"&fscr;","⪌":"&gtreqqless;","ǵ":"&gacute;","γ":"&gamma;","⪆":"&gtrapprox;","ğ":"&gbreve;","ĝ":"&gcirc;","г":"&gcy;","ġ":"&gdot;","⪩":"&gescc;","⪀":"&gesdot;","⪂":"&gesdoto;","⪄":"&gesdotol;","⋛︀":"&gesl;","⪔":"&gesles;","𝔤":"&gfr;","ℷ":"&gimel;","ѓ":"&gjcy;","⪒":"&glE;","⪥":"&gla;","⪤":"&glj;","≩":"&gneqq;","⪊":"&gnapprox;","⪈":"&gneq;","⋧":"&gnsim;","𝕘":"&gopf;","ℊ":"&gscr;","⪎":"&gsime;","⪐":"&gsiml;","⪧":"&gtcc;","⩺":"&gtcir;","⋗":"&gtrdot;","⦕":"&gtlPar;","⩼":"&gtquest;","⥸":"&gtrarr;","≩︀":"&gvnE;","ъ":"&hardcy;","⥈":"&harrcir;","↭":"&leftrightsquigarrow;","ℏ":"&plankv;","ĥ":"&hcirc;","♥":"&heartsuit;","…":"&mldr;","⊹":"&hercon;","𝔥":"&hfr;","⤥":"&searhk;","⤦":"&swarhk;","⇿":"&hoarr;","∻":"&homtht;","↩":"&larrhk;","↪":"&rarrhk;","𝕙":"&hopf;","―":"&horbar;","𝒽":"&hscr;","ħ":"&hstrok;","⁃":"&hybull;","í":"&iacute;","î":"&icirc;","и":"&icy;","е":"&iecy;","¡":"&iexcl;","𝔦":"&ifr;","ì":"&igrave;","⨌":"&qint;","∭":"&tint;","⧜":"&iinfin;","℩":"&iiota;","ĳ":"&ijlig;","ī":"&imacr;","ı":"&inodot;","⊷":"&imof;","Ƶ":"&imped;","℅":"&incare;","∞":"&infin;","⧝":"&infintie;","⊺":"&intercal;","⨗":"&intlarhk;","⨼":"&iprod;","ё":"&iocy;","į":"&iogon;","𝕚":"&iopf;","ι":"&iota;","¿":"&iquest;","𝒾":"&iscr;","⋹":"&isinE;","⋵":"&isindot;","⋴":"&isins;","⋳":"&isinsv;","ĩ":"&itilde;","і":"&iukcy;","ï":"&iuml;","ĵ":"&jcirc;","й":"&jcy;","𝔧":"&jfr;","ȷ":"&jmath;","𝕛":"&jopf;","𝒿":"&jscr;","ј":"&jsercy;","є":"&jukcy;","κ":"&kappa;","ϰ":"&varkappa;","ķ":"&kcedil;","к":"&kcy;","𝔨":"&kfr;","ĸ":"&kgreen;","х":"&khcy;","ќ":"&kjcy;","𝕜":"&kopf;","𝓀":"&kscr;","⤛":"&lAtail;","⤎":"&lBarr;","⪋":"&lesseqqgtr;","⥢":"&lHar;","ĺ":"&lacute;","⦴":"&laemptyv;","λ":"&lambda;","⦑":"&langd;","⪅":"&lessapprox;","«":"&laquo;","⤟":"&larrbfs;","⤝":"&larrfs;","↫":"&looparrowleft;","⤹":"&larrpl;","⥳":"&larrsim;","↢":"&leftarrowtail;","⪫":"&lat;","⤙":"&latail;","⪭":"&late;","⪭︀":"&lates;","⤌":"&lbarr;","❲":"&lbbrk;","{":"&lcub;","[":"&lsqb;","⦋":"&lbrke;","⦏":"&lbrksld;","⦍":"&lbrkslu;","ľ":"&lcaron;","ļ":"&lcedil;","л":"&lcy;","⤶":"&ldca;","⥧":"&ldrdhar;","⥋":"&ldrushar;","↲":"&ldsh;","≤":"&leq;","⇇":"&llarr;","⋋":"&lthree;","⪨":"&lescc;","⩿":"&lesdot;","⪁":"&lesdoto;","⪃":"&lesdotor;","⋚︀":"&lesg;","⪓":"&lesges;","⋖":"&ltdot;","⥼":"&lfisht;","𝔩":"&lfr;","⪑":"&lgE;","⥪":"&lharul;","▄":"&lhblk;","љ":"&ljcy;","⥫":"&llhard;","◺":"&lltri;","ŀ":"&lmidot;","⎰":"&lmoustache;","≨":"&lneqq;","⪉":"&lnapprox;","⪇":"&lneq;","⋦":"&lnsim;","⟬":"&loang;","⇽":"&loarr;","⟼":"&xmap;","↬":"&rarrlp;","⦅":"&lopar;","𝕝":"&lopf;","⨭":"&loplus;","⨴":"&lotimes;","∗":"&lowast;","◊":"&lozenge;","(":"&lpar;","⦓":"&lparlt;","⥭":"&lrhard;","‎":"&lrm;","⊿":"&lrtri;","‹":"&lsaquo;","𝓁":"&lscr;","⪍":"&lsime;","⪏":"&lsimg;","‚":"&sbquo;","ł":"&lstrok;","⪦":"&ltcc;","⩹":"&ltcir;","⋉":"&ltimes;","⥶":"&ltlarr;","⩻":"&ltquest;","⦖":"&ltrPar;","◃":"&triangleleft;","⥊":"&lurdshar;","⥦":"&luruhar;","≨︀":"&lvnE;","∺":"&mDDot;","¯":"&strns;","♂":"&male;","✠":"&maltese;","▮":"&marker;","⨩":"&mcomma;","м":"&mcy;","—":"&mdash;","𝔪":"&mfr;","℧":"&mho;","µ":"&micro;","⫰":"&midcir;","−":"&minus;","⨪":"&minusdu;","⫛":"&mlcp;","⊧":"&models;","𝕞":"&mopf;","𝓂":"&mscr;","μ":"&mu;","⊸":"&mumap;","⋙̸":"&nGg;","≫⃒":"&nGt;","⇍":"&nlArr;","⇎":"&nhArr;","⋘̸":"&nLl;","≪⃒":"&nLt;","⇏":"&nrArr;","⊯":"&nVDash;","⊮":"&nVdash;","ń":"&nacute;","∠⃒":"&nang;","⩰̸":"&napE;","≋̸":"&napid;","ŉ":"&napos;","♮":"&natural;","⩃":"&ncap;","ň":"&ncaron;","ņ":"&ncedil;","⩭̸":"&ncongdot;","⩂":"&ncup;","н":"&ncy;","–":"&ndash;","⇗":"&neArr;","⤤":"&nearhk;","≐̸":"&nedot;","⤨":"&toea;","𝔫":"&nfr;","↮":"&nleftrightarrow;","⫲":"&nhpar;","⋼":"&nis;","⋺":"&nisd;","њ":"&njcy;","≦̸":"&nleqq;","↚":"&nleftarrow;","‥":"&nldr;","𝕟":"&nopf;","¬":"&not;","⋹̸":"&notinE;","⋵̸":"&notindot;","⋷":"&notinvb;","⋶":"&notinvc;","⋾":"&notnivb;","⋽":"&notnivc;","⫽⃥":"&nparsl;","∂̸":"&npart;","⨔":"&npolint;","↛":"&nrightarrow;","⤳̸":"&nrarrc;","↝̸":"&nrarrw;","𝓃":"&nscr;","⊄":"&nsub;","⫅̸":"&nsubseteqq;","⊅":"&nsup;","⫆̸":"&nsupseteqq;","ñ":"&ntilde;","ν":"&nu;","#":"&num;","№":"&numero;"," ":"&numsp;","⊭":"&nvDash;","⤄":"&nvHarr;","≍⃒":"&nvap;","⊬":"&nvdash;","≥⃒":"&nvge;",">⃒":"&nvgt;","⧞":"&nvinfin;","⤂":"&nvlArr;","≤⃒":"&nvle;","<⃒":"&nvlt;","⊴⃒":"&nvltrie;","⤃":"&nvrArr;","⊵⃒":"&nvrtrie;","∼⃒":"&nvsim;","⇖":"&nwArr;","⤣":"&nwarhk;","⤧":"&nwnear;","ó":"&oacute;","ô":"&ocirc;","о":"&ocy;","ő":"&odblac;","⨸":"&odiv;","⦼":"&odsold;","œ":"&oelig;","⦿":"&ofcir;","𝔬":"&ofr;","˛":"&ogon;","ò":"&ograve;","⧁":"&ogt;","⦵":"&ohbar;","⦾":"&olcir;","⦻":"&olcross;","⧀":"&olt;","ō":"&omacr;","ω":"&omega;","ο":"&omicron;","⦶":"&omid;","𝕠":"&oopf;","⦷":"&opar;","⦹":"&operp;","∨":"&vee;","⩝":"&ord;","ℴ":"&oscr;","ª":"&ordf;","º":"&ordm;","⊶":"&origof;","⩖":"&oror;","⩗":"&orslope;","⩛":"&orv;","ø":"&oslash;","⊘":"&osol;","õ":"&otilde;","⨶":"&otimesas;","ö":"&ouml;","⌽":"&ovbar;","¶":"&para;","⫳":"&parsim;","⫽":"&parsl;","п":"&pcy;","%":"&percnt;",".":"&period;","‰":"&permil;","‱":"&pertenk;","𝔭":"&pfr;","φ":"&phi;","ϕ":"&varphi;","☎":"&phone;","π":"&pi;","ϖ":"&varpi;","ℎ":"&planckh;","+":"&plus;","⨣":"&plusacir;","⨢":"&pluscir;","⨥":"&plusdu;","⩲":"&pluse;","⨦":"&plussim;","⨧":"&plustwo;","⨕":"&pointint;","𝕡":"&popf;","£":"&pound;","⪳":"&prE;","⪷":"&precapprox;","⪹":"&prnap;","⪵":"&prnE;","⋨":"&prnsim;","′":"&prime;","⌮":"&profalar;","⌒":"&profline;","⌓":"&profsurf;","⊰":"&prurel;","𝓅":"&pscr;","ψ":"&psi;"," ":"&puncsp;","𝔮":"&qfr;","𝕢":"&qopf;","⁗":"&qprime;","𝓆":"&qscr;","⨖":"&quatint;","?":"&quest;","⤜":"&rAtail;","⥤":"&rHar;","∽̱":"&race;","ŕ":"&racute;","⦳":"&raemptyv;","⦒":"&rangd;","⦥":"&range;","»":"&raquo;","⥵":"&rarrap;","⤠":"&rarrbfs;","⤳":"&rarrc;","⤞":"&rarrfs;","⥅":"&rarrpl;","⥴":"&rarrsim;","↣":"&rightarrowtail;","↝":"&rightsquigarrow;","⤚":"&ratail;","∶":"&ratio;","❳":"&rbbrk;","}":"&rcub;","]":"&rsqb;","⦌":"&rbrke;","⦎":"&rbrksld;","⦐":"&rbrkslu;","ř":"&rcaron;","ŗ":"&rcedil;","р":"&rcy;","⤷":"&rdca;","⥩":"&rdldhar;","↳":"&rdsh;","▭":"&rect;","⥽":"&rfisht;","𝔯":"&rfr;","⥬":"&rharul;","ρ":"&rho;","ϱ":"&varrho;","⇉":"&rrarr;","⋌":"&rthree;","˚":"&ring;","‏":"&rlm;","⎱":"&rmoustache;","⫮":"&rnmid;","⟭":"&roang;","⇾":"&roarr;","⦆":"&ropar;","𝕣":"&ropf;","⨮":"&roplus;","⨵":"&rotimes;",")":"&rpar;","⦔":"&rpargt;","⨒":"&rppolint;","›":"&rsaquo;","𝓇":"&rscr;","⋊":"&rtimes;","▹":"&triangleright;","⧎":"&rtriltri;","⥨":"&ruluhar;","℞":"&rx;","ś":"&sacute;","⪴":"&scE;","⪸":"&succapprox;","š":"&scaron;","ş":"&scedil;","ŝ":"&scirc;","⪶":"&succneqq;","⪺":"&succnapprox;","⋩":"&succnsim;","⨓":"&scpolint;","с":"&scy;","⋅":"&sdot;","⩦":"&sdote;","⇘":"&seArr;","§":"&sect;",";":"&semi;","⤩":"&tosa;","✶":"&sext;","𝔰":"&sfr;","♯":"&sharp;","щ":"&shchcy;","ш":"&shcy;","­":"&shy;","σ":"&sigma;","ς":"&varsigma;","⩪":"&simdot;","⪞":"&simg;","⪠":"&simgE;","⪝":"&siml;","⪟":"&simlE;","≆":"&simne;","⨤":"&simplus;","⥲":"&simrarr;","⨳":"&smashp;","⧤":"&smeparsl;","⌣":"&ssmile;","⪪":"&smt;","⪬":"&smte;","⪬︀":"&smtes;","ь":"&softcy;","/":"&sol;","⧄":"&solb;","⌿":"&solbar;","𝕤":"&sopf;","♠":"&spadesuit;","⊓︀":"&sqcaps;","⊔︀":"&sqcups;","𝓈":"&sscr;","☆":"&star;","⊂":"&subset;","⫅":"&subseteqq;","⪽":"&subdot;","⫃":"&subedot;","⫁":"&submult;","⫋":"&subsetneqq;","⊊":"&subsetneq;","⪿":"&subplus;","⥹":"&subrarr;","⫇":"&subsim;","⫕":"&subsub;","⫓":"&subsup;","♪":"&sung;","¹":"&sup1;","²":"&sup2;","³":"&sup3;","⫆":"&supseteqq;","⪾":"&supdot;","⫘":"&supdsub;","⫄":"&supedot;","⟉":"&suphsol;","⫗":"&suphsub;","⥻":"&suplarr;","⫂":"&supmult;","⫌":"&supsetneqq;","⊋":"&supsetneq;","⫀":"&supplus;","⫈":"&supsim;","⫔":"&supsub;","⫖":"&supsup;","⇙":"&swArr;","⤪":"&swnwar;","ß":"&szlig;","⌖":"&target;","τ":"&tau;","ť":"&tcaron;","ţ":"&tcedil;","т":"&tcy;","⌕":"&telrec;","𝔱":"&tfr;","θ":"&theta;","ϑ":"&vartheta;","þ":"&thorn;","×":"&times;","⨱":"&timesbar;","⨰":"&timesd;","⌶":"&topbot;","⫱":"&topcir;","𝕥":"&topf;","⫚":"&topfork;","‴":"&tprime;","▵":"&utri;","≜":"&trie;","◬":"&tridot;","⨺":"&triminus;","⨹":"&triplus;","⧍":"&trisb;","⨻":"&tritime;","⏢":"&trpezium;","𝓉":"&tscr;","ц":"&tscy;","ћ":"&tshcy;","ŧ":"&tstrok;","⥣":"&uHar;","ú":"&uacute;","ў":"&ubrcy;","ŭ":"&ubreve;","û":"&ucirc;","у":"&ucy;","ű":"&udblac;","⥾":"&ufisht;","𝔲":"&ufr;","ù":"&ugrave;","▀":"&uhblk;","⌜":"&ulcorner;","⌏":"&ulcrop;","◸":"&ultri;","ū":"&umacr;","ų":"&uogon;","𝕦":"&uopf;","υ":"&upsilon;","⇈":"&uuarr;","⌝":"&urcorner;","⌎":"&urcrop;","ů":"&uring;","◹":"&urtri;","𝓊":"&uscr;","⋰":"&utdot;","ũ":"&utilde;","ü":"&uuml;","⦧":"&uwangle;","⫨":"&vBar;","⫩":"&vBarv;","⦜":"&vangrt;","⊊︀":"&vsubne;","⫋︀":"&vsubnE;","⊋︀":"&vsupne;","⫌︀":"&vsupnE;","в":"&vcy;","⊻":"&veebar;","≚":"&veeeq;","⋮":"&vellip;","𝔳":"&vfr;","𝕧":"&vopf;","𝓋":"&vscr;","⦚":"&vzigzag;","ŵ":"&wcirc;","⩟":"&wedbar;","≙":"&wedgeq;","℘":"&wp;","𝔴":"&wfr;","𝕨":"&wopf;","𝓌":"&wscr;","𝔵":"&xfr;","ξ":"&xi;","⋻":"&xnis;","𝕩":"&xopf;","𝓍":"&xscr;","ý":"&yacute;","я":"&yacy;","ŷ":"&ycirc;","ы":"&ycy;","¥":"&yen;","𝔶":"&yfr;","ї":"&yicy;","𝕪":"&yopf;","𝓎":"&yscr;","ю":"&yucy;","ÿ":"&yuml;","ź":"&zacute;","ž":"&zcaron;","з":"&zcy;","ż":"&zdot;","ζ":"&zeta;","𝔷":"&zfr;","ж":"&zhcy;","⇝":"&zigrarr;","𝕫":"&zopf;","𝓏":"&zscr;","‍":"&zwj;","‌":"&zwnj;"}}}},41592:function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.numericUnicodeMap={0:65533,128:8364,130:8218,131:402,132:8222,133:8230,134:8224,135:8225,136:710,137:8240,138:352,139:8249,140:338,142:381,145:8216,146:8217,147:8220,148:8221,149:8226,150:8211,151:8212,152:732,153:8482,154:353,155:8250,156:339,158:382,159:376}},53039:function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.fromCodePoint=String.fromCodePoint||function(t){return String.fromCharCode(Math.floor((t-65536)/1024)+55296,(t-65536)%1024+56320)},n.getCodePoint=String.prototype.codePointAt?function(t,n){return t.codePointAt(n)}:function(t,n){return 1024*(t.charCodeAt(n)-55296)+t.charCodeAt(n+1)-56320+65536},n.highSurrogateFrom=55296,n.highSurrogateTo=56319},61734:function(t,n,e){"use strict";e.d(n,{W6:function(){return o},Bs:function(){return s},Un:function(){return u}});var r=e(33967),i=e(77489);function o(){var t=(0,i.Nt)();return(0,r.yv)()?t?"https://login.windows.net/":"https://login.microsoftonline.com/":"https://login.windows-ppe.net/"}function s(){return"USGovProd"===(0,r.kD)()||"USDoDProd"===(0,r.kD)()?"032e56fd-dfe5-4a50-8017-89692bcbcb0e":"038ed4f5-da78-47bc-8176-9153c79e0edb"}function u(){return"USGovProd"===(0,r.kD)()||"USDoDProd"===(0,r.kD)()?"153a74ba-783f-4394-bc9a-a109ef69f5c2":"c9a559d2-7aab-4f13-a6ed-e7e9c52aec87"}},77489:function(t,n,e){"use strict";e.d(n,{Gb:function(){return o},Nt:function(){return s},$6:function(){return u}});var r=e(13877),i="officeforms.uselegacylogindomain";function o(){return(0,r.y1)()}function s(){return!!a(i)}function u(t){c(i,t?"1":null)}function a(t){return(0,r.$o)().getItem(t)}function c(t,n){n?(0,r.$o)().setItem(t,n):(0,r.$o)().removeItem(i)}},35705:function(t,n,e){"use strict";e.d(n,{L:function(){return o},T:function(){return s}});var r=["#1F77B4","#EB7005","#2CA02C","#D62728","#9467BD","#8C564B","#D347A9","#7F7F7F","#A2951A","#29A2AE"],i=["#BC3B03","#E65722","#EB7005","#FF993E","#C2885B","#939393","#708090","#5C97BF","#2A7AB0","#1460AA","#004980"];function o(t){return u(t,r)}function s(t){return u(t,i)}function u(t,n){return n[t%n.length]}},69065:function(t,n,e){"use strict";e.d(n,{en:function(){return o},hq:function(){return u},$W:function(){return l},sL:function(){return f},Mk:function(){return h},zn:function(){return d}});function r(t){var n=[t.R,t.G,t.B].map((function(t){return(t/=255)<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}));return.2126*n[0]+.7152*n[1]+.0722*n[2]}function i(t){return(r({R:255,G:255,B:255})+.05)/(r(t)+.05)>4.5}function o(t){return i(t)?{R:255,G:255,B:255}:{R:0,G:0,B:0}}function s(t){var n=t.toString(16);return 1===n.length?"0"+n:n}function u(t){return"#"+s(t.R)+s(t.G)+s(t.B)}function a(t){var n,e=t.R,r=t.G,i=t.B,o=Math.max(e,r,i),s=Math.min(e,r,i),u=o-s,a=0===o?0:u/o,c=o/255;switch(o){case s:n=0;break;case e:n=r-i+u*(r<i?6:0),n/=6*u;break;case r:n=i-e+2*u,n/=6*u;break;case i:n=e-r+4*u,n/=6*u}return{H:n,S:a,V:c}}function c(t){var n,e,r,i,o,s,u,a,c=t.H,l=t.S,f=t.V;switch(s=f*(1-l),u=f*(1-(o=6*c-(i=Math.floor(6*c)))*l),a=f*(1-(1-o)*l),i%6){case 0:n=f,e=a,r=s;break;case 1:n=u,e=f,r=s;break;case 2:n=s,e=f,r=a;break;case 3:n=s,e=u,r=f;break;case 4:n=a,e=s,r=f;break;case 5:n=f,e=s,r=u}return{R:Math.round(255*n),G:Math.round(255*e),B:Math.round(255*r)}}function l(t){t.startsWith("#")&&(t=t.substring(1));var n=parseInt(t,16);return{R:n>>16&255,G:n>>8&255,B:255&n}}function f(t){var n=l(t),e=a(n);return r(n)>186&&(e.V=.45,n=c(e)),u(n)}function h(t){var n=a(l(t));return u(c({H:n.H,S:n.S,V:n.V>=.1?n.V-.1:0}))}function d(t){var n,e=a(l(t));return n=e.S>.05?.05:0,u(c({H:e.H,S:n,V:.95}))}},80820:function(t,n,e){"use strict";e.d(n,{tu:function(){return r},oc:function(){return i},lP:function(){return o}});var r="#03787c",i="#014446",o="#e8f2f4"},32782:function(t,n,e){"use strict";var r=e(63804),i=r.Suspense;n.Z=function(t){var n=t.children,e=t.fallback;return r.createElement(i,{fallback:e||null},n)}},2289:function(t,n,e){"use strict";e.d(n,{p:function(){return i}});var r=e(72377);function i(){return r.Pv.Resolve(22)}},54178:function(t,n,e){"use strict";e.d(n,{J:function(){return o}});var r=e(94978),i=["https://forms.office.com","https://forms.office-int.com","https://forms.osi.apps.mil","https://forms.osi.office365.us","https://forms.microsoft.com","https://msit.microsoftstream.com","https://web.microsoftstream.com","https://microsoftapc.sharepoint.com","https://teams.microsoft.com","https://microsoft.sharepoint-df.com","https://www.onenote.com","https://sway.office.com","https://approvals.teams.microsoft.com","https://approvalsint.teams.microsoft.com","https://approvalsppe.teams.microsoft.com","https://approvals.gcc.teams.microsoft.com","https://healthcarestaging.teams.microsoft.com","https://healthcareppe.teams.microsoft.com","https://healthcaredev.teams.microsoft.com","https://healthcaredogfood.teams.microsoft.com","https://healthcare.teams.microsoft.com","https://outlook.office365.com","https://purview.azure-test.com","https://purview.azure.com","https://outlook-sdf.office.com","https://www.office.com","https://outlook.office.com","https://fa000000084.resources.office.net","https://fa000000096.resources.office.net","https://fluidhostwin32.azurewebsites.net","https://fluidhostwin32-dev.azurewebsites.net","https://dev.ch5.fluidpreview.office.net","https://dev.fluidpreview.office.net","https://fluidpreview.office.net","https://fluidhostwin32-staging.azurewebsites.net","https://office.com","https://reports.teams.microsoft.com","https://reports-ppe.teams.microsoft.com","https://reports-int.teams.microsoft.com","https://sci.local.dynamics.com","https://sci.test.dynamics.com","https://sci.us-cm100.gateway.test.cm.powerapps.com","https://ch5.fluidpreview.office.net","https://officefluidprdeployments.azurewebsites.net"];function o(t){return function(t){return-1!==i.indexOf(t.toLowerCase())}(t)||function(t){var n=(0,r.qA)("ParentOriginWhitelist");return!!n&&(-1!==n.indexOf(t.toLowerCase())||function(t,n){for(var e=0,r=n;e<r.length;e++){var i=r[e],o=t.length-i.length;if(o>=0&&-1!==t.indexOf(i,o))return!0}return!1}(t.toLowerCase(),n))}(t)}},36476:function(t,n,e){"use strict";e.d(n,{$B:function(){return s}});var r=e(9947),i=e(33967),o="/cdn";function s(t){var n=function(){try{var t=decodeURI((0,r.k0)().webSettings||"{}");return JSON.parse(t).CdnEndPoint}catch(t){return""}}(),e=(0,i.Zr)();return function(t,n,e,r){if(!t)return"";var i=t.toLowerCase();if(!n)return i;return(r&&e?e:o)+i}(t,(0,r.k0)().isCdnEnabled,n,e)}},78587:function(t,n,e){"use strict";e.d(n,{Jn:function(){return u},oE:function(){return a}});var r=e(9947),i=e(36476),o="/FormsPro",s={defaultFolder:{css:"/css/dist/",js:"/Scripts/dists/"},vendorsFolder:{css:"/css/",js:"/Scripts/"}};function u(t){return t?(0,r.k0)().isCdnEnabled?(0,i.$B)(t):(0,r.k0)().addPrefixForProWhenNoCdn?o+t:t:""}function a(t,n){if(!t)return"";var e=t.split(".").pop();if("js"!==e&&"css"!==e)return t;var u=function(t,n){return(/^vendors\//i.test(t)?s.vendorsFolder:s.defaultFolder)[n]}(t,e)+t,a=(0,r.k0)().hashMapping,c=(0,r.k0)().isCdnEnabled;if(c&&void 0!==a){var l=a[t.toLowerCase()];if(void 0!==l){var f=u.replace(new RegExp(e+"$"),l+"."+e);return(0,i.$B)(f)}}var h=u+(n?"?v="+(0,r.k0)().version:""),d=(0,r.k0)().ring;return!c&&d&&(h=h+(n?"&":"?")+"ring="+d),(0,r.k0)().addPrefixForProWhenNoCdn?o+h:h}},86353:function(t,n,e){"use strict";e.d(n,{DP:function(){return d},Tl:function(){return m},dm:function(){return v}});var r,i,o=e(59312),s=e(9947),u=e(75827),a=e(90710),c=e(33967),l={settings:"",configIds:"",etag:""},f=!1;function h(){if(!f){var t={IntelligenceExp1:"Unknown",IntelligenceExp2:"Unknown",IntelligenceInsightsExpPerTenant:"Unknown",IntelligencePollContentExp:"Unknown",IntelligencePollHistoryExp:"Unknown",IntelligencePollEngageExp:"Unknown",IntelligencePollIntentExp:"Unknown",IntelligencePollResponseViewExp:"Unknown",IntelligencePollTagExp:"Unknown",CrossDeviceM1:(0,c.yv)()?0:2,CrossDeviceM1Union:(0,c.yv)()?0:2,CrossDeviceM2S1:(0,c.yv)()?0:2,CrossDeviceM2S1D:(0,c.yv)()?0:2,FluentDatePicker:(0,c.yv)()?0:2,FormsEasyStart_BIZ:0,FormsEasyStart_EDU:0,FormsSuperL1:(0,c.yv)()?0:2,FormsTemplatePage_Biz:(0,c.yv)()?0:2,FormsTemplatePage_Edu:(0,c.yv)()?0:2,QuizResultImprovement:0,SendAndShare:(0,c.yv)()?0:2,SmartNotification:0,TeamsPollCreateNewExp:0};r=(0,s.k0)().ecsConfigSettings||l,i=(0,o.pi)((0,o.pi)((0,o.pi)({},t),function(t){var n;try{n=JSON.parse(decodeURI(t||"{}"))}catch(t){n={}}return n}(r.settings)),function(){var t="fo",n=(0,a.NW)()[t];Array.isArray(n)&&(n=n[n.length-1]);var e={};n&&n.split(";").forEach((function(t){"!"!==t[0]?e[t]=!0:(t=t.substr(1),e[t]=!1)}));return e}()),f=!0}}function d(){return f||h(),r.configIds}function m(){return f||h(),i}function v(){return f||h(),r.isFirstRelease?"true"===r.isFirstRelease:(0,u.$O)()}},33967:function(t,n,e){"use strict";e.d(n,{kD:function(){return i},Zr:function(){return o},yv:function(){return s},Fc:function(){return u},rq:function(){return a},x8:function(){return c},j4:function(){return l},u7:function(){return f},Ke:function(){return h},H:function(){return d},Mr:function(){return m},bQ:function(){return v},a4:function(){return p},iI:function(){return g},_7:function(){return b},H5:function(){return y},Gd:function(){return I},Wr:function(){return S}});var r=e(9947);function i(){return(0,r.k0)().environmentType}function o(t){var n=t||i();return/.*(Prod|USNat|USSec|Int|Tip|CVFastfood)$/.test(n)}function s(){var t=i();return/.*Prod$/.test(t)||"CVTip"===t||"CVFastfood"===t||"USNat"===t||"USSec"===t}function u(){switch(i()){case"WWProd":case"MSProd":case"CVProd":case"CVTip":case"CVFastfood":return"9188040d-6c67-4c5b-b112-36a304b66dad";default:return"4925308c-f164-4d2d-bc7e-0631132e9375"}}function a(){switch(i()){case"WWProd":case"MSProd":case"CVProd":case"CVTip":case"CVFastfood":return"72f988bf-86f1-41af-91ab-2d7cd011db47";default:return"f686d426-8d16-42db-81b7-ab578e110ccd"}}function c(){var t=i();return"USGovProd"===t||"USDoDProd"===t||"USGovGccProd"===t||"USNat"===t||"USSec"===t}function l(){var t=i();return"USGovProd"===t||"USDoDProd"===t||"USNat"===t||"USSec"===t}function f(){return"USGovGccProd"===i()}function h(){return"USGovProd"===i()}function d(){return"USDoDProd"===i()}function m(){return"USNat"===i()}function v(){return"USSec"===i()}function p(){var t=i();return"WWProd"===t||"MSProd"===t||"CVProd"===t||"CVTip"===t||"CVFastfood"===t}function g(){switch(i()){case"WWProd":case"MSProd":case"CVProd":case"CVTip":case"CVFastfood":return["89d8a01e-e5db-493e-8720-b820d953ef20","b6338c92-533e-4f6d-a327-994263712399"];default:return["f686d426-8d16-42db-81b7-ab578e110ccd"]}}function b(){switch(i()){case"WWProd":return"https://c.office.com";case"MSProd":case"CVProd":case"CVTip":case"CVFastfood":return"https://c1.microsoft.com";case"Int":return"https://c.office-int.com";case"MSInt":default:return null}}function w(){return window.location.host.toLocaleLowerCase()}function y(){return w().indexOf("forms.microsoft")>=0}function I(){return w().indexOf(".forms.osi.office.net")>0}function S(){var t=(0,r.k0)().datacenter;if(t){var n=t.split(".")[0].toLowerCase().split("-")[0];return"neu"===n||"weu"===n}return!1}},30029:function(t,n,e){"use strict";function r(){return"https://go.microsoft.com/fwlink/?linkid=2121428"}e.d(n,{d:function(){return r}})},96078:function(t,n,e){"use strict";e.d(n,{Z:function(){return i}});var r=e(33967);function i(){return(0,r.Mr)()?"https://graph.eaglex.ic.gov/v1.0":(0,r.bQ)()?"https://graph.microsoft.scloud/v1.0":(0,r.j4)()?"https://graph.microsoft.us/v1.0":(0,r.a4)()||(0,r.u7)()?"https://graph.microsoft.com/v1.0":"https://graph.microsoft-ppe.com/v1.0"}},94290:function(t,n,e){"use strict";e.d(n,{hj:function(){return d},_y:function(){return m},Wy:function(){return v},XF:function(){return b},rh:function(){return w},Eh:function(){return y},av:function(){return S},jM:function(){return C},uV:function(){return F},Kw:function(){return N},OL:function(){return T},S0:function(){return k},GF:function(){return x},mF:function(){return P},CE:function(){return D},QR:function(){return E},ft:function(){return R},HI:function(){return L},RQ:function(){return A},lS:function(){return q},Ig:function(){return O},HQ:function(){return M},W6:function(){return U}});var r,i=e(9947),o=e(90710);!function(t){t[t.signup=1]="signup"}(r||(r={}));var s,u,a,c,l,f,h="delegatepage.aspx",d="platform",m="jsSdkVersion",v="id",p=null,g=!1;function b(){return a||y()}function w(){return f||(f=(0,o.NW)().appid)}function y(){var t=a||(0,o.NW)().Host||(0,o.$p)().Host;switch(t){case"Bookings":case"OneNote":case"OneNoteUwp":case"Outlook":case"Teams":case"TeamsApproval":case"TeamsBot":case"TeamsPollTab":case"TeamsPollBubble":case"TeamsBotForLife":case"TeamsReports":case"Excel":case"OneDrive":case"Excel_Win32":case"PowerPointContent":case"PowerPointTaskpane":case"Assignments":case"ProjectShimla":case"Stream":case"StreamMobile":case"Union":case"ODC":case"Word_Web":case"Outlook_Web_App_Fluid":case"Word_Web_Fluid":case"Fluid_Component":case"SupplyChainInsights":return t;default:return null}}function I(){return c||r[c&&r[c]||(0,o.NW)().redirectorigin||(0,o.$p)().redirectorigin]}function S(){return s||(0,o.NW)().groupId||(0,o.$p)().groupId}function C(){return u||(0,o.NW)().tid||(0,o.$p)().tid}function F(){return!!y()||!!(0,i.k0)().isOembedSPO}function N(){var t=b();return("Teams"===t||"TeamsBot"===t||"TeamsPollTab"===t||"TeamsPollBubble"===t||"TeamsBotForLife"===t)&&"undefined"!=typeof microsoftTeams}function T(){return"Guest"===l}function k(){return"Bookings"===b()}function x(){return"Assignments"===b()}function P(){return"Union"===b()}function D(){return"/pages/assignmentsdesignpage.aspx"===window.location.pathname.toLowerCase()||"/pages/assignmentsresponsepage.aspx"===window.location.pathname.toLowerCase()}function E(){return N()||x()||"Stream"===b()||"StreamMobile"===b()||("TeamsApproval"===(t=b())||"TeamsReports"===t||"Bookings"===t||"PurView"===t||"SupplyChainInsights"===t||"EmbedTestPage"===t);var t}function R(){return"PowerPointTaskpane"===b()||"PowerPointContent"===b()||"PowerPointLive"===b()}function L(){return-1!==window.location.pathname.indexOf("FluidFormPage")}function A(){return I()===r.signup}function q(){if(null===p){var t=window.location.pathname.trimEnd("/").toLowerCase();p=t.lastIndexOf(h)===t.length-h.length}return p}function O(){return g}function M(){return(0,o.NW)().cdsId}function U(){return(0,o.NW)().cdsRegion}},51531:function(t,n,e){"use strict";e.d(n,{o:function(){return i}});var r=e(9947);function i(){return(0,r.k0)().isOembedSPO}},66676:function(t,n,e){"use strict";e.d(n,{Kd:function(){return o},WB:function(){return s},t6:function(){return u}});var r=e(9947),i=e(90710);function o(){var t=(0,r.k0)().cultureInfo;return t&&t.Name||(0,i.NW)().lang}function s(t){switch((t||o()||"").toLowerCase()){case"fr":case"fr-ca":case"fr-fr":case"fr-be":case"fr-lu":case"fr-ch":return!0;default:return!1}}function u(){return document&&document.body&&"rtl"===document.body.getAttribute("dir")}},43209:function(t,n,e){"use strict";e.d(n,{C2:function(){return i},_B:function(){return o},aK:function(){return s}});var r="/formspro";function i(){var t=window.location.pathname.toLowerCase();switch(s()&&(t=t.substring(r.length)),t){case"/pages/designpage.aspx":case"/pages/teamsdesignpage.aspx":case"/pages/onenoteaddinpage.aspx":case"/pages/delegatepage.aspx":case"/pages/teamsmeetingpollpage.aspx":case"/pages/designpagev2.aspx":return"Design";case"/pages/responsepage.aspx":case"/pages/teamsresponsepage.aspx":return"Response";case"/pages/analysispage.aspx":return"Analyze";case"/pages/teamsconfigpage.aspx":return"TeamsConfig";case"/pages/shareformpage.aspx":return"ShareForm";case"/pages/responsepreviewpage.aspx":return"ResponsePreviewPage";case"/pages/adminphishingreviewpage.aspx":return"AdminPhishingReviewPage";case"/pages/portalpage.aspx":return"PortalPage";case"/pages/fluidformpage.aspx":return"Fluid";case"/pages/filedownloadpage.aspx":return"FileDownload";default:return"Unknown"}}function o(){var t=window.location.host.toLocaleLowerCase();return t.indexOf("cus-000.forms.osi.office.net")>=0||t.indexOf("tip.forms.office.com")>=0||t.indexOf("tip.customervoice.microsoft.com")>=0}function s(){return!!window.location.pathname.toLocaleLowerCase().startsWith(r)}},18137:function(t,n,e){"use strict";e.d(n,{Ii:function(){return i}});var r=e(68289),i=function(t){return(0,r.v)()+"Pages/DesignPageV2.aspx"+(t?"?groupid="+t:"")}},68289:function(t,n,e){"use strict";e.d(n,{v:function(){return s}});var r=e(33967),i="https://forms.microsoft.com/",o="https://forms.office.com/";function s(){if(!(0,r.Zr)())return"https://forms.office-int.com/";var t;switch((0,r.kD)()){case"USDoDProd":t="https://forms.osi.apps.mil/";break;case"USGovProd":t="https://forms.osi.office365.us/";break;case"USGovGccProd":t=(0,r.H5)()?i:o;break;case"WWProd":t=o;break;case"MSProd":t=i;break;case"USNat":t="https://forms.osi.eaglex.ic.gov/";break;case"USSec":t="https://forms.osi.microsoft.scloud/";break;default:t="https://"+window.location.host+"/"}return t}},56010:function(t,n,e){"use strict";e.d(n,{hp:function(){return i}});var r=e(90710);function i(){var t=(0,r.NW)().route;if(t){var n=t.toLowerCase();switch(n){case"groupforms":case"myforms":case"officehome":case"start":case"templates":return n;default:return"others"}}}},58268:function(t,n,e){"use strict";e.d(n,{ZD:function(){return o},dg:function(){return s},V9:function(){return u},YD:function(){return a},bR:function(){return c}});var r=e(9947),i=e(33967),o="https://go.microsoft.com/fwlink/?linkid=866263",s="https://go.microsoft.com/fwlink/p/?LinkId=2083423";function u(){return(0,i.u7)()?"https://portal.office.com/account/#subscriptions":(0,i.Ke)()?"https://portal.office365.us/account/#subscriptions":(0,i.H)()?"https://portal.apps.mil/account/#subscriptions":(0,i.Mr)()?"https://admin.eaglex.ic.gov":(0,i.bQ)()?"https://admin.microsoft.scloud":s}function a(){return o}function c(){return(0,r.k0)().userInfo.IsMsa?a():u()}},29559:function(t,n,e){"use strict";e.d(n,{tq:function(){return i},fM:function(){return o},lZ:function(){return s},rA:function(){return u},w1:function(){return a},i7:function(){return c},un:function(){return l},tH:function(){return f},gn:function(){return h},vh:function(){return d},G6:function(){return m},Dt:function(){return v},K$:function(){return p},MG:function(){return g},c:function(){return b}});function r(){return navigator.userAgent.toLocaleLowerCase()}function i(){var t=r();return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iPad|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}function o(){return window.innerWidth}function s(){return i()&&u()}function u(){return o()<=640}function a(){var t=r();return-1!==t.indexOf("msie")||-1!==t.indexOf("trident/")}function c(){var t=r();return-1!==t.indexOf("chrome/")&&-1===t.indexOf("edge/")}function l(){return-1!==r().indexOf("edge/")}function f(){return-1!==r().indexOf("firefox/")}function h(){return/ip(hone|od|ad)/.test(r())&&!window.MSStream}function d(){var t=r(),n=-1!==t.indexOf("version/9")||-1!==t.indexOf("version/13");return-1!==t.indexOf("mac os x")&&n&&-1!==t.indexOf("safari")}function m(){return r().indexOf("safari")>-1}function v(){return!!r().match(/android/i)}function p(){return-1!==r().indexOf("tbs/")}function g(){return-1!==r().indexOf("micromessenger/")}function b(){return-1!==navigator.platform.toLowerCase().indexOf("win")}},79552:function(t,n,e){"use strict";function r(t,n){return s(n,t&&t.type,t&&t.statusCode)}function i(t,n){return s(n,t&&t.failureType,t&&t.statusCode)}function o(t){var n=t;if(n&&n.statusCode)return JSON.stringify({correlationId:n.correlationId,innerCode:n.innerCode,innerMessage:n.innerMessage,isServerError:n.isServerError,statusCode:n.statusCode,statusText:n.statusText,type:n.type});var e=t;return e&&e.message?JSON.stringify({message:e.message,name:e.name,stack:u(e.stack)}):u(JSON.stringify(t||""))}function s(t,n,e){switch(t){case"Information":case"FormsProInformation":return!0;case"Error":return!1;default:switch(n){case"Failure":return!1;case"ExpectedFailure":return!0;default:if(e>=0&&e<500)return!0}}return!1}function u(t){return t&&"string"==typeof t&&t.toLowerCase().indexOf("auth_upn")<0&&t.toLowerCase().indexOf("token")<0?t:t?"Sanitized error":""}e.d(n,{xP:function(){return r},WP:function(){return i},Y8:function(){return o}})},37790:function(t,n,e){"use strict";e.d(n,{e:function(){return s}});var r=e(22617),i=e(61734),o=e(63795);function s(t,n){var e="";if(t)if(t instanceof Error&&!t.hasOwnProperty("correlationId")){switch(t.name){case"LoginIECrossZoneError":e=(0,o.WU)(n.Error_Message_Client_LoginIECrossZoneError,window.location.origin,(0,i.W6)());break;case"ThirdPartyCookieBlockedError":e=(0,o.WU)(n.Error_Message_Client_ThirdPartyCookieError,(0,i.W6)());break;case"AuthNoStorageError":e=n.Error_Message_Client_AuthNoStorageError;break;case"AADAcquireTokenMfaCheckError":e=n.Error_Message_705;break;case"TeamSiteNoGroupError":e=n.Error_Message_Client_TeamSiteNoGroupError}}else{var s=t;s.innerCode&&(e=(0,r.D)(String(s.innerCode),n)||(0,o.WU)(n.Error_Message_Default,s.innerCode))}return e}},687:function(t,n,e){"use strict";e.d(n,{gX:function(){return r},kA:function(){return i},LY:function(){return o},vM:function(){return s},HJ:function(){return u},Fy:function(){return a},Rr:function(){return c},w_:function(){return l},yi:function(){return f},HR:function(){return h},dD:function(){return d},jm:function(){return m},gC:function(){return v},hN:function(){return p},gj:function(){return g},xZ:function(){return b},R3:function(){return w},g1:function(){return y},GC:function(){return I},ip:function(){return S},FT:function(){return C},vT:function(){return F}});var r=function(){return 200},i=function(){return 1e3},o=function(){return 1e3},s=function(){return 800},u=function(){return 600},a=function(){return 719},c=function(){return 320},l=function(){return 240},f=function(){return 5242880},h=function(){return 422},d=function(){return"AnalyzerToken"},m=function(){return 5242880},v=function(){return"yyyy-MM-dd"},p=function(){return 4e3},g=function(){return 40},b=function(){return 3e3},w=function(){return 5},y=function(){return 1e3},I=function(){return 200},S=function(){return 10},C=function(){return/^[\w+!#$%&'*+-/=?^_`{|}~.]+@[\w+.-]+\.[\w+.]+$/},F=function(){return 28}},9947:function(t,n,e){"use strict";e.d(n,{k0:function(){return i},$Q:function(){return o}});var r=[];function i(){var t;return null!==(t=window.OfficeFormServerInfo)&&void 0!==t?t:{cultureInfo:{Name:navigator.language},environmentType:"WWProd",serverInfoFromPageHeaders:{},userInfo:{}}}function o(t){window.OfficeFormServerInfo=t,r.forEach((function(t){"function"==typeof t&&t(window.OfficeFormServerInfo)}))}},87260:function(t,n,e){"use strict";e.d(n,{I:function(){return i}});var r=e(72377);function i(){return new Promise((function(t){r.Pv.Resolve("IAWTLogger").flush(t)}))}},916:function(t,n,e){"use strict";e.d(n,{o:function(){return u}});var r=e(73546),i=e(85708),o=e(97265),s=e(2775),u=function(){function t(t,n){void 0===n&&(n=null),this.nt={correlationId:n||(0,o.GW)(),duration:0,eventName:t,eventType:"qos_event",extraData:void 0},this.et=null}var n=t.prototype;return Object.defineProperty(n,"CorrelationId",{get:function(){return this.nt.correlationId},enumerable:!1,configurable:!0}),Object.defineProperty(n,"ExtraData",{get:function(){return this.nt.extraData},set:function(t){this.nt.extraData=t},enumerable:!1,configurable:!0}),n.start=function(t){void 0===t&&(t=null),this.et=t||(0,i.dg)();var n=this.rt(this.nt,"Start");(0,r.j)().logData(n,!1)},n.end=function(t,n){void 0===n&&(n=null);var e=this.rt(t,"End");return n&&(e.duration=n-this.et),(0,r.j)().logData(e,!1),e.duration},n.log=function(t){var n=this.rt(t,"Log");(0,r.j)().logData(n,!1)},n.rt=function(t,n){var e=(0,s.d9)(this.nt);switch(null!==this.et&&"Start"!==n&&(e.duration=(0,i.dg)()-this.et),t.logLevel&&(e.logLevel=t.logLevel),t.extraData&&(e.extraData=t.extraData),n){case"Start":e.eventName+="."+n;break;case"Log":e.eventName+="."+n,t.resultCode&&(e.eventName+="."+t.resultCode);break;case"End":t.resultType&&(e.eventName+="."+t.resultType)}return e},t}()},41480:function(t,n,e){"use strict";e.d(n,{k:function(){return s}});var r,i=e(9947),o=e(97265);function s(){if(r)return r;var t=(0,i.k0)().serverSessionId;return r=t||(0,o.GW)()}},75827:function(t,n,e){"use strict";e.d(n,{$O:function(){return i}});var r=e(9947);function i(){var t=function(){var t=(0,r.k0)().userReleaseTrackInfo;if(t&&t.id){return{tenantReleaseTrack:t.tenantReleaseTrack,userReleaseTrack:t.userReleaseTrack,isFirstRelease:t.isFirstRelease}}return null}();return null!==t&&(t.hasOwnProperty("isFirstRelease")?t.isFirstRelease:function(t,n){var e=!1;switch(t){case"None":e=!1;break;case"StagedRollout":n.toLowerCase().startsWith("stagedrollout")&&(e=!0);break;case"FirstRelease":case"Compass":case"Dogfood":e=!0;break;default:e=!1}return e}(t.tenantReleaseTrack,t.userReleaseTrack))}},83894:function(t,n,e){"use strict";e.d(n,{ro:function(){return s},Wh:function(){return u},Ak:function(){return a}});var r=e(33967),i=e(9947),o=function(){return(0,i.k0)().userInfo.TenantId};function s(t){return!(!(t=t||o())||t.toLowerCase()!==(0,r.Fc)())}function u(t){return!(!(t=t||o())||t.toLowerCase()!==(0,r.rq)())}function a(t){return(t=t||o())&&-1!==(0,r.iI)().indexOf(t.toLowerCase())}},262:function(t,n,e){"use strict";function r(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var e=t.map((function(t){return t&&t.trim()})).filter((function(t){return!!t})).join(" ");return e||t.some((function(t){return""===t}))||(e=void 0),e}e.d(n,{j:function(){return r}})},72420:function(t,n,e){"use strict";function r(t){return"number"==typeof t}function i(t){return"string"==typeof t}e.d(n,{hj:function(){return r},HD:function(){return i}})},85708:function(t,n,e){"use strict";function r(){return Date.now||(Date.now=function(){return(new Date).getTime()}),Math.floor(Date.now())}e.d(n,{dg:function(){return r}})},2995:function(t,n,e){"use strict";e.d(n,{Ih:function(){return u}});var r=/('[^']*'|"[^"]*")/g,i=/('[^']*'|"[^"]*"|d{1,2}|M{1,2}|y{2,4}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|t{2})/g;function o(t,n){var e=t.toString();if(t<0)return e;if(n&&n>e.length)for(;n>e.length;)e="0"+e;return e}function s(t){return r.test(t)?t.substr(1,t.length-2):t}function u(t,n){return function(t,n,e){return null==t||null==n?null:n.split(i).map((function(n){switch(n){case"d":case"dd":return o(t.getDate(),n.length);case"ddd":return null==e?void 0:e.DateTimeFormat.AbbreviatedDayNames[t.getDay()];case"M":case"MM":return o(t.getMonth()+1,n.length);case"MMM":return null==e?void 0:e.DateTimeFormat.AbbreviatedMonthNames[t.getMonth()];case"yy":var r=t.getFullYear(),i=o(r,4);return r>(null==e?void 0:e.Calendar.TwoDigitYearMax)-100&&r<=(null==e?void 0:e.Calendar.TwoDigitYearMax)?i.slice(2):i;case"yyy":case"yyyy":case"yyyyy":return o(t.getFullYear(),n.length);case"H":case"HH":return o(t.getHours(),n.length);case"h":case"hh":return o((t.getHours()+11)%12+1,n.length);case"m":case"mm":return o(t.getMinutes(),n.length);case"s":case"ss":return o(t.getSeconds(),n.length);case"t":case"tt":var u=t.getHours()<12?null==e?void 0:e.DateTimeFormat.AMDesignator:null==e?void 0:e.DateTimeFormat.PMDesignator;return 1===n.length?u.charAt(0):u;default:return s(n)}})).join("")}(t,n.DateTimeFormat.ShortDatePattern,n)}},97265:function(t,n,e){"use strict";function r(){return t=[i()+i(),i(),i(),i(),i()+i()+i()].join("-"),n=parseInt(t.charAt(19),16),e=(n=3&n|8).toString(16),t=o(t,14,"4"),t=o(t,19,e);var t,n,e}function i(){return function(t,n,e){for(var r=t.length,i=e.length;r<n;r+=i)t=e+t;return t}(Math.floor(65536*Math.random()).toString(16),4,"0")}function o(t,n,e){return t.substring(0,n)+e+t.substring(n+1)}e.d(n,{GW:function(){return r}})},81620:function(t,n,e){"use strict";function r(t){return"string"==typeof t&&(t=document.querySelector(t)),t?window.getComputedStyle?parseInt(window.getComputedStyle(t).height):t.clientHeight:0}function i(t,n){if(t&&n)return t[n]||t[n.toLowerCase()]||void 0}function o(t,n,e){var r=t.indexOf("#"),i=-1===r?"":t.substr(r);t=-1===r?t:t.substr(0,r);var o=new RegExp("([?&])"+n+"=.*?(&|$)","i"),s=-1!==t.indexOf("?")?"&":"?";return(t=t.match(o)?t.replace(o,"$1"+n+"="+e+"$2"):t+s+n+"="+e)+i}function s(t,n){void 0===n&&(n=!0);var e=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;");return n&&(e=e.replace(/'/g,"&apos;")),e}e.d(n,{Uy:function(){return r},jL:function(){return i},y:function(){return o},F1:function(){return s}})},38174:function(t,n,e){"use strict";e.d(n,{Wz:function(){return r},y3:function(){return i}});function r(t,n){t&&t.focus({preventScroll:!!n})}function i(t){var n=t.nativeEvent&&t.nativeEvent.explicitOriginalTarget;return t.relatedTarget||n||document.activeElement}},15934:function(t,n,e){"use strict";function r(t){return/^(https ?\:\/\/)?((www\.)?youtube\.com|youtu\.?be)\/.+$/.test(t)}function i(t){return/^(https ?\:\/\/)?(?:msit|web)\.microsoftstream\.com\/.+$/.test(t)||/^(https ?\:\/\/)?(?:www\.)?(microsoft-my.sharepoint-df|microsoft.sharepoint)\.com\/.+$/.test(t)||/(https ?\:\/\/)[^\s]*.(sharepoint|sharepoint-df)\.com\/[^\s]*/.test(t)}function o(t){return r(t)||i(t)}function s(t){var n=document.createElement("a");return n.href=t,n.host&&n.host!==window.location.host}e.d(n,{yk:function(){return r},M4:function(){return i},eC:function(){return o},K2:function(){return s}})},64459:function(t,n,e){"use strict";function r(t){try{return JSON.parse(t)}catch(n){return t}}e.d(n,{d:function(){return r}})},65274:function(t,n,e){"use strict";function r(t){var n=typeof t;return"function"===n||"object"===n&&!!t}function i(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return n.length<1||!r(t)||n.forEach((function(n){s(n).forEach((function(e){t[e]=n[e]}))})),t}function o(t){return r(t)?Array.isArray(t)?t.slice():i({},t):t}function s(t){return r(t)?Object.keys(t):[]}function u(t,n){Array.isArray(t)&&t.forEach(n),r(t)&&s(t).forEach((function(e){n(t[e],e)}))}e.d(n,{l7:function(){return i},d9:function(){return o},S6:function(){return u},EL:function(){return c}});var a,c=(a=0,function(t){return""+(t||"")+ ++a});Date.now},84475:function(t,n,e){"use strict";e.d(n,{A:function(){return o}});var r=e(94290),i=e(9947);function o(){var t="ms-formweb";if((0,r.uV)()){var n=(0,r.Eh)();n&&(t="ms-"+n.toLowerCase()),(0,i.k0)().isOembedSPO&&(t="forms-webpart")}return(0,i.k0)().isSonarServer&&(t="ms-sonar"),(0,i.k0)().isAntiPhishingTool&&(t="ms-antiphishingtool"),t}},37890:function(t,n,e){"use strict";function r(t){return new Promise((function(n,e){t.then(n,e)}))}function i(t){var n=function(){return Promise.resolve(null)};return t?t.then(n,n):n()}function o(){return new Promise((function(){}))}var s;e.d(n,{Px:function(){return r},Bx:function(){return i},eX:function(){return o},Cb:function(){return s},bC:function(){return u},wU:function(){return a}}),function(t){t[t.Pending=0]="Pending",t[t.Resolved=1]="Resolved",t[t.Rejected=2]="Rejected"}(s||(s={}));var u=function(){function t(t){var n=this;t.then((function(){n.it=s.Resolved}),(function(){n.it=s.Rejected})),this.ot=t,this.it=s.Pending}var n=t.prototype;return n.promise=function(){return this.ot},n.states=function(){return this.it},t}(),a=function(){function t(){var t=this;this.ot=new u(new Promise((function(n,e){t.ut=n,t.at=e})))}var n=t.prototype;return n.promise=function(){return this.ot.promise()},n.resolve=function(t){return this.ut(t),this},n.reject=function(t){return this.at(t),this},n.states=function(){return this.ot.states()},t}()},90710:function(t,n,e){"use strict";function r(t){return o(t||window.location.search.substring(1))}function i(t){return o(t||window.location.hash.substring(1))}function o(t){var n={};return t&&t.trim().split("&").forEach((function(t){var e=t.indexOf("=");-1===e&&(e=t.length);var r=t.substring(0,e).trim();r&&(n[r]=decodeURIComponent(t.substring(e+1)||"").trim())})),n}e.d(n,{NW:function(){return r},$p:function(){return i}})},88744:function(t,n,e){"use strict";function r(t,n){return function(e){t&&t(e),n&&n(e)}}e.d(n,{F:function(){return r}})},37043:function(t,n,e){"use strict";function r(t){return t?(t.startsWith("t=")?"":"Bearer ")+t:""}e.d(n,{U:function(){return r}})},18113:function(t,n,e){"use strict";e.d(n,{ZP:function(){return c},fq:function(){return l}});var r=e(2775),i=["strong","em","u","sup","sub","a","i","b"],o=i.map((function(t){return"<"+t+">"})),s=i.map((function(t){return"</"+t+">"})),u=i.map((function(t){return"&lt;"+t+"&gt;"})),a=i.map((function(t){return"&lt;/"+t+"&gt;"}));function c(t){return function(t){var n=document.createElement("span");return n.innerHTML=t,t=n.innerHTML}(function(t){var n=(0,r.YU)(t);return i.forEach((function(t,e){n=n.replaceAll(u[e],o[e]).replaceAll(a[e],s[e])})),n}(t))}function l(t){return(t||"").replace(/(<ol>|<\/ol>|<ul>|<\/ul>|<li>|<\/li>)/gi,"")}},13877:function(t,n,e){"use strict";var r,i,o,s;e.d(n,{ns:function(){return c},$o:function(){return l},G:function(){return f},y1:function(){return d},f:function(){return m}});var u=null,a=null;function c(){return r||(r=l())instanceof v&&(r=f()),r}function l(){return i||(i=d()?window.localStorage:h()),i}function f(){return o||(o=m()?window.sessionStorage:h()),o}function h(){return s||(s=new v),s}function d(){if(null==u)try{var t="officeforms.__storage_test__";window.localStorage.setItem(t,t),window.localStorage.removeItem(t),u=!0}catch(t){u=!1}return u}function m(){if(null==a)try{var t="officeforms.__storage_test__";window.sessionStorage.setItem(t,t),window.sessionStorage.removeItem(t),a=!0}catch(t){a=!1}return a}var v=function(){function t(){}var n=t.prototype;return n.clear=function(){},n.getItem=function(t){},n.key=function(t){return null},n.removeItem=function(t){},n.setItem=function(t,n){},t}()},45900:function(t,n,e){"use strict";function r(t){return function(t,n){var e=i(),r=e.domain,o=e.isCdn,s=e.ring,u=o?"":"?ring="+s;return""+r+n+t.toLowerCase()+u}(t,"/scripts/dists/")}e.d(n,{uW:function(){return r}});var i=(0,e(4851).Rm)((function(){var t,n,e=window.shellInfo,r=!1;if(e)r=!!(t=e.cdnEndpoint),n=e.ring;else{var i=window.OfficeFormServerInfo;r=i.isCdnEnabled,t=JSON.parse(decodeURIComponent(i.webSettings||"{}")).CdnEndPoint,n=i.ring}return{isCdn:r=r&&!!t,domain:r?t:location.protocol+"//"+location.host,ring:n}}))},63795:function(t,n,e){"use strict";function r(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return t?t.replace(/{(\d+)}/g,(function(t,e){return void 0!==n[e]&&null!==n[e]?n[e].toString():t})):t}function i(t){return t&&"function"==typeof t.normalize?t.normalize("NFC"):t}e.d(n,{WU:function(){return r},bC:function(){return i}})},4851:function(t,n,e){"use strict";function r(t){var n,e=!1,r=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return e?n:(e=!0,n=t.apply(void 0,r))};return r.reset=function(){e=!1,n=null},r}e.d(n,{Rm:function(){return r}})},2775:function(t,n,e){"use strict";e.d(n,{S6:function(){return i},d9:function(){return o},YU:function(){return s},l7:function(){return u},Kn:function(){return a},XP:function(){return c},CE:function(){return l},Ry:function(){return f}});var r=e(36215),i=r.each,o=r.clone,s=r.escape,u=r.extend,a=r.isObject,c=r.keys,l=r.omit,f=(r.pick,r.object)},18145:function(t,n,e){"use strict";e.d(n,{vq:function(){return s},hu:function(){return u},DR:function(){return a},D9:function(){return c},sq:function(){return l}});var r,i=e(78587),o=e(39455);function s(){return"Segoe UI"}function u(){return parseInt(o.Z.getSetting(o.G.CascadeSubQuesMaxLimit))}!function(t){t[t.SixHourly=0]="SixHourly",t[t.Daily=1]="Daily",t[t.Weekly=2]="Weekly",t[t.Monthly=3]="Monthly",t[t.Quarterly=4]="Quarterly",t[t.Yearly=5]="Yearly"}(r||(r={}));var a="api/GetAllSatisfactionMetricsByProject/",c="api/DeleteSatisfactionMetric/",l="api/CreateOrUpdate",f=[{BackgroundColor:"#FBE8E1",BackgroundImage:null,Name:"CV_Orange",PrimaryColor:"#D83B01",SecondaryColor:"#C33400",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/orange-thumbnail.png")},{BackgroundColor:"#FFF8E5",BackgroundImage:null,Name:"CV_Yellow",PrimaryColor:"#FFB900",SecondaryColor:"#E6A800",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/yellow-thumbnail.png")},{BackgroundColor:"#D1DBD1",BackgroundImage:null,Name:"CV_Green",PrimaryColor:"#107C10",SecondaryColor:"#0F700F",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/green-thumbnail.png")},{BackgroundColor:"#E7F2E7",BackgroundImage:null,Name:"CV_Teal",PrimaryColor:"#008575",SecondaryColor:"#007769",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/teal-thumbnail.png")},{BackgroundColor:"#E9F0FE",BackgroundImage:null,Name:"CV_Blue",PrimaryColor:"#2266E3",SecondaryColor:"#1F5BCC",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/blue-thumbnail.png")},{BackgroundColor:"#EFEFF6",BackgroundImage:null,Name:"CV_Purple",PrimaryColor:"#6264A7",SecondaryColor:"#585A95",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/purple-thumbnail.png")},{BackgroundColor:"#F0EAEA",BackgroundImage:null,Name:"CV_Dark_Orange",PrimaryColor:"#6B2929",SecondaryColor:"#602525",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/darkorange-thumbnail.png")},{BackgroundColor:"#E6EDE8",BackgroundImage:null,Name:"CV_Dark_Green",PrimaryColor:"#054B16",SecondaryColor:"#328647",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/darkgreen-thumbnail.png")},{BackgroundColor:"#E9EDED",BackgroundImage:null,Name:"CV_Dark_Teal",PrimaryColor:"#274B47",SecondaryColor:"#23433F",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/darkteal-thumbnail.png")},{BackgroundColor:"#E9EBEF",BackgroundImage:null,Name:"CV_Dark_Blue",PrimaryColor:"#243A5E",SecondaryColor:"#203455",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/darkblue-thumbnail.png")},{BackgroundColor:"#EAEEF5",BackgroundImage:null,Name:"CV_Sapphire",PrimaryColor:"#2B579A",SecondaryColor:"#274E8A",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/sapphire-thumbnail.png")},{BackgroundColor:"#EBEAEE",BackgroundImage:null,Name:"CV_Dark_Purple",PrimaryColor:"#3B2E58",SecondaryColor:"#362A50",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/darkpurple-thumbnail.png")},{BackgroundColor:"#EDECEC",BackgroundImage:null,Name:"CV_Black",PrimaryColor:"#000000",SecondaryColor:"#252525",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/black-thumbnail.png")},{BackgroundColor:"#EEEEEE",BackgroundImage:null,Name:"CV_Dark_Grey",PrimaryColor:"#2F2F2F",SecondaryColor:"#737373",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/darkgrey-thumbnail.png")},{BackgroundColor:"#FFF4ED",BackgroundImage:null,Name:"CV_Light_Orange",PrimaryColor:"#FF9349",SecondaryColor:"#E68443",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/lightorange-thumbnail.png")},{BackgroundColor:"#E5F8FE",BackgroundImage:null,Name:"CV_Light_Blue",PrimaryColor:"#00BCF2",SecondaryColor:"#00ABDA",Thumbnail:(0,i.Jn)("/Images/CustomerVoice/lightblue-thumbnail.png")}];f.forEach((function(t,n){t=Object.freeze(t),f[n]=t}))},29096:function(t,n,e){"use strict";e.d(n,{X:function(){return a}});var r=e(59312),i=e(63804),o=e(32782),s=e(29295);function u(){return(0,r.mG)(this,void 0,void 0,(function(){return(0,r.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(1245).then(e.bind(e,12212))];case 1:return[2,{default:t.sent().SurveyVariables}]}}))}))}function a(t){var n=(0,s.J)(a,u);return i.createElement(o.Z,null,i.createElement(n,(0,r.pi)({},t)))}},17309:function(t,n,e){"use strict";e.d(n,{bX:function(){return l},nE:function(){return f},F9:function(){return h}});var r=e(36215),i=e(9947),o=e(97265),s=e(13877),u=e(70699),a=e(27349),c=e(55890),l=function(){function t(){}t.prototype;return t.setLocaleItem=function(t,n,e,i){t&&(this.localeItem=t!==n?r.find(i,(function(n){return n.localeId===t})):{localeId:t,localeName:e})},t.updatePausedResponseForTextQuestion=function(t,n,e,r,o){var u=n?(0,s.G)():(0,s.$o)(),a=u.getItem("officeforms.answermap."+t+"."+(0,i.k0)().userInfo.UserId),c=null;if(a){var l=JSON.parse(a);Array.isArray(l)&&(c=l)}if(c){var f=u.getItem("officeforms.activesection"+t+"."+(0,i.k0)().userInfo.UserId);this.callUpdatePausedResponse(c,t,f,e,r,o)}},t.callUpdatePausedResponse=function(t,n,e,r,s,l){if(n&&r){var f=document.getElementById("form-container");if(null!=f){var h=(new Date).toUTCString();!function(t,n,e){var r=0,s=(0,o.GW)();(0,c.JG)({type:"CustomerVoice_UpsertPausedResponseStart",eventInfo:{Component:"PauseResumeSurvey",requestId:s,inviteId:n}}),new Promise((function(o,l){var f=function(){r++,(0,a.lW)({requestUri:(0,u.nL)()+"api/upsertpausedresponse/forms/"+t+"/invites/"+n,method:"POST",body:JSON.stringify(e),headers:{__RequestVerificationToken:(0,i.k0)().antiForgeryToken,Accept:"application/json"}}).then((function(){(0,c.JG)({type:"CustomerVoice_UpsertPausedResponseSuccess",eventInfo:{Component:"PauseResumeSurvey",requestId:s,inviteId:n}}),o(null)})).catch((function(t){r>3?((0,c.JG)({type:"CustomerVoice_UpsertPausedResponseFailed",eventInfo:{Component:"PauseResumeSurvey",requestId:s,inviteId:n}}),o(null)):f()}))};f()}))}(n,r,{formId:n,inviteId:r,answers:JSON.stringify(t),activeSection:e,modifiedDate:h,langCode:this.localeItem&&JSON.stringify(this.localeItem),validationToken:s,expiryDuration:l})}}},t}();function f(t,n){var e=0,r=(0,o.GW)();return(0,c.JG)({type:"CustomerVoice_FetchPausedResponseStart",eventInfo:{Component:"PauseResumeSurvey",requestId:r,inviteId:n}}),new Promise((function(o,s){var l=function(){e++,(0,a.lW)({requestUri:(0,u.nL)()+"api/fetchpausedresponse/forms/"+t+"/invites/"+n,method:"GET",headers:{__RequestVerificationToken:(0,i.k0)().antiForgeryToken,Accept:"application/json"}}).then((function(t){(0,c.JG)({type:"CustomerVoice_FetchPausedResponseSuccess",eventInfo:{Component:"PauseResumeSurvey",requestId:r,inviteId:n}}),o(t)})).catch((function(t){e>3?((0,c.JG)({type:"CustomerVoice_FetchPausedResponseFailed",eventInfo:{Component:"PauseResumeSurvey",requestId:r,inviteId:n}}),o(null)):l()}))};l()}))}function h(t,n){var e=0,r=(0,o.GW)();return(0,c.JG)({type:"CustomerVoice_DeletePausedResponseStart",eventInfo:{Component:"PauseResumeSurvey",requestId:r,inviteId:n}}),new Promise((function(o,s){var l=function(){e++,(0,a.lW)({requestUri:(0,u.nL)()+"api/deletepausedresponse/forms/"+t+"/invites/"+n,method:"DELETE",headers:{__RequestVerificationToken:(0,i.k0)().antiForgeryToken,Accept:"application/json"}}).then((function(){(0,c.JG)({type:"CustomerVoice_DeletePausedResponseSuccess",eventInfo:{Component:"PauseResumeSurvey",requestId:r,inviteId:n}}),o(null)})).catch((function(t){e>3?((0,c.JG)({type:"CustomerVoice_DeletePausedResponseFailed",eventInfo:{Component:"PauseResumeSurvey",requestId:r,inviteId:n}}),o(null)):l()}))};l()}))}},81291:function(t,n,e){"use strict";e.d(n,{x9:function(){return f},rV:function(){return h},VK:function(){return d},Ic:function(){return m},D4:function(){return o},cL:function(){return s},O8:function(){return u},BM:function(){return b},lx:function(){return w}});var r,i,o,s,u,a=e(59312),c=e(78587),l=e(21607),f="Header Uploaded Image Custom Theme",h="Header Predefined Image Custom Theme",d="No Header Image Custom Theme",m="Compact Header Custom Theme";function v(){return{HeaderBackgroundImage:null,Name:"CV_SimpleStyle",HeaderBackgroundThumbnail:(0,c.Jn)("/Images/CustomerVoice/blue-thumbnail.png"),BackGroundPositionX:"0px",BackGroundPositionY:"0px",BackGroundPositionZ:"auto",LogoPositionX:"Left",LogoPositionY:"Mid",TitlePositionX:"Left",TitlePositionY:"Mid",LogoSize:"Medium"}}function p(){return i||(i=e.e(8093).then(e.t.bind(e,65920,19)).then((function(t){return t.default}))),i}function g(t){return r||(r=(0,l.UM)(t||v().Name).then(JSON.parse)),r}function b(t){return(0,a.mG)(this,void 0,Promise,(function(){return(0,a.Jh)(this,(function(n){switch(n.label){case 0:return[4,p()];case 1:return[2,y(n.sent()[t])||v()]}}))}))}function w(t){return(0,a.mG)(this,void 0,Promise,(function(){return(0,a.Jh)(this,(function(n){switch(n.label){case 0:return[4,g(t)];case 1:return[2,y(n.sent()[t])||v()]}}))}))}function y(t){if(!t)return t;var n=t.HeaderBackgroundImage,e=t.HeaderBackgroundThumbnail;return null!=n&&/^\/Images\//i.test(n)&&(t.HeaderBackgroundImage=(0,c.Jn)(n)),null!=e&&/^\/Images\//i.test(e)&&(t.HeaderBackgroundThumbnail=(0,c.Jn)(e)),t}!function(t){t.Left="Left",t.Mid="Mid",t.Right="Right"}(o||(o={})),function(t){t.Top="Top",t.Mid="Mid",t.Down="Down"}(s||(s={})),function(t){t.Small="Small",t.Medium="Medium",t.Large="Large"}(u||(u={}))},82802:function(t,n,e){"use strict";e.d(n,{p:function(){return S}});var r=e(59312),i=e(15934),o=e(31699),s=e.n(o),u=e(63804),a=e(27196),c=e(36215),l=e(29096),f=e(55411),h=e(10836),d=e(7645),m=e(72467),v=e(67661),p=e(64290),g=e(20572),b=e(23112),w=e(26203),y=e(6462);p.Xw.createTextFieldWithCKEditor=function(t,n,e,i,o,s,a,c,l){return void 0===e&&(e=!1),void 0===i&&(i=!1),void 0===o&&(o=null),void 0===s&&(s=null),void 0===a&&(a=null),void 0===c&&(c=null),void 0===l&&(l=!1),t.Value=p.Xw.sanitizeRichTextHTML(t.Value),u.createElement(I,(0,r.pi)({Form:n,PipesNeeded:e,addLink:i,onFocus:o,onBlur:s,onKeyDownChoiceOption:a,onPasteChoiceOption:c,blockEnter:l},t))};var I=function(t){function n(n){var e=t.call(this,n)||this;return e.ct=[],e.lt=u.createRef(),e.dt=function(){(0,m.f5)().Model.FlexPane="CustomData"},e.gt=function(){e.setState({isPanelOpen:!0})},e.bt=e.bt.bind(e),e.wt=e.wt.bind(e),e.yt=e.yt.bind(e),e.state={isPanelOpen:!1},e}(0,r.ZT)(n,t);var e=n.prototype;return e.bt=function(t){var n=this.yt(t),e=p.Xw.sanitizeRichTextHTML(n);this.props.onValueChange(e)},e.yt=function(t){if((0,h.cr)("CKEditorAttributeValidation")){var n=(0,y.decode)(t);if((u=n.match(/(\<a\w*)((\s\/\>)|(.*\<\/a\w*\>))/gm))&&u.length>0)for(var e=0,r=u;e<r.length;e++){var o=r[e];if(o.includes("onclick")){var s=(new DOMParser).parseFromString(o,"text/html").body.lastElementChild;if(a=$(s).attr("onclick"))a.toString().startsWith("window.open")||($(s).removeAttr("onclick"),n=n.replaceAll(o,$(s).prop("outerHTML")),o=$(s).prop("outerHTML"));if(c=$(s).attr("href"))(0,i.K2)(c)||($(s).removeAttr("href"),n=n.replaceAll(o,$(s).prop("outerHTML")))}}return n}var u;if((u=t.match(/(\<\w*)((\s\/\>)|(.*\<\/\w*\>))/gm))&&u[0]&&u[0].includes("onclick")){var a,c;s=(new DOMParser).parseFromString(u[0],"text/html").body.lastElementChild;if(a=$(s).attr("onclick"))a.toString().startsWith("window.open")||($(s).removeAttr("onclick"),t=t.replaceAll(u[0],$(s).prop("outerHTML")));if(c=$(s).attr("href"))(0,i.K2)(c)||($(s).removeAttr("href"),t=t.replaceAll(u[0],$(s).prop("outerHTML")))}return t},e.focus=function(){this.lt.current&&this.lt.current.focus()},e.componentDidMount=function(){return(0,r.mG)(this,void 0,void 0,(function(){var t,n,e,i,o,s,u,c,l,m,p,g=this;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:return CKEDITOR?(t=a.findDOMNode(this),n=(0,f.cT)()?document.getElementById("form-designer-container"):document.getElementById("body-scrollable-content"),e=document.getElementById("reactshellheader"),i=(0,f.cT)()?document.getElementById("content-root-project"):document.getElementById("content-root"),o=document.getElementsByClassName("muliti-lingual-page-padding"),CKEDITOR.disableAutoInline=!0,this.props.Form?[4,this.props.Form.ensureFieldsReady([v.x.Schema.PipesDetails])]:[3,2]):[2];case 1:if(r.sent(),s=this.props.Form.Model.PipesDetails,u=JSON.parse(s)){for(c=void 0,c=0;c<u.length;c++)this.ct.push(u[c].pipeName);if(this.ct.length>0){for(l=[],m=0;m<this.ct.length;m++)p={value:"{{"+this.ct[m]+"}}",name:this.ct[m]},l.push(p);CKEDITOR.config.pipeinsert_strings=l,CKEDITOR.config.pipeinsert_button_label=(0,d.pm)().DistributePage_Variables_Label,CKEDITOR.config.pipeinsert_button_title=(0,d.pm)().DESIGNPAGE_PIPE_DROPDOWN_TOOLTIP,CKEDITOR.config.pipeinsert_button_voice=(0,d.pm)().DESIGNPAGE_PIPE_DROPDOWN_TOOLTIP,CKEDITOR.config.pipeinsert_addnew_option_text=(0,d.pm)().SettingsPane_SurveyVariable_Add,CKEDITOR.config.pipeinsert_addnew_option_text_colour=(0,f.cT)()?" #2266E3":" #008272",CKEDITOR.config.pipeinsert_addnew_option_callBack=(0,f.cT)()?this.gt:this.dt}}(0,h.cr)("FormsProAnswerTag")&&this.props.Form.ensureFieldsReady([v.x.Schema.FormsProAnswerTagMap]).then((function(){var t=w.d.convertToArray(g.props.Form.Model.FormsProAnswerTagMap);t.length>0?(CKEDITOR.config.answertag_strings=t,CKEDITOR.config.answertag_button_label=(0,d.pm)().DESIGNPAGE_ANSWERTAG_CKEDITOR_MENU_LABEL,CKEDITOR.config.answertag_button_title=(0,d.pm)().DESIGNPAGE_ANSWERTAG_DROPDOWN_TOOLTIP,CKEDITOR.config.answertag_button_voice=(0,d.pm)().DESIGNPAGE_ANSWERTAG_DROPDOWN_TOOLTIP):CKEDITOR.config.answertag_strings=void 0})),r.label=2;case 2:return $(t).find("textarea").each((function(t,r){if(n){var s=[n,e,i];g.It(r,s,g.props.PipesNeeded)}else if(null!=o&&o.length>0){var u=[o[0]];g.It(r,u,g.props.PipesNeeded)}})),[2]}}))}))},e.It=function(t,n,e){var r=this;this.St=CKEDITOR.inline(t,{removePlugins:"elementspath,magicline,liststyle,tableselection,tabletools,tableresize,contextmenu",fontSize_defaultLabel:"14px",skin:"moono-lisa",disallowedContent:"script",startupFocus:1==this.props.AutoFocus&&"start",startupShowBorders:!1,protectedSource:[/\n/g],enterMode:CKEDITOR.ENTER_BR,floatSpaceDockedOffsetY:2,title:!1,basicEntities:!1,fillEmptyBlocks:!1,tabSpaces:0,htmlEncodeOutput:!1,entities:!1,ignoreEmptyParagraph:!1,extraAllowedContent:["a(*)[*]"],baseFloatZIndex:1e7}),this.St.config.extraPlugins="confighelper",this.St.config.placeholder=this.props.Placeholder;var i=[{name:"basicstyles",items:["Bold","Italic","Underline"]},{name:"colors",items:["TextColor"]}];i=(0,f.cT)()?i.concat({name:"styles",items:["FontSize"]}):i.concat({name:"styles",items:["Font","FontSize"]});var o="richcombo,confighelper";if(e){var u=!1,l=!1;null!=CKEDITOR.config.pipeinsert_strings&&null!=CKEDITOR.config.pipeinsert_strings.length&&CKEDITOR.config.pipeinsert_strings.length>0&&(u=!0),null!=CKEDITOR.config.answertag_strings&&null!=CKEDITOR.config.answertag_strings.length&&CKEDITOR.config.answertag_strings.length>0&&(l=!0),(u||l)&&(o="richcombo,confighelper",u&&(o+=",pipeinsert"),l&&(o+=",answertag")),i=this.Ct(u,l,i)}else this.props.addLink&&(i=i.concat({name:"Link",items:["Link"]}));(0,h.cr)("FormsProRTECharLimit")&&(o+=",wordcount"),this.St.config.extraPlugins=o,this.St.config.toolbar=i,(0,f.cT)()&&(this.St.config.allowedContent="strong em u;span{!font-family};span{!color};span{!font-size};",this.props.addLink&&(this.St.config.allowedContent=this.St.config.allowedContent+"a[!href];")),(0,h.cr)("FormsProRTECharLimit")&&(this.St.config.wordcount={countHTML:!1,countLineBreaks:!0,countBytesAsChars:!1,countSpacesAsChars:!0,maxCharCount:this.props.MaxLength-1}),this.St.on("change",(function(t){r.bt(r.St.getData()),r.props.onFocus&&r.props.onFocus()})),this.St.on("key",(function(t){r.props.onKeyDownChoiceOption&&13===t.data.keyCode&&(r.props.onKeyDownChoiceOption(),t.cancel())})),this.St.on("paste",(function(t){if(r.props.onPasteChoiceOption){if("html"===t.data.type){t.data.dataValue=t.data.dataValue.replaceAll("<tr><td>",""),t.data.dataValue=t.data.dataValue.replaceAll("</td></tr>","\n");var n=s().sanitize(t.data.dataValue,{ALLOWED_ATTR:["style"],ALLOWED_TAGS:["span","strong","em","u","a"]});t.data.dataValue=n?n.toString():n}var e=t.data.dataValue;if(e=e.replaceAll("<br />","\n"))e.replace(/\r/g,"").split("\n").map((function(t){return t.trim()})).filter((function(t){return!!t})).length>1&&(r.props.onPasteChoiceOption(t),t.cancel())}})),this.St.on("focus",(function(t){if($("#"+t.editor.name+"TBdiv").show(),r.St.execCommand("selectAll"),r.props.onFocus){var n=t.editor;if(n){var e=n.document.getElementsByTag("a").toArray();(e=e.filter((function(t){return t.hasClass("cke_combo_button")||t.hasClass("cke_button__textcolor")})))&&e.length&&c.forEach(e,(function(t){t.on("click",(function(t){r.props.onFocus()}))}))}}})),CKEDITOR.on("dialogDefinition",(function(t){var n=t.data.definition.dialog;n.on("show",(function(){var t=document.getElementsByClassName("muliti-lingual-page-padding"),n=$("input.cke_dialog_ui_input_text[type=text]");if(n)for(var e=0;e<n.length;e++)n[e].labels&&n[e].labels.length>0&&"Display Text"===n[e].labels[0].innerText&&n[e].focus();if(t)if(0===$(".ms-Layer--fixed.lang-edit-layout-main").length){$(".ms-Layer--fixed.lang-edit-layout-clone").remove();var r=$(".ms-Layer--fixed").has(".cv-lang-edit-container"),i=$(".cke_dialog_background_cover:visible"),o=r.clone();if(0!==o.length&&0!==o.length&&0!=i.length){r.slice(0,1),o.slice(0,1),i.slice(0,1);var s=r[0].className,u=o[0].className;o[0].className=u+" lang-edit-layout-clone",r[0].className=s+" lang-edit-layout-main",o.insertAfter(i),$(".ms-Layer--fixed.lang-edit-layout-clone")[0].style.display="block",$(".ms-Layer--fixed.lang-edit-layout-main")[0].style.display="none"}}else 1===$(".ms-Layer--fixed.lang-edit-layout-clone").length&&($(".ms-Layer--fixed.lang-edit-layout-clone")[0].style.display="block",$(".ms-Layer--fixed.lang-edit-layout-main")[0].style.display="none")})),n.on("hide",(function(){document.getElementsByClassName("muliti-lingual-page-padding")&&($(".ms-Layer--fixed.lang-edit-layout-clone").remove(),$(".ms-Layer--fixed.lang-edit-layout-main").removeClass("lang-edit-layout-main").css("display","block"))}))})),this.St.on("blur",(function(t){if($("#"+t.editor.name+"TBdiv").hide(),r.props.onFocus){var n=t.editor;if(n){var e=n.document.getElementsByTag("a").toArray();e&&e.length&&c.forEach(e,(function(t){t.removeAllListeners()}))}}r.props.onBlur&&r.props.onBlur()})),this.St.on("instanceReady",(function(){if((0,f.cT)()){var t=null,n=null,e=(0,m.f5)();e&&e.Model&&e.Model.FormMaster&&(t=e.Model.FormMaster.Model.SurveyFont,n=e.Model.FormMaster.Model.HeaderFont);var r=this.element.$.parentElement.parentElement.className,i=$(this.element.$).attr("aria-label"),o=$(this.element.$).attr("placeholder"),s="font-family";n&&r&&c.contains(["title-designer-title-editor","multi-lingual-title-editon-text","title-designer-subtitle-editor","multi-lingual-subtitle-edition-box"],r)&&i&&c.contains([(0,d.pm)().Designer_FormTitle,(0,d.pm)().Designer_FormSubtitle,(0,d.pm)().Designer_SectionTitle,(0,d.pm)().Designer_SectionSubtitle],i)?$(a.findDOMNode(this.element.$.parentElement)).find(".cke_editable_inline")[0].style[s]=n:t&&($(a.findDOMNode(this.element.$.parentElement)).find(".cke_editable_inline")[0].style[s]=t);var u=$(a.findDOMNode(this.element.$.parentElement)).find(".cke_editable_inline")[0];u&&i&&"false"===u.getAttribute("aria-label")&&(o?u.setAttribute("aria-label",o):u.setAttribute("aria-label",i))}if(CKEDITOR.env.ie||CKEDITOR.env.edge){var l=this,h=l.editable(),v=l.getSnapshot();h.on("compositionstart",p),h.on("compositionupdate",p),h.on("compositionend",p)}function p(){var t=l.getSnapshot();t!==v&&(v=t,l.fire("change"))}})),n&&c.forEach(n,(function(t){t&&t.addEventListener("click",(function(t){var n=t.target;!n||"form-designer-container"!==n.id&&"form-designer"!==n.id||r.St.focusManager.blur(!0),"string"==typeof $(t.target)[0].className&&""!==$(t.target)[0].className.trim()&&$(t.target)[0].className.indexOf("cke_textarea_inline")<0&&$(t.target)[0].parentElement.className.indexOf("cke_textarea_inline")<0&&r.St.focusManager.blur(!0)}))})),this.St.on("key",(function(t){!r.props.blockEnter||13!==t.data.keyCode&&40!==t.data.keyCode||t.cancel()}))},e.Ct=function(t,n,e){return n&&t?(e=(e=e.concat({name:"custompipes",items:["pipeinsert"]})).concat({name:"answertags",items:["answertag"]}),this.props.addLink&&(e=e.concat({name:"Link",items:["Link"]}))):n?(e=e.concat({name:"answertags",items:["answertag"]}),this.props.addLink&&(e=e.concat({name:"Link",items:["Link"]}))):t&&(e=e.concat({name:"custompipes",items:["pipeinsert"]}),this.props.addLink&&(e=e.concat({name:"Link",items:["Link"]}))),e},e.render=function(){var t=c.clone(this.props);return t.ref=this.lt,u.createElement(u.Fragment,null,this.state.isPanelOpen&&(0,l.X)({onDismissSaveDialogue:this.wt,isPanelOpen:this.state.isPanelOpen}),u.createElement(u.Fragment,null,(0,g.ZA)(t)))},e.wt=function(){this.setState({isPanelOpen:!1})},n}(b.r);function S(t,n,e){void 0===e&&(e=null);var r=t;if(!n)return t;if("Segoe UI"===n){if(t&&t.indexOf("font-family")>0){var i=t.indexOf("font-family"),o=(u=t.slice(i+12)).indexOf('"'),s=u.slice(0,o);r=(r=(r=t.replace(s,"")).replace('<span style="font-family:">',"")).slice(0,r.length-7)}}else if(t)if(t.indexOf("font-family")>0){var u;i=t.indexOf("font-family"),o=(u=t.slice(i+12)).indexOf('"'),s=u.slice(0,o);r=t.replace(s,n)}else r='<span style="font-family:'+n+'">'+t+"</span>";else e&&(r='<span style="font-family:'+n+'">'+e+"</span>");return r}},39455:function(t,n,e){"use strict";e.d(n,{G:function(){return r},Z:function(){return s}});var r,i=e(9947),o={};!function(t){t[t.ApiFacadeEndPoint=0]="ApiFacadeEndPoint",t[t.FormsProUIHost=1]="FormsProUIHost",t[t.FormsHomeUrl=2]="FormsHomeUrl",t[t.FormsSingleSignOnHomeUrl=3]="FormsSingleSignOnHomeUrl",t[t.FormsProCdnHomeUrl=4]="FormsProCdnHomeUrl",t[t.PreviewSettingsDefaultDate=5]="PreviewSettingsDefaultDate",t[t.FormsProGeo=6]="FormsProGeo",t[t.FormsProLicensingServiceEndPoint=7]="FormsProLicensingServiceEndPoint",t[t.FormsProSampleFormTenantId=8]="FormsProSampleFormTenantId",t[t.FormsProMSRewardsAvailableCountryCodes=9]="FormsProMSRewardsAvailableCountryCodes",t[t.FormsProCSATEndpoint=10]="FormsProCSATEndpoint",t[t.FormsProCSATTenant=11]="FormsProCSATTenant",t[t.FormsProResponseLimit=12]="FormsProResponseLimit",t[t.UIFacadeEndPoint=13]="UIFacadeEndPoint",t[t.ChatDistributionEndpoint=14]="ChatDistributionEndpoint",t[t.ProjectUIServiceEndpoint=15]="ProjectUIServiceEndpoint",t[t.FormsProResponseGridLimit=16]="FormsProResponseGridLimit",t[t.OrchestrationServiceEndpoint=17]="OrchestrationServiceEndpoint",t[t.FormsProRespondentGridMaxLimit=18]="FormsProRespondentGridMaxLimit",t[t.FormsProRespondentGridPageSize=19]="FormsProRespondentGridPageSize",t[t.SatisfactionMetricTrendAndAggregateDataUrl=20]="SatisfactionMetricTrendAndAggregateDataUrl",t[t.SatisfactionMetricMaxLimit=21]="SatisfactionMetricMaxLimit",t[t.CustomerVoiceProjectShareServiceEndpoint=22]="CustomerVoiceProjectShareServiceEndpoint",t[t.ExportCsvServiceEndpoint=23]="ExportCsvServiceEndpoint",t[t.CustomerVoiceSurveyUIServiceEndpoint=24]="CustomerVoiceSurveyUIServiceEndpoint",t[t.CurrentFlowEndpoint=25]="CurrentFlowEndpoint",t[t.CVFlowUIServiceEndPoint=26]="CVFlowUIServiceEndPoint",t[t.CVHomeVideoLinks=27]="CVHomeVideoLinks",t[t.CVDynamicsLink=28]="CVDynamicsLink",t[t.ProjectAlertServiceEndPoint=29]="ProjectAlertServiceEndPoint",t[t.CVReportingLimit=30]="CVReportingLimit",t[t.CustomerVoiceProjectShareServiceV2Endpoint=31]="CustomerVoiceProjectShareServiceV2Endpoint",t[t.CVCIServiceEndpoint=32]="CVCIServiceEndpoint",t[t.CVSurveyReportDateFilterRange=33]="CVSurveyReportDateFilterRange",t[t.DistributionServiceEndpoint=34]="DistributionServiceEndpoint",t[t.CVPauseResumeService=35]="CVPauseResumeService",t[t.InviteServiceEndpoint=36]="InviteServiceEndpoint",t[t.ShareV2StatusFetchDuration=37]="ShareV2StatusFetchDuration",t[t.CustomLinksExcelUploadLimit=38]="CustomLinksExcelUploadLimit",t[t.CustomLinksRecordsLimit=39]="CustomLinksRecordsLimit",t[t.CVReportServiceHostUrl=40]="CVReportServiceHostUrl",t[t.CascadeSubQuesMaxLimit=41]="CascadeSubQuesMaxLimit",t[t.CVRespondentGridPageSize=42]="CVRespondentGridPageSize",t[t.CVResponseDeletePerBatchLimit=43]="CVResponseDeletePerBatchLimit",t[t.CVProjectOperationFetchDuration=44]="CVProjectOperationFetchDuration",t[t.CVSurveyCountApproachingLimitFirstStage=45]="CVSurveyCountApproachingLimitFirstStage",t[t.CVSurveyCountApproachingLimitSecondStage=46]="CVSurveyCountApproachingLimitSecondStage",t[t.CVSurveyCountExceedLimit=47]="CVSurveyCountExceedLimit",t[t.ShareV2SurveyLimitToShowMessage=48]="ShareV2SurveyLimitToShowMessage",t[t.CVHomeVideoTitles=49]="CVHomeVideoTitles",t[t.CVRoleTemplateId=50]="CVRoleTemplateId",t[t.CVGetFormLimit=51]="CVGetFormLimit",t[t.CVCkEditorVersion=52]="CVCkEditorVersion"}(r||(r={})),o[r.ApiFacadeEndPoint]="https://mfpapifacadefaint.azurewebsites.net/",o[r.UIFacadeEndPoint]="https://cvsurveyuiserviceint.azurewebsites.net",o[r.FormsProUIHost]="https://mfpuiwebappint.azurewebsites.net",o[r.FormsHomeUrl]="https://forms.office-int.com",o[r.FormsSingleSignOnHomeUrl]="https://forms.office-int.com/formspro",o[r.FormsProCdnHomeUrl]="https://mfpembedcdnint.azureedge.net/mfpembedcontint/",o[r.PreviewSettingsDefaultDate]="2019-02-08",o[r.FormsProGeo]="INT",o[r.FormsProLicensingServiceEndPoint]="https://mfplicensingservicefaint.azurewebsites.net/",o[r.FormsProSampleFormTenantId]="558a6a52-809d-4de8-8b01-01a51502c93f",o[r.FormsProMSRewardsAvailableCountryCodes]="US",o[r.FormsProCSATEndpoint]="https://nps.onyx.azure.net",o[r.FormsProCSATTenant]="formspro",o[r.FormsProResponseLimit]="50000",o[r.ChatDistributionEndpoint]="https://mfpuifacadeint.projectsshimlaint.com/",o[r.ProjectUIServiceEndpoint]="https://cvuiserviceatmint.projectsshimlaint.com/",o[r.ProjectAlertServiceEndPoint]="https://mfpprojectalertfaint.azurewebsites.net/",o[r.FormsProResponseGridLimit]="5000",o[r.OrchestrationServiceEndpoint]="https://cvtemplateorchfaint.azurewebsites.net/",o[r.FormsProRespondentGridMaxLimit]="500",o[r.FormsProRespondentGridPageSize]="50",o[r.SatisfactionMetricTrendAndAggregateDataUrl]="https://mfpsatisfactionmetricsapisfaint.azurewebsites.net/",o[r.SatisfactionMetricMaxLimit]="10",o[r.CustomerVoiceProjectShareServiceEndpoint]="https://cvuisharev2tm.projectsshimlaint.com/",o[r.ExportCsvServiceEndpoint]="https://mfpuasfaint.azurewebsites.net/",o[r.CustomerVoiceSurveyUIServiceEndpoint]="https://cvsurveyuiserviceint.azurewebsites.net/",o[r.CurrentFlowEndpoint]="https://us.tip1.flow.microsoft.com/",o[r.CVFlowUIServiceEndPoint]="https://cvflowfaint.azurewebsites.net/",o[r.CVHomeVideoLinks]="https://youtu.be/Mctc8pc6q_A,https://youtu.be/se5fCA9IptI,https://youtu.be/jLdw_TSqolA",o[r.CVHomeVideoTitles]="Introduction to Dynamics 365 Customer Voice,How to add branching rules to your survey in Dynamics 365 Customer Voice,Customer Feedback Management Solution for banks using Dynamics 365 Customer Voice",o[r.CVDynamicsLink]="https://dynamics.microsoft.com/en-us/customer-voice/overview/",o[r.CVReportingLimit]="500000",o[r.CustomerVoiceProjectShareServiceV2Endpoint]="https://cvuisharev2faint.azurewebsites.net/",o[r.CVCIServiceEndpoint]="https://cvcifaint.azurewebsites.net/",o[r.DistributionServiceEndpoint]="https://mfpdistfaint.azurewebsites.net/",o[r.CVSurveyReportDateFilterRange]="90",o[r.CVPauseResumeService]="https://mcvparfaint.azurewebsites.net/",o[r.InviteServiceEndpoint]="https://cvinviteservicefaint.azurewebsites.net/formapi/api/",o[r.ShareV2StatusFetchDuration]="5000",o[r.CustomLinksExcelUploadLimit]="10000",o[r.CustomLinksRecordsLimit]="10000",o[r.CVReportServiceHostUrl]="https://customervoicereportingapi.azurewebsites.net/",o[r.CascadeSubQuesMaxLimit]="3",o[r.CVRespondentGridPageSize]="500",o[r.CVResponseDeletePerBatchLimit]="500",o[r.CVProjectOperationFetchDuration]="5000",o[r.CVSurveyCountApproachingLimitFirstStage]="350",o[r.CVSurveyCountApproachingLimitSecondStage]="375",o[r.CVSurveyCountExceedLimit]="400",o[r.ShareV2SurveyLimitToShowMessage]="15",o[r.CVRoleTemplateId]="62e90394-69f5-4237-9190-012177145e10",o[r.CVGetFormLimit]="200",o[r.CVCkEditorVersion]="4.11.2-full";var s=function(){function t(){}t.prototype;return t.getSetting=function(n){t.webSettingsJson||(t.webSettingsJson=decodeURI((0,i.k0)().webSettings||"{}")),t.webSettingsMap||(t.webSettingsMap=JSON.parse(t.webSettingsJson));var e=t.webSettingsMap[r[n].toString()];if(!e){var s=o[n];e=s||t.defaultValue}return e},t.defaultValue="",t}()},98722:function(t,n,e){"use strict";var r;e.d(n,{G:function(){return r}}),function(t){t[t.ResponsePage=1]="ResponsePage",t[t.TeamsResponsePage=2]="TeamsResponsePage",t[t.AssignmentResponsePage=4]="AssignmentResponsePage"}(r||(r={}))},99019:function(t,n,e){"use strict";var r;function i(t){r=t}function o(){return r?r():Promise.reject("GetAddinAccessTokenFailed")}e.d(n,{Q:function(){return i},y:function(){return o}})},7614:function(t,n,e){"use strict";e.d(n,{r:function(){return c}});var r,i=e(9947),o=e(72317),s=e(55890),u=e(21607),a=!1;function c(t){if(!r||a){a=!1,r=(0,u.v9)(t).then((function(){return(0,s.$U)("RefreshInfo.Success"),(0,o.a)().Flighting.setFlights((0,i.k0)().flights),!0})).catch((function(t){throw(0,s.$U)("RefreshInfo.Failed",{error:t}),a=!0,t}))}return r}},94016:function(t,n,e){"use strict";e.d(n,{g$:function(){return k},l8:function(){return x},LP:function(){return P}});var r,i,o=e(54178),s=e(61734),u=e(77489),a=e(94290),c=e(29559),l=e(9947),f=e(916),h=e(37890),d=e(72317),m=e(55890),v=e(55411),p=e(10836),g=e(62662),b=e(81620),w=e(93592),y=e(47835),I=e(46008),S=e(99019),C=e(7614),F=e(59469),N=0,T=null;function k(){window.formsRefreshAuthTokenCallbacks||(window.formsRefreshAuthTokenCallbacks=[]);return(0,F.W3)((function(){return(0,d.a)().AuthContext.hasUserLoggedIn()}),(function(){window.onbeforeunload=null,(0,d.a)().AuthContext.signIn().then(w.iv)}))}function x(t,n){return new Promise((function(e,r){var i="detect-user-loggedIn-frame";if(window.formsDetectUserLoggedInCallback)r();else{var o="Msa"===t,s=o?"Auth.DetectUserLoggedInMSA":"Auth.DetectUserLoggedInAAD",u=new f.o(s);u.start();var a=(0,l.k0)(),c=a.signInLinkSilentMsa,h=a.signInLinkSilent,d=o?c:h;n&&(d=(0,b.y)(d,o?"username":"login_hint",encodeURIComponent(n)));var m=$("<iframe id='"+i+"' style='display: none' src='"+d+"' />");m.on("load",(function(){window.setTimeout((function(){window.formsDetectUserLoggedInCallback&&window.formsDetectUserLoggedInCallback(!1,!0)}),5e3)})),window.formsDetectUserLoggedInCallback=function(t,n){window.formsDetectUserLoggedInCallback=void 0,u.end({resultType:n?"ExpectedFailure":"Success"}),$("#"+i).remove(),e(t)},$(document.body).append(m)}}))}function P(t,n){if((0,g.dY)()||(0,g.LG)()||(0,g.Av)()){if(i||(i=new h.wU),!(0,g.LG)()&&!(0,g.Av)()&&T&&T.isAccessTokenFromHostValid()){var e=T.getAccessToken();return n?(0,C.r)(e).then((function(){return i.resolve(e)})):i.resolve(e),i.promise()}return i.states()!==h.Cb.Pending&&(i=new h.wU),function(){T=null,window.addEventListener("message",D,!1);var t="*";(0,p.cr)("FixEslintPostMessageError")&&(!(t=(0,I.LU)())||t&&!(0,o.J)(t))&&((0,m.$U)("Warning.HostOrigin.GetAccessTokenFromHost",{error:"Parent origin doesn't exist in whitelist",origin:t}),t="*");window.parent.postMessage("GetAccessTokenFromHost",t)}(),N=0,R(),i.promise()}return(0,I.xO)()?(0,S.y)().then(null,(function(){return E(t)})):(0,a.mF)()?(0,y.l4)():E(t)}function D(t){if(t.data&&"string"==typeof t.data&&t.data.startsWith("FormsAccessTokenFromHost:"))try{var n="FormsAccessTokenFromHost:Bearer ",e=t.data.indexOf(n);if(-1!==e){var r=t.data.substring(e+n.length);T=new L(r)}}finally{window.removeEventListener("message",D,!1)}}function E(t){return(0,v.hj)()?Promise.resolve(null):t.getCachedUser()?new Promise((function(n,e){t.acquireToken((0,s.Un)(),(function(i,o){if(!i&&o)return r=new Date,n(o);var a,l;if(!t.getCachedToken((0,s.Bs)())){if(r){var f=(new Date).getTime()-r.getTime();(0,m.$U)("Auth.AcquireTokenIdleTime",{error:i,idleTimeInMinutes:f/6e4})}return t.clearCache(),void(0,w.sl)()}if(t.clearCache(),i.match("^AADSTS50079:"))return(0,m.zU)("AADAcquireTokenMfaCheckFailure",i),(a=new Error).name="AADAcquireTokenMfaCheckError",a.message=i,e(a);if(!i.match("^AADSTS50058:"))return(0,m.zU)("AADAcquireTokenFailure",i),(a=new Error).name="AADAcquireTokenError",a.message=i,e(a);if((0,c.w1)()||(0,c.un)()){var h=(0,u.Nt)();if((0,m.zU)("LoginIECrossZone",{useLegacyLoginDomain:!!h}),(0,u.Nt)())(0,u.$6)(!1);else if((0,u.Gb)())return(0,u.$6)(!0),void(0,w.sl)()}else(0,m.zU)("AADAcquireTokenFailure",i);(l=i,new Promise((function(t){!function(t){var n=function(e){switch(e.data){case"TPC:NotSupported":t(!1),window.removeEventListener("message",n);break;case"TPC:Supported":t(!0),window.removeEventListener("message",n)}};window.addEventListener("message",n,!1);var e="https://controls.officeppe.com/thirdpartycookie/check.html";$("body").append('<iframe id="detectThirdPartyCookieFrame" style="display:none;" src='+e+"><iframe>")}((function(n){(0,m.$U)("Auth.ThirdPartyCookieSupport",{allow:n});var e=new Error(l);e.name=n?"LoginIECrossZoneError":"ThirdPartyCookieBlockedError",t(e)}))}))).then(e)}))})):Promise.resolve(null)}function R(){if(null!=T){var t=T.getAccessToken();(0,C.r)(t).then((function(){return i.resolve(t)}))}else N<10?(N++,window.setTimeout(R,1e3)):(N=0,i.resolve(null))}var L=function(){function t(t){this.Ft=t;this.Tt=(new Date).getTime()+33e5}var n=t.prototype;return n.getAccessToken=function(){return this.Ft},n.isAccessTokenFromHostValid=function(){return!!this.Ft&&(new Date).getTime()<this.Tt},t}()},59469:function(t,n,e){"use strict";e.d(n,{hh:function(){return c},W3:function(){return l},xO:function(){return f},D1:function(){return h},ad:function(){return d}});var r=e(64459),i=e(9947),o=e(916),s=e(55411),u=e(81620),a=e(93592);function c(t){var n=t&&t.response&&t.response.statusCode;if((0,s.hj)()&&401===n){if(t&&t.response&&"Expired"===(0,u.jL)(t.response.headers,"X-FailureReason"))return!0;var e=t&&t.response&&(0,r.d)(t.response.body);if(711===(e&&e.error&&parseInt(e.error.code)))return!0}return!1}function l(t,n){var e=(0,i.k0)().signInLinkSilent,r=(0,i.k0)().signInLinkSilentMsa;return new Promise((function(s){if(window.formsRefreshAuthTokenCallbacks||(window.formsRefreshAuthTokenCallbacks=[]),window.formsRefreshAuthTokenCallbacks.push((function(t,e){!e&&t?s():n()})),!window.formsRefreshAuthTokenCallback){var u=new o.o("Auth.RefreshToken");u.start();var a=function(t,n){try{u.end({extraData:{loggedIn:t},resultType:n?"ExpectedFailure":"Success"});var e=document.querySelector("#refreshAuthTokenFrame");e&&e.parentNode.removeChild(e);var r=window.formsRefreshAuthTokenCallbacks;r&&(n?r&&r.length>0&&r[0](t,n):r.forEach((function(e){return e(t,n)})))}finally{window.formsRefreshAuthTokenCallback=void 0,window.formsRefreshAuthTokenCallbacks=void 0}};if(t()){var c=(0,i.k0)().userInfo.IsMsa?r:e,l=document.createElement("iframe");l.id="refreshAuthTokenFrame",l.setAttribute("style","display: none;"),l.setAttribute("src",c);var f=function(){window.formsRefreshAuthTokenCallback&&window.formsRefreshAuthTokenCallback(!1,!0)};l.onload=function(){window.setTimeout(f,5e3)},window.setTimeout(f,5e3),window.formsRefreshAuthTokenCallback=a,document.body.appendChild(l)}else a(!1,!0)}}))}function f(t){var n=t&&t.response&&t.response.statusCode;if((0,s.hj)()&&401===n){var e=t&&t.response&&(0,r.d)(t.response.body);if(718===(e&&e.error&&parseInt(e.error.code)))return!0}return!1}function h(t){if(401===(t&&t.response&&t.response.statusCode)){var n=t&&t.response&&(0,u.jL)(t.response.headers,"WWW-Authenticate");return n&&-1!==n.indexOf("invalid_token")}return!1}function d(){var t=window.location.href,n=t.replace(/^https:\/\/forms\.microsoft(-int)?\.com/,"https://forms.office$1.com");t!==n&&(0,a.mj)(n)}},49211:function(t,n,e){"use strict";e.d(n,{w:function(){return a}});var r=e(36215),i=e(29952),o=e(9947),s=e(72420),u=e(67661);function a(t,n){var e;if((0,s.HD)(t))e=t;else if(t){var a=t;if(a.isFieldReady(u.x.Schema.OwnerId)&&!a.IsGroupForm&&a.Model.OwnerId!==(0,o.k0)().userInfo.UserId)return!1;a.isFieldReady(u.x.Schema.Category)&&(e=a.Model.Category),a.isFieldReady(u.x.Schema.Type)&&!(0,i.Oy)()&&("approval"===a.Model.Type?e="Approval":"reports"===a.Model.Type&&(e="Reports"))}return!!e&&r.contains({"Loop Poll":["DisableEditForm"],Poll:["Settings.AllowResponderGetAllResponses","DisableEditForm","ResponsePage.PollView"],"Teams Poll":["DisableEditForm"],Approval:["DisableEditForm"],Reports:["DisableEditForm"]}[e],n)}},55411:function(t,n,e){"use strict";e.d(n,{WT:function(){return a},Pq:function(){return c},y:function(){return l},cT:function(){return f},hj:function(){return h},sv:function(){return d},HA:function(){return m},lz:function(){return v},Kc:function(){return p},pc:function(){return g}});var r=e(96078),i=e(33967),o=e(64290),s=e(10836),u=e(90710);function a(){return(0,s.cr)("EnableCustomerVoice")&&!(0,s.cr)("CustomerVoiceBlackList")}function c(){return window.location.host.toLocaleLowerCase().indexOf("customervoice.microsoft.us")>=0}function l(){var t=(0,i.kD)();return"CVInt"===t||"CVProd"===t||"CVTip"===t||"CVFastfood"===t||"CVDaily"===t||c()}function f(){return l()&&a()}function h(){return(0,i.Zr)()}function d(){switch(window.location.pathname.toLowerCase()){case"/pages/mobiledesignpage.aspx":return!0;default:return!1}}function m(){return(0,o.pd)(r.Z,(function(){return(0,i.yv)()?"https://graph.microsoft.com/beta":"https://graph.microsoft-ppe.com/beta"}))}function v(t){return"lists."+b(t)}function p(){return(0,u.NW)().lang||null}function g(){return"Int"}function b(t,n){switch(void 0===n&&(n=!1),null==t&&(t=(0,i.kD)()),t){case"USNat":return n?"eaglex.ic.gov":"osi.eaglex.ic.gov";case"USSec":return n?"microsoft.scloud":"osi.microsoft.scloud";case"USDoDProd":return n?"apps.mil":"osi.apps.mil";case"USGovProd":return n?"office365.us":"osi.office365.us";case"USGovGccProd":return n?"office.com":"gcc.osi.office365.us";case"WWProd":case"MSProd":case"ProTip":case"CVProd":case"CVTip":case"CVFastfood":return"office.com";case"Trial":return"officeppe.com";default:return"office-int.com"}}},10836:function(t,n,e){"use strict";e.d(n,{M0:function(){return c},VE:function(){return l},cr:function(){return f},g:function(){return h},_y:function(){return m},Be:function(){return v}});var r,i=e(86353),o=e(9947),s=e(90710),u=e(98722),a=e(72317);function c(){return d(u.G.ResponsePage)&&!m()}function l(){return d(u.G.ResponsePage|u.G.TeamsResponsePage|u.G.AssignmentResponsePage)&&!m()}function f(t){return(0,a.a)().Flighting.isEnabled(t)}function h(){return f("FirstReleaseClientEnabled")}function d(t){return 0!=(r&t)}function m(){return!!(0,o.k0)().proEnabled&&f("FormsPro")}function v(){var t=f("EnableSuperL1"),n=2===(0,i.Tl)().FormsSuperL1,e=(0,s.NW)(),r="1"===e.disablel1,o=e.origin,u=e.prevorigin;return!r&&t&&n&&!("OfficeDotCom"===o||"OfficeDotComPrv"===o||"OfficeDotCom"===u||"OfficeDotComPrv"===u)}},94978:function(t,n,e){"use strict";e.d(n,{Gw:function(){return s},qA:function(){return u},vj:function(){return a}});var r,i=e(9947),o={};function s(t){var n,e;if(void 0===r)try{r=JSON.parse(decodeURI((0,i.k0)().webSettings||"{}"))}catch(t){r={}}return null!==(e=null!==(n=r[t])&&void 0!==n?n:o[t])&&void 0!==e?e:""}function u(t){var n=s(t);if(n)try{var e=JSON.parse(n);if(Array.isArray(e))return e}catch(t){return null}return null}function a(t,n){var e=s(t);if(e){var r=parseInt(e);if(!isNaN(r))return r}return n}function c(t,n){o[t]=n}c("CustomerVoiceTransitionCompletionDate","08/30/2020"),c("CustomerVoiceUrl","https://customervoice.microsoft-int.com")},57411:function(t,n,e){"use strict";e.d(n,{p3:function(){return u},x_:function(){return a},EA:function(){return c},tE:function(){return l},gq:function(){return f},M5:function(){return h},eT:function(){return d},BP:function(){return m}});var r=e(33967),i=e(37076),o=null,s=null;function u(t){o=t}function a(){return o&&o()}function c(t){s=t}function l(){return s&&s()}function f(){var t=(0,i.kc)(a()||"");return!!t.OrgId&&t.OrgId.toLowerCase()===(0,r.rq)()}function h(){var t=(0,i.kc)(a()||"");return!!t.OrgId&&t.OrgId.toLowerCase()===(0,r.Fc)()}function d(){var t=(0,i.kc)(a()||"");return!!t.OrgId&&-1!==(0,r.iI)().indexOf(t.OrgId.toLowerCase())}function m(){var t=a();return t&&(0,i.kc)(t)}},63797:function(t,n,e){"use strict";e.d(n,{un:function(){return r}});e(64290);function r(){return["image/bmp","image/gif","image/jpeg","image/png"]}},7899:function(t,n,e){"use strict";e.d(n,{y:function(){return a},m:function(){return c}});var r=e(78587),i=e(33967),o=e(9947);var s,u=e(67640);function a(t){return v[t]||(v[t]=c(d[t]||[]).then((function(){return function(t){return function(){void 0===s&&(t=(0,o.k0)(),n=t.scriptSuffix,e=t.isCdnEnabled,i={"combined-design":e?"Vendors/combinedmin/design_v3.min.js":"Vendors/combined/design_v3_aabaaa2.js","combined-response":e?"Vendors/combinedmin/response_v2.min.js":"Vendors/combined/response_v2_5234a19.js",BootStrap:"Vendors/bootstrap/3.4.1/bootstrap."+n,DataTables:"Vendors/DataTables."+n,Chart:"Vendors/Chart-2.6."+n,Clipboard:"Vendors/clipboard-1.7.1.min.js",ColorThief:"Vendors/color-thief/color-thief.min.js",Cropper_Modified:"Vendors/cropper/cropper.modified."+n,D3:"Vendors/d3/d3."+n,Heatmap:"Vendors/highcharts/heatmap.min.js",HighCharts:"Vendors/highcharts/highcharts.min.js",HighCharts_More:"Vendors/highcharts/highcharts-more.min.js",ImmersiveReader:"Vendors/ImmersiveReader/immersive-reader-sdk.0.0.2.min.js",Ivy:"//edera.cloudapp.net/javascripts/api/ivy.js",OfficeBrowserFeedback:"Vendors/officebrowserfeedback/1.4.2/officebrowserfeedback_floodgate.min.js",JQuery_RateIt:"Vendors/rating-1.1.0/jquery.rateit."+n,JQuery_Picker:"Vendors/pickadate-3.5.6/picker."+n,JQuery_Picker_Date:"Vendors/pickadate-3.5.6/picker.date."+n,JQuery_Picker_Time:"Vendors/pickadate-3.5.6/picker.time."+n,JQuery_QRCode:"Vendors/jquery.qrcode.min.js",Linkify:"Vendors/linkify-2.1.8/linkify.min.js",Linkify_JQuery:"Vendors/linkify-2.1.8/linkify-jquery.min.js",MathJax:l(),MathQuill:"Vendors/mathquill/mathquill."+n,O365ShellBootstrap:f(),Pattern_Fill:"Vendors/highcharts/pattern-fill.min.js",Mark:"Vendors/markjs-8.9.0/mark."+n,SignalR:"Vendors/SignalR/jquery.signalR-2.4.1.min.js",Sortable:"Vendors/sortablejs-1.8.4/Sortable.modified."+n,WordCloud:"Vendors/highcharts/wordcloud.min.js"},s=Object.keys(i).reduce((function(t,n){return t[n]=function(t,n){return h.indexOf(t)>=0?n||"":(0,r.oE)(n,!1)}(n,i[n]),t}),{}));var t,n,e,i}(),function(t,n,e){return new Promise((function(r,i){if(!t)throw Error("No script path for "+t);var o=document.getElementsByTagName("head")[0];if(!o)return i(Error("No head element found!"));var s=document.createElement("script");s.type="text/javascript",s.async=!0,s.src=t,n&&e&&(s.crossOrigin="anonymous"),s.onload=function(){return r()},s.onerror=function(){o.removeChild(s),i(Error("Failed to load javascript file: "+t))},o.appendChild(s)}))}(s[t],(0,o.k0)().isCdnEnabled,function(t){return h.indexOf(t)<0}(t))}(t)})),"undefined"!=typeof Forms&&(0,u.z)("script:"+t,v[t])),v[t]}function c(t){return Promise.all(t.map(a))}function l(){return(0,i.Zr)()?"../scripts/vendors/mathjax/MathJax.js?config=TeX-AMS_HTML":"//cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML"}function f(){var t=(0,o.k0)(),n=t.o365ShellBootHost,e=t.o365ShellBootstrapperUrl;return n?e||n.concat("/api/shellbootstrapper/",(0,o.k0)().userInfo.IsMsa?"consumer":"business","/oneshell"):""}var h=["Ivy","MathJax","O365ShellBootstrap"];var d={};function m(t,n){d[t]=n}m("JQuery_Picker_Date",["JQuery_Picker"]),m("JQuery_Picker_Time",["JQuery_Picker"]),m("Linkify_JQuery",["Linkify"]),m("WordCloud",["HighCharts"]),m("HighCharts_More",["HighCharts"]),m("Heatmap",["HighCharts"]),m("Pattern_Fill",["HighCharts"]);var v={}},17290:function(t,n,e){"use strict";function r(t){t.trigger("focus")}e.d(n,{x:function(){return r}})},77356:function(t,n,e){"use strict";e.d(n,{z:function(){return u}});var r=e(72377);var i=e(57411),o=e(55890),s=e(94978);function u(t){(0,i.M5)()||r.Pv.Resolve("IThirdPartyLinkify").then((function(){return function(t){t.linkify();var n=/^[a-z0-9]\.|\.xxx/i,e=(0,s.Gw)("LinkifyEscapeRegex");e&&(n=new RegExp(e,"i"));t.find("a.linkified").each((function(t,e){$(e).text().match(n)&&$(e).contents().unwrap()})),t.find("a.linkified").length&&(0,o.$U)("NeedLinkify")}(t)}))}},51254:function(t,n,e){"use strict";e.d(n,{WW:function(){return s},d6:function(){return a}});var r,i=e(37890),o=e(41448),s="ClientMSGraph.";function u(){r=new i.bC((0,o.d8)().getOD4BToken())}function a(t){return(r&&r.states()!==i.Cb.Rejected||u(),r.promise()).then(t).catch((function(n){if(n&&n.response&&401===n.response.statusCode)return(r&&r.states()===i.Cb.Pending||u(),r.promise()).then(t);throw n}))}FormsPro.sendRequestWithToken=a},10050:function(t,n,e){"use strict";e.d(n,{o:function(){return r}});var r=function(){function t(n){if(this.secureUUID=n,t.initialize(),!this.secureUUID||0===this.secureUUID.trim().length)throw Error("The union secure uuid is null or empty.")}var n=t.prototype;return n.initializeNativeEventCallback=function(t){window.officeMobileHandleNativeEvent=t},t.initialize=function(){window.officeMobileHandleNativeMessage||(window.officeMobileHandleNativeMessage=function(t){if(!t)return"responseObject is Empty";if(!t.callbackId)return"CallbackId and message are Empty";var n=window.mOfficeMobileNativeCallbackMap.get(t.callbackId);return n?(window.mOfficeMobileNativeCallbackMap.delete(t.callbackId),n(t.args)):"Unable to find callback"}),window.mOfficeMobileNativeCallbackMap||(window.mOfficeMobileNativeCallbackMap=new Map)},n.updateAndGetAuthTokenCallback=function(n,e){var r=this;t.initialize();var i=Date.now().toString()+"-"+t.callbackIndex++;return window.mOfficeMobileNativeCallbackMap.set(i,(function(t){var i=null;return t?t.UUID!==r.secureUUID&&(i="uuid is not same with the expected secure uuid"):i="Args is empty",null!==i?e(i):t.isSuccess?n(t.response):e(t.response),i})),i},t.callbackIndex=1e3,t}()},47303:function(t,n,e){"use strict";e.d(n,{L:function(){return r}});var r=function(){function t(t){if(this.secureUUID=t,!this.secureUUID||0===this.secureUUID.trim().length)throw Error("The union secure uuid is null or empty.")}t.prototype;return t}()},4101:function(t,n,e){"use strict";e.d(n,{h:function(){return i}});var r=e(59312),i=function(t){function n(n){return t.call(this,n)||this}return(0,r.ZT)(n,t),n.prototype.getServerAuthToken=function(){var n=this;return new Promise((function(e,r){if(void 0!==window.OMWebViewJSInterface&&void 0!==window.OMWebViewJSInterface.getServerAuthToken){var i=t.prototype.updateAndGetAuthTokenCallback.call(n,e,r);window.OMWebViewJSInterface.getServerAuthToken(n.secureUUID,i)}else r("App Interface not found")}))},n}(e(10050).o)},50830:function(t,n,e){"use strict";e.d(n,{_:function(){return i}});var r=e(59312),i=function(t){function n(n){return t.call(this,n)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.sendLinkViaApp=function(t,n){void 0!==window.OMWebViewJSInterface&&void 0!==window.OMWebViewJSInterface.sendLinkViaApp&&window.OMWebViewJSInterface.sendLinkViaApp(this.secureUUID,t,n)},e.exitWebView=function(){void 0!==window.OMWebViewJSInterface&&void 0!==window.OMWebViewJSInterface.exitWebView&&window.OMWebViewJSInterface.exitWebView(this.secureUUID)},e.onPageLoadCompleted=function(){void 0!==window.OMWebViewJSInterface&&void 0!==window.OMWebViewJSInterface.onPageLoadCompleted&&window.OMWebViewJSInterface.onPageLoadCompleted(this.secureUUID)},n}(e(47303).L)},96153:function(t,n,e){"use strict";e.d(n,{h:function(){return i}});var r=e(59312),i=function(t){function n(n){return t.call(this,n)||this}return(0,r.ZT)(n,t),n.prototype.getServerAuthToken=function(){var n=this;return new Promise((function(e,r){var i,o;if(void 0!==window.webkit&&void 0!==window.webkit.messageHandlers.AuthToken){var s=t.prototype.updateAndGetAuthTokenCallback.call(n,e,r);null===(o=null===(i=window.webkit.messageHandlers)||void 0===i?void 0:i.AuthToken)||void 0===o||o.postMessage({UUID:n.secureUUID,callbackId:s})}else r("App Interface not found")}))},n}(e(10050).o)},88033:function(t,n,e){"use strict";e.d(n,{_:function(){return i}});var r=e(59312),i=function(t){function n(n){return t.call(this,n)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.sendLinkViaApp=function(t,n){var e,r;void 0!==window.webkit&&(null===(r=null===(e=window.webkit.messageHandlers)||void 0===e?void 0:e.SendLinkViaApp)||void 0===r||r.postMessage({UUID:this.secureUUID,link:t,app:n}))},e.exitWebView=function(){var t,n;void 0!==window.webkit&&(null===(n=null===(t=window.webkit.messageHandlers)||void 0===t?void 0:t.ExitWebView)||void 0===n||n.postMessage({UUID:this.secureUUID}))},e.onPageLoadCompleted=function(){var t,n;void 0!==window.webkit&&(null===(n=null===(t=window.webkit.messageHandlers)||void 0===t?void 0:t.PageLoadCompleted)||void 0===n||n.postMessage({UUID:this.secureUUID}))},n}(e(47303).L)},32852:function(t,n,e){"use strict";e.d(n,{P:function(){return s}});var r=e(4101),i=e(96153),o=e(67625),s=function(){function t(){}var n=t.prototype;return n.resolvePlatformAndgetInterface=function(t,n){var e=(0,o.L)();return this.getInterface(t,n,e)},n.getInterface=function(t,n,e){switch(n){case"v1_0_0":switch(+e){case o.t.Android:return new r.h(t);case o.t.IOS:return new i.h(t);default:return null}default:return null}},t}()},26202:function(t,n,e){"use strict";e.d(n,{F:function(){return s}});var r=e(50830),i=e(88033),o=e(67625),s=function(){function t(){}var n=t.prototype;return n.resolvePlatformAndgetInterface=function(t,n){var e=(0,o.L)();return this.getInterface(t,n,e)},n.getInterface=function(t,n,e){switch(n){case"v1_0_0":switch(+e){case o.t.Android:return new r._(t);case o.t.IOS:return new i._(t);default:return null}default:return null}},t}()},67625:function(t,n,e){"use strict";var r;function i(){return window.webkit&&window.webkit.messageHandlers.PageLoadCompleted?r.IOS:window.OMWebViewJSInterface&&window.OMWebViewJSInterface.onPageLoadCompleted?r.Android:r.Unknown}e.d(n,{t:function(){return r},L:function(){return i}}),function(t){t[t.Android=0]="Android",t[t.IOS=1]="IOS",t[t.Unknown=2]="Unknown"}(r||(r={}))},21607:function(t,n,e){"use strict";e.d(n,{h6:function(){return f},Ip:function(){return h},Yq:function(){return d},sE:function(){return m},RC:function(){return v},UM:function(){return p},v9:function(){return g}});var r=e(9947),i=e(916),o=e(41480),s=e(84475),u=e(63795),a=e(77209),c=e(64290),l=(e(55890),e(55411));function f(t){var n;return t&&(n="lang="+t),function(t,n,e){return w(t,n,e,void 0)}("GetResourceStrings",n,void 0)}function h(){return f((0,l.Kc)())}function d(t){var n;return t&&"string"==typeof t&&(n=b(t)),w("GetRefreshedAntiForgeryToken",void 0,void 0,n).then((function(t){var n=(0,r.k0)();n.antiForgeryToken=t,(0,r.$Q)(n)}))}function m(){return w("GetUserInfo",void 0,void 0,void 0).then((function(t){var n=(0,r.k0)();n.userInfo=t,(0,r.$Q)(n)}))}function v(t){return w("GetThemes",void 0,JSON.stringify({name:t||""}),void 0)}function p(t){return(0,c.md)((function(){return!0}))?w("GetHeaderThemes",void 0,JSON.stringify({name:t||""}),void 0):Promise.resolve("")}function g(t){return y("/Handlers/PageCommonHandler.ashx?method=GetCombined",void 0,b(t),"GetCombinedInfo").then((function(t){var n,e;if(t){var i=(0,r.k0)();i.ecsConfigSettings=t.ecsConfigSettings,i.flights=t.flight,i.userInfo=t.userInfo,i.environmentType=null!==(n=t.environmentType)&&void 0!==n?n:i.environmentType,i.ring=null!==(e=t.ring)&&void 0!==e?e:i.ring,(0,r.$Q)(i)}}))}function b(t){return{Accept:"application/json",Authorization:(0,a.U)(t)}}function w(t,n,e,r){var i;return i="/"===window.location.pathname?"/Default.aspx/"+t:window.location.pathname+"/"+t,n&&(i+="?"+n),y(i,e,r,(0,u.WU)("PageMethod.{0}",t)).then((function(t){return t.d}))}function y(t,n,e,r){return new Promise((function(u,a){var l=new i.o(r),f=new XMLHttpRequest;f.open("POST",t),(0,c.md)((function(){f.setRequestHeader("formspro","enabled")})),f.setRequestHeader("content-type","application/json; charset=utf-8"),f.setRequestHeader("X-CorrelationId",l.CorrelationId),f.setRequestHeader("X-UserSessionId",(0,o.k)()||""),f.setRequestHeader("x-ms-form-request-source",(0,s.A)()),e&&Object.keys(e).forEach((function(t){f.setRequestHeader(t,e[t])})),l.start(),n?f.send(n):f.send(),f.onreadystatechange=function(){if(f.readyState===XMLHttpRequest.DONE){var n=f.status;200===n||202===n||201===n?(l.end({resultType:"Success",extraData:{status:f.statusText}}),u(f.responseText&&JSON.parse(f.responseText))):(l.end({resultType:"Failure",extraData:{url:t,message:f.statusText}}),a(f.statusText))}}}))}},67640:function(t,n,e){"use strict";e.d(n,{z:function(){return c},c:function(){return l}});var r=e(9947),i=e(55890),o=Date.now(),s={},u={},a=function(){try{var t="FormsVersion"+window.location.pathname,n=window.localStorage.getItem(t),e=(0,r.k0)().version;return n===e||(window.localStorage.setItem(t,e),!1)}catch(t){return!1}}();function c(t,n){var e=Date.now(),r={sa:e-o};return s[t]=r,n.then((function(t){return r.d=Date.now()-e,t})).catch((function(t){throw r.d=Date.now()-e,r.f=1,t}))}function l(){var t=window.NavKeyPoints;(0,i.$U)("Forms.PerformanceAnalysis",{checkPoints:u,requests:s,requestsAll:Date.now()-o,scriptCached:a,scriptDownload:t&&t.PageStartTime&&o-t.PageStartTime,version:1})}},24821:function(t,n,e){"use strict";e.d(n,{f:function(){return r}});var r=function(){function t(t){var n=this;this.prefetchPromise=new Promise((function(t,e){n.prefetchResolve=t,n.prefetchReject=e})),this.cache=t}var n=t.prototype;return n.init=function(){if(this.cache)switch(this.cache.state){case 3:this.onPrefetchSucceed();break;case 4:this.onPrefetchFaied();break;case 2:this.cache.successCallback=this.onPrefetchSucceed.bind(this),this.cache.errorCallback=this.onPrefetchFaied.bind(this);break;default:this.fallBackToNormalBoot()}else this.fallBackToNormalBoot()},n.getPromise=function(){return this.prefetchPromise},t}()},45913:function(t,n,e){"use strict";e.d(n,{j:function(){return o}});var r=e(59312),i=e(41448),o=function(t){function n(){var e=this;return n.instance?n.instance:((e=t.call(this,window.FormPrefetchCache&&window.FormPrefetchCache.userLicenseInfoCache)||this).init(),n.instance=e,e)}(0,r.ZT)(n,t);var e=n.prototype;return n.getInstance=function(){return new n},e.onPrefetchSucceed=function(){try{var t=JSON.parse(this.cache.data);this.prefetchResolve(t)}catch(t){this.fallBackToNormalBoot()}},e.onPrefetchFaied=function(){this.fallBackToNormalBoot()},e.fallBackToNormalBoot=function(){var t=this;i.VY.getInstance().createDataProvider().getUserInfo().then((function(n){return t.prefetchResolve(n)})).catch((function(n){return t.prefetchReject(n)}))},n}(e(24821).f)},22617:function(t,n,e){"use strict";e.d(n,{D:function(){return i}});var r=e(7645);function i(t,n){var e=null!=n?n:(0,r.pm)();switch(t){case"1001":return e.Error_Message_1001;case"10203":return e.Error_Message_10203;case"10204":return e.Error_Message_10204;case"10205":return e.Error_Message_10205;case"10206":return e.Error_Message_10206;case"10207":return e.Error_Message_10207;case"10208":return e.Error_Message_10208;case"10300":return e.Error_Message_10300;case"10301":return e.Error_Message_10301;case"1204":return e.Error_Message_1204;case"15001":return e.Error_Message_15001;case"15003":return e.Error_Message_15003;case"15429":return e.Error_Message_15429;case"1624":return e.Error_Message_1624;case"20000":return e.Error_Message_20000;case"20001":return e.Error_Message_20001;case"5001":return e.Error_Message_5001;case"5002":return e.Error_Message_5002;case"5003":return e.Error_Message_5003;case"5004":return e.Error_Message_5004;case"5005":return e.Error_Message_5005;case"5006":return e.Error_Message_5006;case"5109":return e.Error_Message_5109;case"5114":return e.Error_Message_5114;case"5117":return e.Error_Message_5117;case"5203":return e.Error_Message_5203;case"5204":return e.Error_Message_5204;case"5205":return e.Error_Message_5205;case"5206":return e.Error_Message_5206;case"5207":return e.Error_Message_5207;case"5208":return e.Error_Message_5208;case"5209":return e.Error_Message_5209;case"5302":return e.Error_Message_5302;case"532":return e.Error_Message_532;case"533":return e.Error_Message_533;case"534":return e.Error_Message_534;case"535":return e.Error_Message_535;case"536":return e.Error_Message_536;case"537":return e.Error_Message_537;case"5400":return e.Error_Message_5400;case"5401":return e.Error_Message_5401;case"5402":return e.Error_Message_5402;case"5403":return e.Error_Message_5403;case"5501":return e.Error_Message_5501;case"5503":return e.Error_Message_5503;case"5504":return e.Error_Message_5504;case"5510":return e.Error_Message_5510;case"5550":return e.Error_Message_5550;case"5551":return e.Error_Message_5551;case"5552":return e.Error_Message_5552;case"5553":return e.Error_Message_5553;case"5554":return e.Error_Message_5554;case"5556":return e.Error_Message_5556;case"5557":return e.Error_Message_5557;case"5558":return e.Error_Message_5558;case"5559":return e.Error_Message_5559;case"5560":return e.Error_Message_5560;case"5561":return e.Error_Message_5561;case"600":return e.Error_Message_600;case"601":return e.Error_Message_601;case"602":return e.Error_Message_602;case"603":return e.Error_Message_603;case"604":return e.Error_Message_604;case"605":return e.Error_Message_605;case"606":return e.Error_Message_606;case"607":return e.Error_Message_607;case"608":return e.Error_Message_608;case"609":return e.Error_Message_609;case"610":return e.Error_Message_610;case"6100":return e.Error_Message_6100;case"6102":return e.Error_Message_6102;case"6103":return e.Error_Message_6103;case"6105":return e.Error_Message_6105;case"611":return e.Error_Message_611;case"613":return e.Error_Message_613;case"614":return e.Error_Message_614;case"615":return e.Error_Message_615;case"620":return e.Error_Message_620;case"624":return e.Error_Message_624;case"625":return e.Error_Message_625;case"6252":return e.Error_Message_6252;case"6254":return e.Error_Message_6254;case"636":return e.Error_Message_636;case"642":return e.Error_Message_642;case"645":return e.Error_Message_645;case"649":return e.Error_Message_649;case"650":return e.Error_Message_650;case"651":return e.Error_Message_651;case"652":return e.Error_Message_652;case"653":return e.Error_Message_653;case"654":return e.Error_Message_654;case"655":return e.Error_Message_655;case"656":return e.Error_Message_656;case"657":return e.Error_Message_657;case"658":return e.Error_Message_658;case"659":return e.Error_Message_659;case"660":return e.Error_Message_660;case"6611":return e.Error_Message_6611;case"6612":return e.Error_Message_6612;case"6613":return e.Error_Message_6613;case"6614":return e.Error_Message_6614;case"6624":return e.Error_Message_6624;case"6700":return e.Error_Message_6700;case"6701":return e.Error_Message_6701;case"6702":return e.Error_Message_6702;case"6705":return e.Error_Message_6705;case"674":return e.Error_Message_674;case"676":return e.Error_Message_676;case"700":return e.Error_Message_700;case"701":return e.Error_Message_701;case"702":return e.Error_Message_702;case"703":return e.Error_Message_703;case"704":return e.Error_Message_704;case"705":return e.Error_Message_705;case"707":return e.Error_Message_707;case"709":return e.Error_Message_709;case"710":return e.Error_Message_710;case"711":return e.Error_Message_711;case"712":return e.Error_Message_712;case"714":return e.Error_Message_714;case"715":return e.Error_Message_715;case"717":return e.Error_Message_717;case"751":return e.Error_Message_751;case"752":return e.Error_Message_752;case"754":return e.Error_Message_754;case"755":return e.Error_Message_755;case"756":return e.Error_Message_756;case"812":return e.Error_Message_812;case"824":return e.Error_Message_824;default:return""}}},31581:function(t,n,e){"use strict";e.d(n,{x:function(){return i}});var r=e(7645);function i(t,n){var e=null!=n?n:(0,r.pm)();switch(t){case"Between":return e.NumberValidation_ErrorMessage_Between;case"Equal":return e.NumberValidation_ErrorMessage_Equal;case"Greater":return e.NumberValidation_ErrorMessage_Greater;case"GreaterOrEqual":return e.NumberValidation_ErrorMessage_GreaterOrEqual;case"Less":return e.NumberValidation_ErrorMessage_Less;case"LessOrEqual":return e.NumberValidation_ErrorMessage_LessOrEqual;case"None":return e.NumberValidation_ErrorMessage_None;case"NotBetween":return e.NumberValidation_ErrorMessage_NotBetween;case"NotEqual":return e.NumberValidation_ErrorMessage_NotEqual;default:return""}}},7645:function(t,n,e){"use strict";e.d(n,{pm:function(){return h},ay:function(){return m}});var r,i,o,s=e(66676),u=e(43209),a=e(72377),c=e(97058),l=e(55411),f=e(21607);function h(){return o}function d(t){o=(0,c.Y)(t)}function m(){return r||(r=new Promise((function(t,n){o?t(o):i?i.then((function(n){i=null,d(n),t(n)})):p().then((function(n){d(n),t(n)})).catch(n)}))),r}function v(t){return(t?(0,f.h6)(t):(0,f.Ip)()).then(c.Y)}function p(t){return(0,u.aK)()||(0,l.y)()?v(t):Promise.resolve().then((function(){t=t||(0,s.Kd)().toLowerCase();var n=a.Pv.Resolve("ILazyLoadResourceStringsFunc");return n(t).catch((function(){var e=null==t?void 0:t.split("-")[0];return t!==e?n(e).catch((function(){return n(void 0)})):n(void 0)}))})).catch((function(){return v(t)}))}},41317:function(t,n,e){"use strict";e.d(n,{FP:function(){return c},kC:function(){return l},BM:function(){return h},lx:function(){return d}});var r,i,o=e(59312),s=e(78587),u=e(21607),a=e(43367),c="Customized Theme",l="Default Theme";function f(t){return r||(r=(0,u.RC)(t||(0,a.EW)().Name).then(JSON.parse)),r}function h(t){return(0,o.mG)(this,void 0,Promise,(function(){return(0,o.Jh)(this,(function(n){switch(n.label){case 0:return[4,(i||(i=(0,a.v5)()),i)];case 1:return[2,m(n.sent()[t])||(0,a.EW)()]}}))}))}function d(t){return(0,o.mG)(this,void 0,Promise,(function(){return(0,o.Jh)(this,(function(n){switch(n.label){case 0:return[4,f(t)];case 1:return[2,m(n.sent()[t])||(0,a.EW)()]}}))}))}function m(t){if(!t)return t;var n=(0,o.pi)({},t),e=t.BackgroundImage,r=t.Thumbnail;return null!=e&&(/^\/Images\//i.test(e)||/^\/formsresources\//i.test(e))&&(n.BackgroundImage=(0,s.Jn)(e)),null!=r&&(/^\/Images\//i.test(r)||/^\/formsresources\//i.test(r))&&(n.Thumbnail=(0,s.Jn)(r)),n}},89404:function(t,n,e){"use strict";function r(t){var n=function(t){if(!t)return null;var n=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t),e=4;if(!n||n.length<e)return null;return{header:n[1],JWSPayload:n[2],JWSSig:n[3]}}(t);if(!n)return null;try{var e=function(t){return t=t.replace(/-/g,"+").replace(/_/g,"/"),decodeURIComponent(encodeURI(window.atob(t)))}(n.JWSPayload);return e?JSON.parse(e):null}catch(t){}return null}e.d(n,{e:function(){return r}})},62132:function(t,n,e){"use strict";e.d(n,{E:function(){return u},j:function(){return a}});var r,i=e(36215),o=e(41350),s=e(46008);function u(){return r||(r=new a)}var a=function(){function t(){this.kt=new o.Y,this.xt={}}var n=t.prototype;return t.isValidUser=function(t){return!!(t&&t.userId&&t.displayName)},n.registerUsersStateChange=function(t){this.kt.register(t)},n.unregisterUsersStateChange=function(t){this.kt.unregister(t)},n.getUser=function(t){return i.clone(this.xt[t])},n.getAllUsers=function(){return i.values((0,s.I8)(this.xt))},n.getUserCount=function(){return i.keys(this.xt).length},n.addOrUpdateUser=function(n){if(t.isValidUser(n)){var e=this.xt[n.userId];if(null!=e){if(t.isValidUser(e))return;i.extend(e,n)}else this.xt[n.userId]=n;this.kt.trigger()}},n.removeUser=function(t){delete this.xt[t.userId]&&this.kt.trigger()},n.removeAllUsers=function(){this.getUserCount()>0&&(this.xt={},this.kt.trigger())},t}()},83830:function(t,n,e){"use strict";e.d(n,{v:function(){return c}});var r=e(33967),i=e(64290),o=e(55411),s=e(70699),u="https://forms.microsoft.com/",a="https://forms.office.com/";function c(){var t;if(!(0,r.Zr)())return"CVDaily"===(0,r.kD)()?"https://customervoice.microsoft-int.com/":"https://forms.office-int.com/";switch((0,r.kD)()){case"USNat":t="https://forms.osi.eaglex.ic.gov/";break;case"USSec":t="https://forms.osi.microsoft.scloud/";break;case"USDoDProd":t="https://forms.osi.apps.mil/";break;case"USGovProd":t="https://forms.osi.office365.us/";break;case"USGovGccProd":t=(0,r.H5)()?u:(0,o.Pq)()?"https://customervoice.microsoft.us/":a;break;case"WWProd":t=(0,i.pd)((function(){return a}),(function(){var t=(0,s.Bh)();return"/"!==t[t.length-1]&&(t+="/"),t}));break;case"MSProd":t=u;break;case"ProTip":t="https://tip.forms.office.com/";break;case"CVProd":t="https://customervoice.microsoft.com/";break;case"CVTip":t="https://tip.customervoice.microsoft.com/";break;case"CVFastfood":t="https://msit2.customervoice.microsoft.com/";break;default:t="https://"+window.location.host+"/"}return t}},43367:function(t,n,e){"use strict";e.d(n,{gi:function(){return i},rG:function(){return o},ue:function(){return s},v5:function(){return u},EW:function(){return a},_w:function(){return c},u1:function(){return l},wp:function(){return f},aK:function(){return h},Pv:function(){return d},$V:function(){return m}});var r=e(72377);function i(t){return v().addSurveyFontToSchemas(t)}function o(t,n){return v().getModifiedTextField(t,n)}function s(t){return v().getFooterElement(t)}function u(){return v().getLazyLoadThemes()}function a(){return v().getDefaultTheme()}function c(t){return v().getThemeBackground(t)}function l(t){return v().getThemeStyle(t)}function f(){return v().getErrorPage()}function h(t,n,e,r,i,o){return v().callUpdatePR(t,n,e,r,i,o)}function d(t){return v().getQuestionDelegatorClass(t)}function m(t){return v().getQuestionRendererFooter(t)}function v(){return r.Pv.Resolve("ICustomerVoiceUxFactory")}},37632:function(t,n,e){"use strict";e.d(n,{kL:function(){return i}});var r=e(72377);function i(t){return o().getCVAppliedBranchingIcon(t)}function o(){return r.Pv.Resolve("ICustomerVoiceBranchingFactory")}},65861:function(t,n,e){"use strict";e.d(n,{e:function(){return o}});var r=e(37790),i=e(7645);function o(t){var n=(0,i.pm)();return(0,r.e)(t,n)}},925:function(t,n,e){"use strict";e.d(n,{U8:function(){return c},Wr:function(){return l},jI:function(){return f}});var r=e(81380),i=e(33967),o=e(94290),s=e(54496),u=e(24209),a=e(46008);function c(t){var n="RedirectToExcelPage.aspx?id="+encodeURIComponent(t)+"&forceReExport=false";(0,u.K)(n)}function l(t){if((0,o.Kw)()){(0,r.o7)(t).getOrNewExcelInOneDrive(t,!0).then((function(t){window.postMessage("formreexportsuccess",(0,a.Zh)())}))}else{var n="RedirectToExcelPage.aspx?id="+encodeURIComponent(t)+"&forceReExport=true";(0,s.rG)(n)}}function f(t,n){if(t&&!n&&!(0,i.j4)())return"WaitingForExport"}},62662:function(t,n,e){"use strict";e.d(n,{Au:function(){return o},Es:function(){return s},dY:function(){return u},Fd:function(){return a},LG:function(){return c},ft:function(){return l},Av:function(){return f}});var r=e(33967),i=e(21902);function o(){return(0,i.Z)("debug")}function s(){return(0,i.Z)("d")}function u(){return(0,i.Z)("oembedssotrial")&&(0,r.yv)()||(0,i.Z)("oembedsso")||(0,i.Z)("powerappembed")}function a(){return s()&&!(0,r.yv)()}function c(){return!!(0,i.Z)("pptcontentsso")}function l(){return(0,i.Z)("pptintegration")}function f(){return(0,i.Z)("streamsso")}},21902:function(t,n,e){"use strict";e.d(n,{Z:function(){return i}});var r=e(90710);function i(t,n){void 0===n&&(n=!1);var e=(0,r.NW)()[t];return""===e||(e?(Array.isArray(e)&&(e=e[0]),n?"false"!==e.toLowerCase():"true"===e.toLowerCase()):n)}},37076:function(t,n,e){"use strict";e.d(n,{kc:function(){return o}});var r=16,i="$%@#";function o(t){var n=function(t){try{t=t.replace(/_/g,"/").replace(/-/g,"+");var n=(h=t,window.atob(h.replace(/ /g,"")).split("").map((function(t){return t.charCodeAt(0)}))),e=s(n.slice(0,r)),o=s(n.slice(r,32)),u=function(t,n){if(null==t||0===t.length)return t;var e=t.length;for(;--e>=0&&!(n.indexOf(t.charAt(e))<0););return t.substr(0,e+1)}(function(t){for(var n="",e=0;e<t.length;++e)n+=String.fromCharCode(t[e]);return n}(n.slice(32)),"."),a={},c=u.split(i);if(c.length>1){u=c[0];for(var l=1;l<c.length;l++){var f=c[l].split("=");f&&2===f.length&&(a[f[0]]=f[1])}}return{OrgId:e,OwnerId:o,TableId:u,MoreInfo:a}}catch(t){return{OrgId:null,OwnerId:null,TableId:null,MoreInfo:null}}var h}(t),e=!1,o="0";return n.MoreInfo&&("g"===n.MoreInfo.t&&(e=!0),n.MoreInfo.c&&(o=n.MoreInfo.c)),{OrgId:n.OrgId,OwnerId:n.OwnerId,TableId:n.TableId,IsGroupOwner:e,ContainerId:o}}function s(t){if(16!==t.length)return null;var n=function(t){for(var n="",e="",r=0;r<t.length;r++)n+=e=1===(e=t[r].toString(16)).length?"0"+e:e;return n}([].concat(t.slice(0,4).reverse(),t.slice(4,6).reverse(),t.slice(6,8).reverse(),t.slice(8)));return n=n.slice(0,8)+"-"+n.slice(8,12)+"-"+n.slice(12,16)+"-"+n.slice(16,20)+"-"+n.slice(20)}},42735:function(t,n,e){"use strict";e.d(n,{pw:function(){return u},Tq:function(){return c},df:function(){return l},e1:function(){return f}});var r=e(64541),i=e(7645),o=e(89404),s=e(46008);function u(t){return(0,o.e)(function(t){return t&&t.split(" ")[1]}(t)).exp<=Date.now()/1e3}function a(t,n){return t=(0,r.gA)(t),n?t?$("<div/>").html(t).text():"":t}function c(t){if((0,s.le)(t)||""===t.trim())return t;var n=t.replace(/&&/g,"__BR_AND_PAR__").replace(/\|\|/g,"__BR_OR_PAR__");return n=n.replace(/\(/g,"__BR_L_PAR__").replace(/\)/g,"__BR_R_PAR__")}function l(t){if((0,s.le)(t)||""===t.trim())return t;var n=t.replace(/__BR_L_PAR__/g,"(").replace(/__BR_R_PAR__/g,")");return n=n.replace(/__BR_AND_PAR__/g,"&&").replace(/__BR_OR_PAR__/g,"||")}function f(t){return t&&t.split("href")[0].indexOf('target="_blank"')>-1&&(t=t.replace('target="_blank"',' target="_blank" tabindex="0" aria-label="'+function(t){if(t){var n=a(t,!0);return(n.indexOf("http")>-1?(0,i.pm)().Response_Page_Footer_Open_In_New_Tab_Text.format(n):(0,i.pm)().Response_Page_Footer_Open_In_New_Tab_Text_Terms_Privacy.format(n)).replace(/("|')/g,"")}return null}(t)+'"')),t}FormsPro.getTextFromHtml=a,FormsPro.encodeBranchingString=c,FormsPro.decodeBranchingString=l},48789:function(t,n,e){"use strict";function r(t){for(var n={},e=0,r=t.getAllResponseHeaders().split(/\r?\n/);e<r.length;e++){var i=r[e];if(i){var o=i.indexOf(": "),s=i.substring(0,o),u=i.substring(o+2);n[s]=u}}return n}e.d(n,{D:function(){return r}})},24209:function(t,n,e){"use strict";e.d(n,{K:function(){return i}});var r=e(94290);function i(t,n,e,i){return function(t,n,e,r,i){if(i){var o=document.createElement("a");return o.href=t,o.target=n||"_blank",document.body.appendChild(o),o.click(),document.body.removeChild(o),null}return n||e||r?e||r?r?window.open(t,n,e,r):window.open(t,n,e):window.open(t,n):window.open(t)}(t,n,e,i,(0,r.Kw)())}},28087:function(t,n,e){"use strict";e.d(n,{WN:function(){return i},Lp:function(){return o}});var r=function(t){var n=document.createElement("a");return n.href=t,n};function i(t){return r(t).href}function o(t){return r(t).hostname}},54496:function(t,n,e){"use strict";e.d(n,{n1:function(){return s},p2:function(){return u},IB:function(){return a},rG:function(){return c},Nw:function(){return l},bq:function(){return f}});var r=e(262),i=e(88744),o=e(2775);function s(t,n,e,r,i){r=r||0,e=e||0;var o=n.height(),s=t.outerHeight();if(t.offset()&&n.offset()){var u=t.offset().top-n.offset().top;if(u<0)n.scrollTop(n.scrollTop()+u-(s+e>o?0:e));else{var a=Math.min(s,o),c=u+a-o;s+e+r<o?c=u+(a=s+r)-o:s+e<o&&(a=s+e,c=u-e),c>0&&(i?n.animate({scrollTop:n.scrollTop()+c},"fast"):n.scrollTop(n.scrollTop()+c))}}}function u(t,n){var e=(0,o.l7)({},t);for(var s in n)switch(s){case"className":case"aria-labelledby":case"aria-describedby":e[s]=(0,r.j)(e[s],n[s]);break;case"children":case"defaultValue":case"value":n.hasOwnProperty(s)&&(null!=e[s]?e[s]=[].concat(e[s],n[s]):e[s]=n[s]);break;case"style":null!=e[s]?(0,o.l7)(e[s],n[s]):e[s]=n[s];break;case"onCopy":case"onCut":case"onPaste":case"onCompositionEnd":case"onCompositionStart":case"onCompositionUpdate":case"onFocus":case"onBlur":case"onChange":case"onInput":case"onSubmit":case"onLoad":case"onError":case"onKeyDown":case"onKeyPress":case"onKeyUp":case"onAbort":case"onCanPlay":case"onCanPlayThrough":case"onDurationChange":case"onEmptied":case"onEncrypted":case"onEnded":case"onLoadedData":case"onLoadedMetadata":case"onLoadStart":case"onPause":case"onPlay":case"onPlaying":case"onProgress":case"onRateChange":case"onSeeked":case"onSeeking":case"onStalled":case"onSuspend":case"onTimeUpdate":case"onVolumeChange":case"onWaiting":case"onClick":case"onContextMenu":case"onDoubleClick":case"onDrag":case"onDragEnd":case"onDragEnter":case"onDragExit":case"onDragLeave":case"onDragOver":case"onDragStart":case"onDrop":case"onMouseDown":case"onMouseEnter":case"onMouseLeave":case"onMouseMove":case"onMouseOut":case"onMouseOver":case"onMouseUp":case"onSelect":case"onTouchCancel":case"onTouchEnd":case"onTouchMove":case"onTouchStart":case"onScroll":case"onWheel":e[s]=(0,i.F)(e[s],n[s]);break;default:void 0!==n[s]&&(e[s]=n[s])}return e}function a(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return function(e){(0===n.length||n.indexOf(e.keyCode)>=0)&&t(e)}}function c(t){var n="hiddeon-open-iframe",e=document.getElementById(n);e&&e.parentNode.removeChild(e),(e=document.createElement("iframe")).id=n,e.name=n,e.hidden=!0,document.body.appendChild(e),e.contentWindow.location.href=t}function l(t){return f(function(t){var n=["b"],e=n.map((function(t){return"<"+t+">"})),r=n.map((function(t){return"</"+t+">"})),i=n.map((function(t){return"&lt;"+t+"&gt;"})),s=n.map((function(t){return"&lt;/"+t+"&gt;"})),u=(0,o.YU)(t);return n.forEach((function(t,n){u=u.replaceAll(i[n],e[n]).replaceAll(s[n],r[n])})),u}(t))}function f(t){var n=document.createElement("span");return n.innerHTML=t,n.innerHTML}},93592:function(t,n,e){"use strict";e.d(n,{gB:function(){return u},sl:function(){return a},iv:function(){return c},mj:function(){return f},Mh:function(){return h},Gh:function(){return d}});var r=e(43209),i=e(9947),o=e(87260),s=e(81620);function u(t){return m().then((function(){window.location.assign(t)}))}function a(){return l(!1)}function c(){return l(!0)}function l(t){return m().then((function(){window.location.reload(t)}))}function f(t){return m().then((function(){window.location.replace(t)}))}function h(t){return m().then((function(){var n=window.location,e=n.origin+t+n.search+n.hash;window.location.replace(e)}))}function d(){var t=(0,i.k0)(),n=t.userInfo,e=(t.serverSessionId,t.signInLink),o=t.signInLinkMsa,u=window.location.href,a=encodeURIComponent(u),c=n.IsMsa,l="Response"===(0,r.C2)(),f=e;return!c||l?f=-1!==f.indexOf("/oidcLogin")?(0,s.y)(f,"ru",a):(0,s.y)(f,"state",a):(f=o,f=(0,s.y)(f,"redirecturl",a)),f}function m(){return(0,o.I)()}},72821:function(t,n,e){"use strict";e.d(n,{bR:function(){return S},jD:function(){return C},ID:function(){return F},VE:function(){return N},Ak:function(){return T},xY:function(){return k},DP:function(){return x},mR:function(){return P},qM:function(){return D}});var r,i,o,s,u,a,c,l,f,h,d,m,v,p,g,b,w,y=e(83894),I=e(2775);function S(){return h}function C(){return d}function F(){return v}function N(){return p}function T(){return g}function k(){return b}function x(){return w}function P(t,n){var e=(0,I.Ry)(t.map((function(t){var n=t.licenseName,e=t.skus;return[n.toUpperCase(),JSON.parse(e)]})));return function(t){for(var n in r)if(t.hasOwnProperty(r[n])){var e=t[r[n]];if(e&&e.length>0)return void(h=!0)}h=!1}(e),function(t){for(var n in i)if(t.hasOwnProperty(i[n])){var e=t[i[n]];if(e&&e.length>0)return d=!0,void parseInt(n)}d=!1}(e),function(t){for(var n in o)if(t.hasOwnProperty(o[n])&&(e=t[o[n]])&&e.length>0){v=!0,parseInt(n);break}for(var n in s)if(t.hasOwnProperty(s[n])&&(e=t[s[n]])&&e.length>0){parseInt(n);break}for(var n in u){var e;if(t.hasOwnProperty(u[n])&&(e=t[u[n]])&&e.length>0){parseInt(n);break}}}(e),function(t){m=!(!(0,y.ro)()||!t)}(n),function(t){for(var n in a)if(t.hasOwnProperty(a[n])){var e=t[a[n]];if(e&&e.length>0)return void(p=!0)}p=!1}(e),function(t){for(var n in c)t.hasOwnProperty(c[n])&&(e=t[c[n]])&&e.length>0&&(g=!0);for(var n in l)t.hasOwnProperty(l[n])&&(e=t[l[n]])&&e.length>0&&(w=!0);for(var n in f){var e;t.hasOwnProperty(f[n])&&(e=t[f[n]])&&e.length>0&&(b=!0)}}(e),e}function D(){var t=0;return S()&&(t=1),C()&&(t|=2),(0,y.Wh)()&&(t|=8),(0,y.ro)()&&(t|=m?16:4),N()&&(t|=64,T()?t|=128:x()?t|=256:k()&&(t|=512)),t}!function(t){t[t.OFFICE_FORMS_PLAN_2=0]="OFFICE_FORMS_PLAN_2",t[t.OFFICE_FORMS_PLAN_3=1]="OFFICE_FORMS_PLAN_3"}(r||(r={})),function(t){t[t.FORMS_PLAN_E1=0]="FORMS_PLAN_E1",t[t.FORMS_PLAN_E3=1]="FORMS_PLAN_E3",t[t.FORMS_PLAN_E5=2]="FORMS_PLAN_E5",t[t.FORMS_PLAN_K=3]="FORMS_PLAN_K"}(i||(i={})),function(t){t[t.FORMS_GOV_E1=0]="FORMS_GOV_E1",t[t.FORMS_GOV_E3=1]="FORMS_GOV_E3",t[t.FORMS_GOV_E5=2]="FORMS_GOV_E5",t[t.FORMS_GOV_F1=3]="FORMS_GOV_F1"}(o||(o={})),function(t){t[t.FORMS_GCCHIGH_E1=0]="FORMS_GCCHIGH_E1",t[t.FORMS_GCCHIGH_E3=1]="FORMS_GCCHIGH_E3",t[t.FORMS_GCCHIGH_E5=2]="FORMS_GCCHIGH_E5",t[t.FORMS_GCCHIGH_F1=3]="FORMS_GCCHIGH_F1"}(s||(s={})),function(t){t[t.FORMS_DOD_E1=0]="FORMS_DOD_E1",t[t.FORMS_DOD_E3=1]="FORMS_DOD_E3",t[t.FORMS_DOD_E5=2]="FORMS_DOD_E5",t[t.FORMS_DOD_F1=3]="FORMS_DOD_F1"}(u||(u={})),function(t){t[t.FORMS_PRO=0]="FORMS_PRO",t[t.FORMS_PRO_USL=1]="FORMS_PRO_USL",t[t.FORMS_PRO_USL_GCC=2]="FORMS_PRO_USL_GCC",t[t.FORMS_PRO_CE=3]="FORMS_PRO_CE",t[t.FORMS_PRO_SERVICE=4]="FORMS_PRO_SERVICE",t[t.FORMS_PRO_FS=5]="FORMS_PRO_FS",t[t.FORMS_PRO_MARKETING=6]="FORMS_PRO_MARKETING",t[t.FORMS_PRO_PLAN=7]="FORMS_PRO_PLAN",t[t.FORMS_PRO_PS=8]="FORMS_PRO_PS",t[t.FORMS_PRO_SALESENT=9]="FORMS_PRO_SALESENT",t[t.FORMS_PRO_TALENT=10]="FORMS_PRO_TALENT",t[t.FORMS_PRO_OPERATIONS=11]="FORMS_PRO_OPERATIONS",t[t.FORMS_PRO_RELATIONSHIP_SALES=12]="FORMS_PRO_RELATIONSHIP_SALES",t[t.FORMS_PRO_CUSTOMER_INSIGHTS=13]="FORMS_PRO_CUSTOMER_INSIGHTS",t[t.FORMS_PRO_SERVICE_GCC=14]="FORMS_PRO_SERVICE_GCC",t[t.FORMS_PRO_FS_GCC=15]="FORMS_PRO_FS_GCC",t[t.FORMS_PRO_HUMAN_RESOURCES_GCC=16]="FORMS_PRO_HUMAN_RESOURCES_GCC",t[t.FORMS_PRO_PS_GCC=17]="FORMS_PRO_PS_GCC",t[t.FORMS_PRO_SALESENT_GCC=18]="FORMS_PRO_SALESENT_GCC",t[t.FORMS_PRO_CE_GCC=19]="FORMS_PRO_CE_GCC"}(a||(a={})),function(t){t[t.FORMS_PRO_USL=0]="FORMS_PRO_USL",t[t.FORMS_PRO_USL_GCC=1]="FORMS_PRO_USL_GCC"}(c||(c={})),function(t){t[t.FORMS_PRO_CE=0]="FORMS_PRO_CE",t[t.FORMS_PRO_SERVICE=1]="FORMS_PRO_SERVICE",t[t.FORMS_PRO_FS=2]="FORMS_PRO_FS",t[t.FORMS_PRO_MARKETING=3]="FORMS_PRO_MARKETING",t[t.FORMS_PRO_PLAN=4]="FORMS_PRO_PLAN",t[t.FORMS_PRO_PS=5]="FORMS_PRO_PS",t[t.FORMS_PRO_SALESENT=6]="FORMS_PRO_SALESENT",t[t.FORMS_PRO_TALENT=7]="FORMS_PRO_TALENT",t[t.FORMS_PRO_OPERATIONS=8]="FORMS_PRO_OPERATIONS",t[t.FORMS_PRO_RELATIONSHIP_SALES=9]="FORMS_PRO_RELATIONSHIP_SALES",t[t.FORMS_PRO_CUSTOMER_INSIGHTS=10]="FORMS_PRO_CUSTOMER_INSIGHTS",t[t.FORMS_PRO_SERVICE_GCC=11]="FORMS_PRO_SERVICE_GCC",t[t.FORMS_PRO_FS_GCC=12]="FORMS_PRO_FS_GCC",t[t.FORMS_PRO_HUMAN_RESOURCES_GCC=13]="FORMS_PRO_HUMAN_RESOURCES_GCC",t[t.FORMS_PRO_PS_GCC=14]="FORMS_PRO_PS_GCC",t[t.FORMS_PRO_SALESENT_GCC=15]="FORMS_PRO_SALESENT_GCC",t[t.FORMS_PRO_CE_GCC=16]="FORMS_PRO_CE_GCC"}(l||(l={})),function(t){t[t.FORMS_PRO=0]="FORMS_PRO"}(f||(f={}))},33447:function(t,n,e){"use strict";e.d(n,{J:function(){return r}});var r="⁣"},72467:function(t,n,e){"use strict";e.d(n,{Ed:function(){return i},Cu:function(){return o},zE:function(){return s},AX:function(){return u},mp:function(){return a},BF:function(){return c},f5:function(){return l},uq:function(){return f},AJ:function(){return h}});var r=e(72377);function i(){return r.Pv.Resolve("IMixin").getMixinFormMaster()}function o(){return r.Pv.Resolve("IMixin").getMixinImageInfoMaster()}function s(){return r.Pv.Resolve("IMixin").getMixinQuestionMaster()}function u(){return r.Pv.Resolve("IFormApiMixin").getMixinFormApi()}function a(){return r.Pv.Resolve("IMixin").getMixinFormElementManager()}function c(){return r.Pv.Resolve("IMixin").getMixinImageSettingsMaster()}function l(){return r.Pv.Resolve("IMixin").getMixinDesignPageUxStateMaster().getInstance()}function f(){return r.Pv.Resolve("IMixin").getMobileDesignPageUxStateMaster().getInstance()}function h(){return r.Pv.Resolve("IMixin").getFileUploadConfirmDialog()}},41376:function(t,n,e){"use strict";e.d(n,{DO:function(){return s}});var r,i=e(55890),o=e(47835);function s(){try{(0,o.Km)().exitWebView()}catch(t){(0,i.zU)("Union.exitWebViewFailed",{errorInfo:t.message})}}!function(t){t[t.Mail=0]="Mail",t[t.Teams=1]="Teams"}(r||(r={}))},13886:function(t,n,e){"use strict";function r(t){var n=(t||"").trim().replace(/[,]/g,"");return $.isNumeric(n)}function i(t){var n=(t||"").trim().replace(/[,]/g,"");return $.isNumeric(n)?parseFloat(n).toString():""}e.d(n,{ZR:function(){return r},Q5:function(){return i}})},77494:function(t,n,e){"use strict";e.d(n,{C_:function(){return s},Tl:function(){return u},b6:function(){return a},x4:function(){return l},Hr:function(){return f}});var r=e(9947),i=e(81620),o=e(90710);function s(){if((0,r.k0)().isOembedSPO||(0,o.NW)().oembedocv){var t,n=(0,i.Uy)(".office-form.office-form-theme-shadow"),e=(0,i.Uy)(".office-form-footer-container");if((0,o.NW)().oembedocv)(t=(n||0)+(e||0)+12)>0&&c("ResponsePage",t);else if(n&&e)c("ResponsePage",t=n+e+80+(0,i.Uy)(".office-form-new-bottom-bar"))}}function u(){if((0,r.k0)().isOembedSPO&&$(".analysis-page-content").height()){c("AnalysisPage",$(".analysis-page-content").height()+50)}}function a(t){(0,r.k0)().isOembedSPO&&c("ResponsePage",t)}function c(t,n){var e=(0,o.NW)().hostId;if(e)parent.postMessage("FormsPageHeight:"+e+":"+n.toString(),"*");else{var r=(0,o.NW)().id;parent.postMessage(t+"Height:"+r+":"+n.toString(),"*")}}function l(t){(0,r.k0)().isOembedSPO&&function(t,n){if(!(0,r.k0)().isOembedSPO)return;var e=(0,o.NW)().hostId;parent.postMessage("FormsInfo:"+e+":"+encodeURIComponent(t)+":"+encodeURIComponent(n),"*")}(t.Model.Title?t.Model.Title:"",t.Model.Description?t.Model.Description:"")}function f(t){if((0,r.k0)().isOembedSPO){var n=t&&(t.innerCode||t.message||""),e=(0,o.NW)().hostId;parent.postMessage("FormsError:"+e+":"+encodeURIComponent(n),"*")}}var h=window.onerror;window.onerror=function(t,n,e,r,i){f(i),h&&h.apply(this,arguments)}},25664:function(t,n,e){"use strict";e.d(n,{kf:function(){return a},bx:function(){return c},A8:function(){return l},VK:function(){return f}});var r=e(94290),i=e(55411),o=e(10836),s=e(93592),u=e(34570);function a(t){return new Promise((function(n){var e=window.location.pathname,r=e.toLowerCase().startsWith(u.t.toLowerCase())||(0,i.y)();return!t!=!r?(e=t?u.t+e:e.substring(u.t.length),void(0,s.Mh)(e)):n()}))}function c(){return new Promise((function(t){if(!(0,o.cr)("ProRedirectInWeb"))return t();var n=location.href.indexOf("experienceType=");if(n>=0){var e=l(location.search,"experienceType"),r=window.location.pathname,i=r.toLowerCase().startsWith(u.t.toLowerCase()),a=location.href.substring(n).toLowerCase().indexOf("pro")>=0;i&&a||!i&&!a?window.history.replaceState(null,null,r+e):(r=a?u.t+r:r.substring(u.t.length),(0,s.mj)(location.origin+r+e))}}))}function l(t,n){var e=window.location.search.substring(1);return e&&(e=e.split("&").filter((function(t){return!t.startsWith(n+"=")})).join("&")),e?"?"+e:""}function f(){if((0,r.uV)())return{name:"type",operator:"ne",value:"'survey'"}}},34570:function(t,n,e){"use strict";e.d(n,{t:function(){return r}});var r="/FormsPro"},70699:function(t,n,e){"use strict";e.d(n,{sy:function(){return i},Bh:function(){return o},cj:function(){return s},yX:function(){return u},QZ:function(){return a},zN:function(){return c},ru:function(){return l},d9:function(){return f},aE:function(){return h},R0:function(){return d},ib:function(){return m},J8:function(){return v},FW:function(){return p},nL:function(){return g},bL:function(){return b},_G:function(){return w},KG:function(){return y},qb:function(){return I},NA:function(){return S}});var r=e(39455);function i(){return r.Z.getSetting(r.G.FormsProGeo)}function o(){return r.Z.getSetting(r.G.FormsHomeUrl)}function s(){return r.Z.getSetting(r.G.ApiFacadeEndPoint)}function u(){return r.Z.getSetting(r.G.ProjectUIServiceEndpoint)}function a(){return r.Z.getSetting(r.G.ProjectAlertServiceEndPoint)}function c(){return r.Z.getSetting(r.G.CustomerVoiceProjectShareServiceEndpoint)}function l(){return r.Z.getSetting(r.G.CustomerVoiceSurveyUIServiceEndpoint)}function f(){return r.Z.getSetting(r.G.FormsProSampleFormTenantId)}function h(){return r.Z.getSetting(r.G.FormsProCdnHomeUrl)}function d(){return r.Z.getSetting(r.G.FormsProLicensingServiceEndPoint)}function m(){return r.Z.getSetting(r.G.OrchestrationServiceEndpoint)}function v(){return r.Z.getSetting(r.G.SatisfactionMetricTrendAndAggregateDataUrl)}function p(){return r.Z.getSetting(r.G.ExportCsvServiceEndpoint)}function g(){return r.Z.getSetting(r.G.CVPauseResumeService)}function b(){return r.Z.getSetting(r.G.ShareV2StatusFetchDuration)}function w(){return r.Z.getSetting(r.G.CVSurveyCountApproachingLimitFirstStage)}function y(){return r.Z.getSetting(r.G.CVSurveyCountApproachingLimitSecondStage)}function I(){return r.Z.getSetting(r.G.CVSurveyCountExceedLimit)}function S(){return r.Z.getSetting(r.G.CVGetFormLimit)}},41350:function(t,n,e){"use strict";e.d(n,{Y:function(){return i}});var r=e(36215),i=function(){function t(){this.Pt=[]}var n=t.prototype;return n.register=function(t){this.Pt.push(t)},n.unregister=function(t){this.Pt=r.without(this.Pt,t)},Object.defineProperty(n,"trigger",{get:function(){return this.Et},enumerable:!1,configurable:!0}),n.clear=function(){this.Pt=[]},n.Et=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.Pt.forEach((function(n){return n.apply(void 0,t)}))},t}()},47835:function(t,n,e){"use strict";e.d(n,{l4:function(){return d},v3:function(){return m},Km:function(){return g}});var r,i=e(94290),o=e(29559),s=e(916),u=e(55890),a=e(7614),c=e(32852),l=e(26202),f=e(67625),h=e(90710);function d(t){return void 0===t&&(t=!1),new Promise((function(n,e){var r,i=function(){var t=v(),n=p(),e=null;e=t===f.t.Unknown?(new c.P).resolvePlatformAndgetInterface(window.UnionUuid,n):(new c.P).getInterface(window.UnionUuid,n,t);e||(0,u.zU)("createGetTokenInterface",{errorInfo:b()});return e}(),o=new s.o("Union.GetToken");if(o.start(),!i)return w(o,r="the nativeInterface is null"),void e(r);i.getServerAuthToken().then((function(i){if(i){if(o.end({resultType:"Success"}),t)return void n(i);(0,a.r)(i).then((function(){return n(i)}))}else w(o,r="the token is null or empty"),e(r)}),(function(t){o.end({resultType:"ExpectedFailure"}),e({innerCode:10302,innerMessage:t,type:"ExpectedFailure"})}))}))}function m(){return new Promise((function(t,n){try{t(g().onPageLoadCompleted())}catch(t){(0,u.zU)("Union.onPageLoadCompletedFailed",{errorInfo:t.message}),n(t)}}))}function v(){var t=(0,h.NW)()[i.hj],n=f.t.Unknown;if(t)switch(t){case"Android":n=f.t.Android;break;case"IOS":n=f.t.IOS}else n=(0,f.L)();return n===f.t.Unknown&&(n=(0,o.Dt)()?f.t.Android:(0,o.gn)()?f.t.IOS:f.t.Unknown),n}function p(){var t=(0,h.NW)()[i._y];return t||"v1_0_0"}function g(){var t=v(),n=p(),e=null;return(e=t===f.t.Unknown?(new l.F).resolvePlatformAndgetInterface(window.UnionUuid,n):(new l.F).getInterface(window.UnionUuid,n,t))||(0,u.zU)("createNativeInterface",{errorInfo:b()}),e}function b(){var t=v(),n=p(),e=(0,h.NW)(),r=window.location.hash?(0,h.NW)(window.location.hash):null;return"platform:"+t+";version:"+n+";platformInUrl:"+(null==e?void 0:e[i.hj])+";versionInUrl:"+(null==e?void 0:e[i._y])+";id:"+(null==e?void 0:e[i.Wy])+";action:"+(null==r?void 0:r["#Action"])+";formId:"+(null==r?void 0:r["#FormId"])}function w(t,n){t.end({resultType:"Failure",extraData:{error:n}})}!function(t){t[t.Mail=0]="Mail",t[t.Teams=1]="Teams"}(r||(r={}))},64534:function(t,n,e){"use strict";e.d(n,{pw:function(){return a},wG:function(){return c},tC:function(){return l}});var r=e(18137),i=e(9947),o=e(41448),s=e(67661),u=e(57411);function a(){return new Promise((function(t){var n,e=(0,u.tE)();if(e)if(e.isFieldReady(e.Schema.PrivacyUrl)&&e.Model.PrivacyUrl&&(n=e.Model.PrivacyUrl),n)t(n);else{var r=(0,u.BP)();e.ensureFieldsReady([s.x.Schema.Settings]).then((function(){(0,o.d8)().getPrivacySettings(r&&r.OrgId,(0,i.k0)().userInfo.TenantId,e.SettingMaster.Model.IsAnonymous).then((function(n){return t(n&&n.privacyUrl)}),(function(n){return t(void 0)}))}))}else t(void 0)}))}function c(){location.assign("/Pages/PortalPage.aspx")}function l(t){window.location.assign((0,r.Ii)(t))}},1014:function(t,n,e){"use strict";e.d(n,{Qn:function(){return u}});var r=e(15934),i=e(94978),o=e(90710),s=e(46008);function u(t,n){return(0,s.Fp)()?(0,r.yk)(t)?a(t):(0,r.M4)(t)?function(t,n){if(-1===t.indexOf("sharepoint")){var e=t.indexOf("/video"),r=t.substring(t.indexOf("?")+1),s=(0,o.NW)(r),u=s.st?"st="+s.st+"&amp;":"",a=t.indexOf("?")>-1?t.slice(e,t.indexOf("?")):t.slice(e);return c=t.slice(0,e)+"/embed"+a+"?"+u+"autoplay=false&amp;showinfo=true&amp;app=forms"}var c=null;if(-1===t.indexOf("layouts")&&t.indexOf("AllItems.aspx")>=0){var l=/teams\/[^\/]+\/(.+.aspx)/,f=(0,i.Gw)("VideoOfficeStreamUrl");f&&(l=new RegExp(f,"i"));var h=t.match(l);if(h&&2===h.length){var d=h[1];c=t.replace(d,"_layouts/15/embed.aspx")+"&correlationId="+n+"&client_id=Forms"}}else{var m=function(t,n){return"/"+n+"/embed.aspx"};c=t.replace(/\/(_layouts\/15)\/([^\s]*).aspx/,m)+"&correlationId="+n+"&client_id=Forms"}return c}(t,n):void 0:a(t)}function a(t){var n=document.createElement("a");n.href=t;var e=n.pathname.split("/"),r=t.substring(t.indexOf("?")+1),i=(0,o.NW)(r);return"https://www.youtube.com/embed/"+(i.v||e[0]||e[1])+"?feature=oembed&amp;modestbranding=1&amp;rel=0"+(i.t?"&amp;start="+i.t:"")}},46008:function(t,n,e){"use strict";e.d(n,{hu:function(){return f},X9:function(){return h},wM:function(){return d},f5:function(){return m},xO:function(){return v},Fp:function(){return p},rA:function(){return g},I8:function(){return b},$T:function(){return w},LU:function(){return y},Zh:function(){return I},Nb:function(){return S},B6:function(){return C},le:function(){return F},Ei:function(){return N}});var r=e(33967),i=e(94290),o=e(43209),s=e(29559),u=e(83894),a=e(2775),c=e(83830),l=e(90710);function f(t,n){if(!t&&!(0,r.yv)()&&!(0,r.Gd)()){var e=(new Error).stack;console.assert(t,n,e)}}function h(){return(0,a.CE)((0,l.NW)(),"embed","oembedsso","themecolor","preview")}function d(){return!!(0,l.NW)().embed}function m(){var t=(0,l.NW)().compact;return t&&"true"===t.toLowerCase()}function v(){return!(!(0,i.GF)()&&!function(){if((0,i.Kw)()&&(0,r.yv)()&&"Analyze"!==(0,o.C2)())return!0;return!1}()&&"Fluid"!==(0,o.C2)())}function p(){return!(0,u.ro)()&&!(0,r.x8)()}function g(){return $(window).width()<=768}function b(t){var n=(0,a.d9)(t);return(0,a.S6)(n,(function(t,e){(0,a.Kn)(t)&&(n[e]=b(t))})),n}function w(t){return(0,a.XP)(t).filter($.isNumeric).map((function(n){return t[n]}))}function y(){var t=null,n=window.location!==window.parent.location?document.referrer:document.location.href;return n&&(t=new URL(n).origin),t}function I(){var t=(0,c.v)();return t.substring(0,t.length-1)}function S(t){var n=new RegExp("\\s+","gi");return t=t.replace(n,"")}function C(t){document.execCommand("print",!1,null)||window.print(),"function"==typeof t&&((0,s.G6)()?setTimeout((function(){t()}),3e3):t())}function F(t){return null==t}function N(t){return t}},70877:function(t,n,e){"use strict";e.d(n,{B9:function(){return o}});e(36215);var r=e(15934),i=e(19976);function o(t,n){return!s(n)&&(0,r.yk)(t)}function s(t){return(0,i.a)().Model.FormsTenantSettings.bingImageSearch||t&&t.isFieldReady(t.Schema.TenantSwitches)&&1===t.Model.TenantSwitches}},77209:function(t,n,e){"use strict";function r(t){return t?(t.startsWith("t=")||t.startsWith("Bearer")?"":"Bearer ")+t:""}e.d(n,{U:function(){return r}})},49306:function(t,n,e){"use strict";e.d(n,{F:function(){return u},I:function(){return a}});var r,i,o=e(55890),s=e(41448);function u(t,n){if(!i){var e=s.VY.getInstance().createDataProvider();(i=e.getDataClassificationLabelDetail(t,n)).catch((function(t){(0,o.zU)("TenantDataClassificationLevelDetailGetFailure",t)}))}return i}function a(){return r||(r=new Promise((function(t,n){$((function(){s.VY.getInstance().createDataProvider().getDataClassificationLabels().then(t,n)}))}))).catch((function(t){(0,o.zU)("TenantDataClassificationLevelsGetFailure",t)})),r}},23946:function(t,n,e){"use strict";e.d(n,{d:function(){return a}});var r=e(9947),i=e(72317),o=e(77209),s=e(27349),u=e(72275);function a(t,n){return(0,i.a)().AuthContext.getFormApiToken().then((function(e){var i;return t.headers=$.extend(!0,t.headers,(i=e||"",{__RequestVerificationToken:(0,r.k0)().antiForgeryToken,Accept:"application/json",Authorization:(0,o.U)(i),"Content-Type":"application/json"})),(0,s.lW)(t,n).then((function(t){return t?(0,u.EI)(t):Promise.reject("Data is null.")}),u.W3)}))}},88914:function(t,n,e){"use strict";e.d(n,{UF:function(){return l},sK:function(){return f},nY:function(){return h},GO:function(){return d},tW:function(){return m},ge:function(){return v},s1:function(){return p},Ng:function(){return g}});var r,i=e(94290),o=e(9947),s=e(72821),u=e(64290),a=e(55890),c=e(62054);function l(){return b().then(s.bR,(function(){return!1}))}function f(){return b().then(s.jD,(function(){return!1}))}function h(){return b().then((function(){return!!(0,s.ID)()}),(function(){return!1}))}function d(){return b().then(s.VE,(function(){return!1}))}function m(){return b().then((function(){return!!(0,s.Ak)()}),(function(){return!1}))}function v(){return b().then((function(){return!(0,s.Ak)()&&!!(0,s.DP)()}),(function(){return!1}))}function p(){return b().then((function(){return!(0,s.Ak)()&&!(0,s.DP)()&&!!(0,s.xY)()}),(function(){return!1}))}function g(){return b().then(s.qM,(function(){return 0}))}function b(){return r||(r=new Promise((function(t,n){$((function(){if((0,o.k0)().userInfo.UserId||(0,i.CE)()||(0,i.Kw)())try{var e=(0,o.k0)().userLicenseInfo;if(null==e?void 0:e.id){var r=(0,s.mR)(e.licenses,e.isPaidUser);t(r)}else(0,c.bG)().then((function(n){var e=(0,s.mR)(n.licenses,n.isPaidUser);t(e)})).catch(n)}catch(t){n(t)}else t({})}))}))).catch((function(t){(0,u.md)((function(){return!0}))&&window.location.pathname.toLowerCase().indexOf("responsepage.aspx")>-1&&758===t.innerCode?(0,a.JG)({type:"UserInfoGetFailure",eventInfo:{error:t}}):(0,a.zU)("UserInfoGetFailure",t)})),r}},88807:function(t,n,e){"use strict";e.d(n,{L:function(){return f}});var r=e(10836),i=e(33967),o=e(51254),s=e(37076),u=e(81380),a=e(27349),c="GetDriveItem",l=(0,i.yv)()?"https://graph.microsoft.com/v1.0/":"https://graph.microsoft-ppe.com/v1.0/",f=function(){function t(t){this.Rt=t.Model.Id,t&&(this.Lt=(0,u.lK)(t))}var n=t.prototype;return n.createFileUploadSession=function(t,n){return this.Lt.createUploadSession(this.Rt,t,n).then((function(t){if(null==t)throw new Error("no data return");return t}))},n.cancelOrDeleteUploadFile=function(t){return this.Lt.cancelOrDeleteUploadFile(t)},n.uploadBytesToSession=function(t,n,e,r,i,o){return(0,a.lW)({body:n,headers:{"Content-Range":"bytes "+r+"-"+i+"/"+o,"Content-Type":"*/*"},method:"PUT",qosEventName:"FileUpload.UploadFile",requestUri:t.uploadUrl})},n.getFileFolder=function(t){var n=this;return(0,r.cr)("GetDriveItemFromFormApi")?(0,a.lW)({headers:{"Content-Type":"*/*"},method:"GET",isSensitiveUri:!0,qosEventName:o.WW+c+"FromFormAPI",requestUri:"/formapi/api/"+h(this.Rt)+"/graphDriveItem/"+t}).then((function(t){return t&&(t.WebUrl||t.webUrl)})):(0,o.d6)((function(e){return(0,a.lW)({headers:{Authorization:e,"Content-Type":"*/*"},method:"GET",isSensitiveUri:!0,qosEventName:o.WW+c,requestUri:""+l+h(n.Rt)+"/drive/items/"+t})})).then((function(t){return t.webUrl}))},t}();function h(t){var n=(0,s.kc)(t),e=n.OwnerId;return n.OrgId+"/"+(n.IsGroupOwner?"groups":"users")+"/"+e}},86749:function(t,n,e){"use strict";e.d(n,{p:function(){return m}});var r=e(33967),i=e(9947),o=e(916),s=e(41480),u=e(97265),a=e(59469),c=e(55411),l=e(21607),f=e(93592),h=e(72317),d=e(64290),m=function(){function t(t){for(this.At=t.trim();"/"===this.At.charAt(this.At.length-1);)this.At=this.At.substr(0,this.At.length-1)}var n=t.prototype;return n.qt=function(t){return this.At+"/"+t},n.deleteQuestionImage=function(t,n,e){var r=this;return v().then((function(i){return b(i,r.qt(g(t,n,e)))}))},n.uploadQuestionImage=function(t,n,e,r){var i=this;return v().then((function(o){return w(o,i.qt(g(t,n,e)),e,r)}))},n.deleteFormImage=function(t,n){var e=this;return v().then((function(r){return b(r,e.qt(p(t,n)))}))},n.uploadFormImage=function(t,n,e){var r=this;return v().then((function(i){return w(i,r.qt(p(t,n)),n,e)}))},t}();function v(){return(0,h.a)().AuthContext.getFormApiToken()}function p(t,n){return"forms('{0}')/{1}".format(t,n)}function g(t,n,e){return"forms('{0}')/questions('{1}')/{2}".format(t,n,e)}function b(t,n){var e=new o.o("Image.Delete");e.start();return y({methodName:"DELETE",url:n,headers:{Authorization:t?"Bearer "+t:"","X-CorrelationId":e.CorrelationId,"X-UserSessionId":(0,s.k)()},successHandler:function(){return e.end({resultType:"Success"})},errorHandler:function(t){var r={correlationId:e.CorrelationId,innerCode:t.responseJSON&&t.responseJSON.error&&t.responseJSON.error.code,statusCode:t.status,innerMessage:t.responseJSON&&t.responseJSON.error&&t.responseJSON.error.message,statusText:t.statusText};return e.end({resultType:"Failure",extraData:{imageUrl:n,error:r}}),r}})}function w(t,n,e,r){var i=new o.o("Image.Upload");i.start();return y({methodName:"PUT",url:n,headers:{Authorization:t?"Bearer "+t:"","Content-Type":r.ImageType,"Content-Disposition":"attachment; name={0}; filename={1}".format((0,u.GW)(),r.ImageName),"X-CorrelationId":i.CorrelationId,"X-UserSessionId":(0,s.k)()},successHandler:function(t){if(!t||!t.resourceId){var r={correlationId:i.CorrelationId,innerCode:5200,statusCode:0,innerMessage:"Upload image return bad response",statusText:"CollabDb bad response"};throw i.end({resultType:"Failure",extraData:{imageUrl:n,error:r,imageType:e}}),r}return i.end({resultType:"Success",extraData:{imageType:e}}),{altText:t.altText,contentType:t.contentType,fileIdentifier:t.fileIdentifier,originalFileName:t.originalFileName,resourceId:t.resourceId,resourceUrl:t.resourceUrl,height:t.height,width:t.width}},errorHandler:function(t){var e={correlationId:i.CorrelationId,innerCode:t.responseJSON&&t.responseJSON.error&&t.responseJSON.error.code,statusCode:t.status,innerMessage:t.responseJSON&&t.responseJSON.error&&t.responseJSON.error.message,statusText:t.statusText};return i.end({resultType:"Failure",extraData:{imageUrl:n,error:e}}),e},blob:r.ImageBlob})}function y(t){var n=t.methodName,e=t.url,o=t.headers,s=t.successHandler,u=t.errorHandler,m=t.data,v=t.blob,p=new XMLHttpRequest;return p.open(n,e),(0,c.hj)()&&p.setRequestHeader("__RequestVerificationToken",(0,i.k0)().antiForgeryToken),(0,d.md)((function(){"USGovGccProd"===(0,r.kD)()?p.setRequestHeader("x-ms-form-request-ring","formsprogcc"):p.setRequestHeader("x-ms-form-request-ring","formspro")})),Object.keys(o).forEach((function(t){p.setRequestHeader(t,o[t])})),m?(p.setRequestHeader("content-type","application/json; charset=utf-8"),p.send(m)):v?p.send(v):p.send(),new Promise((function(t,n){p.onreadystatechange=function(){if(p.readyState===XMLHttpRequest.DONE){var e=p.status;200===e||202===e||201===e||204===e?t(p.responseText&&JSON.parse(p.responseText)):n(p.statusText)}}})).then(s,(function(t){if(!(0,a.hh)(t))return u(t);(0,h.a)().AuthContext.refreshToken().then(l.Yq).then((function(){return y({methodName:n,url:e,headers:o,successHandler:s,errorHandler:u,data:m,blob:v})})).catch(f.sl)}))}},68246:function(t,n,e){"use strict";e.d(n,{A:function(){return a}});var r=e(69856),i=e(86353),o=e(9947),s=e(83830),u=e(23946),a=function(){function t(t,n,e,r){var o,s,u;this.At=t+"intelligence/api/",this.Ot=n&&e&&r?""+this.At+n+"/"+r+"/"+e+"/":""+this.At;var a=(0,i.Tl)();this.Mt={IntelligenceExp1:null===(o=null==a?void 0:a.IntelligenceExp1)||void 0===o?void 0:o.replace(/"/g,""),IntelligenceExp2:null===(s=null==a?void 0:a.IntelligenceExp2)||void 0===s?void 0:s.replace(/"/g,""),IntelligenceInsightsExp:null===(u=null==a?void 0:a.IntelligenceInsightsExpPerTenant)||void 0===u?void 0:u.replace(/"/g,"")}}var n=t.prototype;return t.createIntelligenceProvider=function(n,e,r){return new t((0,s.v)(),e,r,3===n?"groups":"users")},n.getInsights=function(t,n,e){return(0,u.d)({method:"GET",qosEventName:"Intelligence.GetInsights",requestUri:this.Ot+"forms('"+t+"')/getinsights("+n+","+e+")"})},n.getCachedInsights=function(t){return(0,u.d)({method:"GET",qosEventName:"Intelligence.GetCachedInsights",requestUri:this.Ot+"forms('"+t+"')/getcachedinsights"})},n.getOrCalculateInteractiveInsights=function(t){var n,e,r=null!==(e=null===(n=(0,i.Tl)())||void 0===n?void 0:n.IntelligenceInsightsExpPerTenant)&&void 0!==e?e:"Unknown";return(0,u.d)({method:"GET",qosEventName:"Intelligence.GetInteractiveInsights",requestUri:this.Ot+"forms('"+t+"')/getorcalculateinteractiveinsights?intelligenceInsightsExp="+r})},n.getIntelligenceInsights=function(t,n,e,i,o){return void 0===e&&(e=r.K.Form),void 0===i&&(i=""),void 0===o&&(o=[]),(0,u.d)({body:JSON.stringify({ContextType:e,ContextId:i,ResponseCount:n,InsightTypes:o,Experiments:this.Mt}),method:"POST",qosEventName:"Intelligence.GetIntelligenceInsights",qosExtraData:{experiments:this.Mt},requestUri:this.Ot+"forms('"+t+"')/getIntelligenceInsights"})},n.getOptionToOptionSuggestion=function(t,n,e){return(0,u.d)({body:JSON.stringify({existingOptions:t,variation:e}),method:"POST",qosEventName:"Ingelligence.GetOptionToOptionSuggestion",qosExtraData:{feature:n,variation:e},requestUri:this.Ot+"getOptionToOptionSuggestion"})},n.getHistorySuggestion=function(t,n,e){var r=(0,o.k0)().userInfo,i=r&&r.TenantId,s=r&&r.UserId,a=""+this.At+i+"/users/"+s+"/getHistoryFormSuggestion";return(0,u.d)({body:JSON.stringify({Text:t,FormId:n,IsQuiz:e}),method:"POST",qosEventName:"Ingelligence.GetHistorySuggestion",requestUri:a})},n.predictResponseTime=function(t){var n=this.At+"PredictResponseTime";return(0,u.d)({body:JSON.stringify(t),method:"POST",qosEventName:"Intelligence.PredictResponseTime",requestUri:n})},n.textAnalyze=function(t){return this.textAnalyzeWithFeatures(256,t)},n.textAnalyzeWithFeatures=function(t,n){if(!n){return Promise.resolve({Features:0,Results:[]})}return(0,u.d)({body:JSON.stringify({Features:t,Text:n,Experiments:this.Mt}),method:"POST",qosEventName:"Question.TextAnalysis",qosExtraData:{Features:t},requestUri:this.Ot+"textanalysis3"})},n.logUserSignal=function(t){return(0,u.d)({body:JSON.stringify(t),method:"POST",qosEventName:"Intelligence.LogUserSignal",requestUri:this.At+"LogUserSignal"})},n.askSuggestion=function(t){var n={Feature:null==t?void 0:t.Feature};return(0,u.d)({body:JSON.stringify(t),method:"POST",qosEventName:"Intelligence.AskSuggestion",qosExtraData:n,requestUri:this.At+"ask"})},n.askSuggetions=function(t){var n={Feature:null==t?void 0:t.Feature};return(0,u.d)({body:JSON.stringify(t),method:"POST",qosEventName:"Intelligence.AskSuggestions",qosExtraData:n,requestUri:this.At+"askSuggestions"})},t}()},22810:function(t,n,e){"use strict";e.d(n,{PR:function(){return u},ex:function(){return a},o6:function(){return c}});var r=e(64459),i=e(55411),o=e(51254),s=e(27349);function u(t){return l((0,i.HA)()+"/users/"+t,"GetUser")}function a(t){return l((0,i.HA)()+"/groups/"+t,"GetGroup")}function c(t){return l((0,i.HA)()+"/me/checkMemberGroups","CheckMemberGroups","POST",'{"groupIds": ["'+t+'"] }')}function l(t,n,e,i){return void 0===e&&(e="GET"),void 0===i&&(i=null),(0,o.d6)((function(r){var u={body:i,headers:{Authorization:r,"Content-Type":"application/json"},isSensitiveUri:!0,method:e,qosEventName:o.WW+n,requestUri:t};return(0,s.lW)(u,{disableLog:!0,disableXMsHeader:!0,skipExpiredTokenCheck:!0})})).then((function(t){return(0,r.d)(t)}))}},54438:function(t,n,e){"use strict";e.d(n,{m:function(){return u}});var r=e(81380),i=e(51586),o=function(){function t(t,n){this.Ut=[],this.Vt=t,n=n||{},this._t=n.deferredTimeInMs||100,this.Gt=n.maxCount||10}var n=t.prototype;return n.insert=function(t){var n=this,e=new Promise((function(e,r){n.Ut.push({Arguments:t,Resolve:e,Reject:r})}));return this.Ut.length>=this.Gt?this.Bt():void 0===this.Qt&&(this.Qt=window.setTimeout((function(){return n.Bt()}),this._t)),e},n.Bt=function(){var t=this.Ut;this.Ut=[],void 0!==this.Qt&&(window.clearTimeout(this.Qt),this.Qt=void 0),0!==t.length&&this.Vt(t.map((function(t){return t.Arguments}))).then((function(n){if(t.length!==n.length)throw Error("All the elements needs to be listed in result array.");n.forEach((function(n,e){n.Succeeded?t[e].Resolve(n.Value):t[e].Reject(n.Error)}))})).catch((function(n){t.forEach((function(t){t.Reject(n)}))}))},t}(),s={};function u(t,n){return s.hasOwnProperty(n)||(s[n]=new o((function(t){return function(t,n){var e=t.length,o=(0,i.OM)(n);if(o)return(0,r.lK)(o).copyLocaleResources(n,t).then((function(){for(var t=[],n=0;n<e;++n)t.push({Succeeded:!0,Value:void 0});return t}),(function(t){for(var n=[],r=0;r<e;++r)n.push({Error:t,Succeeded:!1});return n}));return Promise.resolve(null)}(t,n)}))),s[n].insert(t)}},27349:function(t,n,e){"use strict";e.d(n,{lW:function(){return P},MM:function(){return D}});var r,i=e(59312),o=e(36215),s=e.n(o),u=e(37043),a=e(33967),c=e(79552),l=e(9947),f=e(916),h=e(41480),d=e(83894),m=e(84475),v=e(59469),p=e(94978),g=e(57411),b=e(21607),w=e(48789),y=e(93592),I=e(72317),S=e(64290),C=e(44644),F=e(60591),N=e(72275);var T={},k={},x=null;function P(t,n,e){var o,w;void 0===n&&(n={});var P,D,L=t.qosEventName,A=-1!==((0,p.Gw)("ThrottledQosEventNames")||[]).indexOf(L),q=!n.disableLog,O=-1;q&&!A||(x||(x=setInterval((function(){Object.keys(T).forEach((function(t){T[t]=!0}))}),6e5)),void 0===T[L]||T[L]?(q=!0,O=null!==(o=k[L])&&void 0!==o?o:0,T[L]=!1,k[L]=0):(q=!1,void 0!==k[L]?++k[L]:k[L]=1));if(q){w=null!=e?e:new f.o(L);var M=s().clone(t.qosExtraData);O>=0&&(M=(0,i.pi)({SkippedCount:O},M)),w.ExtraData=M,w.start(),t.headers["X-CorrelationId"]=w.CorrelationId,t.headers["X-UserSessionId"]=(0,h.k)()}n.disableXMsHeader||(t.headers["x-ms-form-request-source"]=(0,m.A)(),(0,S.md)((function(){t.qosExtraData&&t.qosExtraData.FormType&&(P=t.qosExtraData.FormType),t.requestUri&&-1!==t.requestUri.indexOf("linkedBrData")&&(t.headers["x-ms-form-deleted"]=1)})),n.disableRequestRingHeader||(t.headers["x-ms-form-request-ring"]=(D=P,(0,S.md)((function(){r="Form"!==D&&"Quiz"!==D?"USGovGccProd"===(0,a.kD)()?"formsprogcc":"formspro":null})),r||((0,l.k0)().ring&&!(0,a.x8)()&&(r=(0,l.k0)().ring.toLowerCase()),r="USGovGccProd"===(0,a.kD)()?"gcc":(0,d.ro)()||(0,g.M5)()?"msa":(0,d.Wh)()||(0,g.gq)()?"msft":(0,d.Ak)()||(0,g.eT)()?"fastfood":"business"),r)));var U=-1,V=new Promise((function(e,r){var i=function(){U++,function(t,n,e,r){void 0===r&&(r=!1);t.blobResponseType?E(t,n,r?e:i):R(t,n,r?e:i);function i(r){(0,v.hh)(r)?(0,I.a)().AuthContext.refreshToken().then((function(r){(0,b.Yq)(r).then((function(){t.headers.__RequestVerificationToken=(0,l.k0)().antiForgeryToken,r&&"string"==typeof r&&(t.headers.Authorization=(0,u.U)(r)),o().then((function(){return R(t,n,e)}))})).catch(y.sl)}),e):(0,v.xO)(r)?(0,v.ad)():(0,v.D1)(r)?(0,I.a)().AuthContext.signIn().then(y.iv):e(r)}function o(){return(0,l.k0)().userInfo.UserId?Promise.resolve():(0,b.sE)().catch((function(){}))}}(t,(function(t){e(t)}),(function(e){var o,s=t.isSensitiveUri?void 0:t.requestUri.toString(),u=(0,F.L)(s,e),a=u.statusCode,c=u.innerCode,l=!1,f=0;if(502===a)o="Forms_Http_"+a,l=U<2;else if(503===a)o="Forms_Http_"+a,l=U<5;else if(504===a||0===a)f=5e3,o="Forms_Http_"+a,l=U<6;else if(6503===c||624===c||647===c)o="CDB_Http_"+c,l=U<2;else if(645===c||646===c){(0,I.a)().RetryingRecoverableError=!0,o="CDB_Http_"+c,l=U<10;var h=[2,16,32,64],d=U>=h.length?64:h[U];n.hasPrefetch&&(d*=2),f=1e3*Math.min(d,64)*(.8+.4*Math.random())}if(!l)return r(e);w&&w.log({resultCode:o,extraData:{RetryCount:U,RetryInterval:f,ServiceError:u}}),setTimeout(i,f)}),n.skipExpiredTokenCheck)};i()}));return w?V.then((function(n){var e,r,i={resultCode:(null===(r=null===(e=null==n?void 0:n.response)||void 0===e?void 0:e.response)||void 0===r?void 0:r.statusCode)||"",resultType:"Success"};if("Form.Create"===t.qosEventName){var o=(0,N.EI)(n);i.extraData={FormId:o.id,Origin:(0,C.P)()||void 0,RetryCount:U||void 0,XLWorkbookId:o.xlWorkbookId||void 0},s().extend(i.extraData,t.qosExtraData)}return w.end(i),n})).catch((function(n){var e=t.isSensitiveUri?void 0:t.requestUri.toString(),r=(0,F.L)(e,n);throw w.end({resultCode:n&&n.response?n.response.statusCode:"",resultType:(0,c.WP)(r)?"ExpectedFailure":"Failure",extraData:{ServiceError:r,RetryCount:U||void 0}}),n})):V}function D(t,n){return void 0===n&&(n={}),new Promise((function(n,e){E(t,n,e,!0)}))}function E(t,n,e,r){void 0===r&&(r=!1);var i=new XMLHttpRequest,o=t.requestUri;if(i.onreadystatechange=function(){if(null!=i&&4===i.readyState){var s=i.status,u=i.statusText;1223===s&&(s=204,u="No Content");var a=i.response;if(s>=200&&s<=299){if(r){var c=(0,w.D)(i);a={requestUri:o,statusCode:s,statusText:u,headers:c,body:a}}i=null,n(a)}else{c=(0,w.D)(i);i=null,e({message:"HTTP request failed",request:t,response:{requestUri:o,statusCode:s,statusText:u,headers:c,body:a}})}}},i.open(t.method||"GET",o,!0),i.responseType="blob",t.headers)for(var s in t.headers)i.setRequestHeader(s,t.headers[s]);i.send(t.body)}function R(t,n,e){odatajs.oData.request(t,n,e)}},41448:function(t,n,e){"use strict";e.d(n,{VY:function(){return c},d8:function(){return l},GA:function(){return f}});var r=e(33967),i=e(9947),o=e(55411),s=e(83830),u=e(72467),a=e(86749),c=function(){function t(){if(t.instance)return t.instance;t.instance=this}var n=t.prototype;return t.getInstance=function(){return new t},n.getOwnerServiceUrl=function(t,n,e){return 1===t?this.getFormApiServiceUrl():4===t?this.getFormApiServiceUrl()+"me/":n&&e?this.getFormApiServiceUrl()+n+(3===t?"/groups/":"/users/")+e+"/":null},n.createDataProvider=function(t,n,e){void 0===t&&(t=1),void 0===n&&(n=null),void 0===e&&(e=null);var r=(0,u.AX)();if(1===t)return this.defaultDataProvider||(this.defaultDataProvider=new r(this.getFormApiServiceUrl(),this.getFormApiServiceUrl())),this.defaultDataProvider;var i=this.getOwnerServiceUrl(t,n,e);return i&&new r(this.getFormApiServiceUrl(),i)},n.createImageProvider=function(t,n,e){if(void 0===t&&(t=1),void 0===n&&(n=null),void 0===e&&(e=null),1===t)return this.currentImageProvider||(this.currentImageProvider=new a.p(this.getFormApiServiceUrl())),this.currentImageProvider;var r=this.getOwnerServiceUrl(t,n,e);return r&&new a.p(r)},n.getFormApiServiceUrl=function(){return this.getServiceUrl("formapi/api/")},n.getCollabDBServiceUrl=function(){var t;return t=(0,r.Zr)()?(0,r.kD)():(0,o.pc)(),(0,o.lz)(t)},n.getServiceUrl=function(t){return(0,s.v)()+t},t}();function l(){return c.getInstance().createDataProvider()}function f(t){return c.getInstance().createDataProvider(3,(0,i.k0)().userInfo.TenantId,t)}},60591:function(t,n,e){"use strict";e.d(n,{Q:function(){return i},L:function(){return s}});var r=e(81620);function i(t){var n,e,i,s,u={error:{code:"15001",message:null===(n=t.response)||void 0===n?void 0:n.body}},a=t&&t.response&&t.response.statusCode;try{t.response.body&&(u=JSON.parse(t.response.body))}catch(n){if(401===a){var c=(0,r.jL)(t.response.headers,"WWW-Authenticate");c&&-1!==c.indexOf("invalid_token")&&(u.error.code="701")}}var l=(null===(e=u.error)||void 0===e?void 0:e.code)&&parseInt(u.error.code);if(isNaN(l))switch(a){case 0:l=15001;break;case 429:l=15429}return{correlationId:(0,r.jL)(null===(i=null==t?void 0:t.response)||void 0===i?void 0:i.headers,"X-CorrelationId"),headers:null===(s=null==t?void 0:t.response)||void 0===s?void 0:s.headers,statusCode:t&&t.response&&t.response.statusCode,statusText:t&&t.response&&t.response.statusText,innerMessage:u.error&&u.error.message,type:o(a,u),customizedMessage:u.error&&u.error["@ms.form.error.customizedMessage"],isServerError:!0,innerCode:l}}function o(t,n){var e=n.error&&n.error["@ms.form.error.type"];if(!e){e=t>=0&&t<500?"ExpectedFailure":"Failure"}return e}function s(t,n){var e,o,s,u=i(n),a={statusCode:n&&n.response?parseInt(n.response.statusCode):0,correlationId:(0,r.jL)(null===(e=null==n?void 0:n.response)||void 0===e?void 0:e.headers,"X-CorrelationId"),statusText:n&&n.response?n.response.statusText:"",innerCode:u?u.innerCode:-1,innerMessage:u?u.innerMessage:"",failureReason:(0,r.jL)(null===(o=null==n?void 0:n.response)||void 0===o?void 0:o.headers,"X-FailureReason"),failureType:u?u.type:void 0,afdRef:(0,r.jL)(null===(s=null==n?void 0:n.response)||void 0===s?void 0:s.headers,"X-MSEdge-Ref")};return t&&(a.sourceUrl=t),a}},72275:function(t,n,e){"use strict";e.d(n,{W3:function(){return c},EI:function(){return l},D3:function(){return f}});var r=e(64459),i=e(93592),o=e(72317),s=e(19578),u=e(60591),a=e(58494);function c(t){var n=(0,u.Q)(t);if(function(t){var n=function(){(0,o.a)().AuthContext.signIn().then(i.iv)};return(0,a.ef)(t,n,s.P)}(n))return new Promise((function(){}));throw n}function l(t){return f(t).value}function f(t){var n={status:0};if(null==t)n.value=t;else{var e=t,i=e["@odata.count"]&&parseInt(e["@odata.count"]);isNaN(i)||(n.count=i),n.value=(0,r.d)(void 0===e.value?t:e.value)}return n}},58494:function(t,n,e){"use strict";e.d(n,{ef:function(){return a}});var r=e(94290),i=e(29559),o=e(9947),s=e(90710),u=e(55890);function a(t,n,e){return 401===t.statusCode&&!(0,r.ft)()&&((401!==t.statusCode||!(0,r.Kw)()||!(0,r.OL)())&&((401!==t.statusCode||!(0,r.HI)())&&(function(t){if(t){var n=void 0;switch(t.innerCode){case 702:n="Auth.NotOnboardedTenant";break;case 703:n="Auth.DisabledByTenantAdmin";break;case 705:n="Auth.UserNeedMultiFactorAuth"}n&&(0,u.$U)(n,{tenantId:(0,o.k0)().userInfo.TenantId})}}(t),(0,s.NW)().embed?(t.innerCode=10001,!1):(700===t.innerCode||701===t.innerCode)&&(!(0,r.mF)()||701!==t.innerCode&&700!==t.innerCode?(0,i.K$)()&&(0,i.MG)()&&(0,i.Dt)()?(t.innerCode=15003,!1):(n(),!0):(e({innerCode:701===t.innerCode?10300:10301}),!1)))))}},84950:function(t,n,e){"use strict";e.d(n,{l_:function(){return r},qe:function(){return u}});var r,i=e(66676),o=e(83830),s=e(23946);function u(t,n,e){void 0===e&&(e="");var r=(0,o.v)()+"intelligence/api/"+"forms("+t+")/LogUserActionSigsSignals",u={UserActionSigsSignals:n,FormContent:e,Locale:(0,i.Kd)()};return(0,s.d)({body:JSON.stringify(u),method:"POST",qosEventName:"Intelligence.LogUserActionSigsSignals",requestUri:r})}!function(t){t[t.Form=0]="Form",t[t.Question=1]="Question",t[t.Response=2]="Response",t[t.ThemeSuggestion=3]="ThemeSuggestion",t[t.QuestionSuggestion=4]="QuestionSuggestion",t[t.HistorySuggestion=5]="HistorySuggestion",t[t.EstimatedTime=6]="EstimatedTime",t[t.Insights=7]="Insights"}(r||(r={}))},62054:function(t,n,e){"use strict";e.d(n,{bG:function(){return i}});var r=e(45913);function i(){return r.j.getInstance().getPromise()}},29295:function(t,n,e){"use strict";e.d(n,{J:function(){return i}});var r=e(63804);function i(t,n){return t.__lazyComponentClass||(t.__lazyComponentClass=r.lazy(n)),t.__lazyComponentClass}},30521:function(t,n,e){"use strict";e.d(n,{a:function(){return a}});var r=e(59312),i=e(63804),o=e(32782),s=e(43367),u=e(29295);function a(t){var n=(0,u.J)(a,s.wp);return i.createElement(o.Z,null,i.createElement(n,(0,r.pi)({},t)))}},15305:function(t,n,e){"use strict";e.d(n,{l:function(){return i}});var r=e(59312);e(63804);function i(){return(0,r.mG)(this,void 0,void 0,(function(){return(0,r.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(1778).then(e.bind(e,74623)).then((function(t){return t.initializeIcons()}))];case 1:return t.sent(),[2]}}))}))}},54569:function(t,n,e){"use strict";e.d(n,{u5:function(){return a},os:function(){return l},YW:function(){return h}});var r=e(59312),i=e(63804),o=e(32782),s=e(29295);function u(){return(0,r.mG)(this,void 0,void 0,(function(){return(0,r.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(2149).then(e.bind(e,91882))];case 1:return[2,{default:t.sent().InsightsPinedView}]}}))}))}function a(t){var n=(0,s.J)(a,u);return i.createElement(o.Z,null,i.createElement(n,(0,r.pi)({},t)))}function c(){return(0,r.mG)(this,void 0,void 0,(function(){return(0,r.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(2149).then(e.bind(e,95563))];case 1:return[2,{default:t.sent().InsightsExploreView}]}}))}))}function l(t){var n=(0,s.J)(l,c);return i.createElement(o.Z,null,i.createElement(n,(0,r.pi)({},t)))}function f(){return(0,r.mG)(this,void 0,void 0,(function(){return(0,r.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(2149).then(e.bind(e,4834))];case 1:return[2,{default:t.sent().SurveyAnalyzeViewSummaryInsightPanel}]}}))}))}function h(t){var n=(0,s.J)(h,f);return i.createElement(o.Z,null,i.createElement(n,(0,r.pi)({},t)))}},29952:function(t,n,e){"use strict";e.d(n,{Oy:function(){return o}});var r=e(94290),i=e(90710);function o(){var t,n=(0,r.XF)();return"embed"===(null===(t=(0,i.NW)().mode)||void 0===t?void 0:t.toLowerCase())||"TeamsApproval"===n||"TeamsReports"===n}},22768:function(t,n,e){"use strict";e.d(n,{Sp:function(){return c},Rq:function(){return l}});var r=e(59312),i=e(63804),o=e(32782),s=e(29295);function u(){return(0,r.mG)(this,void 0,void 0,(function(){return(0,r.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(4600).then(e.bind(e,54281))];case 1:return[2,{default:t.sent().MathjaxFormulaRenderer}]}}))}))}function a(){return(0,r.mG)(this,void 0,void 0,(function(){return(0,r.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(4600).then(e.bind(e,57596))];case 1:return[2,{default:t.sent().VirtualKeyboardControl}]}}))}))}function c(t){var n=(0,s.J)(c,a);return i.createElement(o.Z,null,i.createElement(n,(0,r.pi)({},t)))}function l(t){var n=(0,s.J)(l,u);return i.createElement(o.Z,null,i.createElement(n,(0,r.pi)({},t)))}},18260:function(t,n,e){"use strict";e.d(n,{WL:function(){return a},vw:function(){return l}});var r=e(59312),i=e(63804),o=e(32782),s=e(29295);function u(){return(0,r.mG)(this,void 0,void 0,(function(){return(0,r.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(9852).then(e.bind(e,56011))];case 1:return[2,{default:t.sent().PhishingReviewPageNavBar}]}}))}))}function a(t){var n=(0,s.J)(a,u);return i.createElement(o.Z,null,i.createElement(n,(0,r.pi)({},t)))}function c(){return(0,r.mG)(this,void 0,void 0,(function(){return(0,r.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(9852).then(e.bind(e,23729))];case 1:return[2,{default:t.sent().PhishingPopUpMessage}]}}))}))}function l(t){var n=(0,s.J)(l,c);return i.createElement(o.Z,null,i.createElement(n,(0,r.pi)({},t)))}},83726:function(t,n,e){"use strict";e.d(n,{d:function(){return i}});var r=e(72377);function i(){return r.Pv.Resolve("IThirdPartyRateIt")}},45351:function(t,n,e){"use strict";e.d(n,{Z:function(){return a}});var r=e(59312),i=e(63804),o=e(32782),s=e(29295);function u(){return(0,r.mG)(this,void 0,void 0,(function(){return(0,r.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(8653).then(e.bind(e,31970))];case 1:return[2,{default:t.sent().ReportPage}]}}))}))}function a(t){var n=(0,s.J)(a,u);return i.createElement(o.Z,null,i.createElement(n,(0,r.pi)({},t)))}},97058:function(t,n,e){"use strict";e.d(n,{Y:function(){return o},f:function(){return u}});var r=e(45900),i=e(37823);function o(t){return t}function s(t){if("string"!=typeof t||!t)return"default";var n=t.toLowerCase();if(i.indexOf(n)>=0)return n;var e=n.replace(/-[^-]+$/,"");return e&&n!==e?s(e):"default"}function u(t){window.FormsLsMap=window.FormsLsMap||{},window.formsLsPromiseMap=window.formsLsPromiseMap||{},t=s(t);var n=window.FormsLsMap[t];if(n)return Promise.resolve(n);var e=window.formsLsPromiseMap[t];return e||(e=a((0,r.uW)("ls-sr."+t+".67b36fccd.js")).then((function(){return window.formsLsPromiseMap[t]=null,window.FormsLsMap[t]}),(function(){throw window.formsLsPromiseMap[t]=null,new Error("fail to download locstring")})).catch((function(t){return new Promise((function(){}))})),window.formsLsPromiseMap[t]=e,e)}function a(t,n){return void 0===n&&(n=0),new Promise((function(e,r){if(n>=2)r();else{var i=document.createElement("script");i.src=t.toLowerCase(),i.type="text/javascript",i.async=!0,i.onload=function(){e()},i.onerror=function(){!function(){try{document.head.removeChild(i)}catch(t){}}(),e(a(t,n+1))};try{document.head.appendChild(i)}catch(t){r()}}}))}},6917:function(t,n,e){"use strict";function r(){return e.e(5514).then(e.t.bind(e,26814,19)).then((function(t){return t.default}))}e.d(n,{e_:function(){return r}})},64541:function(t,n,e){"use strict";e.d(n,{wg:function(){return c},gA:function(){return l},UG:function(){return f},Mw:function(){return d}});var r=e(59312),i=e(31699),o=e.n(i),s=e(2775),u=e(64290),a=[{PropertyName:"color",PropertyDisplayName:"color",AllowedValue:/\s?rgb\(/},{PropertyName:"fontSize",PropertyDisplayName:"font-size",AllowedValue:/(1.2|1|0.8|0.9|1.3)em/}];function c(t,n,e){return void 0===e&&(e=!1),n&&function(t,n){return"false"!==n||"false"===t}(t,n)?n:t||""}function l(t){return(0,u.pd)((function(){return f(t)}),(function(){return u.Xw.sanitizeRichTextHTML(t)}))}function f(t,n){void 0===n&&(n=!1),o().addHook("afterSanitizeAttributes",h);var e=["strong","em","u","b","i","ul","li","span","ol"],i=o().sanitize(function(t){if(!t)return"";var n=function(t){if(!t)return t;var n=document.createElement("div");return n.innerHTML=t,p(n),n.innerHTML}(function(t){var n=/(<\/?)(p|section|article|blockquote|nav|header|h1|h2|h3|h4|h5|h6)([^>]*>)/gi;return t?t.replace(n,"$1div$3"):t}(function(t){if(!t)return"";var n=/<\/?[a-z][^>]*>/gi,e=t.replace(/\r/gi,"");return n.test(e)?e.replace(/\n/gi," "):e.replace(/\n/gi,"<br>")}(o().sanitize(t)))).split(/<div.*?>(.*?)<\/div>/gi).filter((function(t){return!!t}));return n.map((function(t,e){return e===n.length-1||function(t){var n=document.createElement("div");n.innerHTML=t;var e=n.lastChild;for(;null==e?void 0:e.hasChildNodes();)e=e.lastChild;return"BR"===(null==e?void 0:e.nodeName)}(t)?t:t+"<br>"})).join("")}(t),{ALLOWED_ATTR:["style"],ALLOW_DATA_ATTR:!1,ALLOWED_TAGS:n?e:(0,r.ev)((0,r.ev)([],e),["br"])});return o().removeHook("afterSanitizeAttributes"),i}function h(t){if(t.hasAttribute("style")){for(var n=[],e=0,r=a;e<r.length;e++){var i=r[e],o=t.style[i.PropertyName];o&&i.AllowedValue.test(o)&&n.push(i.PropertyDisplayName+": "+o+";")}n.length?t.setAttribute("style",n.join("")):t.removeAttribute("style")}}function d(t,n){return(0,u.pd)((function(){return v(t)}),(function(){return FormsPro.getTextFromHtml(t,n)}))}var m,v=(m=document.createElement("div"),function(t){var n=f(t).replace(/\<br\>/gi,"\n");return n?(m.innerHTML=n,m.innerText):""});function p(t){var n;t&&(t.hasChildNodes&&t.hasChildNodes()?(0,s.S6)(t.childNodes,(function(t){p(t)})):"BR"===t.nodeName||t.textContent||null===(n=t.parentElement)||void 0===n||n.removeChild(t))}},3339:function(t,n,e){"use strict";e.d(n,{Z:function(){return r}});var r=function(){function t(){}return t.GoBackToReleaseResults="GoBackToReleaseResults",t.GoBackToAnalysis="GoBackToAnalysis",t.ByStudent={View:"Student",Index:0,GoBackToView:t.GoBackToAnalysis},t.ByQuestion={View:"Question",Index:0,GoBackToView:t.GoBackToAnalysis},t}()},78688:function(t,n,e){"use strict";e.d(n,{tE:function(){return r}});e(36215),e(26203);function r(){var t=document.getElementById("grading-by-people-tab");return!!t&&"true"===t.getAttribute("aria-selected")}},94605:function(t,n,e){"use strict";e.d(n,{G:function(){return h}});var r=e(59312),i=e(72377),o=e(26203),s=e(39923),u=e(10836),a=e(73293),c=e(25366),l=e(72374),f={TargetQuestionId:s.J4.string(),ToTheEnd:s.J4.boolean()},h=function(t){function n(e){var r=t.call(this,e)||this;return r.Ht=!1,r.jt=!1,r.$t="",r.Wt=function(t){return r.Jt()},e.MasterTreeReady.then((function(){r.Deleted||(n.normalize(r,{},!1),r.addRule({Name:"normalize",onChange:function(t){n.normalize(r,t.OldValues,!0)}}),r.observe((function(t){r.Deleted||r.Kt()})))})),r}(0,r.ZT)(n,t);var e=n.prototype;return e.getElementMaster=function(){var t=this.Parent;do{if(t instanceof l.MF||t instanceof a.Jv)return t}while(t=t.Parent);return null},e.getTargetElementMaster=function(){if(this.Deleted)return null;var t=this.getElementMaster().Form.FormElementManager;if(!this.Model.TargetQuestionId)return null;var n=t.getElementMasterById(this.Model.TargetQuestionId);return n&&n.Deleted?null:n?(c.H.isSection(n.Model.Type)||t.findContainerSection(this.getElementMaster())===t.findContainerSection(n))&&n:n},e.resetToDefault=function(){var t=this;this.Ht=!1,this.bulkEdit((function(){t.Model.ToTheEnd=null,t.Model.TargetQuestionId=null}))},e.isDefault=function(){return!this.Model.ToTheEnd&&!this.Model.TargetQuestionId},e.getBranchingResult=function(){var t=this.Model;return this.isValid()?t.ToTheEnd?{Type:"End"}:{Type:"Specified",TargetElement:this.getTargetElementMaster()}:{Type:"Next"}},e.hasSectionBranching=function(){var t=this.getElementMaster(),n=this.getTargetElementMaster();return c.H.isSection(t.Model.Type)||n&&c.H.isSection(n.Model.Type)},n.normalize=function(t,n,e){var r=t.Model;r.ToTheEnd?n.ToTheEnd&&r.TargetQuestionId||(r.TargetQuestionId=null):r.ToTheEnd=null,e&&t.Xt()},e.isValid=function(){return this.Ht&&this.$t===this.Model.TargetQuestionId||(this.Xt(),this.Kt()),this.jt},e.Xt=function(){this.Ht=!0,this.$t=this.Model.TargetQuestionId,this.jt=!(!this.Model.ToTheEnd&&!this.getTargetElementMaster());var t=this.Model.TargetQuestionId;!this.jt&&t&&(0,u.M0)()&&(this.jt=i.Pv.Resolve("IIncrementalLoadStrategy").has(t))},e.Kt=function(){var t=this.getTargetElementMaster(),n=this.Yt;t!==n&&((n instanceof l.MF||n instanceof a.Jv)&&n.unobserve(this.Wt),this.Yt=t,(t instanceof l.MF||t instanceof a.Jv)&&t.observe(this.Wt))},e.Jt=function(){if(this.Yt.Deleted)this.Model.TargetQuestionId=null;else if(this.Yt instanceof l.MF){var t=this.getElementMaster().Form.FormElementManager;t.findContainerSection(this.getElementMaster())!==t.findContainerSection(this.Yt)&&(this.Model.TargetQuestionId=null)}},n}(o.d.createObjectMasterClass("BranchInfoMaster",f))},22707:function(t,n,e){"use strict";e.d(n,{cV:function(){return p},kR:function(){return g},Ai:function(){return b},yH:function(){return w}});var r=e(59312),i=e(36215),o=e(10836),s=e(94978),u=e(26203),a=e(41293),c=e(55411),l=e(7645),f=e(64290),h=e(85866),d=e(9743),m=e(67661),v=e(81380),p=function(){function t(t,n){if(this.Zt=t,this.Lt=(0,v.lK)(t),this.Lt){var e=this.Lt.getDesignForm;switch(this.Zt.SyncContext){case d.y.SharedTimeForm:e=this.Lt.getSharedForm;break;case d.y.ResponseTimeForm:e=this.Lt.getRuntimeForm;break;case d.y.AnalysisTimeForm:e=this.Lt.getAnalysisTimeForm;break;case d.y.ResponseDetailTimeForm:e=this.Lt.getResponseDetailRuntimeForm;break;case d.y.AdminPhishingReviewForm:e=this.Lt.getAdminPhishingReviewForm}this.tn=e.bind(this.Lt)}}var n=t.prototype;return n.add=function(t){return this.Zt.SyncContext===d.y.LocalForm?new Promise((function(){})):this.Zt.SyncContext===d.y.DesignTimeForm?this.Lt.createForm(t):void(0,a._y)("Trying to create a form without design type.")},n.delete=function(t){var n=this;if(this.Zt.SyncContext===d.y.DesignTimeForm)return this.nn(),(0,f.md)((function(){return!0}))?this.Zt.ensureFieldsReady([m.x.Schema.BusinessCdsId,m.x.Schema.BusinessCdsRegion]).then((function(){return n.Lt.deleteForm(n.Zt.Model.Id,n.Zt.Model.BusinessCdsId,n.Zt.Model.BusinessCdsRegion)})):this.Lt.deleteForm(this.Zt.Model.Id);(0,a._y)("Trying to delete a form without design type.")},n.query=function(t){var n=this;if((0,f.md)((function(){return!0}))&&this.Zt.IsSampleForm)return Promise.resolve(null);if(!this.tn){return Promise.reject({innerCode:1001,type:"ExpectedFailure"})}var e=this.Zt.isFieldReady(this.Zt.Schema.Flags)&&g(this.Zt.Model.Flags),o=this.rn(e),s=this.sn(t,o);return Promise.all(s).then((function(t){return i.extend.apply(i,(0,r.ev)([{}],t))})).then((function(e){var r=u.d.getFieldSchemaInfo(n.Zt.Schema.Flags).Attributes.SourceFieldName;return t.indexOf(r)>=0&&!g(e.flags)&&(e.archivedRowCount=0),e}))},n.update=function(t){if(!(0,f.md)((function(){return!0}))||!this.Zt.IsSampleForm){if(this.Zt.SyncContext===d.y.LocalForm)return new Promise((function(){}));if(this.Zt.SyncContext!==d.y.DesignTimeForm)return Promise.resolve();var n=u.d.getFieldSchemaInfo(m.x.Schema.SoftDeleted).Attributes.SourceFieldName;if(n in t)t[n]===h.d.SoftDeleted&&this.nn();else if(this.Zt.isFieldReady(m.x.Schema.SoftDeleted)&&this.Zt.Model.SoftDeleted===h.d.SoftDeleted)return Promise.resolve();return""!==t.title||(0,c.y)()||(t.title=(0,l.pm)().Designer_DefaultFormTitle),this.Lt.updateForm(this.Zt.Model.Id,t)}},n.sn=function(t,n){var e=[],r=new Set;t.forEach((function(t){n.hasOwnProperty(t)?r.add(n[t]):e.push(t)}));var i=[];return e.length&&i.push(this.tn(this.Zt.Model.Id,e)),r.forEach((function(t){return i.push(t())})),i},n.rn=function(t){var n=this,e={localizedResources:function(){if(!(0,c.sv)())return n.Zt.getAllLocaleResources()}};if(t){e.archivedRowCount=function(){return n.Lt.getArchiveAndActiveResponseCount({$formId:n.Zt.Model.Id}).then((function(t){return{rowCount:t.active,archivedRowCount:t.archive}}))}}return e},n.nn=function(){var t=this;return this.Lt.removeRecentForm(this.Zt.Model.Id).then((function(){var n=Forms.Mru.MruDocumentCollectionMaster.getInstance();n&&n.removeDocument(t.Zt.Model.Id)}))},t}();function g(t){return(128&t)>0}function b(t){return(64&t)>0}function w(t,n){return g(n)||(0,o.cr)("WarmToCold")&&t&&t.Model.TotalResponseCount>(0,s.vj)("FormResponsesQuota",5e4)}},81380:function(t,n,e){"use strict";e.d(n,{qU:function(){return f},Cs:function(){return h},Mv:function(){return d},lK:function(){return p},o7:function(){return g},lb:function(){return b},rl:function(){return w},GI:function(){return y},zg:function(){return I},tx:function(){return S},Ah:function(){return C},Ol:function(){return F}});var r=e(26203),i=e(37076),o=e(70699),s=e(41448),u=e(64290),a=e(55890),c=e(67661),l=e(96680);function f(t,n,e){var i=F(t);i.push("status");var o=r.d.getFieldSchemaInfo(c.x.Schema.Version).Attributes.SourceFieldName;i.indexOf(o)&&i.push(o);var u=4,l=null,f=null;n&&(l=n.OwnerTenantId,f=n.OwnerId,u=n.IsGroupForm?3:2);var h=s.VY.getInstance().createDataProvider(u,l,f);return h.getForms(i,e).then((function(t){var n=[],e=0,i=[];return t.forEach((function(t){if("Deleted"===t.status)++e,h.deleteForm(t.id);else if(t.version){var o=r.d.convertFromSourceData(t,c.x.Schema);i.push(o)}else n.push(t.id)})),(n.length||e)&&(0,a.$U)("PortalPage.FilteredOutForms",{deletedFormCount:e,oldVersionForms:n}),i}))}function h(){return s.VY.getInstance().createDataProvider().getFormsResponseCount()}function d(){return(0,u.pd)(m,v)}function m(){return s.VY.getInstance().createDataProvider(4).getFormsSharedWithCurrentUser().then((function(t){return t.map((function(t){return r.d.convertFromSourceData(t,c.x.Schema)}))}))}function v(){var t=s.VY.getInstance().createDataProvider(4),n=null;return new Promise((function(e,i){t.getFormsSharedWithCurrentUserPro(!1).then((function(i){n=i.Forms.map((function(t){return r.d.convertFromSourceData(t,c.x.Schema)}));var s=i.TotalFormCount/parseInt((0,o.NA)())-1,u=1;if(!(i.TotalFormCount>parseInt((0,o.NA)())))return e(n);for(;s>0;){var a=t.getFormsSharedWithCurrentUserPro(!0,u*parseInt((0,o.NA)()));u++,s--,a.then((function(t){if((n=n.concat(t.Forms.map((function(t){return r.d.convertFromSourceData(t,c.x.Schema)})))).length===i.TotalFormCount)return e(n)}))}}))}))}function p(t){if(!t.isFieldReady(c.x.Schema.OwnerTenantId)||!t.isFieldReady(c.x.Schema.OwnerId))return s.VY.getInstance().createDataProvider();var n=1;if(t.IsGroupForm)n=3;else{if(!t.Model.OwnerTenantId||!t.Model.OwnerId)return null;n=2}return s.VY.getInstance().createDataProvider(n,t.Model.OwnerTenantId,t.Model.OwnerId)}function g(t){var n=(0,i.kc)(t),e=1;return n.IsGroupOwner?e=3:n.OrgId&&n.OwnerId&&(e=2),s.VY.getInstance().createDataProvider(e,n.OrgId,n.OwnerId)}function b(t,n,e){return p(t).downloadExcelFile(t.Model.Id,n,e)}function w(t){return(0,a.$U)("DesignPage.ResponseCount.Get"),p(t).getFormResponseCount(t.Model.Id)}function y(t,n){return g(t).getAnalysisSurveyData(t,n)}function I(t){return g(t).getAnalysisQuizData(t)}function S(t){return g(t).getResultSharingAnalysisSurveyData(t)}function C(t){return g(t).getResultSharingAnalysisQuizData(t)}function F(t){return(0,l.sQ)(t||r.d.getSubFieldSchemas(c.x.Schema)).map((function(t){var n=r.d.getFieldSchemaInfo(t);if(!n.Attributes.IsLocalField)return n.Attributes.SourceFieldName||n.Name})).filter((function(t){return t}))}},82963:function(t,n,e){"use strict";e.d(n,{qs:function(){return c},aj:function(){return l},Lu:function(){return f},_n:function(){return h},Od:function(){return d},mt:function(){return m},q4:function(){return v}});var r=e(36215),i=e(43209),o=e(26203),s=e(41275),u=e(81380),a="0001-01-01T00:00:00Z";function c(t,n){var e=r.map(n.Answers,(function(t){return{questionId:t.QuestionId,answer1:t.Answer}})),i={answers:JSON.stringify(e),startDate:n.StartDate instanceof Date?n.StartDate.toISOString():"",submitDate:n.SubmitDate instanceof Date?n.SubmitDate.toISOString():""};return i.emailReceiptConsent=n.EmailReceiptConsent,i.submitLanguage=n.SubmitLanguage,n.Responder&&(i.responder=n.Responder,i.responderName=n.ResponderName),(0,u.lK)(t).submitFormResponse(t.Model.Id,i)}function l(t,n,e,r){return(0,u.lK)(t).getFormResponses(t.Model.Id,r,n,e).then((function(t){return t.map(p)}))}function f(t){return(0,u.lK)(t).getRuntimeResponses(t.Model.Id).then((function(t){return t.map(p)}))}function h(t){return(0,u.lK)(t).deleteFormResponses(t.Model.Id)}function d(t,n){var e,r,o=null===(r=null===(e=window.FormPrefetchCache)||void 0===e?void 0:e.responseCache)||void 0===r?void 0:r.data;return("Response"===(0,i.C2)()&&o?Promise.resolve(o.value):(0,u.lK)(t).getRuntimeResponses(t.Model.Id,n)).then((function(t){return t.filter((function(t){return t.releaseDate!==a})).map(p)}))}function m(t,n){return(0,u.lK)(t).getRuntimeResponse(t.Model.Id,n).then(p)}function v(t,n){var e=(0,u.o7)(t);return Promise.all(n.map((function(n){return e.deleteFormResponse(t,n)})))}function p(t){var n=o.d.convertFromSourceData(t,s.KJ.Schema);void 0!==n.StartDateAsString&&(n.StartDate=new Date(n.StartDateAsString)),void 0!==n.SubmitDateAsString&&(n.SubmitDate=new Date(n.SubmitDateAsString)),void 0!==n.ReleaseDateAsString&&(null===n.ReleaseDateAsString?n.ReleaseDate=new Date(a):n.ReleaseDate=new Date(n.ReleaseDateAsString));var e=[];if(n.AnswersAsString&&(e=JSON.parse(n.AnswersAsString).map((function(t){return{Answer:t.answer1,QuestionId:t.questionId}})),n.Answers=e),n.Comments){var i={},u=[];r.forEach(n.Comments,(function(t){var n=t.QuestionId||"___";i[n]&&u.push(i[n]),i[n]=t})),n.Comments=r.difference(n.Comments,u)}if(n.Comments){var c={};e.forEach((function(t){return c[t.QuestionId]=t})),r.forEach(n.Comments,(function(t){var r=t.QuestionId;if(r){var i=c[r];i||(i={Answer:null,QuestionId:r},e.push(i),c[r]=i),i.Feedback=t.Feedback,i.Score=t.Score}else n.Feedback=t.Feedback,n.TotalScore=t.Score}))}return n}},94956:function(t,n,e){"use strict";e.d(n,{b:function(){return o}});var r=e(94290),i=e(37890),o=function(){function t(t,n,e){var i=this;void 0===n&&(n=1e3),void 0===e&&(e=5e3),this.cn=Number.MAX_VALUE,n=null!=n?n:1e3,e=null!=e?e:5e3,(0,r.mF)()?this.ln=n:this.ln=4*n,this.fn=4*e,this.hn=function(){var t=i.dn();t&&t.resolve()}}var n=t.prototype;return n.scheduleUpdate=function(){return this.mn&&console.warn("Calling scheduleUpdate() before the previous one is resolved."),this.mn=new i.wU,this.vn=window.setTimeout(this.hn,this.ln),this.wn=window.setTimeout(this.hn,this.fn),this.mn.promise()},n.postponeUpdate=function(){this.mn||console.warn("Calling postponeUpdate() before update scheduled."),this.vn&&window.clearTimeout(this.vn),this.vn=window.setTimeout(this.hn,this.ln)},n.cancelUpdate=function(){var t;null===(t=this.dn())||void 0===t||t.reject()},n.setMaxRetryTimesForUpdate=function(t){this.cn=t},n.dn=function(){window.clearTimeout(this.vn),this.vn=void 0,window.clearTimeout(this.wn),this.wn=void 0;var t=this.mn;return this.mn=void 0,t},n.retryForCreation=function(t){return t<3?Promise.resolve():Promise.reject("Retry times exceeded.")},n.retryForUpdate=function(t){var n=this;if(t>=this.cn)return Promise.reject("times >= this.maxRetryTimesForUpdate");var e=u;t<a&&(e=s*Math.pow(2,t));var r=new i.wU;return this.yn=window.setTimeout((function(){n.yn=void 0,r.resolve()}),e),r.promise()},n.cancelRetryForUpdate=function(){window.clearTimeout(this.yn),this.yn=void 0},t}(),s=2500,u=6e5,a=Math.log(u/s)/Math.log(2)},86415:function(t,n,e){"use strict";e.d(n,{k:function(){return p},I:function(){return v}});var r=e(59312),i=e(26203),o=e(39923),s=e(94956),u=e(82205),a=e(55890),c=e(41293),l=e(78688),f=e(81380),h=e(9743),d=function(){function t(t,n){this.In=t,this.Lt=(0,f.lK)(this.In.Response.Form)}var n=t.prototype;return Object.defineProperty(n,"FormId",{get:function(){return this.In.FormId},enumerable:!1,configurable:!0}),Object.defineProperty(n,"ResponseId",{get:function(){return this.In.ResponseId},enumerable:!1,configurable:!0}),n.Sn=function(){var n=this;return new Promise((function(e,r){t.responsePromiseObjCacheMap.set(n.ResponseId,{resolve:e,reject:r});void 0===t.timerID&&0!==t.comments.length&&(t.timerID=window.setTimeout((function(){if(t.timerID=void 0,1===t.comments.length){var i=t.comments[0];t.comments=[],n.Lt.addFormResponseComment(n.FormId,n.ResponseId,i).then((function(t){e(t)}),r)}else{var o=t.comments.map((function(t){return t}));t.comments=[],n.Lt.addFormResponseComments(n.FormId,o).then((function(n){for(var e=0,r=n;e<r.length;e++){var i=r[e],o=t.responsePromiseObjCacheMap.get(i.responseId);t.responsePromiseObjCacheMap.delete(i.responseId),o.resolve(i)}}),(function(n){t.responsePromiseObjCacheMap.forEach((function(t,e,r){t.reject(n)}))}))}}),500))}))},n.add=function(n,e,r){return(0,l.tE)()?this.Lt.addFormResponseComment(this.FormId,this.ResponseId,e.Snapshot):(e.Snapshot.responseId=this.ResponseId,t.comments.push(e.Snapshot),this.Sn())},n.delete=function(t){return new Promise((function(){}))},n.query=function(t){return(0,c._y)("No scenario to call this method currently.")},n.update=function(t,n){var e=this.In.Response.Form.SyncContext;return e!==h.y.DesignTimeForm&&e!==h.y.AnalysisTimeForm?new Promise((function(){})):this.add(t,n,!0)},t.comments=new Array,t.responsePromiseObjCacheMap=new Map,t}(),m={QuestionId:o.J4.string({IsKeyField:!0,SourceFieldName:"questionId"}),Id:o.J4.number({SourceFieldName:"id"}),Feedback:o.J4.string({SourceFieldName:"feedback"}),Score:o.J4.number({SourceFieldName:"score"}),SavingState:o.J4.reference({IsLocalField:!0})};function v(t){return i.d.getObjectMasterFromModel(t)}var p=function(t){function n(e){var r=t.call(this,e,{Scheduler:new s.b(n.name)})||this;return(0,u.vG)(r),r.observe(g),r.Synchronizer.observe(n.checkCommentUpdateError,[r.Synchronizer.Schema.UpdateError]),r}(0,r.ZT)(n,t);var e=n.prototype;return n.setUpdateErrorCallback=function(t){n.updateErrorCallback=t},n.resetUpdateErrorCallback=function(){n.updateErrorCallback=null},Object.defineProperty(e,"Response",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(e,"FormId",{get:function(){return this.Response.FormId},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ResponseId",{get:function(){return this.Response.ResponseId},enumerable:!1,configurable:!0}),n.checkCommentUpdateError=function(t){n.updateErrorCallback&&t.Master&&t.Master.Schema.UpdateError&&n.updateErrorCallback(t.Master.Model.UpdateError,t.Master.getInstanceId())},n}(i.d.createObjectMasterClass("Comment",m,(function(t,n){return new d(t,n)})));function g(t){if(t.BeingDeleted&&t.Master.Synchronizer.Model.UpdateScheduled)try{throw Error("DeletingComment")}catch(t){(0,a.zU)("ModelError",t.stack)}}},73293:function(t,n,e){"use strict";e.d(n,{Jv:function(){return T},PQ:function(){return N}});var r=e(59312),i=e(36215),o=e(41480),s=e(15934),u=e(37890),a=e(26203),c=e(39923),l=e(72467),f=e(1014),h=e(46008),d=e(55890),m=e(94605),v=e(94956),p=e(90819),g=e(3920),b=e(81380),w=e(9743),y=function(){function t(t,n){this.Cn=t,this.Lt=(0,b.lK)(this.Cn.Form)}var n=t.prototype;return Object.defineProperty(n,"FormId",{get:function(){return this.Cn.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(n,"ElementId",{get:function(){return this.Cn.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(n,"ElementType",{get:function(){return this.Cn.Model.Type},enumerable:!1,configurable:!0}),Object.defineProperty(n,"ExtraQosData",{get:function(){var t=this.Cn.Form;return{WithSection:t.isFieldReady(t.Schema.DescriptiveElements)&&!!t.FormElementManager.SectionMasters.length}},enumerable:!1,configurable:!0}),n.add=function(t){var n=this;if(this.Cn.Form.SyncContext!==w.y.DesignTimeForm)throw Error("Trying to create an element without design type.");return this.Cn.createSyncJob((function(){return n.Lt.createFormDescriptiveElement(n.FormId,t,n.ExtraQosData)}))},n.delete=function(t){var n=this;if(!t||!t.id)throw Error("Trying to delete an empty element.");if(this.Cn.Form.SyncContext!==w.y.DesignTimeForm)throw Error("Trying to delete an element without design type.");return this.Cn.createSyncJob((function(){return n.Lt.deleteFormDescriptiveElement(n.FormId,t.id||"",n.ElementType,n.ExtraQosData)})).then(null,(function(t){if(t&&621===t.innerCode)return Promise.resolve();throw t}))},n.query=function(t){throw Error("No scenario to call this method currently.")},n.update=function(t,n){var e=this;return this.Cn.Form.SyncContext!==w.y.DesignTimeForm?Promise.resolve():this.Cn.createUploadSyncJob((function(){return e.Lt.updateFormDescriptiveElement(e.FormId,e.ElementId,e.ElementType,t,e.ExtraQosData)}))},t}(),I=e(53907),S=e(62539),C=e(82205),F={BranchInfo:c.J4.fromMasterClass((function(){return m.G}),{IsLocalField:!0}),CoAuthors:c.J4.collectionOf(c.J4.reference(),{IsLocalField:!0}),FileUploadSPOInfo:c.J4.create({anonymousLinkInfo:c.J4.string(),driveId:c.J4.string(),errorCode:c.J4.string(),folderId:c.J4.string(),linkInfo:c.J4.string()},{SourceFieldName:"fileUploadSPOInfo"}),FormsProRTQuestionTitle:c.J4.string({SourceFieldName:"formsProRTQuestionTitle"}),FormsProRTSubtitle:c.J4.string({SourceFieldName:"formsProRTSubtitle"}),Id:c.J4.string({IsKeyField:!0,SourceFieldName:"id"}),ImageInfo:c.J4.fromMasterClass(l.Cu,{SourceFieldName:"image"}),ImageSettings:c.J4.fromMasterClass(l.BF,{IsLocalField:!0}),IntegratedSavingState:c.J4.reference({IsLocalField:!0}),Order:c.J4.number({SourceFieldName:"order"}),QuestionInfo:c.J4.string({SourceFieldName:"questionInfo"}),SavingState:c.J4.reference({IsLocalField:!0}),ShowSubtitle:c.J4.boolean({IsLocalField:!0}),Subtitle:c.J4.string({SourceFieldName:"subtitle"}),Title:c.J4.string({SourceFieldName:"title"}),Type:c.J4.reference({SourceFieldName:"type"}),Hidden:c.J4.boolean({IsLocalField:!0}),Visible:c.J4.boolean({IsLocalField:!0}),VideoInfo:c.J4.create({Author:c.J4.string(),OriginalHeight:c.J4.number(),OriginalWidth:c.J4.number(),ShowWarningBar:c.J4.boolean(),Thumbnail_url:c.J4.string(),Title:c.J4.string(),Url:c.J4.string()},{IsLocalField:!0})};function N(t){return a.d.getObjectMasterFromModel(t)}var T=function(t){function n(e){var r=this,o=new u.wU;if(!e.InitialData)throw Error("Element model should created with initial data.");return(e=i.clone(e)).InitialData=i.clone(e.InitialData),e.InitialData.FormsProRTQuestionTitle||(e.InitialData.FormsProRTQuestionTitle=null),e.InitialData.FormsProRTSubtitle||(e.InitialData.FormsProRTSubtitle=null),r=t.call(this,e,{MasterReady:o.promise(),Scheduler:new v.b(n.name)})||this,(0,C.vG)(r),r.Fn(),r.Nn(e),(0,g.CU)(r,n.Schema.ImageInfo,n.Schema.ImageSettings),n.Rules.forEach((function(t){return r.addRule(t)})),r.Tn={},o.resolve(),r}(0,r.ZT)(n,t);var e=n.prototype;return n.supportMobileDesign=function(t){return!1},Object.defineProperty(e,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ImageInfoMaster",{get:function(){return(0,p.rQ)(this.Model.ImageInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ImageSettingsMaster",{get:function(){return(0,g.Hi)(this.Model.ImageSettings)},enumerable:!1,configurable:!0}),e.isFieldReady=function(e){return e=n.getSourceFields([e])[0],t.prototype.isFieldReady.call(this,e)},e.ensureFieldsReady=function(e){return t.prototype.ensureFieldsReady.call(this,n.getSourceFields(e))},e.fieldsReady=function(e){return t.prototype.fieldsReady.call(this,n.getSourceFields(e))},e.ensureCreationDone=function(){var t=this;return this.ImageInfoMaster.Synchronizer.flush().then((function(){return t.Synchronizer.flush()}))},e.setVideoUrl=function(t,e){var r=this.Model.VideoInfo;a.d.getObjectMasterFromModel(r).bulkEdit((function(){r.Url=(0,f.Qn)(t,(0,o.k)()),r.Title="",r.Author="",r.Thumbnail_url="",r.OriginalWidth=n.defaultWidth,r.OriginalHeight=n.defaultHeight,r.ShowWarningBar=e&&(0,s.M4)(t)}))},e.hasValidVideoUrl=function(){return(0,h.Fp)()?this.kn()&&(0,s.eC)(this.Model.VideoInfo.Url):this.kn()&&(0,s.yk)(this.Model.VideoInfo.Url)},e.clearVideoInfo=function(){this.Model.VideoInfo={Author:"",OriginalHeight:n.defaultHeight,OriginalWidth:n.defaultWidth,ShowWarningBar:!1,Thumbnail_url:"",Title:"",Url:""}},e.resetBranchInfo=function(){n.getBranchInfoMaster(this.Model.BranchInfo).resetToDefault()},e.createSyncJob=function(t){var n=this,e=new u.wU,r=e.promise().then((function(){return n.Form.getQuestionSyncBlocker(r)})).then(t);return e.resolve(),r},e.createUploadSyncJob=function(t){var n=this,e=new u.wU,r=Promise.all([e,this.xn]).then((function(){return n.createSyncJob(t)}));return e.resolve(),this.xn=(0,u.Bx)(r),r},e.updateCoAuthors=function(t){var n=this,e=i.filter(this.Model.CoAuthors,(function(n){return t.userId===n.userId}))[0],r=function(){e&&o.deleteItems([e]),t.userId in n.Tn&&(clearTimeout(n.Tn[t.userId]),delete n.Tn[t.userId])},o=a.d.getCollectionMasterFromModel(this.Model.CoAuthors);o.bulkEdit((function(){r(),e=a.d.Collection.addItems(n.Model.CoAuthors,[t])[0]}));this.Tn[t.userId]=window.setTimeout(r,1e4)},n.getBranchInfoMaster=function(t){return a.d.getObjectMasterFromModel(t)},e.Nn=function(t){this.Pn=new I.S(this,n.Schema.QuestionInfo,n.QuestionInfoFieldSet),t.InitialData&&this.isFieldReady(n.Schema.QuestionInfo)&&(t.ExistingInDataSource||t.InitialData.QuestionInfo?this.Pn.deserialize():this.Pn.serialize())},e.Fn=function(){this.isFieldReady(n.Schema.ImageInfo)?this.Model.IntegratedSavingState=(0,C.IM)([this.Model.ImageInfo.SavingState,this.Model.SavingState]):this.Model.IntegratedSavingState=this.Model.SavingState},e.kn=function(){return this.Model.VideoInfo&&this.Model.VideoInfo.Url},Object.defineProperty(n,"QuestionInfoFieldSet",{get:function(){return n.questionInfoFieldSet||(n.questionInfoFieldSet=new S.C([n.Schema.BranchInfo,n.Schema.ImageSettings,n.Schema.ShowSubtitle,n.Schema.VideoInfo,n.Schema.Hidden])),n.questionInfoFieldSet},enumerable:!1,configurable:!0}),Object.defineProperty(n,"Rules",{get:function(){if(!n.rules){var t=n.Schema;n.rules=[{InterestedFields:[t.Id],Name:"block id changes",onChange:function(t){var n,e=t.Master.Model,r=e.Id,i=t.OldValues.Id;e.Id=i;try{throw Error("Changing element id")}catch(t){n=t}(0,d.zU)("UpdatingElementId",{newId:r,oldId:i,stack:n.stack})}},{InterestedFields:[t.ImageInfo.SavingState,t.SavingState],Name:"IntegrateSavingState",onChange:function(t){return t.Master.Fn()}}]}return n.rules},enumerable:!1,configurable:!0}),n.getSourceFields=function(t){return i.uniq(t.map((function(t){return n.QuestionInfoFieldSet.covers(t)?n.Schema.QuestionInfo:t})))},n.defaultWidth=459,n.defaultHeight=256,n}(a.d.createObjectMasterClass("DescriptiveElementMaster",F,(function(t,n){return new y(t,n)})))},85866:function(t,n,e){"use strict";var r;e.d(n,{d:function(){return r}}),function(t){t[t.Normal=0]="Normal",t[t.SoftDeleted=1]="SoftDeleted"}(r||(r={}))},19930:function(t,n,e){"use strict";var r;e.d(n,{r:function(){return r}}),function(t){t[t.NotStarted=1]="NotStarted",t[t.Opened=2]="Opened",t[t.Expired=3]="Expired",t[t.Closed=4]="Closed"}(r||(r={}))},9743:function(t,n,e){"use strict";var r;e.d(n,{y:function(){return r}}),function(t){t[t.DesignTimeForm=1]="DesignTimeForm",t[t.ResponseTimeForm=2]="ResponseTimeForm",t[t.SharedTimeForm=3]="SharedTimeForm",t[t.LocalForm=4]="LocalForm",t[t.AnalysisTimeForm=5]="AnalysisTimeForm",t[t.ResponseDetailTimeForm=6]="ResponseDetailTimeForm",t[t.AdminPhishingReviewForm=7]="AdminPhishingReviewForm"}(r||(r={}))},51150:function(t,n,e){"use strict";var r;e.d(n,{E:function(){return r}}),function(t){t[t.Default=0]="Default",t[t.Shown=1]="Shown",t[t.Closed=2]="Closed"}(r||(r={}))},34212:function(t,n,e){"use strict";var r;e.d(n,{Z:function(){return r}}),function(t){t[t.None=0]="None",t[t.All=1]="All",t[t.Flip=2]="Flip",t[t.LimitedNumber=3]="LimitedNumber",t[t.Advanced=4]="Advanced"}(r||(r={}))},53907:function(t,n,e){"use strict";e.d(n,{S:function(){return o}});var r=e(26203),i=0,o=function(){function t(t,n,e){this.Dn=t,this.En=n,this.Rn=e.FieldSchemas,this.Ln()}var n=t.prototype;return n.serialize=function(){var t=this.Dn.getSnapshot(this.Rn),n=this.Dn.Schema,e={};this.Rn.forEach((function(n){var i=r.d.getFieldSchemaInfo(n).Name;e[i]=r.d.convertToSourceData(t[i],n)}));var o=r.d.getFieldSchemaInfo(this.En).Name,u=s(e,n,[]),a=u&&JSON.stringify(u),c=this.Dn.Model[o]!==a;(c||Math.random()<i)&&(c=!0,a=(u=s(e,n,null))&&JSON.stringify(u)),c&&(this.Dn.Model[o]=a)},n.deserialize=function(){var t=r.d.getFieldSchemaInfo(this.En).Name,n=this.Dn.Model[t],e=n?JSON.parse(n):{},i={};this.Rn.forEach((function(t){var n=r.d.getFieldSchemaInfo(t).Name;i[n]=r.d.convertFromSourceData(e[n],t)})),this.Dn.setData(i,this.Rn)},n.Ln=function(){var t=this,n=r.d.getFieldSchemaInfo(this.En).Name;this.Dn.addRule({Name:"Deserialize - "+n,InterestedFields:[this.En],onChange:function(n){n.BeingDeleted||t.deserialize()}}),this.Dn.addRule({Name:"Serialize - "+n,InterestedFields:this.Rn,onChange:function(n){n.BeingDeleted||t.serialize()}})},t}();function s(t,n,e){if(null==t)return null;if(Array.isArray(t)){if(t.length){var i=n[0];return t.map((function(t){return s(t,i,e)}))}return e}var o={},u=0;return r.d.getSubFieldSchemas(n).forEach((function(n){var i=r.d.getFieldSchemaInfo(n),a=i.Attributes.SourceFieldName||i.Name,c=t[a];i.IsLeaf||(c=s(c,n,e)),null!=c&&(++u,o[a]=c)})),u>0?o:null}},62539:function(t,n,e){"use strict";e.d(n,{C:function(){return s}});var r=e(36215),i=e(72420),o=e(26203),s=function(){function t(t){this.An=t.concat(),this.qn=t.map((function(t){return o.d.getFieldSchemaInfo(t).Name}))}var n=t.prototype;return Object.defineProperty(n,"FieldSchemas",{get:function(){return this.An.concat()},enumerable:!1,configurable:!0}),n.covers=function(t){return(0,i.HD)(t)?r.contains(this.qn,t):r.contains(this.An,t)},t}()},67661:function(t,n,e){"use strict";e.d(n,{x:function(){return V}});var r=e(59312),i=e(36215),o=e(64459),s=e(9947),u=e(37890),a=e(72377);var c=e(26203),l=e(39923),f=e(10836),h=e(62662),d=e(72467),m=e(64290),v=e(22707),p=e(81380),g=e(82963),b=e(94956),w=e(73293),y=e(53907),I=e(90819),S=e(3920),C=e(502),F=e(9743),N=function(){function t(t){this.Dn=t,this.Lt=(0,p.lK)(this.Dn.Form)}var n=t.prototype;return n.add=function(t){if(!t.localeId||!t.localeName||this.Dn.Form.SyncContext!==F.y.DesignTimeForm)return Promise.resolve();var n={elementKey:"localename",elementValue:t.localeName,locale:t.localeId,questionId:""};return this.Lt.createLocaleItem(this.Dn.FormId,n)},n.delete=function(t){return t.localeId&&this.Dn.Form.SyncContext===F.y.DesignTimeForm?this.Lt.deleteLocale(this.Dn.FormId,t.localeId):Promise.resolve()},n.query=function(t){throw Error("No scenario to call this method currently.")},n.update=function(t,n){if(!n.ValuesBefore||!t.localeName||this.Dn.Form.SyncContext!==F.y.DesignTimeForm)return Promise.resolve();var e=null!==n.ValuesBefore.localeName,r={elementKey:"localename",elementValue:t.localeName,locale:this.Dn.Model.localeId,questionId:null};return e?this.Lt.updateLocaleItem(this.Dn.FormId,r):this.Lt.createLocaleItem(this.Dn.FormId,r)},t}(),T={localeId:l.J4.string({IsKeyField:!0}),localeName:l.J4.string()},k=function(t){function n(e){return t.call(this,e,{Scheduler:new b.b(n.name)})||this}(0,r.ZT)(n,t);var e=n.prototype;return Object.defineProperty(e,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(e,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),n}(c.d.createObjectMasterClass("LocaleInfoMaster",T,(function(t){return new N(t)}))),x=e(91091),P=e(64966),D=e(99374),E=e(20469),R=e(41275),L=e(85866),A=e(51150),q=e(96680),O=e(74871),M=e(56647),U={Id:l.J4.string({IsSourceGenerated:!0,IsKeyField:!0,SourceFieldName:"id"}),Description:l.J4.string({SourceFieldName:"description"}),Background:l.J4.fromMasterClass(d.Cu,{SourceFieldName:"background"}),Category:l.J4.string({SourceFieldName:"category"}),Logo:l.J4.fromMasterClass(d.Cu,{SourceFieldName:"logo"}),MeetingId:l.J4.string({SourceFieldName:"meetingId"}),ModifiedDate:l.J4.string({SourceFieldName:"modifiedDate"}),CreatedDate:l.J4.string({SourceFieldName:"createdDate"}),OtherInfo:l.J4.string({SourceFieldName:"otherInfo"}),OwnerId:l.J4.string({SourceFieldName:"ownerId"}),OwnerTenantId:l.J4.string({SourceFieldName:"ownerTenantId"}),OwnerUserType:l.J4.string({SourceFieldName:"ownerUserType"}),CollectionId:l.J4.string({SourceFieldName:"collectionId"}),RowCount:l.J4.number({SourceFieldName:"rowCount"}),ArchivedRowCount:l.J4.number({SourceFieldName:"archivedRowCount"}),SharedBy:l.J4.string({SourceFieldName:"sharedBy"}),SharedFormOwnerName:l.J4.string({SourceFieldName:"ownerDisplayName"}),SharedDate:l.J4.string({SourceFieldName:"dateTimeShared"}),TableId:l.J4.string({IsSourceGenerated:!0,SourceFieldName:"tableId"}),TenantSwitches:l.J4.number({SourceFieldName:"tenantSwitches"}),PrivacyUrl:l.J4.string({SourceFieldName:"privacyUrl"}),Title:l.J4.string({SourceFieldName:"title"}),Version:l.J4.string({SourceFieldName:"version"}),XlWorkbookId:l.J4.string({SourceFieldName:"xlWorkbookId"}),XlExportingTag:l.J4.string({SourceFieldName:"xlExportingTag"}),XlFileUnsynced:l.J4.boolean({SourceFieldName:"xlFileUnSynced"}),XlUnsyncedReason:l.J4.string({SourceFieldName:"xlUnsyncedReason"}),Permissions:l.J4.collectionOf((function(){return P.LN}),{SourceFieldName:"permissions"}),ResponderPermissions:l.J4.collectionOf((function(){return E.Qq}),{SourceFieldName:"responderPermissions"}),PermissionTokens:l.J4.collectionOf((function(){return D.p}),{SourceFieldName:"permissionTokens"}),Questions:l.J4.collectionOf(d.zE,{SourceFieldName:"questions"}),DescriptiveElements:l.J4.collectionOf((function(){return w.Jv}),{SourceFieldName:"descriptiveQuestions"}),MovingToRecycleBin:l.J4.boolean({IsLocalField:!0}),FormsInsightsInfo:l.J4.string({SourceFieldName:"formsInsightsInfo"}),SoftDeleted:l.J4.enumeration((function(){return L.d}),{SourceFieldName:"softDeleted",IsNumberTypeInDataSource:!0}),BusinessCdsId:l.J4.string({SourceFieldName:"BusinessCdsId"}),BusinessCdsRegion:l.J4.string({SourceFieldName:"BusinessCdsRegion"}),IsDefaultCds:l.J4.string({SourceFieldName:"IsDefaultCds"}),LastEmbedConfig:l.J4.string({SourceFieldName:"LastEmbedConfig"}),FormsProBranchRules:l.J4.string({SourceFieldName:"FormsProBranchRules"}),MfpBranchingData:l.J4.string({SourceFieldName:"mfpBranchingData"}),CVSimplifiedBranchingSupported:l.J4.string({SourceFieldName:"cvSimplifiedBranchingSupported"}),PipesDetails:l.J4.string({SourceFieldName:"formsProConfiguredPipes"}),FormsProRTTitle:l.J4.string({SourceFieldName:"formsProRTTitle"}),FormsProRTDescription:l.J4.string({SourceFieldName:"formsProRTDescription"}),ResponseThresholdCount:l.J4.string({SourceFieldName:"responseThresholdCount"}),InviteExpiryDays:l.J4.string({SourceFieldName:"inviteExpiryDays"}),FormsProEmbedCode:l.J4.string({SourceFieldName:"formsProEmbedCode"}),FormsProAnswerTagMap:l.J4.collectionOf({name:l.J4.string(),value:l.J4.string(),questionId:l.J4.string()},{IsLocalField:!0}),FormsProAnswerTagMapRT:l.J4.collectionOf({name:l.J4.string(),value:l.J4.string()},{IsLocalField:!0}),FooterText:l.J4.string({SourceFieldName:"footerText"}),ConditionalThankyouMessage:l.J4.string({SourceFieldName:"conditionalThankyouMessage"}),CVDefaultLanguage:l.J4.string({SourceFieldName:"cvDefaultLanguage"}),CustomCssFileName:l.J4.string({SourceFieldName:"customCssFileName"}),CustomDomainSenderEmail:l.J4.string({SourceFieldName:"customDomainSenderEmail"}),ProjectId:l.J4.string({SourceFieldName:"projectId"}),InitialFormId:l.J4.string({SourceFieldName:"initialFormId"}),InitialFormOwnerId:l.J4.string({SourceFieldName:"initialFormOwnerId"}),SurveyFont:l.J4.string({SourceFieldName:"surveyFont"}),HeaderFont:l.J4.string({SourceFieldName:"headerFont"}),Alias:l.J4.string({SourceFieldName:"alias"}),ShortUrl:l.J4.string({SourceFieldName:"shortUrl"}),ProjectName:l.J4.string({SourceFieldName:"projectName"}),ProjectGroupId:l.J4.string({SourceFieldName:"projectGroupId"}),FileUploadStorage:l.J4.string({SourceFieldName:"fileUploadStorage"}),SurveyPermanentId:l.J4.string({SourceFieldName:"surveyPermanentId"}),EmailTemplatesMapping:l.J4.string({SourceFieldName:"emailTemplatesMapping"}),SurveyLastModifiedAt:l.J4.string({SourceFieldName:"surveyLastModifiedAt"}),HeaderEnabled:l.J4.string({SourceFieldName:"headerEnabled"}),HeaderBGImage:l.J4.fromMasterClass(d.Cu,{SourceFieldName:"header"}),HeaderTheme:l.J4.fromMasterClass((function(){return a.Pv.Resolve("ICVMixin").getMixinHeaderThemeMaster()}),{IsLocalField:!0}),BackGroundPositionX:l.J4.string({IsLocalField:!0}),BackGroundPositionY:l.J4.string({IsLocalField:!0}),BackGroundPositionZ:l.J4.string({IsLocalField:!0}),ThemeHeaderBackgroundImageURL:l.J4.string({IsLocalField:!0}),LogoPositionX:l.J4.string({IsLocalField:!0}),LogoPositionY:l.J4.string({IsLocalField:!0}),TitlePositionX:l.J4.string({IsLocalField:!0}),TitlePositionY:l.J4.string({IsLocalField:!0}),LogoSize:l.J4.string({IsLocalField:!0}),HeaderImageFocalPointEnabled:l.J4.string({IsLocalField:!0}),HeaderOtherInfo:l.J4.string({SourceFieldName:"headerOtherInfo"}),HeaderAltText:l.J4.string({SourceFieldName:"headerAltText"}),CustomCSSInLineHeaderToggle:l.J4.string({SourceFieldName:"customCSSInLineHeaderToggle"}),FlowTemplateId:l.J4.string({SourceFieldName:"flowTemplateId"}),InvitesCoolingPeriod:l.J4.number({SourceFieldName:"invitesCoolingPeriod"}),OverSurveySettingEnabled:l.J4.boolean({SourceFieldName:"overSurveySettingEnabled"}),TrackingId:l.J4.string({SourceFieldName:"trackingId"}),ThankYouMessage:l.J4.string({SourceFieldName:"thankYouMessage"}),EmailReceiptEnabled:l.J4.boolean({SourceFieldName:"emailReceiptEnabled"}),Flags:l.J4.number({SourceFieldName:"flags"}),Type:l.J4.reference({SourceFieldName:"type"}),ReputationTier:l.J4.number({SourceFieldName:"reputationTier"}),BufferResponses:l.J4.collectionOf(l.J4.reference({},(function(t){return t.Id.toString()})),{IsLocalField:!0}),CoAuthors:l.J4.collectionOf(l.J4.reference(),{IsLocalField:!0}),DeleteCollaborationPermission:l.J4.boolean({IsLocalField:!0}),LastSyncTime:l.J4.number({IsLocalField:!0}),RtcStatus:l.J4.number({IsLocalField:!0}),HasValidBranching:l.J4.boolean({IsLocalField:!0}),HasQuestionMedia:l.J4.boolean({IsLocalField:!0}),Created:l.J4.string({IsLocalField:!0}),Modified:l.J4.string({IsLocalField:!0}),PredefinedResponses:l.J4.collectionOf({Id:l.J4.number({IsKeyField:!0}),Answers:l.J4.collectionOf({QuestionId:l.J4.string(),Answer:l.J4.reference()})},{IsLocalField:!0}),PrimaryCustomizedThemeColor:l.J4.string({IsLocalField:!0}),QuizQuestionsCount:l.J4.number({IsLocalField:!0}),SecondaryCustomizedThemeColor:l.J4.string({IsLocalField:!0}),Responses:l.J4.collectionOf(l.J4.reference({},(function(t){return t.Id.toString()})),{IsLocalField:!0}),ResponsesCount:l.J4.number({IsLocalField:!0}),XlExportingLocalTag:l.J4.string({IsLocalField:!0}),SerializedSettings:l.J4.string({SourceFieldName:"settings"}),Settings:l.J4.fromMasterClass((function(){return O.w}),{IsLocalField:!0}),SerializedPredefinedResponses:l.J4.string({SourceFieldName:"predefinedResponses"}),TertiaryCustomizedThemeColor:l.J4.string({IsLocalField:!0}),Theme:l.J4.fromMasterClass((function(){return M.I}),{IsLocalField:!0}),ResponseModels:l.J4.collectionOf((function(){return R.KJ}),{IsLocalField:!0}),IntegratedSavingState:l.J4.reference({IsLocalField:!0}),SavingState:l.J4.reference({IsLocalField:!0}),LogoInfo:l.J4.fromMasterClass(d.BF,{IsLocalField:!0}),CreatedFromOneDrive:l.J4.boolean({IsLocalField:!0}),TemplateId:l.J4.string({IsLocalField:!0}),TransferInProgress:l.J4.boolean({IsLocalField:!0}),DataClassificationLabel:l.J4.string(),DefaultLanguage:l.J4.string({SourceFieldName:"defaultLanguage"}),LocaleList:l.J4.collectionOf((function(){return k}),{SourceFieldName:"localeList"}),LocalizedResources:l.J4.collectionOf((function(){return C.k}),{SourceFieldName:"localizedResources"}),CreatedBy:l.J4.string({SourceFieldName:"createdBy"}),FileUploadFormInfo:l.J4.create({errorCode:l.J4.string()},{SourceFieldName:"fileUploadFormInfo"}),ProgressBarEnabled:l.J4.string({SourceFieldName:"progressBarEnabled"}),YouTubeMessageBarState:l.J4.enumeration((function(){return A.E}),{IsLocalField:!0}),QuizPreviousResponsesCount:l.J4.number({IsLocalField:!0}),NotifiedAdminForApproval:l.J4.boolean({IsLocalField:!0}),SupportedQuestionType:l.J4.reference({IsLocalField:!0})},V=function(t){function n(e,r,i,o,s,a){void 0===o&&(o=!1);var c=this,l=new u.wU;r=(0,q.xO)(r),(c=t.call(this,r,{Scheduler:new b.b(n.name),MasterReady:l.promise()})||this).initializing=l,c.syncBlocker=s?new u.bC(s):c.initializing,c.isGroupForm=i,c.On=o,c.Vn=e,c.Gn=a;var f=(0,d.mp)();return c.formElementManager=new f(c),c.Bn(r),(0,m.md)((function(){c.initializeHeaderOtherInfoBinder(r)})),c.Hn(r),c.jn(r),n.Rules.forEach((function(t){return c.addRule(t)})),c.$n(),c}(0,r.ZT)(n,t);var e=n.prototype;return e.getSyncBlocker=function(){return this.syncBlocker},Object.defineProperty(e,"IsGroupForm",{get:function(){return this.isGroupForm},enumerable:!1,configurable:!0}),Object.defineProperty(e,"IsSampleForm",{get:function(){return this.On},enumerable:!1,configurable:!0}),Object.defineProperty(e,"IsAssignmentForm",{get:function(){return!!this.isFieldReady(this.Schema.Category)&&"assignments"===this.Model.Category},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SyncContext",{get:function(){return this.Vn},enumerable:!1,configurable:!0}),Object.defineProperty(e,"FormElementManager",{get:function(){return this.formElementManager},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SettingMaster",{get:function(){return c.d.getObjectMasterFromModel(this.Model.Settings)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ThemeMaster",{get:function(){return c.d.getObjectMasterFromModel(this.Model.Theme)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"HeaderThemeMaster",{get:function(){return c.d.getObjectMasterFromModel(this.Model.HeaderTheme)},enumerable:!1,configurable:!0}),e.getRelatedSourceFields=function(t){return(0,q.sQ)(t)},e.getImageMaster=function(t){return(0,I.rQ)(this.getModelByFieldSchema(t))},e.getImageSettingsMaster=function(t){return(0,S.Hi)(this.getModelByFieldSchema(t))},e.getQuestionById=function(t){return this.formElementManager.getQuestionById(t)},e.getElementById=function(t){return this.formElementManager.getElementMasterById(t)},e.getReleasedResponsesByResponder=function(t){var n=this;return t&&!this.SettingMaster.Model.IsAnonymous?(0,g.Od)(this,t).then((function(t){return(0,f.M0)()?n.Gn.normalizeResponses(t):n.normalizeResponses(t)})):Promise.resolve(null)},e.getRuntimeResponse=function(t){var n=this;return t?(0,g.mt)(this,t).then((function(t){return n.Wn(t)})):Promise.resolve(null)},e.ensureReadyToResponse=function(){return this.ensureFieldsReady((0,q.Co)())},e.ensureReadyToShare=function(){return this.ensureFieldsReady((0,q.ez)())},e.getDefaultResponse=function(){var t={};return(0,h.Es)()&&i.forEach(this.Model.Questions,(function(n){return t[n.Id]=n.DefaultValue})),t},e.hasSection=function(){return this.FormElementManager.SectionMasters.length>0},e.syncRuntimeResponses=function(){var t=this;return this.Synchronizer.existingInDataSource().then((function(){return(0,g.Lu)(t)})).then((function(n){t.updatingResponsesFromServer=!0,t.bulkEdit((function(){return t.Model.Responses=t.normalizeResponses(n)})),t.updatingResponsesFromServer=!1}))},e.submitResponse=function(t){var n=this;if(this.syncBlocker.states()===u.Cb.Pending)return Promise.resolve(void 0);var e=!1;return(t=i.clone(t)).Answers=i.map(t.Answers,(function(t){var r=n.getQuestionById(t.QuestionId);return r&&r.Model&&((t=i.clone(t)).Answer=r.serializeAnswer(t.Answer),"Question.TextField"===r.Model.Type&&!e&&r.Model.IsMathQuiz&&(e=!0)),t})),e&&this.Xn(t),new Promise((function(e){n.Synchronizer.existingInDataSource().then((function(){return e((0,g.qs)(n,t))}))}))},e.getSnapshotToCopy=function(){var t=this.getSnapshot((0,q.DV)()),n=null;return t.XlWorkbookId&&((n=i.clone(t)).XlWorkbookId="WaitingForExport"),this.Model.OwnerTenantId!==(0,s.k0)().userInfo.TenantId&&t.DataClassificationLabel&&(n||(n=i.clone(t)),n.DataClassificationLabel=null),(0,m.md)((function(){t.CustomCssFileName&&(n||(n=i.clone(t)),n.CustomCssFileName=null)})),null===n?t:n},e.getLocaleResouceById=function(t){return(0,p.o7)(this.Model.Id).getLocaleResource(this.Model.Id,t).then((function(t){return(0,x.n$)(t)}))},e.totalSectionCount=function(){return this.formElementManager.SectionMasters.length+(this.formElementManager.HeaderTopQuestionMasters.length>0?1:0)},e.isProgressBarVisible=function(){return!!this.isFieldReady(n.Schema.ProgressBarEnabled)&&("true"===this.Model.ProgressBarEnabled&&this.totalSectionCount()>=2)},e.ensureFieldsReady=function(n){return t.prototype.ensureFieldsReady.call(this,n)},e.Hn=function(t){t.ExistingInDataSource?this.isFieldReady(n.Schema.ModifiedDate)&&(this.Model.Modified=this.Model.ModifiedDate):this.Model.Modified=(new Date).toISOString()},e.jn=function(t){t.ExistingInDataSource?this.isFieldReady(n.Schema.CreatedDate)&&(this.Model.Created=this.Model.CreatedDate):this.Model.Created=(new Date).toISOString()},e.Bn=function(t){this.Yn=new y.S(this,n.Schema.OtherInfo,(0,q.gD)()),t.InitialData&&this.isFieldReady(n.Schema.OtherInfo)&&(t.ExistingInDataSource||t.InitialData.OtherInfo?this.Yn.deserialize():this.Yn.serialize())},e.initializeHeaderOtherInfoBinder=function(t){var e=this;(0,m.md)((function(){e.Zn=new y.S(e,n.Schema.HeaderOtherInfo,(0,q.Av)()),t.InitialData&&e.isFieldReady(n.Schema.HeaderOtherInfo)&&(t.ExistingInDataSource||t.InitialData.HeaderOtherInfo?e.Zn.deserialize():e.Zn.serialize())}))},e.normalizeResponses=function(t){var n=this;return this.bulkEdit((function(){t=t.map((function(t){return n.Wn(t)}))})),t},e.Wn=function(t){var n=this.Model.Settings.IsQuizMode&&this.SyncContext!==F.y.ResponseTimeForm,e={};this.FormElementManager.QuestionMasters.forEach((function(t){return e[t.Model.Id]=t})),(t=i.clone(t)).Answers=i.map(t.Answers,(function(t){var r=e[t.QuestionId];return r?((t=i.clone(t)).Answer=r.deserializeAnswer(t.Answer),t.IsMathAnswer=!r.Model.IsAnswerPlainText,null==t.Score&&n&&r.autoGradeAnswer(t),t):null})).filter((function(t){return!!t}));var r=this.getResponseModelById(t.Id);return r&&((0,R._p)(r).updateWithNormalizedResponse(t),t=r),t},e.getResponseModelById=function(t){return c.d.Collection.getItemWithKeyFields(this.Model.ResponseModels,{Id:t})},e.Xn=function(t){var n=this,e={QuestionCount:0,GradableQuestionCount:0,MathResponses:0,MathGradableResponses:0,TextResponses:0,TextGradableResponses:0,EmptyResponses:0,TotalLength:0};i.forEach(t.Answers,(function(t){var r=n.getQuestionById(t.QuestionId);if(r&&r.Model&&"Question.TextField"===r.Model.Type&&r.Model.IsMathQuiz){r.hasCorrectAnswers()?e.GradableQuestionCount++:e.QuestionCount++;var i=(0,o.d)(t.Answer);null!=i&&i.Answer?(e.TotalLength+=i.Answer.length,r.hasCorrectAnswers()?i.IsMath?e.MathGradableResponses++:e.TextGradableResponses++:i.IsMath?e.MathResponses++:e.TextResponses++):e.EmptyResponses++}}))},e.$n=function(){var t=this;this.formElementManager.adjustElementOrders();var e=[n.Schema.Questions,n.Schema.DescriptiveElements],r=this.Gn;this.addRule({Name:"ElementOrder",InterestedFields:e,onChange:function(){r&&!r.isFormLoadingComplete()||t.formElementManager.adjustElementOrders()}})},Object.defineProperty(n,"Rules",{get:function(){if(!n.rules){var t=n.Schema;n.rules=[{Name:"DeserializeSettings",InterestedFields:[t.SerializedSettings],onChange:function(t){if(!t.BeingDeleted){var n=t.Master.Model.SerializedSettings||"{}",e=JSON.parse(n);t.Master.setData({Settings:e})}}},{Name:"DeserializePredefinedResponses",InterestedFields:[t.SerializedPredefinedResponses],onChange:function(t){if(!t.BeingDeleted){var n=t.Master.Model.SerializedPredefinedResponses||"[]",e=JSON.parse(n);t.Master.setData({PredefinedResponses:e})}}},{Name:"QuestionMediaProperties",InterestedFields:[t.Questions,t.DescriptiveElements],onChange:function(t){var n=t.Master.Model,e=c.d.convertToArray(t.Master.getSnapshot().Questions),r=c.d.convertToArray(t.Master.getSnapshot().DescriptiveElements);n.HasQuestionMedia=e.some((function(t){return!(!t.ImageInfo.ResourceUrl&&!t.VideoInfo.Url)}))||r.some((function(t){return!(!t.ImageInfo.ResourceUrl&&!t.VideoInfo.Url)}))}},{Name:"QuestionBranchValidity",InterestedFields:[t.Questions,t.DescriptiveElements],onChange:function(t){var e=t.Master.Model,r=!1;t.Master.isFieldReady(n.Schema.Questions)&&(r=c.d.convertToArray(t.Master.Model.Questions).some((function(t){return c.d.getObjectMasterFromModel(t).hasValidBranching()})));var i=!1;t.Master.isFieldReady(n.Schema.DescriptiveElements)&&(i=c.d.convertToArray(t.Master.Model.DescriptiveElements).some((function(t){return t.BranchInfo&&c.d.getObjectMasterFromModel(t.BranchInfo).isValid()})));e.HasValidBranching=r||i;var o=c.d.convertToArray(t.Master.getSnapshot().Questions);e.QuizQuestionsCount=o.filter((function(t){return t.IsQuiz})).length}}]}return n.rules},enumerable:!1,configurable:!0}),n}(c.d.createObjectMasterClass("FormMaster",U,(function(t,n){return t.getSyncBlocker().promise().then((function(){return new v.cV(t,n)}))})))},25366:function(t,n,e){"use strict";e.d(n,{H:function(){return a}});var r=e(36215),i=e(26203),o=e(73293),s=e(67661),u=e(72374),a=function(){function t(t){this.formMaster=t}var n=t.prototype;return Object.defineProperty(t,"QuestionOrderFloor",{get:function(){return 500},enumerable:!1,configurable:!0}),Object.defineProperty(t,"QuestionOrderDefaultStep",{get:function(){return 100},enumerable:!1,configurable:!0}),t.isDescriptiveElement=function(t){return"Question.ColumnGroup"===t},t.isSection=function(t){return"Question.ColumnGroup"===t},Object.defineProperty(n,"TopQuestionMasters",{get:function(){return r.filter(this.formMaster.Model.Questions,(function(t){return!t.GroupId})).map(i.d.getObjectMasterFromModel)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"HeaderTopQuestionMasters",{get:function(){var t=this.SectionMasters,n=t.length&&t[0].Model.Order;return n>0?this.te(null,n):this.TopQuestionMasters},enumerable:!1,configurable:!0}),Object.defineProperty(n,"HeaderQuestionMasters",{get:function(){var t=this.SectionMasters,n=t.length&&t[0].Model.Order;return n>0?this.te(null,n,!0):this.QuestionMasters},enumerable:!1,configurable:!0}),Object.defineProperty(n,"QuestionMasters",{get:function(){return i.d.convertToArray(this.formMaster.Model.Questions).map(i.d.getObjectMasterFromModel)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"DescriptiveElementMasters",{get:function(){return i.d.convertToArray(this.formMaster.Model.DescriptiveElements).map(i.d.getObjectMasterFromModel)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"SectionMasters",{get:function(){return r.filter(this.DescriptiveElementMasters,(function(n){return t.isDescriptiveElement(n.Model.Type)}))},enumerable:!1,configurable:!0}),Object.defineProperty(n,"AllElementMasters",{get:function(){return this.getAllElements().map(i.d.getObjectMasterFromModel)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"TopElementMasters",{get:function(){return this.ne(!0).map(i.d.getObjectMasterFromModel)},enumerable:!1,configurable:!0}),n.getQuestionById=function(t){var n=i.d.Collection.getItemWithKeyFields(this.formMaster.Model.Questions,{Id:t});return n&&(0,u.vV)(n)},n.getElementMasterById=function(t){return this.getQuestionById(t)||this.getDescriptiveElementMasterById(t)},n.getDescriptiveElementMasterById=function(t){var n=i.d.Collection.getItemWithKeyFields(this.formMaster.Model.DescriptiveElements,{Id:t});return n&&(0,o.PQ)(n)},n.findQuestionsInSection=function(t,n){if(t){var e=this.SectionMasters,i=r.indexOf(e,t);return i>=0?this.te(e[i].Model.Order,i+1<e.length?e[i+1].Model.Order:null,n):[]}return n?this.HeaderQuestionMasters:this.HeaderTopQuestionMasters},n.findContainerSection=function(t){var n=this.SectionMasters;return n[r.findLastIndex(n,(function(n){return n.Model.Order<=t.Model.Order}))]},n.adjustElementOrders=function(){var n=this;if(this.formMaster.isFieldReady(s.x.Schema.Questions)){var e=this.formMaster.isFieldReady(s.x.Schema.DescriptiveElements),r=this.getAllElements();r.length&&this.formMaster.bulkEdit((function(){r.sort(t.questionComparer),r[0].Order||(r[0].Order=t.QuestionOrderFloor+t.QuestionOrderDefaultStep);for(var i=0,o=r[0].Order,s=1;s<=r.length;++s){var u=r[s]&&r[s].Order;if(!u)break;if(o!==u){var a=(u-o)/(s-i);for(o+=a;++i<s;)r[i].Order=o,o+=a}}for(;++i<r.length;)o+=t.QuestionOrderDefaultStep,r[i].Order=o;n.formMaster.Model.Questions=r.filter((function(n){return!t.isDescriptiveElement(n.Type)})).map((function(t){return t})),e&&(n.formMaster.Model.DescriptiveElements=r.filter((function(n){return t.isDescriptiveElement(n.Type)})))}))}},n.getSectionNodes=function(){var t=this,n=[],e=this.HeaderTopQuestionMasters;return e.length&&n.push({TopQuestionMasters:e}),this.SectionMasters.forEach((function(e){n.push({Section:e,TopQuestionMasters:t.findQuestionsInSection(e)})})),n},n.getAllElements=function(){return this.ne(!1)},n.ne=function(n){var e=i.d.convertToArray(this.formMaster.Model.Questions);n&&(e=r.filter(e,(function(t){return!t.GroupId})));var o=e;return this.formMaster.isFieldReady(s.x.Schema.DescriptiveElements)&&(o=o.concat(i.d.convertToArray(this.formMaster.Model.DescriptiveElements)).sort(t.questionComparer)),o},t.questionComparer=function(t,n){var e=t.Order-n.Order;return t.Order&&n.Order||(e=-e),e||t.Id.localeCompare(n.Id)},n.te=function(t,n,e){var r;return r=e?this.QuestionMasters:this.TopQuestionMasters,null!==n&&(r=r.filter((function(t){return n>t.Model.Order}))),null!==t&&(r=r.filter((function(n){return n.Model.Order>=t}))),r},t}()},51586:function(t,n,e){"use strict";e.d(n,{Si:function(){return b},jg:function(){return w},iZ:function(){return y},ZP:function(){return I},Wq:function(){return S},OM:function(){return C}});e(56647);var r=e(36215),i=e(94290),o=e(9947),s=e(26203),u=e(10836),a=e(37076),c=e(72467),l=e(41350),f=e(64290),h=e(9743),d=e(67661),m=e(96680),v={},p={},g=new l.Y;function b(t){return w(t,!0)}function w(t,n,e){if(void 0===e&&(e=!1),t.Id)return I(t,e);if(n?(t.OwnerId=t.OwnerId||(0,i.av)(),!t.OwnerId&&(0,c.f5)().Model.GroupMaster&&(t.OwnerId=(0,c.f5)().Model.GroupMaster.Model.id),(0,f.md)((function(){(0,u.cr)("CustomerVoiceSharingV2AllProject")&&(t.OwnerId=(0,c.f5)().Model.CurrentProject.ADGroupId)})),t.OwnerTenantId=t.OwnerTenantId||(0,i.jM)()||(0,o.k0)().userInfo.TenantId):(t.OwnerId=t.OwnerId||(0,o.k0)().userInfo.UserId,t.OwnerTenantId=t.OwnerTenantId||(0,o.k0)().userInfo.TenantId),!t.OwnerId||!t.OwnerTenantId)throw new Error("Form OwnerId or OwnerTenantId cannot be null!");return function(t,n,e){var i=(0,m.pf)().map(s.d.getFieldSchemaInfo).map((function(t){return t.Name})),o=new((0,c.Ed)())(h.y.DesignTimeForm,{ExistingInDataSource:!1,InitialData:r.pick(t,i)},"Group"===n,e);return p[o.getInstanceId()]=o,o.existingOnServerSide().then((function(){v[o.Model.Id]=o})),g.trigger(o),o}(t,n?"Group":"User",e)}function y(t,n){var e=new((0,c.Ed)())(h.y.DesignTimeForm,{ExistingInDataSource:!0,InitialData:t},n);return e.forceFieldsReady((0,m.E3)()),p[e.getInstanceId()]=e,g.trigger(e),e.Synchronizer.Model.CreationInProcess=!0,e}function I(t,n,e){void 0===e&&(e=!1);var i=v[t.Id];if(i&&!e){var o=s.d.convertToSourceData(t,d.x.Schema);return i.Synchronizer.onSourceDataReceived(o),i}var u=(0,a.kc)(t.Id);return(t=r.clone(t)).OwnerId=u.OwnerId,t.OwnerTenantId=u.OrgId,t.TableId=u.TableId,i=new((0,c.Ed)())(h.y.DesignTimeForm,{ExistingInDataSource:!0,InitialData:t},u.IsGroupOwner,n),p[i.getInstanceId()]=i,v[t.Id]=i,g.trigger(i),i}function S(t){return p[t]}function C(t){return v[t]}},96680:function(t,n,e){"use strict";e.d(n,{sQ:function(){return l},DV:function(){return f},pf:function(){return h},gD:function(){return d},Av:function(){return m},E3:function(){return v},Co:function(){return p},ez:function(){return g},xO:function(){return b},eT:function(){return w}});var r,i,o=e(36215),s=e(64290),u=e(62539),a=e(67661),c=e(74871);function l(t){var n=a.x.Schema,e=[];return t.forEach((function(t){switch(t){case"Settings":case n.Settings:e.push(n.SerializedSettings);break;case"Modified":case n.Modified:e.push(n.ModifiedDate);break;case"Created":case n.Created:e.push(n.CreatedDate);break;case"ResponsesCount":case n.ResponsesCount:e.push(n.RowCount);break;case"PredefinedResponses":case n.PredefinedResponses:e.push(n.SerializedPredefinedResponses);break;case"Theme":case n.Theme:e.push(n.Background,n.OtherInfo);break;case"HeaderTheme":case n.HeaderTheme:e.push(n.HeaderBGImage,n.HeaderOtherInfo);break;default:d().covers(t)?e.push(n.OtherInfo):m().covers(t)?e.push(n.HeaderOtherInfo):e.push(t)}})),o.uniq(e)}function f(){var t=a.x.Schema,n=[t.Background,t.Description,t.Logo,t.LogoInfo,t.Questions,t.DescriptiveElements,t.Settings,t.SerializedSettings,t.SoftDeleted,t.Title,t.PrimaryCustomizedThemeColor,t.SecondaryCustomizedThemeColor,t.TertiaryCustomizedThemeColor,t.Theme,t.TrackingId,t.XlWorkbookId,t.ThankYouMessage,t.EmailReceiptEnabled,t.DataClassificationLabel,t.Type,t.DefaultLanguage,t.LocaleList,t.LocalizedResources,t.ReputationTier,t.MeetingId,t.FormsInsightsInfo,t.ProgressBarEnabled,t.FormsProRTTitle,t.FormsProRTDescription,t.OtherInfo];return(0,s.md)((function(){n.push(t.BusinessCdsId,t.BusinessCdsRegion,t.LastEmbedConfig,t.FormsProBranchRules,t.MfpBranchingData,t.CVSimplifiedBranchingSupported,t.IsDefaultCds,t.PipesDetails,t.FooterText,t.ConditionalThankyouMessage,t.CustomDomainSenderEmail,t.CVDefaultLanguage,t.OverSurveySettingEnabled,t.InvitesCoolingPeriod,t.ResponseThresholdCount,t.InviteExpiryDays,t.OwnerUserType,t.ProjectId,t.SurveyFont,t.HeaderFont,t.Alias,t.ProjectGroupId,t.HeaderEnabled,t.CustomCSSInLineHeaderToggle,t.HeaderAltText,t.HeaderImageFocalPointEnabled,t.HeaderBGImage,t.HeaderTheme,t.BackGroundPositionX,t.BackGroundPositionY,t.BackGroundPositionZ,t.ThemeHeaderBackgroundImageURL,t.LogoPositionX,t.LogoPositionY,t.TitlePositionX,t.TitlePositionY,t.LogoSize,t.FileUploadStorage,t.SurveyLastModifiedAt)})),n}function h(){return f().concat([a.x.Schema.OwnerId,a.x.Schema.OwnerTenantId,a.x.Schema.CollectionId])}function d(){return r||(r=new u.C([a.x.Schema.PrimaryCustomizedThemeColor,a.x.Schema.SecondaryCustomizedThemeColor,a.x.Schema.TertiaryCustomizedThemeColor,a.x.Schema.Theme,a.x.Schema.LogoInfo,a.x.Schema.CreatedFromOneDrive,a.x.Schema.TemplateId])),r}function m(){return i||(i=new u.C([a.x.Schema.HeaderTheme,a.x.Schema.BackGroundPositionX,a.x.Schema.BackGroundPositionY,a.x.Schema.BackGroundPositionZ,a.x.Schema.ThemeHeaderBackgroundImageURL,a.x.Schema.LogoPositionX,a.x.Schema.LogoPositionY,a.x.Schema.TitlePositionX,a.x.Schema.TitlePositionY,a.x.Schema.LogoSize])),i}function v(){var t=a.x.Schema,n=[t.Title,t.ModifiedDate,t.CreatedDate,t.MeetingId,t.FormsInsightsInfo,t.OwnerId,t.OwnerTenantId,t.Description,t.Questions,t.DescriptiveElements,t.Permissions,t.ResponderPermissions,t.PermissionTokens,t.ResponsesCount,t.Settings,t.Theme,t.Logo,t.LogoInfo,t.Background,t.XlWorkbookId,t.XlExportingTag,t.XlFileUnsynced,t.XlUnsyncedReason,t.Category,t.TrackingId,t.PredefinedResponses,t.ThankYouMessage,t.EmailReceiptEnabled,t.Flags,t.ReputationTier,t.DataClassificationLabel,t.Type,t.DefaultLanguage,t.LocaleList,t.LocalizedResources,t.ProgressBarEnabled,t.FormsProRTTitle,t.FormsProRTDescription];return(0,s.md)((function(){n.push(t.BusinessCdsId,t.BusinessCdsRegion,t.PipesDetails,t.FormsProBranchRules,t.MfpBranchingData,t.CVSimplifiedBranchingSupported,t.FooterText,t.ConditionalThankyouMessage,t.CustomCssFileName,t.CustomDomainSenderEmail,t.CVDefaultLanguage,t.OverSurveySettingEnabled,t.InvitesCoolingPeriod,t.Id,t.ResponseThresholdCount,t.InviteExpiryDays,t.OwnerUserType,t.ProjectId,t.SurveyFont,t.HeaderFont,t.Alias,t.ShortUrl,t.ProjectName,t.ProjectGroupId,t.FileUploadStorage,t.SurveyPermanentId,t.FlowTemplateId,t.InitialFormId,t.InitialFormOwnerId,t.HeaderEnabled,t.CustomCSSInLineHeaderToggle,t.HeaderAltText,t.HeaderImageFocalPointEnabled,t.HeaderBGImage,t.BackGroundPositionX,t.BackGroundPositionY,t.BackGroundPositionZ,t.ThemeHeaderBackgroundImageURL,t.LogoPositionX,t.LogoPositionY,t.TitlePositionX,t.TitlePositionY,t.LogoSize,t.HeaderTheme,t.EmailTemplatesMapping,t.SurveyLastModifiedAt)})),n}function p(){var t=a.x.Schema,n=[t.Title,t.ModifiedDate,t.Description,t.Settings,t.Theme,t.Questions,t.DescriptiveElements,t.Logo,t.LogoInfo,t.Background,t.Category,t.PredefinedResponses,t.ThankYouMessage,t.EmailReceiptEnabled,t.DataClassificationLabel,t.Type,t.DefaultLanguage,t.LocaleList,t.ReputationTier,t.ProgressBarEnabled,t.TenantSwitches,t.PrivacyUrl,t.FormsProRTTitle,t.FormsProRTDescription];return(0,s.md)((function(){n.push(t.CustomCssFileName,t.FooterText,t.ConditionalThankyouMessage,t.CVDefaultLanguage,t.FormsProBranchRules,t.MfpBranchingData,t.CVSimplifiedBranchingSupported,t.PipesDetails,t.ResponseThresholdCount,t.InviteExpiryDays,t.OwnerUserType,t.SurveyFont,t.HeaderFont,t.HeaderEnabled,t.CustomCSSInLineHeaderToggle,t.HeaderAltText,t.HeaderBGImage,t.BackGroundPositionX,t.BackGroundPositionY,t.BackGroundPositionZ,t.ThemeHeaderBackgroundImageURL,t.LogoPositionX,t.LogoPositionY,t.TitlePositionX,t.TitlePositionY,t.LogoSize,t.HeaderTheme,t.ProjectGroupId,t.FileUploadStorage,t.SurveyLastModifiedAt)})),n}function g(){var t=a.x.Schema,n=[t.Title,t.ModifiedDate,t.OwnerId,t.OwnerTenantId,t.Description,t.Questions,t.DescriptiveElements,t.Settings,t.Theme,t.Logo,t.LogoInfo,t.Background,t.XlWorkbookId,t.Category,t.Type,t.ProgressBarEnabled,t.FormsProRTTitle,t.FormsProRTDescription];return(0,s.md)((function(){n.push(t.ResponseThresholdCount,t.InviteExpiryDays,t.OwnerUserType,t.HeaderEnabled,t.CustomCSSInLineHeaderToggle,t.HeaderAltText,t.HeaderImageFocalPointEnabled,t.HeaderBGImage,t.BackGroundPositionX,t.BackGroundPositionY,t.BackGroundPositionZ,t.ThemeHeaderBackgroundImageURL,t.LogoPositionX,t.LogoPositionY,t.TitlePositionX,t.TitlePositionY,t.LogoSize,t.HeaderTheme,t.SurveyFont,t.HeaderFont,t.SurveyLastModifiedAt,t.CVSimplifiedBranchingSupported)})),n}function b(t){var n;return t.InitialData&&((t.InitialData.SerializedSettings||t.InitialData.Settings)&&(n=n||{},t.InitialData.SerializedSettings?n.Settings=JSON.parse(t.InitialData.SerializedSettings):n.SerializedSettings=c.w.serialize(t.InitialData.Settings)),(t.InitialData.SerializedPredefinedResponses||t.InitialData.PredefinedResponses)&&(n=n||{},t.InitialData.SerializedPredefinedResponses?n.PredefinedResponses=JSON.parse(t.InitialData.SerializedPredefinedResponses):n.SerializedPredefinedResponses=w(t.InitialData.PredefinedResponses))),n&&((t=o.clone(t)).InitialData=o.extend({},t.InitialData,n)),t}function w(t){return t&&t.length>0?JSON.stringify(t):null}},74871:function(t,n,e){"use strict";e.d(n,{w:function(){return l}});var r=e(59312),i=e(26203),o=e(39923),s=e(7645),u=e(81380),a=e(19930),c={LockGivenQuestionsEndDisplayOrder:o.J4.number(),LockGivenQuestionsStartDisplayOrder:o.J4.number(),FormClosed:o.J4.boolean(),FormClosedMessage:o.J4.string(),FormClosedMessageChanged:o.J4.boolean(),TimerEnabled:o.J4.boolean(),TimerEnabledStart:o.J4.boolean(),TimerEnabledEnd:o.J4.boolean(),StartTime:o.J4.string(),EndTime:o.J4.string(),RequiresUniqueResponse:o.J4.boolean(),IsAnonymous:o.J4.boolean(),NotRecordIdentity:o.J4.boolean(),ShuffleAllQuestions:o.J4.boolean(),ShuffleQuestionOrder:o.J4.boolean(),ShowGradedResults:o.J4.boolean(),RespondInAppOnly:o.J4.boolean(),AllowCopy:o.J4.boolean(),ShareToken:o.J4.string(),ManualGradingEnabled:o.J4.boolean(),IsQuizMode:o.J4.boolean(),EmailNotification:o.J4.boolean(),AllowResponderGetAllResponses:o.J4.boolean(),ShowQuestionNumbers:o.J4.boolean(),IsEmailableEntityCreationEnabled:o.J4.boolean(),CDSSyncQuestionResponses:o.J4.boolean(),OverSurveySettingEnabled:o.J4.boolean(),InvitesCoolingPeriod:o.J4.number(),EmailableEntity:o.J4.string(),HideLanguageDropdown:o.J4.boolean(),PauseAndResumeSurvey:o.J4.boolean(),RecordPartialResponse:o.J4.number()},l=function(t){function n(e){var r=t.call(this,e)||this;return r.addRule({Name:"updateClosedMessage",InterestedFields:[r.Schema.FormClosed],onChange:n.updateClosedMessage}),r.addRule({Name:"updateAllowCopy",InterestedFields:[r.Schema.ShareToken],onChange:n.updateAllowCopy}),r}(0,r.ZT)(n,t);var e=n.prototype;return n.serialize=function(t){var n=i.d.convertToSourceData(t,this.Schema),e=0;return Object.keys(n).forEach((function(t){null==n[t]?delete n[t]:++e})),e>0?JSON.stringify(n):null},e.getFormStatus=function(){var t=this.Model;if(t.FormClosed)return a.r.Closed;if(t.TimerEnabled){var n=Date.now();if(null!=t.StartTime&&Date.parse(t.StartTime)>n)return a.r.NotStarted;if(null!=t.EndTime&&Date.parse(t.EndTime)<n)return a.r.Expired}return a.r.Opened},e.getFormClosedMessage=function(){var t=this.Model;switch(this.getFormStatus()){case a.r.Closed:return t.FormClosedMessage;case a.r.NotStarted:return(0,s.pm)().FormSetting_NotStartForm_DefaultMessage.format(new Date(t.StartTime).toLocaleString());case a.r.Expired:return(0,s.pm)().FormSetting_ExpiredForm_DefaultMessage;default:return}},e.setSharingStatus=function(t,n){var e=this,r=this.Parent,i=(0,u.lK)(r);return r.existingOnServerSide().then((function(){return i.changeSharingStatus(r.Model.Id,n)})).then((function(t){e.Model.ShareToken=t}))},n.updateClosedMessage=function(t){if(-1===t.FieldSchemas.indexOf(n.Schema.FormClosedMessage)){var e=t.Master.Model;e.FormClosed?null!=e.FormClosedMessage&&(0,s.ay)().then((function(t){return e.FormClosedMessage=t.FormSetting_ClosedForm_DefaultMessage})):e.FormClosedMessage=null}},n.updateAllowCopy=function(t){var n=t.Master.Model;n.AllowCopy=!!n.ShareToken},n}(i.d.createObjectMasterClass("FormSettingsMaster",c))},56647:function(t,n,e){"use strict";e.d(n,{I:function(){return h}});var r=e(59312),i=e(9947),o=e(26203),s=e(39923),u=e(41317),a=e(43367),c=e(9743),l=e(67661),f={BackgroundColor:s.J4.string({IsLocalField:!0}),BackgroundImage:s.J4.string({IsLocalField:!0}),Name:s.J4.string(),PrimaryColor:s.J4.string({IsLocalField:!0}),SecondaryColor:s.J4.string({IsLocalField:!0}),Thumbnail:s.J4.string({IsLocalField:!0})},h=function(t){function n(n){var e=t.call(this,n)||this;if(n.MasterTreeReady){var r=l.x.Schema;n.MasterTreeReady.then((function(){return e.Form.fieldsReady([r.Theme])})).then((function(){return e.Form.ensureFieldsReady([r.PrimaryCustomizedThemeColor,r.SecondaryCustomizedThemeColor,r.TertiaryCustomizedThemeColor,r.Background])})).then((function(){return e.ee()}))}return e}(0,r.ZT)(n,t);var e=n.prototype;return Object.defineProperty(e,"Form",{get:function(){return this.Parent},enumerable:!1,configurable:!0}),e.isCustomized=function(){return this.Model.Name===u.FP},e.getCustomizedTheme=function(){var t=this.Form.Model,n=(0,a.EW)();return{BackgroundColor:t.TertiaryCustomizedThemeColor||n.BackgroundColor,BackgroundImage:t.Background.ResourceUrl,Name:u.FP,PrimaryColor:t.PrimaryCustomizedThemeColor||n.PrimaryColor,SecondaryColor:t.SecondaryCustomizedThemeColor||n.SecondaryColor,Thumbnail:null}},e.ee=function(){var t=this;this.addRule({Name:"calculate theme basing on name",onChange:function(n){n.BeingDeleted||t.re()}});var n=l.x.Schema;this.Form.observe((function(){return t.re()}),[n.PrimaryCustomizedThemeColor,n.SecondaryCustomizedThemeColor,n.TertiaryCustomizedThemeColor,n.Background.ResourceUrl]),this.re()},e.re=function(){var t=this,n=this.Model.Name;switch(n){case u.FP:this.setData(this.getCustomizedTheme());break;case u.kC:this.setData((0,a.EW)());break;default:var e=(0,i.k0)().themeConfig;if(e&&"object"==typeof e&&e[n]&&"object"==typeof e[n])return void this.setData(e[n]);this.ie(n).then((function(n){return t.setData(n)}))}},e.ie=function(t){return this.Form.SyncContext!==c.y.ResponseTimeForm?(0,u.BM)(t):(0,u.lx)(t)},n}(o.d.createObjectMasterClass("FormTheme",f))},93271:function(t,n,e){"use strict";e.d(n,{r:function(){return y},k:function(){return w}});var r=e(59312),i=e(97265),o=e(37890),s=e(26203),u=e(39923),a=e(94605),c=e(94956),l=e(53907),f=e(62539),h=e(82205),d=e(41293),m=e(55890),v=e(81380),p=e(9743),g=function(){function t(t,n){this.oe=t,this.Lt=(0,v.lK)(this.oe.Form)}var n=t.prototype;return Object.defineProperty(n,"FormId",{get:function(){return this.oe.FormId},enumerable:!1,configurable:!0}),Object.defineProperty(n,"QuestionId",{get:function(){return this.oe.QuestionId},enumerable:!1,configurable:!0}),Object.defineProperty(n,"ChoiceId",{get:function(){return this.oe.Model.Id},enumerable:!1,configurable:!0}),n.add=function(t){if(this.oe.Form.SyncContext===p.y.DesignTimeForm)return this.Lt.createQuestionChoice(this.FormId,this.QuestionId,t);(0,d._y)("Trying to create a choice out of design time.")},n.delete=function(t){if(this.oe.Form.SyncContext===p.y.DesignTimeForm)return this.Lt.deleteQuestionChoice(this.FormId,this.QuestionId,this.ChoiceId);(0,d._y)("Trying to delete a choice out of design time.")},n.query=function(t){return this.Lt.getQuestionChoice(this.FormId,this.QuestionId,this.ChoiceId)},n.update=function(t,n){if(this.oe.Form.SyncContext===p.y.DesignTimeForm){if(t)return this.Lt.updateQuestionChoice(this.FormId,this.QuestionId,this.ChoiceId,t);try{throw Error("patch choice body null error")}catch(t){(0,m.zU)("DataSourceUpdatingChoiceNull",{stack:t.stack})}return Promise.resolve()}(0,d._y)("Trying to update a choice out of design time.")},t}(),b={Id:u.J4.number({IsSourceGenerated:!0,IsKeyField:!0,SourceFieldName:"id"}),AnswerHint:u.J4.string({SourceFieldName:"description"}),CustomProperties:u.J4.string({SourceFieldName:"customProperties"}),Description:u.J4.string({SourceFieldName:"displayText"}),FormsProDisplayRTText:u.J4.string({IsLocalField:!0}),Order:u.J4.number({SourceFieldName:"order"}),Key:u.J4.string({SourceFieldName:"key"}),IsGenerated:u.J4.boolean({IsLocalField:!0}),IsMathOption:u.J4.boolean({IsLocalField:!0}),BranchInfo:u.J4.fromMasterClass((function(){return a.G}),{IsLocalField:!0}),SavingState:u.J4.reference({IsLocalField:!0}),Level:u.J4.number({SourceFieldName:"level"}),ParentOrder:u.J4.number({SourceFieldName:"parentOrder"}),parentChoiceId:u.J4.number({SourceFieldName:"parentId"})};function w(t){return s.d.getObjectMasterFromModel(t)}var y=function(t){function n(e){var r=this,s=new o.wU;return r=t.call(this,e,{Scheduler:new c.b(n.name),MasterReady:s.promise()})||this,(0,h.vG)(r),r.fieldsReady([r.Schema.Id,r.Schema.Key]).then((function(){r.Model.Key||(r.Model.Key=(0,i.GW)())})),r.se(e),s.resolve(),r}(0,r.ZT)(n,t);var e=n.prototype;return Object.defineProperty(e,"Question",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(e,"QuestionId",{get:function(){return this.Question.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Form",{get:function(){return this.Question.Form},enumerable:!1,configurable:!0}),Object.defineProperty(e,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),e.se=function(t){this.ae=new l.S(this,n.Schema.CustomProperties,n.CustomPropertiesFieldSet),t.InitialData&&this.isFieldReady(n.Schema.CustomProperties)&&(t.ExistingInDataSource||t.InitialData.CustomProperties?this.ae.deserialize():this.ae.serialize())},Object.defineProperty(n,"CustomPropertiesFieldSet",{get:function(){return n.customPropertiesFieldSet||(n.customPropertiesFieldSet=new f.C([n.Schema.BranchInfo,n.Schema.IsGenerated,n.Schema.IsMathOption,n.Schema.FormsProDisplayRTText])),n.customPropertiesFieldSet},enumerable:!1,configurable:!0}),n}(s.d.createObjectMasterClass("ChoiceV2Master",b,(function(t,n){return new g(t,n)})))},76795:function(t,n,e){"use strict";e.d(n,{L:function(){return d},P:function(){return m}});var r=e(59312),i=e(36215),o=e(63795),s=e(26203),u=e(10836),a=e(7645),c=e(64290),l=e(34212),f=e(58680),h=e(72374),d=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return n.getElementTypeName=function(){return"Question.Choice"},n.createDefaultDefinition=function(){var t=[{Description:(0,a.pm)().Designer_Choices_DefaultDescription.format(1),IsGenerated:!0},{Description:(0,a.pm)().Designer_Choices_DefaultDescription.format(2),IsGenerated:!0}],e={Type:n.getElementTypeName(),Title:(0,a.pm)().Question_DefaultTitle,Choices:t,ChoiceType:h.T6.SingleChoice,OptionDisplayStyle:h.h3.ListAll,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1};return(0,c.md)((function(){(0,u.cr)("CVLeapFrogChoiceQuestionNewUX")&&(e.FormsProOptionsLayout=h.ek.Vertical,e.FormsProOtherChoice={Description:(0,a.pm)().CV_ChoiceQuestion_Add_Other_Choice_Placeholder,IsDefault:!0,FormsProDisplayRTText:""},e.FormsProChoiceLimits=!1),(0,u.cr)("CVLeapFrogChoiceQuestionRandomization")&&(e.FormsProRandomizationType=l.Z.None)})),e},n.supportMobileDesign=function(t){return!n.hasInvalidSettingOnMobile(t)&&t.OptionDisplayStyle!==h.h3.Dropdown},e.verify=function(t){return!this.Model.Required||t&&"[]"!==t?t&&t.length>n.MaxAnswerLength?h.ej.MultiChoiceQuestionLengthLimitError:h.ej.Success:h.ej.RequiredError},e.isEmpty=function(t){return this.Model.ChoiceType===h.T6.SingleChoice?!t:!t||"[]"===t},e.getTypeDisplayName=function(){switch(this.Model.ChoiceType){case h.T6.SingleChoice:return(0,a.pm)().QuestionType_SingleChoice;case h.T6.MultiChoice:return(0,a.pm)().QuestionType_MultiChoice;default:throw Error("Choice Question Type Not Supported")}},e.supportsQuestionLevelBranching=function(){return this.Model.ChoiceType!==h.T6.SingleChoice},e.supportsChoiceLevelBranching=function(){return this.Model.ChoiceType===h.T6.SingleChoice},e.getSnapshotWithoutBranchInfo=function(){var n=t.prototype.getSnapshotWithoutBranchInfo.call(this);return n.Choices=s.d.convertToArray(n.Choices).map((function(t){return delete(t=i.clone(t)).BranchInfo,t})),n},e.resetBranchInfo=function(){var n=this;t.prototype.resetBranchInfo.call(this),s.d.convertToArray(this.Model.Choices).filter((function(t){return n.getBranchInfoMaster(t.BranchInfo).resetToDefault()})),this.getBranchInfoMaster(this.Model.BranchInfoForOtherChoice).resetToDefault()},e.insertChoice=function(t,n){var e=this.Model.Choices,r=i.find(e,(function(t){return t.IsGenerated}));if(!r||n&&""!==r.Description){var o=s.d.Collection.addItems(e,[{Description:t,IsMathOption:n}]);r=o[0]}else{var u=s.d.getObjectMasterFromModel(r);(0,c.pd)((function(){u.bulkEdit((function(){r.Description=t,r.IsGenerated=null,r.IsMathOption=n}))}),(function(){var i=[];i.push(r);var o=s.d.Collection.addItems(e,[{IsGenerated:null,Description:t,IsMathOption:n}]);e=s.d.Collection.deleteItems(e,i),r=o[0]}))}return r},e.hasCorrectAnswers=function(t){return t?i.some(t.IsAnswerKeys):i.some(this.Model.Choices,(function(t){return t.IsAnswerKey}))},e.isCorrectAnswer=function(t){var n=m(t,this.Model).SelectedOptions.map((function(t){return(0,o.bC)(t)})).sort(),e=s.d.convertToArray(this.Model.Choices).filter((function(t){return t.IsAnswerKey})).map((function(t){return t.Description})).map((function(t){return(0,o.bC)(t)})).sort();return i.isEqual(e,n)},e.justifyQuestionInfo=function(){var t=this.Master.Model;if(null==t.OptionDisplayStyle){var e=t.ChoiceType===h.T6.SingleChoice&&!t.IsMathQuiz&&!t.AllowOtherAnswer&&t.Choices.length>=n.MinimumOptionsForDropDown;t.OptionDisplayStyle=e?h.h3.Dropdown:h.h3.ListAll}},e.showAsDropdown=function(){return this.Master.Model.OptionDisplayStyle===h.h3.Dropdown},e.setAnswerKey=function(t,n){var e=this;this.Master.bulkEdit((function(){t.IsAnswerKey=n,e.Model.ChoiceType===h.T6.SingleChoice&&t.IsAnswerKey&&s.d.convertToArray(e.Model.Choices).forEach((function(n){n.IsAnswerKey&&n!==t&&(n.IsAnswerKey=!1)}))}))},e.createQuizResult=function(t){if(this.Model.IsQuiz){var n=s.d.convertToArray(this.Model.Choices);return n.some((function(t){return t.IsAnswerKey}))?{IsAnswerCorrect:this.isCorrectAnswer(t),AnswerHints:n.map((function(t){return t.AnswerHint})),IsAnswerKeys:n.map((function(t){return t.IsAnswerKey})),Choices:n.map((function(t){return t.Description})),GradingBasis:this.Model.GradingBasis}:void 0}},e.autoGradeAnswer=function(n){if(i.some(this.Model.Choices,(function(t){return t.IsAnswerKey}))){var e=this.Model.Point?this.Model.Point:0;n.Score=this.isCorrectAnswer(n.Answer)?e:0,n.IsAutoGraded=!0}else t.prototype.autoGradeAnswer.call(this,n)},e.autoGradeWithQuizResult=function(t,n){return n?n.IsAnswerCorrect?this.Model.Point:0:null},e.getBranchingResult=function(n){var e=this;if(this.Model.ChoiceType!==h.T6.SingleChoice)return t.prototype.getBranchingResult.call(this,n);var r=s.d.convertToArray(this.Model.Choices),o=r.filter((function(t){return t.BranchInfo&&s.d.getObjectMasterFromModel(t.BranchInfo).isValid()})),u=s.d.getObjectMasterFromModel(this.Model.BranchInfoForOtherChoice);if(0===o.length&&!u.isValid())return t.prototype.getBranchingResult.call(this,n);var a,c=r.filter((function(t){return e.ce(n,t)})),l=i.intersection(c,o);l.length>0||c.length>0?a=(l[0]||c[0]).BranchInfo:this.isEmpty(n)||(a=this.Model.BranchInfoForOtherChoice);return a?this.getBranchInfoMaster(a).getBranchingResult():{Type:"Pending"}},e.ce=function(t,n){return n.Description===t},n.MinimumOptionsForDropDown=7,n.MaxAnswerLength=4e3,n}(f.P);function m(t,n){var e=n.ChoiceType===h.T6.SingleChoice;if(null!=t){var r=s.d.convertToArray(n.Choices).map((function(t){return t.Description}));if(!e||!n.AllowOtherAnswer&&!i.contains(r,t))try{var o=JSON.parse(t);if(Array.isArray(o)){if(!o.some((function(t){return!i.isString(t)})))return{IsSingleChoiceAnswer:!1,IsLegacyChoiceAnswer:!1,SelectedOptions:o}}else if(i.isObject(o)){var u=i.values(o);if(!u.some((function(t){return!i.isString(t)})))return{IsSingleChoiceAnswer:e&&u.length<=1,IsLegacyChoiceAnswer:!0,SelectedOptions:u}}}catch(t){}}return{IsSingleChoiceAnswer:e,IsLegacyChoiceAnswer:!1,SelectedOptions:null==t?[]:[t]}}},42304:function(t,n,e){"use strict";e.d(n,{o:function(){return u}});var r=e(59312),i=e(7645),o=e(58680),s=e(72374),u=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return n.getElementTypeName=function(){return"Question.DateTime"},n.createDefaultDefinition=function(){return{Type:n.getElementTypeName(),Title:(0,i.pm)().Question_DefaultTitle,Date:!0,Time:!1,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1}},n.supportMobileDesign=function(t){return!n.hasInvalidSettingOnMobile(t)},e.verify=function(t){return this.Model.Required&&!t?s.ej.RequiredError:s.ej.Success},e.getTypeDisplayName=function(){return(0,i.pm)().QuestionType_DateTime},n}(o.P)},58680:function(t,n,e){"use strict";e.d(n,{P:function(){return o}});var r=e(36215),i=e(26203),o=function(){function t(t){this.fe=t}var n=t.prototype;return t.supportMobileDesign=function(t){return!1},t.hasInvalidSettingOnMobile=function(t){return t.ShowSubtitle||!!t.ImageInfo.ResourceUrl||!!t.VideoInfo.Url},Object.defineProperty(n,"Master",{get:function(){return this.fe},enumerable:!1,configurable:!0}),Object.defineProperty(n,"Model",{get:function(){return this.fe.Model},enumerable:!1,configurable:!0}),n.isEmpty=function(t){return!t},n.justifyNumberBoundaries=function(){throw Error("to be overridden")},n.supportsQuestionLevelBranching=function(){return!0},n.supportsChoiceLevelBranching=function(){return!1},n.getBranchedResult=function(t,n){var e=this.getBranchingResult(t);switch(e.Type){case"Next":e.TargetElement=n}return e},n.isNumberType=function(){return!1},n.getNumberValidationErrorMessage=function(t){throw Error("to be overridden")},n.getValidationErrorMessage=function(){throw Error("to be overridden")},n.getSnapshotWithoutBranchInfo=function(){var t=r.clone(this.Master.getSnapshot());return delete t.BranchInfo,delete t.BranchInfoForOtherChoice,t},n.resetBranchInfo=function(){this.getBranchInfoMaster(this.Model.BranchInfo).resetToDefault()},n.insertChoice=function(t,n){},n.getNormalizedAnswer=function(t){return t},n.hasAnswer=function(){return!0},n.hasCorrectAnswers=function(t){return!1},n.isCorrectAnswer=function(t){return!1},n.setAnswerKey=function(t,n){},n.createQuizResult=function(t){return null},n.autoGradeAnswer=function(t){var n=!this.Model.Point,e=null==t.Answer||""===t.Answer;(n||e)&&(t.Score=0,t.IsAutoGraded=!0)},n.autoGradeWithQuizResult=function(t,n){var e=this.Master.Parent;return(e&&e.Model||this.Model).Point||(null==t||""===t)?0:null},n.serializeAnswer=function(t){return t},n.deserializeAnswer=function(t){return t},n.justifyQuestionInfo=function(){},n.showAsDropdown=function(){},n.redressGradingBasis=function(){},n.getBranchInfoMaster=function(t){return i.d.getObjectMasterFromModel(t)},n.getBranchingResult=function(t){return this.getBranchInfoMaster(this.Model.BranchInfo).getBranchingResult()},t}()},72374:function(t,n,e){"use strict";e.d(n,{T6:function(){return o},pW:function(){return i},h3:function(){return a},ek:function(){return c},MF:function(){return z},ej:function(){return u},le:function(){return s},PA:function(){return r},vV:function(){return B}});var r,i,o,s,u,a,c,l,f=e(59312),h=e(36215),d=e(15934),m=e(37890),v=e(26203),p=e(41293),g=e(39923),b=e(10836),w=e(43367),y=e(72467),I=e(46008),S=e(64290),C=e(55890),F=e(94605),N=e(94956),T=e(90819),k=e(3920),x=e(34212),P=e(53907),D=e(62539),E=e(67661),R=e(82205),L=e(93271),A=e(81380),q=e(9743),O=[],M=function(t){for(;O.shift()!==t;);},U=function(t){return t.then((function(n){return M(t),n})).catch((function(n){throw M(t),n}))},V=function(){function t(t,n){this.he=t,this.Lt=(0,A.lK)(this.he.Form)}var n=t.prototype;return Object.defineProperty(n,"FormId",{get:function(){return this.he.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(n,"QuestionId",{get:function(){return this.he.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(n,"QuestionType",{get:function(){return this.he.Model.Type},enumerable:!1,configurable:!0}),Object.defineProperty(n,"ExtraQosData",{get:function(){var t=this.he.Form;return{WithSection:t.isFieldReady(t.Schema.DescriptiveElements)&&t.hasSection(),FormType:t.isFieldReady(t.Schema.Type)&&null!==t.Model.Type?t.Model.Type:""}},enumerable:!1,configurable:!0}),n.add=function(t){var n=this;if(this.he.Form.SyncContext===q.y.DesignTimeForm){var e=this.he.ParentQuestionMaster;return e?e.Synchronizer.existingInDataSource().then((function(){return n.de(t)})):this.de(t)}(0,p._y)("Trying to create a question without design type.")},n.delete=function(t){var n=this;this.he.Form.SyncContext!==q.y.DesignTimeForm&&(0,p._y)("Trying to delete a question without design type.");var e=this.he.ParentQuestionMaster;if(e&&e.Deleted)return Promise.resolve();var r=this.he.SubQuestionMasters.map((function(t){return t.Synchronizer.flush()}));return Promise.all(r).then((function(){return n.he.createSyncJob((function(){return n.Lt.deleteFormQuestion(n.FormId,t.id,n.QuestionType,n.ExtraQosData)}))})).then(null,(function(t){if(t&&621===t.innerCode)return Promise.resolve();throw t}))},n.query=function(t){(0,p._y)("No scenario to call this method currently.")},n.update=function(t,n){var e=this;if((0,S.md)((function(){return!0}))&&this.he.Form.IsSampleForm)return Promise.resolve();if(this.he.Form.SyncContext!==q.y.DesignTimeForm)return Promise.resolve();if("id"in t){var r=t.id,i=n.ValuesBefore.id;(0,C.zU)("DataSourceUpdatingQuestionId",{newId:r,oldId:i})}if(null===t.allowMultipleValues)try{throw Error("allowMultipleValues null error")}catch(t){(0,C.zU)("DataSourceUpdatingQuestionNullAllowMultipleValues",{stack:t.stack})}return this.he.createUploadSyncJob((function(){return e.Lt.updateFormQuestion(e.FormId,e.QuestionId,e.QuestionType,t,e.ExtraQosData)}))},n.de=function(t){var n=this,e=this.he.createSyncJob((function(){return n.me(t)})).then((function(t){var n=t;return n.FileUploadSPOInfo&&(t.fileUploadSPOInfo={driveId:n.FileUploadSPOInfo.DriveId,errorCode:n.FileUploadSPOInfo.ErrorCode,folderId:n.FileUploadSPOInfo.FolderId,linkInfo:n.FileUploadSPOInfo.linkInfo,anonymousLinkInfo:n.FileUploadSPOInfo.anonymousLinkInfo}),t}));return e.then((function(t){"id"in t&&t.id!==n.QuestionId&&(0,C.zU)("ChangedIdFromServerSide",{formId:n.FormId,newId:t.id,oldId:n.QuestionId})})),e},n.me=function(t){var n=this;if("Question.FileUpload"===t.type){if(O.length>0){var e=O[O.length-1].then((function(){return n.Lt.createFormQuestion(n.FormId,t,n.ExtraQosData)}),(function(){return n.Lt.createFormQuestion(n.FormId,t,n.ExtraQosData)}));return O.push(e),U(e)}var r=this.Lt.createFormQuestion(this.FormId,t,this.ExtraQosData);return O.push(r),U(r)}return this.Lt.createFormQuestion(this.FormId,t,this.ExtraQosData)},t}(),_=e(36837),G={Id:g.J4.string({IsKeyField:!0,SourceFieldName:"id"}),DefaultValue:g.J4.string({SourceFieldName:"defaultValue"}),ImageInfo:g.J4.fromMasterClass(y.Cu,{SourceFieldName:"image"}),ImageSettings:g.J4.fromMasterClass(y.BF,{IsLocalField:!0}),Order:g.J4.number({SourceFieldName:"order"}),QuestionInfo:g.J4.string({SourceFieldName:"questionInfo"}),Required:g.J4.boolean({SourceFieldName:"required"}),Subtitle:g.J4.string({SourceFieldName:"subtitle"}),CombinedTitle:g.J4.string({SourceFieldName:"title"}),Type:g.J4.reference({SourceFieldName:"type"}),GroupId:g.J4.string({SourceFieldName:"groupId"}),ShowSubtitle:g.J4.boolean({IsLocalField:!0}),Hidden:g.J4.boolean({IsLocalField:!0}),Visible:g.J4.boolean({IsLocalField:!0}),FormsProRTQuestionTitle:g.J4.string({SourceFieldName:"formsProRTQuestionTitle"}),FormsProCalculateSentiment:g.J4.boolean({IsLocalField:!0}),FormsProRTSubtitle:g.J4.string({SourceFieldName:"formsProRTSubtitle"}),FormsProEnableAnswerTag:g.J4.boolean({IsLocalField:!0}),FormsProAnswerTag:g.J4.string({IsLocalField:!0}),FormsProAnswerTagHasError:g.J4.boolean({IsLocalField:!0}),Title:g.J4.string({IsLocalField:!0}),BranchInfo:g.J4.fromMasterClass((function(){return F.G}),{IsLocalField:!0}),IntegratedSavingState:g.J4.reference({IsLocalField:!0}),SavingState:g.J4.reference({IsLocalField:!0}),IsQuiz:g.J4.boolean({SourceFieldName:"isQuiz"}),GradingBasis:g.J4.string({IsLocalField:!0}),Point:g.J4.number({IsLocalField:!0}),AllowMultipleValues:g.J4.boolean({SourceFieldName:"allowMultipleValues"}),AllowOtherAnswer:g.J4.boolean({IsLocalField:!0}),BranchInfoForOtherChoice:g.J4.fromMasterClass((function(){return F.G}),{IsLocalField:!0}),FormsProIsFileUploaded:g.J4.boolean({IsLocalField:!0}),FormsProChoiceLimits:g.J4.boolean({IsLocalField:!0}),FormsProNumberOfSelections:g.J4.number({IsLocalField:!0}),FormsProOptionsLayout:g.J4.enumeration((function(){return c}),{IsLocalField:!0}),FormsProOtherChoice:g.J4.create({Description:g.J4.string(),IsDefault:g.J4.boolean(),FormsProDisplayRTText:g.J4.string()},{IsLocalField:!0}),FormsProRandomizationType:g.J4.enumeration((function(){return x.Z}),{IsLocalField:!0}),FormsProNumberOfRandomizationOptions:g.J4.number({IsLocalField:!0}),OptionDisplayStyle:g.J4.enumeration((function(){return a}),{IsLocalField:!0}),ChoiceGroup:g.J4.collectionOf((function(){return L.r}),{SourceFieldName:"choices"}),Choices:g.J4.collectionOf({Description:g.J4.string(),BranchInfo:g.J4.fromMasterClass((function(){return F.G})),IsAnswerKey:g.J4.boolean(),AnswerHint:g.J4.string(),IsGenerated:g.J4.boolean(),IsMathOption:g.J4.boolean(),FormsProDisplayRTText:g.J4.string()},{IsLocalField:!0}),ChoiceType:g.J4.reference({IsLocalField:!0}),Hint:g.J4.string({IsLocalField:!0}),ShuffleOptions:g.J4.boolean({IsLocalField:!0}),Length:g.J4.number({IsLocalField:!0}),RatingShape:g.J4.enumeration((function(){return s}),{IsLocalField:!0}),LeftDescription:g.J4.string({IsLocalField:!0}),RightDescription:g.J4.string({IsLocalField:!0}),FormsProRTLeftDescription:g.J4.string({IsLocalField:!0}),FormsProRTRightDescription:g.J4.string({IsLocalField:!0}),ShowRatingLabel:g.J4.boolean({IsLocalField:!0}),MinRating:g.J4.number({IsLocalField:!0}),FormsProSmileyList:g.J4.string({IsLocalField:!0}),Multiline:g.J4.boolean({IsLocalField:!0}),IsNumber:g.J4.boolean({IsLocalField:!0}),HasTFRestrictionForPro:g.J4.boolean({IsLocalField:!0}),Placeholder:g.J4.string({IsLocalField:!0}),NumberValidationRule:g.J4.enumeration((function(){return i}),{IsLocalField:!0}),FormsProValidationType:g.J4.enumeration((function(){return r}),{IsLocalField:!0}),NumberMinBoundary:g.J4.string({IsLocalField:!0}),NumberMaxBoundary:g.J4.string({IsLocalField:!0}),FormsProCustomRegEx:g.J4.string({IsLocalField:!0}),FormsProCustomPlaceholder:g.J4.string({IsLocalField:!0}),Date:g.J4.boolean({IsLocalField:!0}),Time:g.J4.boolean({IsLocalField:!0}),FileUploadSPOInfo:g.J4.create({anonymousLinkInfo:g.J4.string(),driveId:g.J4.string(),folderId:g.J4.string(),errorCode:g.J4.string(),linkInfo:g.J4.string()},{SourceFieldName:"fileUploadSPOInfo"}),FileTypes:g.J4.create({Word:g.J4.boolean(),Excel:g.J4.boolean(),PowerPoint:g.J4.boolean(),PDF:g.J4.boolean(),Image:g.J4.boolean(),Video:g.J4.boolean(),Audio:g.J4.boolean()},{IsLocalField:!0}),MaxFileCount:g.J4.number({IsLocalField:!0}),MaxFileSize:g.J4.number({IsLocalField:!0}),HasSpecificFileType:g.J4.boolean({IsLocalField:!0}),CoAuthors:g.J4.collectionOf(g.J4.reference(),{IsLocalField:!0}),IsMathQuiz:g.J4.boolean({IsLocalField:!0}),IsPlainTextInMathField:g.J4.boolean({IsLocalField:!0}),IsAnswerPlainText:g.J4.boolean({IsLocalField:!0}),IsMathInputDefault:g.J4.boolean({IsLocalField:!0}),InputSwitcherDisabled:g.J4.boolean({IsLocalField:!0}),MathTemplateID:g.J4.number({IsLocalField:!0}),MathAriaLabels:g.J4.collectionOf(g.J4.string(),{IsLocalField:!0}),LastMathMLFormula:g.J4.string({IsLocalField:!0}),VideoInfo:g.J4.create({Url:g.J4.string(),Title:g.J4.string(),Author:g.J4.string(),Thumbnail_url:g.J4.string(),OriginalWidth:g.J4.number(),OriginalHeight:g.J4.number(),ShowWarningBar:g.J4.boolean()},{IsLocalField:!0}),TrackingId:g.J4.string({SourceFieldName:"trackingId"}),QuestionTagForIntelligence:g.J4.string({SourceFieldName:"questionTagForIntelligence"}),InsightsInfo:g.J4.string({SourceFieldName:"insightsInfo"}),IsFromSuggestion:g.J4.boolean({SourceFieldName:"isFromSuggestion"}),SuspiciousEvidence:g.J4.number({IsLocalField:!0}),CascadeLevel:g.J4.number({SourceFieldName:"cascadeLevel"}),CascadeFileName:g.J4.string({SourceFieldName:"cascadeFileName"}),CascadeChoiceGroup:g.J4.collectionOf(g.J4.reference(),{IsLocalField:!0})};!function(t){t[t.Number=0]="Number",t[t.Email=1]="Email",t[t.Custom=2]="Custom"}(r||(r={})),function(t){t[t.None=0]="None",t[t.Greater=1]="Greater",t[t.GreaterOrEqual=2]="GreaterOrEqual",t[t.Less=3]="Less",t[t.LessOrEqual=4]="LessOrEqual",t[t.Equal=5]="Equal",t[t.NotEqual=6]="NotEqual",t[t.Between=7]="Between",t[t.NotBetween=8]="NotBetween",t[t.Max=9]="Max"}(i||(i={})),function(t){t[t.SingleChoice=1]="SingleChoice",t[t.MultiChoice=2]="MultiChoice"}(o||(o={})),function(t){t[t.Number=0]="Number",t[t.Star=1]="Star",t[t.Smiley=2]="Smiley"}(s||(s={})),function(t){t[t.Success=0]="Success",t[t.RequiredError=1]="RequiredError",t[t.NumberValidationError=2]="NumberValidationError",t[t.QuizWrongChoiceError=3]="QuizWrongChoiceError",t[t.MathLengthError=4]="MathLengthError",t[t.MultiChoiceQuestionLengthLimitError=5]="MultiChoiceQuestionLengthLimitError",t[t.RegExValidationError=6]="RegExValidationError"}(u||(u={})),function(t){t[t.Dropdown=0]="Dropdown",t[t.ListAll=1]="ListAll"}(a||(a={})),function(t){t[t.Vertical=0]="Vertical",t[t.Horizontal=1]="Horizontal"}(c||(c={})),function(t){t[t.Editing=0]="Editing",t[t.Preview=1]="Preview"}(l||(l={}));G.Choices[0],G.ChoiceGroup[0];function B(t){return v.d.getObjectMasterFromModel(t)}var z=function(t){function n(e){var r=this,i=new m.wU;return e.InitialData?(n.resolveQuestionNullTypeIssue(e.InitialData),(e=h.clone(e)).InitialData=h.clone(e.InitialData),void 0!==e.InitialData.CombinedTitle?(0,_.S)(e.InitialData):(0,_.k)(e.InitialData)):(0,p._y)("Question model should created with initial data."),(r=t.call(this,e,{MasterReady:i.promise(),Scheduler:new N.b(n.name)})||this).fieldsReady([n.Schema.ChoiceGroup]).then((function(){v.d.Collection.setComparer(r.Model.ChoiceGroup,(function(t,n){return t.Order-n.Order}));var t=v.d.getCollectionMasterFromModel(r.Model.ChoiceGroup);(0,R.v)(t,t.Schema[0].SavingState,(function(t){var n=[r.Model.SavingState,t];r.Model.IntegratedSavingState=(0,R.IM)(n)}))})),r.Nn(e),(0,k.CU)(r,n.Schema.ImageInfo,n.Schema.ImageSettings),r.ve(e),r.redressGradingBasis(),r.coAuthorTimers={},r.initializing=i,r}(0,f.ZT)(n,t);var e=n.prototype;return Object.defineProperty(e,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ImageInfoMaster",{get:function(){return(0,T.rQ)(this.Model.ImageInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ImageSettingsMaster",{get:function(){return(0,k.Hi)(this.Model.ImageSettings)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ParentQuestionMaster",{get:function(){if(!this.isFieldReady(this.Schema.GroupId))return null;var t=this.Model.GroupId;return t&&this.Form.getQuestionById(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SubQuestionMasters",{get:function(){var t=this;return this.Form.FormElementManager.QuestionMasters.filter((function(n){return n.Model.GroupId===t.Model.Id}))},enumerable:!1,configurable:!0}),e.isFieldReady=function(e){return e=n.getSourceFields([e])[0],t.prototype.isFieldReady.call(this,e)},e.ensureFieldsReady=function(e){return t.prototype.ensureFieldsReady.call(this,n.getSourceFields(e))},e.fieldsReady=function(e){return t.prototype.fieldsReady.call(this,n.getSourceFields(e))},e.hasValidVideoUrl=function(){return(0,I.Fp)()?this.kn()&&(0,d.eC)(this.Model.VideoInfo.Url):this.kn()&&(0,d.yk)(this.Model.VideoInfo.Url)},e.createSyncJob=function(t){var n=this,e=new m.wU,r=e.promise().then((function(){return n.Form.getQuestionSyncBlocker(r)})).then(t);return e.resolve(),r},e.createUploadSyncJob=function(t){var n=this,e=new m.wU,r=Promise.all([e,this.xn]).then((function(){return n.createSyncJob(t)}));return e.resolve(),this.xn=(0,m.Bx)(r),r},e.getMethodDelegator=function(){var t=this.Model.Type;this.pe=this.pe||(this.pe={});var n=this.pe[t];n||(n=new((0,w.Pv)(t))(this),this.pe[t]=n);return n},e.getChoiceById=function(t){var n=h.find(this.Model.ChoiceGroup,(function(n){return n.Id===t}));return n&&(0,L.k)(n)},e.getChoiceByKey=function(t){var n=h.find(this.Model.ChoiceGroup,(function(n){return n.Key===t}));return n&&(0,L.k)(n)},e.hasValidBranching=function(){var t=this.Model;return h.map(t.Choices,(function(t){return t.BranchInfo})).concat([t.BranchInfo,t.BranchInfoForOtherChoice]).map(v.d.getObjectMasterFromModel).some((function(t){return t.isValid()}))},e.Nn=function(t){this.Pn=new P.S(this,n.Schema.QuestionInfo,n.QuestionInfoFieldSet),t.InitialData&&this.isFieldReady(n.Schema.QuestionInfo)&&(t.ExistingInDataSource||t.InitialData.QuestionInfo?this.Pn.deserialize():this.Pn.serialize()),this.justifyQuestionInfo()},e.ve=function(t){!t.ExistingInDataSource&&t.InitialData.FileUploadSPOInfo&&(this.Model.FileUploadSPOInfo=null)},e.hasRuntimeError=function(){var t=this,n=this.Model.FileUploadSPOInfo;return(0,S.md)((function(){(0,b.cr)("CustomerVoiceCDSFileUpload")&&t.Form.isFieldReady(E.x.Schema.FileUploadStorage)&&"cds"===t.Form.Model.FileUploadStorage&&(n=null)})),!!n&&!(!this.Form.SettingMaster.Model.IsAnonymous||!n.anonymousLinkInfo)},e.kn=function(){return this.Model.VideoInfo&&this.Model.VideoInfo.Url},Object.defineProperty(n,"QuestionInfoFieldSet",{get:function(){return n.questionInfoFieldSet||(n.questionInfoFieldSet=new D.C([n.Schema.VideoInfo,n.Schema.ShowSubtitle,n.Schema.Hidden,n.Schema.BranchInfo,n.Schema.ShowRatingLabel,n.Schema.Point,n.Schema.FormsProCalculateSentiment,n.Schema.ImageSettings,n.Schema.GradingBasis,n.Schema.ChoiceType,n.Schema.Choices,n.Schema.Hint,n.Schema.AllowOtherAnswer,n.Schema.OptionDisplayStyle,n.Schema.ShuffleOptions,n.Schema.BranchInfoForOtherChoice,n.Schema.Length,n.Schema.RatingShape,n.Schema.LeftDescription,n.Schema.RightDescription,n.Schema.Multiline,n.Schema.IsNumber,n.Schema.NumberValidationRule,n.Schema.NumberMinBoundary,n.Schema.NumberMaxBoundary,n.Schema.Date,n.Schema.Time,n.Schema.IsMathQuiz,n.Schema.IsPlainTextInMathField,n.Schema.IsAnswerPlainText,n.Schema.InputSwitcherDisabled,n.Schema.IsMathInputDefault,n.Schema.MathTemplateID,n.Schema.MathAriaLabels,n.Schema.HasSpecificFileType,n.Schema.FileTypes,n.Schema.MaxFileCount,n.Schema.MaxFileSize,n.Schema.MinRating,n.Schema.FormsProChoiceLimits,n.Schema.FormsProIsFileUploaded,n.Schema.FormsProNumberOfRandomizationOptions,n.Schema.FormsProNumberOfSelections,n.Schema.FormsProOptionsLayout,n.Schema.FormsProOtherChoice,n.Schema.FormsProRandomizationType,n.Schema.FormsProRTLeftDescription,n.Schema.FormsProRTRightDescription,n.Schema.FormsProEnableAnswerTag,n.Schema.FormsProAnswerTag,n.Schema.FormsProAnswerTagHasError,n.Schema.HasTFRestrictionForPro,n.Schema.FormsProValidationType,n.Schema.FormsProCustomRegEx,n.Schema.FormsProCustomPlaceholder,n.Schema.FormsProSmileyList])),n.questionInfoFieldSet},enumerable:!1,configurable:!0}),n.resolveQuestionNullTypeIssue=function(t){if(!t.Type){var n={choiceType:t.ChoiceType,date:t.Date,time:t.Time,ratingShape:t.RatingShape,multiline:t.Multiline};t.Type=null!=n.choiceType?"Question.Choice":null!=n.date||null!=n.time?"Question.DateTime":n.ratingShape?"Question.Rating":"Question.TextField",(0,C.zU)("QuestionNullTypeError",{message:"question type resolved",conditions:n,resolvedType:t.Type})}},n.getSourceFields=function(t){return h.uniq(t.map((function(t){return n.QuestionInfoFieldSet.covers(t)?n.Schema.QuestionInfo:t})))},n}(v.d.createObjectMasterClass("QuestionMaster",G,(function(t,n){return new V(t,n)})));Object.keys({verify:null,isEmpty:null,getTypeDisplayName:null,getBranchedResult:null,isNumberType:null,resetBranchInfo:null,getNormalizedAnswer:null,hasAnswer:null,justifyNumberBoundaries:null,getNumberValidationErrorMessage:null,getValidationErrorMessage:null,supportsQuestionLevelBranching:null,supportsChoiceLevelBranching:null,getSnapshotWithoutBranchInfo:null,insertChoice:null,setAnswerKey:null,createQuizResult:null,autoGradeAnswer:null,autoGradeWithQuizResult:null,serializeAnswer:null,deserializeAnswer:null,justifyQuestionInfo:null,showAsDropdown:null,hasCorrectAnswers:null,isCorrectAnswer:null,redressGradingBasis:null}).forEach((function(t){z.prototype[t]=function(){var n=this.getMethodDelegator();return n[t].apply(n,arguments)}}))},36837:function(t,n,e){"use strict";e.d(n,{k:function(){return i},S:function(){return o}});var r=e(33447);function i(t){if(t.IsMathQuiz&&t.Subtitle){var n=t.Title||"";t.CombinedTitle=n+r.J+t.Subtitle}else t.CombinedTitle=t.Title}function o(t){var n=t.CombinedTitle;n&&(n=n.split(r.J)[0]),t.Title=n}},5438:function(t,n,e){"use strict";e.d(n,{i:function(){return u}});var r=e(59312),i=e(7645),o=e(58680),s=e(72374),u=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return n.getElementTypeName=function(){return"Question.Rating"},n.createDefaultDefinition=function(){return{Type:n.getElementTypeName(),Title:(0,i.pm)().Question_DefaultTitle,Length:5,RatingShape:s.le.Star,LeftDescription:"",RightDescription:"",MinRating:1,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1}},n.supportMobileDesign=function(t){return!n.hasInvalidSettingOnMobile(t)&&!t.ShowRatingLabel},e.verify=function(t){return this.Model.Required&&!t?s.ej.RequiredError:s.ej.Success},e.getTypeDisplayName=function(){return(0,i.pm)().QuestionType_Rating},e.isNumberType=function(){return!0},n}(o.P)},91367:function(t,n,e){"use strict";e.d(n,{E:function(){return u}});var r=e(36215),i=e(97265),o=e(55890),s=function(){return function(t,n,e){this.answer=t,this.id=n||(0,i.GW)(),this.isMath=e}}(),u=function(){function t(n){if(this.be=[],null!=n.GradingBasis)try{this.be=JSON.parse(n.GradingBasis)}catch(e){this.be=[],(0,o.zU)("ShortTextGradingBasisJsonParseFailure",{gradingBasisLength:n.GradingBasis.length,nonAsciiDetected:t.doesContainNonAsciiCharacters(n.GradingBasis)})}else this.be=[]}var n=t.prototype;return n.serialize=function(){return JSON.stringify(this.be)},n.getAnswers=function(){return r.clone(this.be)},n.areAnyAnswersDefined=function(){return 0!==this.be.length},n.addAnswer=function(t,n){return!this.we(t)&&(!this.ye(t)&&(this.be.push(new s(t,void 0,n)),!0))},n.updateAnswer=function(t,n,e){if(this.we(n))return!1;if(this.ye(n,t))return!1;var r=this.Ie(t);if(r<0)return!1;var i=this.be[r];return this.be[r]=new s(n,i.id,e),!0},n.deleteAnswer=function(t){var n=this.Ie(t);n>=0&&this.be.splice(n,1)},n.isCorrect=function(t){return!this.we(t)&&(t=(t+="").trim().toUpperCase(),null!=r.find(this.be,(function(n){return n.answer.trim().toUpperCase()===t})))},n.ye=function(t,n){var e=(t+="").toUpperCase();return null!=r.find(this.be,(function(t){return t.answer.toUpperCase()===e&&t.id!==n}))},n.we=function(t){return null==t||""===t},n.Ie=function(t){return r.findIndex(this.be,(function(n){return n.id===t}))},t.doesContainNonAsciiCharacters=function(t){for(var n=0;n<t.length;n++)if(t.charCodeAt(n)>127)return!0;return!1},t}()},93224:function(t,n,e){"use strict";e.d(n,{nv:function(){return d}});var r=e(59312),i=e(64459),o=e(687),s=e(31581),u=e(7645),a=e(13886),c=e(64290),l=e(58680),f=e(72374),h=e(91367);var d=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return n.getElementTypeName=function(){return"Question.TextField"},n.createDefaultDefinition=function(){return n.createDefaultSingleLineDefinition()},n.createDefaultSingleLineDefinition=function(){var t={Type:n.getElementTypeName(),Title:(0,u.pm)().Question_DefaultTitle,Multiline:!1,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1};return(0,c.md)((function(){t.FormsProCalculateSentiment=!1})),t},n.supportMobileDesign=function(t){return!n.hasInvalidSettingOnMobile(t)&&!t.IsNumber},e.verify=function(t){var n=t;if(this.Model.IsMathQuiz&&n){var e=(0,i.d)(t);if((n=null==e.Answer?t:e.Answer).length>(0,o.xZ)())return f.ej.MathLengthError}if(this.Model.Required&&!n)return f.ej.RequiredError;if(n&&this.Model.HasTFRestrictionForPro&&(f.PA.Email===this.Model.FormsProValidationType||f.PA.Custom===this.Model.FormsProValidationType)){var r=f.PA.Email===this.Model.FormsProValidationType?(0,o.FT)():new RegExp(this.Model.FormsProCustomRegEx),s=f.PA.Email===this.Model.FormsProValidationType?n.trim():n;if(!this.Se(s,r)||""===s&&n!==s)return f.ej.RegExValidationError}else if(n&&this.Model.IsNumber&&!this.Ce(n))return f.ej.NumberValidationError;return f.ej.Success},e.getTypeDisplayName=function(){return this.Model.Multiline?(0,u.pm)().QuestionType_MultiLineText:this.Model.IsNumber?(0,u.pm)().Common_Number_Text:(0,u.pm)().QuestionType_SingleLineText},e.isNumberType=function(){return!!this.Model.IsNumber},e.justifyNumberBoundaries=function(){var t=this;this.Master.bulkEdit((function(){var n=t.Master.Model,e=(0,a.Q5)(n.NumberMinBoundary)||"1",r=(0,a.Q5)(n.NumberMaxBoundary)||"10";switch(n.NumberValidationRule){case f.pW.Greater:case f.pW.GreaterOrEqual:case f.pW.Equal:case f.pW.NotEqual:r=null;break;case f.pW.Less:case f.pW.LessOrEqual:e=null;break;case f.pW.Between:case f.pW.NotBetween:if(parseFloat(e)>parseFloat(r)){var i=e;e=r,r=i}}n.NumberMinBoundary=e,n.NumberMaxBoundary=r}))},e.getValidationErrorMessage=function(t,n){var e,r=this;return(0,c.md)((function(){var i=null!=t?t:(0,u.pm)();switch(r.Model.FormsProValidationType){case f.PA.Email:e=i.EmailValidFormatError;break;case f.PA.Custom:e=n||r.Model.FormsProCustomPlaceholder||i.CustomValidFormatError;break;default:e=r.getNumberValidationErrorMessage(i)}})),e},e.getNumberValidationErrorMessage=function(t){var n=this.Model.NumberValidationRule;if(null!=n){var e=(0,s.x)(f.pW[n],t);return null==e?void 0:e.format(this.Model.NumberMinBoundary,this.Model.NumberMaxBoundary)}},e.hasCorrectAnswers=function(t){return!(!this.Model.IsQuiz||this.Model.Multiline)&&new h.E(t||this.Model).areAnyAnswersDefined()},e.isCorrectAnswer=function(n){return this.Model.IsQuiz&&!this.Model.Multiline?new h.E(this.Model).isCorrect(n):t.prototype.isCorrectAnswer.call(this,n)},e.createQuizResult=function(t){if(new h.E(this.Model).areAnyAnswersDefined()&&this.Model.IsQuiz)return{IsAnswerCorrect:this.isCorrectAnswer(t),GradingBasis:this.Model.GradingBasis}},e.autoGradeAnswer=function(n){if(this.Model.IsQuiz&&!this.Model.Multiline){var e=new h.E(this.Model);if(e.areAnyAnswersDefined()){var r=this.Model.Point?this.Model.Point:0;n.Score=e.isCorrect(n.Answer)?r:0,n.IsAutoGraded=!0}else t.prototype.autoGradeAnswer.call(this,n)}else t.prototype.autoGradeAnswer.call(this,n)},e.autoGradeWithQuizResult=function(n,e){return e?this.Model.IsQuiz&&!this.Model.Multiline?e.IsAnswerCorrect?this.Model.Point:0:t.prototype.autoGradeWithQuizResult.call(this,n,e):null},e.Se=function(t,n){return void 0===t||""===t||!!n.test(t)},e.Ce=function(t){if(void 0===t||""===t)return!0;if(!(0,a.ZR)(t))return!1;var n=parseFloat((0,a.Q5)(t)),e=parseFloat(this.Model.NumberMinBoundary),r=parseFloat(this.Model.NumberMaxBoundary);switch(this.Model.NumberValidationRule){case f.pW.None:return!0;case f.pW.Between:return n>=e&&n<=r;case f.pW.NotBetween:return!(n>=e&&n<=r);case f.pW.Greater:return n>e;case f.pW.GreaterOrEqual:return n>=e;case f.pW.Less:return n<r;case f.pW.LessOrEqual:return n<=r;case f.pW.Equal:return n===e;case f.pW.NotEqual:return n!==e;default:return!0}},e.deserializeAnswer=function(t){if(this.Model.IsMathQuiz&&t&&""!=t){var n=(0,i.d)(t);return this.Model.IsAnswerPlainText=!n.IsMath,null==n.Answer?t:n.Answer}return t},n}(l.P)},82205:function(t,n,e){"use strict";e.d(n,{vG:function(){return o},v:function(){return s},IM:function(){return u}});var r=e(36215),i=e(26203);function o(t){var n=t.Synchronizer;n.observe((function(){return a(t)}),[n.Schema.CreationFailed,n.Schema.CreationInProcess,n.Schema.CreationScheduled,n.Schema.UpdateFailed,n.Schema.UpdateInProcess,n.Schema.UpdateScheduled]),a(t)}function s(t,n,e){var o=i.d.convertToArray(t.Model).map(i.d.getObjectMasterFromModel);function s(){var t=o.map((function(t){return t.getModelByFieldSchema(n)}));e(u(t))}s(),t.observe((function(t){t.AddedModels.length&&(o=o.concat(t.AddedModels.map(i.d.getObjectMasterFromModel))),t.RemovedModels.length&&t.RemovedModels.map(i.d.getObjectMasterFromModel).forEach((function(t){t.Synchronizer.deletedFromDataSource().then((function(){o=r.without(o,t),s()}))})),s()}),[n])}function u(t){return r.contains(t,"Saving")?"Saving":r.contains(t,"Scheduled")?"Scheduled":r.contains(t,"Failed")?"Failed":"Idle"}function a(t){var n=t.Synchronizer.Model;n.CreationInProcess||n.UpdateInProcess?t.Model.SavingState="Saving":n.CreationScheduled||n.UpdateScheduled?t.Model.SavingState="Scheduled":n.CreationFailed||n.UpdateFailed?t.Model.SavingState="Failed":t.Model.SavingState="Idle"}},83735:function(t,n,e){"use strict";e.d(n,{BT:function(){return c},b4:function(){return l},OT:function(){return f},TS:function(){return h}});var r,i=e(59312),o=e(13877),s=e(26203),u=e(39923),a={ExportToExcelCalloutVersion:u.J4.string(),NewFormTeachingCalloutVersion:u.J4.string(),SendTeachingCalloutVersion:u.J4.string(),ThemeSuggestCalloutVersion:u.J4.string(),WhatsNewVersion:u.J4.string(),PortalFormIntroduction:u.J4.string(),PortalFormsProIntroduction:u.J4.string(),OutlookQuickPollTeachingUI:u.J4.string(),FormsProSampleForm:u.J4.string(),FlowTeachingCallout:u.J4.string(),ExcelSurveyIntroduction:u.J4.string(),ToggleExpTeachingBubble:u.J4.string(),ProCardTeachingBubble:u.J4.string(),MSRewardsTeachingCoach:u.J4.string(),MSRewardsCommandBarTeachingCoach:u.J4.string(),IsNotFirstTimePhishingDetected:u.J4.boolean(),FormsProAvailableTeachingCallout:u.J4.string(),CustomerVoiceDesignerCallout:u.J4.string(),CustomerVoiceAdvancedRandomizationCallout:u.J4.string(),CalculateSentimentTeachingCallout:u.J4.string(),AddBranchingTeachingCalloutVersion:u.J4.string(),CustomerVoiceIntroductionDialog:u.J4.string(),EditScoreTeachingCoach:u.J4.string(),CustomerVoiceCustomHeaderCallout:u.J4.string(),ReportFilterTeachingBubble:u.J4.string()},c=2;function l(){return r||(r=new h)}function f(t){var n=parseInt(t);return isNaN(n)||n<c}var h=function(t){function n(){var e=t.call(this,{InitialData:n.getInitialData()})||this;return e.observe((function(t){return e.Fe(t.FieldSchemas)})),e}(0,i.ZT)(n,t);var e=n.prototype;return n.getInitialData=function(){var t=(0,o.ns)(),e={};return Object.keys(n.Schema).forEach((function(n){return e[n]=t.getItem(n)})),e},e.Fe=function(t){var n=(0,o.ns)(),e=this.getSnapshot();t.map(s.d.getFieldSchemaInfo).map((function(t){return t.Name})).forEach((function(t){return n.setItem(t,e[t])}))},n}(s.d.createObjectMasterClass("UserProfileMaster",a))},20263:function(t,n,e){"use strict";e.d(n,{D:function(){return c}});var r,i=e(59312),o=e(26203),s=e(39923),u={$CsvInfo:{EstimateTimeInMinutes:s.J4.number(),FileExpireUtcTime:s.J4.string(),FileGenerateUtcTime:s.J4.string(),FileName:s.J4.string(),FileSize:s.J4.number(),GenerateStatus:s.J4.number(),TotalResponseCount:s.J4.number()},$CsvLink:s.J4.string()},a=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(n,t),n}(o.d.createObjectMasterClass("WarmColdMaster",u)),c=function(){return r||(r=new a),r}},69260:function(t,n,e){"use strict";e.d(n,{Kw:function(){return o}});var r=e(22810),i=function(){function t(t,n,e,r){this.Ne=t,this.Te=n,this.ke=e,this.xe=r}var n=t.prototype;return Object.defineProperty(n,"Id",{get:function(){return this.Ne},enumerable:!1,configurable:!0}),Object.defineProperty(n,"DisplayName",{get:function(){return this.Te},enumerable:!1,configurable:!0}),Object.defineProperty(n,"UserPrincipalName",{get:function(){return this.ke},enumerable:!1,configurable:!0}),Object.defineProperty(n,"Mail",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t}();function o(t,n){return function(t,n){var e=s[n];if(!e){var o="User"===t?(0,r.PR)(n):(0,r.ex)(n);e=Promise.resolve(o).then((function(t){return new i(n,t.displayName,t.userPrincipalName,t.mail)})),s[n]=e}return e}(t,n)}var s={}},90819:function(t,n,e){"use strict";e.d(n,{dL:function(){return i},Xf:function(){return k},nv:function(){return r},w9:function(){return T},rQ:function(){return F},bN:function(){return N},UO:function(){return C}});var r,i,o=e(59312),s=e(36215),u=e(37890),a=e(26203),c=e(39923),l=e(97265),f=e(41293),h=e(72467),d=e(41448),m=e(55890),v=e(73293),p=e(67661),g=e(72374),b=e(81380),w=function(){function t(t,n){this.Pe=t;var e,r=this.Pe.Parent;if(r instanceof p.x)e=r;else{if(!(r instanceof g.MF||r instanceof v.Jv))throw"Wrong parent type of ImageInfoMaster.";e=r.Form}var i=e.IsGroupForm?3:2;this.Lt=(0,b.lK)(e),this.De=d.VY.getInstance().createImageProvider(i,e.Model.OwnerTenantId,e.Model.OwnerId);var o=a.d.getFieldSchemaInfo(t.Membership.FieldSchema);this.Ee=o.Attributes.SourceFieldName||o.Name}var n=t.prototype;return n.add=function(t){return new Promise((function(t){window.setTimeout((function(){t(void 0)}))}))},n.delete=function(t){return(0,f._y)("not supported")},n.query=function(t){return(0,f._y)("not supported")},n.update=function(t){var n,e=t.uploadParameters;return e?(e.Delete?n=this.Re():e.ImageFile?n=this.Le(e.ImageFile):e.Url&&(n=this.Ae(e.Url,e.Size)),n?n.then((function(t){var n=s.clone(t);return n.uploadParameters=null,n})):void 0):this.Oe()},n.Oe=function(){var t=this,n=a.d.convertToSourceData(this.Pe.getSnapshot(),(0,h.Cu)().Schema);delete n.uploadParameters;var e,r={};r[this.Ee]=n;var i=this.Pe.Parent;if(i instanceof p.x)e=this.Lt.updateForm(i.Model.Id,r);else{if(!(i instanceof g.MF||i instanceof v.Jv))return(0,f._y)("not supported");var o=i;e=o.createUploadSyncJob((function(){return t.Lt.updateFormQuestion(o.Form.Model.Id,o.Model.Id,o.Model.Type,r)}))}return e.then((function(n){return n&&n[t.Ee]}))},n.Ae=function(t,n){var e=this,r={SourceUrl:t,Title:(0,l.GW)(),Size:n},i=this.Pe.Parent;if(i instanceof p.x)return this.Lt.createFormImageFromUrl(i.Model.Id,this.Ee,r);if(i instanceof g.MF||i instanceof v.Jv){var o=i;return o.createUploadSyncJob((function(){return e.Lt.createQuestionImageFromUrl(o.Form.Model.Id,o.Model.Id,r)}))}return(0,f._y)("not supported")},n.Le=function(t){var n=this,e={ImageBlob:t,ImageName:(0,l.GW)(),ImageType:t.type},r=this.Pe.Parent;if(r instanceof p.x)return this.De.uploadFormImage(r.Model.Id,this.Ee,e);if(r instanceof g.MF||r instanceof v.Jv){var i=r;return i.createUploadSyncJob((function(){return n.De.uploadQuestionImage(i.Form.Model.Id,i.Model.Id,n.Ee,e)}))}return(0,f._y)("not supported")},n.Re=function(){var t,n=this,e=this.Pe.Parent;if(e instanceof p.x)(0,m.$U)("DesignPage.FormImage.Delete"),t=this.De.deleteFormImage(e.Model.Id,this.Ee);else{if(!(e instanceof g.MF||e instanceof v.Jv))return(0,f._y)("not supported");var r=e;(0,m.$U)("DesignPage.QuestionImage.Delete"),t=r.createUploadSyncJob((function(){return n.De.deleteQuestionImage(r.Form.Model.Id,r.Model.Id,n.Ee)}))}return t.then(null,(function(t){if(t&&805===t.innerCode)return(0,m.zU)("DeleteImageNotFoundError",{imageUrl:n.Pe.Model.ResourceUrl}),Promise.resolve();throw t})).then((function(){return{altText:null,contentType:null,fileIdentifier:null,height:null,imageFile:null,originalFileName:null,resourceId:null,resourceUrl:null,size:null,width:null}}))},t}(),y=e(94956),I=e(82205),S={AltText:c.J4.string({SourceFieldName:"altText"}),ContentType:c.J4.string({SourceFieldName:"contentType"}),FileIdentifier:c.J4.string({SourceFieldName:"fileIdentifier"}),OriginalFileName:c.J4.string({SourceFieldName:"originalFileName"}),ResourceId:c.J4.string({SourceFieldName:"resourceId"}),ResourceUrl:c.J4.string({SourceFieldName:"resourceUrl"}),Width:c.J4.number({SourceFieldName:"width"}),Height:c.J4.number({SourceFieldName:"height"}),UploadParameters:c.J4.reference({SourceFieldName:"uploadParameters"}),ErrorType:c.J4.enumeration((function(){return i}),{IsLocalField:!0}),ResponseError:c.J4.reference({IsLocalField:!0}),ImageProcessingStatus:c.J4.enumeration((function(){return r}),{IsLocalField:!0}),IsPredefined:c.J4.boolean({IsLocalField:!0}),SavingState:c.J4.reference({IsLocalField:!0})};function C(t){if(!t)return!1;if(t.ResourceUrl)return!0;var n=t.UploadParameters;return!!n&&!!n.ImageFile}function F(t){return a.d.getObjectMasterFromModel(t)}function N(t,n,e,r){if(t>e||n>r){var i=Math.min(r/n,e/t);t*=i,n*=i}return{width:t,height:n}}function T(){return{UploadParameters:null,ErrorType:i.NoError,ResponseError:null,ImageProcessingStatus:r.Idle,Width:null,Height:null}}!function(t){t[t.Idle=0]="Idle",t[t.Picking=1]="Picking",t[t.Uploading=2]="Uploading",t[t.Deleting=3]="Deleting"}(r||(r={})),function(t){t[t.NoError=0]="NoError",t[t.SizeTooLarge=1]="SizeTooLarge",t[t.InvalidType=2]="InvalidType",t[t.BrokenImage=3]="BrokenImage",t[t.ServerError=4]="ServerError",t[t.DeleteFailError=5]="DeleteFailError"}(i||(i={}));var k=function(t){function n(e){var o=this,a=new u.wU,c=!e.ExistingInDataSource&&e.InitialData&&!!e.InitialData.ResourceUrl,l=s.clone(e.InitialData);(e=s.clone(e)).InitialData=c?s.extend({},l,{ImageProcessingStatus:r.Uploading}):s.extend({},l,T());var f=new y.b(n.name);f.setMaxRetryTimesForUpdate(0);var h=(o=t.call(this,e,{Scheduler:f,MasterReady:a.promise()})||this).Synchronizer;return h.observe((function(t){var n;s.contains(t.FieldSchemas,h.Schema.CreationError)?n=h.Model.CreationError:s.contains(t.FieldSchemas,h.Schema.UpdateError)&&(n=h.Model.UpdateError),n&&o.bulkEdit((function(){o.Model.ResponseError=n;var t=o.Model.UploadParameters;t&&t.Delete?o.Model.ErrorType=i.DeleteFailError:o.Model.ErrorType=i.ServerError}))}),[h.Schema.CreationError,h.Schema.UpdateError]),o.addRule({InterestedFields:[o.Schema.ResourceId],Name:"ResetErrorStatus",onChange:function(t){!t.BeingDeleted&&o.Model.ResourceId&&o.resetStatus(r.Idle)}}),o.initializing=a,o.duplicatingImage=c,o.originalInitialData=l,(0,I.vG)(o),o}(0,o.ZT)(n,t);var e=n.prototype;return e.getSettingsMaster=function(){return this.Me},e.setSettingsMaster=function(t){this.Me=t},e.resetStatus=function(t){var n=this.Model;this.bulkEdit((function(){n.ErrorType=i.NoError,n.ResponseError=void 0,n.ImageProcessingStatus=t}))},n}(a.d.createObjectMasterClass("ImageInfoMaster",S,(function(t,n){return new w(t,n)})))},3920:function(t,n,e){"use strict";e.d(n,{RZ:function(){return r},h2:function(){return i},Hi:function(){return v},CU:function(){return p},Vj:function(){return g}});var r,i,o=e(59312),s=e(36215),u=e(9947),a=e(26203),c=e(39923),l=e(687),f=e(72317),h=e(67661),d=e(90819),m={Layout:c.J4.enumeration((function(){return r})),Size:c.J4.enumeration((function(){return i})),NaturalWidth:c.J4.number(),NaturalHeight:c.J4.number(),ContainerWidth:c.J4.number(),ContainerHeight:c.J4.number(),ActualWidth:c.J4.number(),ActualHeight:c.J4.number(),Left:c.J4.number(),Top:c.J4.number()};function v(t){return a.d.getObjectMasterFromModel(t)}function p(t,n,e){t.fieldsReady([n]).then((function(){var r=t.getModelByFieldSchema(n),i=(0,d.rQ)(r);t.ensureFieldsReady([e]).then((function(){var n=v(t.getModelByFieldSchema(e));i.setSettingsMaster(n)}))}))}!function(t){t[t.Horizontal=1]="Horizontal",t[t.Vertical=2]="Vertical",t[t.Square=3]="Square"}(r||(r={})),function(t){t[t.Small=1]="Small",t[t.Large=2]="Large"}(i||(i={}));var g=function(t){function n(n){var e=t.call(this,n)||this;return n.MasterTreeReady&&n.MasterTreeReady.then((function(){var t=e.Parent;t instanceof h.x&&t.fieldsReady([h.x.Schema.LogoInfo]).then((function(){t.Model.LogoInfo===e.Model&&(e.Ue=!0)}))})),e}(0,o.ZT)(n,t);var e=n.prototype;return Object.defineProperty(e,"IsFormLogo",{get:function(){return this.Ue},enumerable:!1,configurable:!0}),e.validateImageSettings=function(t){var n=s.clone(this.getSnapshot());if(744===n.ContainerWidth&&(n.ContainerHeight=n.ContainerHeight*(0,l.Fy)()/n.ContainerWidth,n.ContainerWidth=(0,l.Fy)(),!t)){var e=this.Model;e.ContainerWidth=n.ContainerWidth,e.ContainerHeight=n.ContainerHeight}if(null==n.ContainerHeight||null==n.ContainerWidth||null==n.ActualHeight||null==n.ActualWidth||null==n.Top){var r=this.getDefaultImageSettings();for(var i in r)n[i]=Math.round(r[i]),t||(this.Model[i]=n[i])}return n},e.calcLogoLayout=function(t){var n,e,i,o=(this.Model.NaturalWidth||(0,l.vM)())/(this.Model.NaturalHeight||(0,l.HJ)()),s=(t=t||{}).isSmallSize,u=t.isMobile,a=t.isSlimSize;if(u)(e=(n=a?30:s?70:80)*o)>n?(e=(n=a?40:n)*o,i=r.Vertical):i=r.Horizontal;else{var c=void 0;s?(n=70,c=125):a?(n=40,c=95):(n=120,c=215),(e=n*o)>c?(e=(n=a?30:s?40:70)*o,i=r.Vertical):i=r.Horizontal}return{ActualWidth:e=Math.min(e,750),ActualHeight:n,Layout:i}},e.getDefaultImageSettings=function(){var t,n=this.Model;n.NaturalHeight&&n.NaturalWidth?t={NaturalHeight:n.NaturalHeight,NaturalWidth:n.NaturalWidth}:t={NaturalHeight:n.NaturalHeight||(0,l.HJ)(),NaturalWidth:n.NaturalWidth||(0,l.vM)()};if((!(0,f.a)().Flighting.isEnabled_Deprecated("DisableBrandingForMSA")||!(0,u.k0)().userInfo.IsMsa)&&this.IsFormLogo)return t;var e=this.Ve();if(null==e.Height?(t.ContainerWidth=e.Width,t.ContainerHeight=e.Width*t.NaturalHeight/t.NaturalWidth):null==e.Width?(t.ContainerWidth=e.Height*t.NaturalWidth/t.NaturalHeight,t.ContainerHeight=e.Height):(t.ContainerWidth=e.Width,t.ContainerHeight=e.Height),null==e.Height||null==e.Width)t.Left=0,t.Top=0,t.ActualWidth=t.ContainerWidth,t.ActualHeight=t.ContainerHeight;else{var r=Math.max(t.ContainerWidth/t.NaturalWidth,t.ContainerHeight/t.NaturalHeight);t.ActualWidth=r*t.NaturalWidth,t.ActualHeight=r*t.NaturalHeight,t.Left=(t.ContainerWidth-t.ActualWidth)/2,t.Top=(t.ContainerHeight-t.ActualHeight)/2}return t},e.Ve=function(){var t=this.Model;if(null==t.Size||t.Size===i.Small)switch(t.Layout){case r.Square:return{Width:314,Height:314};case r.Vertical:return{Height:314};case r.Horizontal:default:return{Width:314}}else switch(t.Layout){case r.Square:return{Width:414,Height:414};case r.Vertical:return{Height:414};case r.Horizontal:default:return{Width:(0,l.Fy)()}}},n}(a.d.createObjectMasterClass("ImageSettingsMaster",m))},43691:function(t,n,e){"use strict";e.d(n,{M:function(){return v}});var r=e(59312),i=e(36215),o=e(72377),s=e(26203),u=e(39923),a=e(10836),c=e(37076),l=e(68246),f=e(84950),h=e(69856),d=e(55890),m={InsightCount:u.J4.number(),IsReady:u.J4.boolean()};var v=function(t){function n(n){var e=t.call(this,{InitialData:{InsightCount:0,IsReady:!1}})||this;return e._e=n,e.Ge=[],e}(0,r.ZT)(n,t);var e=n.prototype;return Object.defineProperty(e,"Insights",{get:function(){return this.Ge},enumerable:!1,configurable:!0}),Object.defineProperty(e,"FormMaster",{get:function(){return this._e},enumerable:!1,configurable:!0}),e.loadInsight=function(){this.ze()},e.isValidFormScenario=function(){return i.any(this._e.Model.Questions,(function(t){var n=t.QuestionTagForIntelligence;return!!n&&n.indexOf("ScenarioTag")>=0}))},e.hasPinnedInsightOnForm=function(){if(this.Model.IsReady&&this._e.Model.FormsInsightsInfo){var t=JSON.parse(this._e.Model.FormsInsightsInfo);if((null==t?void 0:t.PinedInsights)&&t.PinedInsights.length>0&&i.find(this.Insights,(function(n){return i.contains(t.PinedInsights,n.InsightId)})))return!0}return!1},e.logSeen=function(){var t=i.map(this.Ge,(function(t){return t.CalculationQuestion})),n=s.d.convertToArray(this._e.Model.Questions);n=i.sortBy(n,(function(t){return t.Order}));var e=i.map(t,(function(t){var e=i.findIndex(n,(function(n){return n.Id===t.Id}));return"Page"+(Math.floor(e/2)+1)})),r={AssociationRuleInsightCount:this.Ge.filter((function(t){return t.Type===h.d.AssociationRuleInsight})).length,RatingDistributionInsightCount:this.Ge.filter((function(t){return t.Type===h.d.RatingDistributionAnalysisInsight})).length,SentimentInsightCount:this.Ge.filter((function(t){return t.Type===h.d.ResponseSentimentInsight})).length,WordCloudInsightCount:this.Ge.filter((function(t){return t.Type===h.d.ResponseWordCloudInsight})).length,Distribution:i.uniq(e)};(0,d.$U)("Intelligence.Insights.Seen",r)},e.logAddressable=function(){var t=this._e.Model.ResponsesCount;if(0!==t){var n=i.groupBy(this._e.Model.Questions,(function(t){return t.Type})),e="";i.each(n,(function(t){t&&t.length>0&&(e+=t[0].Type+","+t.length+";")})),e.length>0&&(0,d.$U)("Intelligence.Insights.Addressable",{QuestionType:e,RspCount:t})}},e.logEngage=function(t,n,e,r,s,u){void 0===n&&(n=[]),void 0===e&&(e=null),void 0===r&&(r=0),void 0===s&&(s=0),void 0===u&&(u=null);var a=n.length>0?n[0]:"",c=i.find(this.Insights,(function(t){return t.InsightId===a}));(0,d.$U)("Intelligence.Insights.Engage",{Duration:r,InsightType:null==c?void 0:c.Type,SubActionType:t,QuestionId:u,InsightId:a});var l={AdoptedCandidates:"Explore"!==t&&"LoadMore"!==t?n:[s.toString()],Candidates:n,SuggestionId:e};o.Pv.Resolve("IFormUserContextActionSignal").addUserActionSignal(f.l_[f.l_.Insights]+"."+t,6,l,!1)},e.logHasReomovedInsight=function(){var t,n=this,e=[];if(this._e.Model.FormsInsightsInfo){var r=JSON.parse(this._e.Model.FormsInsightsInfo);(null===(t=null==r?void 0:r.PinedInsights)||void 0===t?void 0:t.length)&&(e=r.PinedInsights)}var o=s.d.convertToArray(this._e.Model.Questions);i.forEach(o,(function(t){if(t.InsightsInfo&&"None"!==t.InsightsInfo){var n=JSON.parse(t.InsightsInfo);(null==n?void 0:n.PinedInsights)&&n.PinedInsights.length>0&&(e=i.union(e,n.PinedInsights))}})),!e.length||this.Ge.length&&!i.some(e,(function(t){return!i.find(n.Insights,(function(n){return n.InsightId===t}))}))||(0,d.$U)("Intelligence.Insights.Removed")},e.Qe=function(){var t=this._e.Model.FormsInsightsInfo;if(t){var n=JSON.parse(t);if(n.PinedInsights&&n.PinedInsights.length>0)return!0}var e=s.d.convertToArray(this._e.Model.Questions);return i.any(e,(function(t){if(t.InsightsInfo&&"None"!==t.InsightsInfo){var n=JSON.parse(t.InsightsInfo);if(n.PinedInsights&&n.PinedInsights.length>0)return!0}}))},e.ze=function(){var t=this;this._e.ensureReadyToDesign().then((function(){var n=t._e.Model;t.logAddressable(),((0,a.cr)("GetRealtimeInsights")||t.Qe()?(0,a.cr)("GetInsightNewApi")?t.IntelligenceProvider.getIntelligenceInsights(n.Id,n.ResponsesCount):t.IntelligenceProvider.getOrCalculateInteractiveInsights(n.Id):t.IntelligenceProvider.getCachedInsights(n.Id)).then((function(n){var e=n.filter((function(t){switch(t.Type){case h.d.AssociationRuleInsight:case h.d.ResponseSentimentInsight:case h.d.ResponseWordCloudInsight:case h.d.RatingDistributionAnalysisInsight:return!0;default:return!1}})).sort((function(t,n){return n.Type-t.Type}));t.bulkEdit((function(){t.Ge=e,t.Model.InsightCount=e.length,t.Model.IsReady=!0})),t.Ge.length>0&&t.logSeen(),(0,a.cr)("AutoPinWordCloudInsight")&&t.He(),t.logHasReomovedInsight()})).catch((function(){t.Model.IsReady=!0}))}))},e.He=function(){var t,n=this,e=this.Ge;if(e&&e.length>0&&(null===(t=this._e)||void 0===t?void 0:t.Model)){var r=e.filter((function(t){return t.Type===h.d.ResponseWordCloudInsight}));if(!r.length)return;var o=[];if(this._e.Model.FormsInsightsInfo&&"None"!==this._e.Model.FormsInsightsInfo){var s=JSON.parse(this._e.Model.FormsInsightsInfo);(null==s?void 0:s.PinedInsights)&&(o=s.PinedInsights)}i.forEach(this._e.Model.Questions,(function(t,e){var s=i.find(r,(function(n){return n.CalculationQuestion.Id===t.Id})),u=null==s?void 0:s.InsightId;if(u){var a=t.InsightsInfo&&"None"!==t.InsightsInfo?JSON.parse(t.InsightsInfo):null,c=(null==a?void 0:a.AutoPinnedInsights)?a.AutoPinnedInsights:[],l=(null==a?void 0:a.PinedInsights)?a.PinedInsights:[],f=!1;i.contains(c,u)||(i.contains(o,u)&&i.contains(l,u)||(l.push(u),f=!0),c.push(u),a={AutoPinnedInsights:c.length>0?c:null,PinedInsights:l.length>0?l:null},n._e.Model.Questions[e].InsightsInfo=JSON.stringify(a),(0,d.$U)("Intelligence.Insights.AutoPin",{pinInsightChanged:f,InsightId:u}))}}))}},Object.defineProperty(e,"IntelligenceProvider",{get:function(){if(!this.je){var t=(0,c.kc)(this._e.Model.Id),n=t.IsGroupOwner?3:2;this.je=l.A.createIntelligenceProvider(n,t.OrgId,t.OwnerId)}return this.je},enumerable:!1,configurable:!0}),n}(s.d.createObjectMasterClass("FormInsight",m))},3864:function(t,n,e){"use strict";e.d(n,{qU:function(){return h},CI:function(){return d},XA:function(){return v},r:function(){return l},bh:function(){return f},Yb:function(){return m}});var r=e(79552),i=e(7645);var o,s,u=e(22617),a=e(72467),c=e(55890);function l(t,n){void 0===n&&(n="Error"),(0,a.f5)().bulkEdit((function(e){e.ErrorBarMessage=t,e.ErrorLevel=n}))}function f(t,n,e){(0,c.$U)((0,r.xP)(n)?"Error.ErrorMessageBar.Show.Expected":"Error.ErrorMessageBar.Show.Unexpected",{Error:JSON.stringify(n),Key:e,Scenario:t},n&&n.correlationId),o=t,s=e,(0,i.ay)().then((function(){return l((t=n.innerCode,t&&(0,u.D)(""+t)||(o?function(t,n){var e=null!=n?n:(0,i.pm)();switch(t){case"CreateQuestion":return e.Error_Bar_Message_CreateQuestion;case"DeleteForm":return e.Error_Bar_Message_DeleteForm;case"DeleteQuestion":return e.Error_Bar_Message_DeleteQuestion;case"ExportResponsesToExcel":return e.Error_Bar_Message_ExportResponsesToExcel;case"RefreshResponses":return e.Error_Bar_Message_RefreshResponses;case"SaveForm":return e.Error_Bar_Message_SaveForm;case"SaveQuestion":return e.Error_Bar_Message_SaveQuestion;case"SyncError_DeleteForm":return e.Error_Bar_Message_SyncError_DeleteForm;case"SyncError_DeleteQuestion":return e.Error_Bar_Message_SyncError_DeleteQuestion;case"SyncError_DeleteSection":return e.Error_Bar_Message_SyncError_DeleteSection;case"SyncError_PatchForm":return e.Error_Bar_Message_SyncError_PatchForm;case"SyncError_PatchQuestion":return e.Error_Bar_Message_SyncError_PatchQuestion;case"SyncError_PatchSection":return e.Error_Bar_Message_SyncError_PatchSection;case"SyncError_PostQuestion":return e.Error_Bar_Message_SyncError_PostQuestion;case"SyncError_PostSection":return e.Error_Bar_Message_SyncError_PostSection;default:return""}}(o):null)));var t}))}function h(t,n){t===o&&n===s&&((0,c.$U)("Error.ErrorMessageBar.Hide",{Key:n,Scenario:t}),o=void 0,s=void 0,l(null))}function d(t){t&&t.Synchronizer.Model.CreationFailed&&!(0,a.f5)().Model.CriticalError&&(0,a.f5)().Model.ErrorBarMessage&&h("SaveForm",t.getInstanceId())}function m(t){(0,a.f5)().Model.InfoBarMessageType=t}function v(){(0,a.f5)().Model.InfoBarMessageType=void 0}},502:function(t,n,e){"use strict";e.d(n,{k:function(){return v}});var r=e(59312),i=e(36215),o=e(26203),s=e(39923),u=e(94956),a=e(54438),c=e(81380),l=e(9743),f=e(91091),h=function(){function t(t){this.Dn=t,this.Lt=(0,c.lK)(this.Dn.Form)}var n=t.prototype;return n.add=function(t){var n=this;if(this.Dn.Form.SyncContext!==l.y.DesignTimeForm)return Promise.resolve();var e=this.Dn.Form;return e?e.Synchronizer.existingInDataSource().then((function(){var t=n.Dn.Model.localeId,r=o.d.Collection.getItemWithKeyFields(e.Model.LocaleList,{localeId:t});return o.d.getObjectMasterFromModel(r).Synchronizer.existingInDataSource()})).then((function(){var e,r=[];for(e in t)if(t.hasOwnProperty(e)){var o=(0,f.Lk)(i.pick(t,[e]));null!==o.elementKey&&"localename"!==o.elementKey&&(o.locale=n.Dn.Model.localeId,o.questionId="",r.push((0,a.m)(o,n.Dn.FormId)))}return Promise.all(r).then((function(t){}))})):Promise.reject()},n.delete=function(t){throw Error("No scenario to call this method currently.")},n.query=function(t){throw Error("No scenario to call this method currently.")},n.update=function(t,n){if(!n.ValuesBefore||this.Dn.Form.SyncContext!==l.y.DesignTimeForm)return Promise.resolve();var e,r=[];for(e in t)if(t.hasOwnProperty(e)){var o=null!==n.ValuesBefore[e],s=(0,f.Lk)(i.pick(t,[e]));s.locale=this.Dn.Model.localeId,s.questionId="",r.push(o?this.Lt.updateLocaleItem(this.Dn.FormId,s):this.Lt.createLocaleItem(this.Dn.FormId,s))}return Promise.all(r).then((function(){}))},t}(),d=e(155),m={conditionalThankyouMessage:s.J4.string(),footerText:s.J4.string(),formCloseMessage:s.J4.string(),formsprortlocalesubtitle:s.J4.string(),formsprortlocaletitle:s.J4.string(),localeId:s.J4.string({IsKeyField:!0}),localeName:s.J4.string(),questionResources:s.J4.collectionOf((function(){return d.A})),subtitle:s.J4.string(),thankYouMessage:s.J4.string(),title:s.J4.string()},v=function(t){function n(e){return t.call(this,e,{Scheduler:new u.b(n.name)})||this}(0,r.ZT)(n,t);var e=n.prototype;return Object.defineProperty(e,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(e,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LocaleId",{get:function(){return this.Model.localeId},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LocaleName",{get:function(){return this.Model.localeName},enumerable:!1,configurable:!0}),n.getFormResourceMaster=function(t,n){var e=i.find(n.Model.LocalizedResources,(function(n){return n.localeId===t}));if(e)return o.d.getObjectMasterFromModel(e);throw Error("This locale does not exist in form.")},n.getQuestionResourceMaster=function(t,n,e){var r=e.Model.LocalizedResources,i=o.d.Collection.getItemWithKeyFields(r,{localeId:t});if(i){if(i.questionResources||(i.questionResources=[]),i.questionResources.length>0){var s=o.d.Collection.getItemWithKeyFields(i.questionResources,{localeId:t,questionId:n});if(s)return o.d.getObjectMasterFromModel(s)}return(0,f._T)({localeId:t,localeName:i.localeName},n,i,e)}throw Error("This locale does not exist in form.")},n}(o.d.createObjectMasterClass("FormLocalizedItemMaster",m,(function(t){return new h(t)})))},91091:function(t,n,e){"use strict";e.d(n,{n$:function(){return s},Lk:function(){return a},e0:function(){return c},an:function(){return l},tc:function(){return f},_T:function(){return h},fp:function(){return d},Mn:function(){return m},fK:function(){return w}});var r=e(36215),i=e(26203),o=e(55890);function s(t){return{localizedResources:u(t)}}function u(t){var n=function(t){var n=t.filter((function(t){return""===t.questionId})),e=r.groupBy(n,(function(t){return t.locale}));return r.map(e,(function(t){var n={conditionalThankyouMessage:null,footerText:null,formCloseMessage:null,formsprortlocalesubtitle:null,formsprortlocaletitle:null,localeId:null,localeName:null,questionResources:[],subtitle:null,thankYouMessage:null,title:null};return t.forEach((function(t){!function(t,n){switch(t.elementKey){case"thankyoumessage":n.thankYouMessage=t.elementValue;break;case"formclosemessage":n.formCloseMessage=t.elementValue;break;case"footertext":n.footerText=t.elementValue;break;case"conditionalthankyoumessage":n.conditionalThankyouMessage=t.elementValue;break;default:v(t,n)}}(t,n)})),n}))}(t),e=function(t){var n=t.filter((function(t){return t.questionId})),e=r.groupBy(n,(function(t){return t.locale})),i={};return r.map(e,(function(t,n){var e=r.groupBy(t,(function(t){return t.questionId}));var i=r.map(e,(function(t,e){var i={choices:[],choicesV1:[],formsprortlocaleldescription:null,formsprortlocalerdescription:null,formsprocustomplaceholder:null,formsprortlocalesubtitle:null,formsprortlocaletitle:null,leftDescription:null,localeId:n,localeName:null,option:null,questionId:e,rightDescription:null,subtitle:null,title:null,cascadeChoices:null};var o=t.filter((function(t){return t.elementKey&&t.elementKey.startsWith("choiceid_")}));if(o&&o.length>0){var s=r.map(o,(function(t){var n={choiceId:null,description:null,key:null};b(t,n);return n}));i.choices=s}var u=t.filter((function(t){return t.elementKey&&!t.elementKey.startsWith("choiceid_")}));if(u){u.forEach((function(t){g(t,i)}))}return i}));return i})).forEach((function(t){var n=t.length>0&&t[0].localeId;n&&(i[n]=t)})),i}(t);return n.forEach((function(t){if(t.localeId){var n=e[t.localeId];n&&(t.questionResources=n)}})),n}function a(t){var n=p(t);return null!=t.formCloseMessage?(n.elementKey="formclosemessage",n.elementValue=t.formCloseMessage):null!=t.thankYouMessage?(n.elementKey="thankyoumessage",n.elementValue=t.thankYouMessage):null!=t.footerText?(n.elementKey="footertext",n.elementValue=t.footerText):null!=t.conditionalThankyouMessage&&(n.elementKey="conditionalthankyoumessage",n.elementValue=t.conditionalThankyouMessage),n}function c(t){var n=p(t);return null!=t.leftDescription?(n.elementKey="leftdescription",n.elementValue=t.leftDescription):null!=t.rightDescription?(n.elementKey="rightdescription",n.elementValue=t.rightDescription):null!=t.option&&'{"choicesV1":[]}'!==t.option?(n.elementKey="option",n.elementValue=t.option):null!=t.formsprortlocaleldescription?(n.elementKey="formsprortlocaleldescription",n.elementValue=t.formsprortlocaleldescription):null!=t.formsprortlocalerdescription?(n.elementKey="formsprortlocalerdescription",n.elementValue=t.formsprortlocalerdescription):null!=t.formsprocustomplaceholder&&(n.elementKey="formsprocustomplaceholder",n.elementValue=t.formsprocustomplaceholder),n}function l(t,n){var e=n.Model;if(!i.d.Collection.getItemWithKeyFields(e.LocalizedResources,{localeId:t.localeId})){var r={footerText:null,formCloseMessage:null,formsprortlocalesubtitle:null,formsprortlocaletitle:null,localeId:t.localeId,localeName:t.localeName,questionResources:[],subtitle:null,thankYouMessage:null,title:null,conditionalThankyouMessage:null};i.d.Collection.itemsAddedInSource(e.LocalizedResources,[r])}}function f(t,n){var e=n.Model,r=i.d.Collection.getItemWithKeyFields(e.LocalizedResources,{localeId:t});r&&i.d.Collection.itemsDeletedInSource(e.LocalizedResources,[r])}function h(t,n,e,o){var s={choices:[],choicesV1:[],formsprortlocaleldescription:null,formsprortlocalerdescription:null,formsprocustomplaceholder:null,formsprortlocalesubtitle:null,formsprortlocaletitle:null,leftDescription:null,localeId:t.localeId,localeName:t.localeName,option:null,questionId:n,rightDescription:null,subtitle:null,title:null,cascadeChoices:null},u=i.d.Collection.getItemWithKeyFields(o.Model.Questions,{Id:n});if(u&&u.ChoiceGroup&&u.ChoiceGroup.length>0){var a=r.map(u.ChoiceGroup,(function(t){return{choiceId:t.Id.toString(),description:null,key:t.Key}}));s.choices=a}var c=i.d.Collection.itemsAddedInSource(e.questionResources,[s]);return i.d.getObjectMasterFromModel(c[0])}function d(t,n,e){var r={choiceId:t,description:null,key:n},o=i.d.Collection.itemsAddedInSource(e.choices,[r]);return i.d.getObjectMasterFromModel(o[0])}function m(t){var n=i.d.Collection.itemsAddedInSource(t.choicesV1,[{choiceId:null,description:"",formsProDisplayRTText:""}]);return i.d.getObjectMasterFromModel(n[0])}function v(t,n){switch(n.localeId=t.locale,t.elementKey){case"title":n.title=t.elementValue;break;case"subtitle":n.subtitle=t.elementValue;break;case"localename":n.localeName=t.elementValue;break;case"formsprortlocaletitle":n.formsprortlocaletitle=t.elementValue;break;case"formsprortlocalesubtitle":n.formsprortlocalesubtitle=t.elementValue;break;default:var e=t.elementValue&&t.elementValue.length,r="Unexpected locale element key:["+t.elementKey+"], value length:"+e,i=new Error(r).stack;return console.log(i),void(0,o.zU)("UnexpectedLocaleElementKey",r+", call stack:"+i)}}function p(t){var n={elementKey:null,elementValue:null,locale:null,questionId:null};return null!=t.title?(n.elementKey="title",n.elementValue=t.title):null!=t.subtitle?(n.elementKey="subtitle",n.elementValue=t.subtitle):null!=t.localeName?(n.elementKey="localename",n.elementValue=t.localeName):null!=t.formsprortlocaletitle?(n.elementKey="formsprortlocaletitle",n.elementValue=t.formsprortlocaletitle):null!=t.formsprortlocalesubtitle&&(n.elementKey="formsprortlocalesubtitle",n.elementValue=t.formsprortlocalesubtitle),n}function g(t,n){switch(n.questionId=t.questionId,t.elementKey){case"leftdescription":n.leftDescription=t.elementValue;break;case"rightdescription":n.rightDescription=t.elementValue;break;case"option":n.option=t.elementValue;break;case"formsprortlocaleldescription":n.formsprortlocaleldescription=t.elementValue;break;case"formsprortlocalerdescription":n.formsprortlocalerdescription=t.elementValue;break;case"formsprocustomplaceholder":n.formsprocustomplaceholder=t.elementValue;break;default:v(t,n)}}function b(t,n){var e=t.elementKey;e&&e.startsWith("choiceid_")&&(n.choiceId=e.split("_")[1]),n.description=t.elementValue}function w(t,n){t&&t.length>0&&r.forEach(t,(function(t){var e=[];r.forEach(n,(function(n){var o=r.filter(t.questionResources,(function(t){return t.questionId===n.oldId}));r.forEach(o,(function(t){(t=r.clone(i.d.getObjectMasterFromModel(t).getSnapshot())).questionId=n.newId,e.push(t)}))})),i.d.Collection.addItems(t.questionResources,e)}))}},155:function(t,n,e){"use strict";e.d(n,{A:function(){return y}});var r=e(59312),i=e(36215),o=e(37890),s=e(26203),u=e(39923),a=e(94956),c=e(53907),l=e(62539),f=e(54438),h=e(81380),d=e(9743),m=function(){function t(t){this.Dn=t,this.Lt=(0,h.lK)(this.Dn.Form)}var n=t.prototype;return n.add=function(t){var n=this;if(this.Dn.Form.SyncContext!==d.y.DesignTimeForm)return Promise.resolve();var e=this.Dn.QuestionId;if(e){var r=this.Dn.Form.getQuestionById(e).getChoiceByKey(this.Dn.Model.key||"");if(r)return r.Synchronizer.existingInDataSource().then((function(){var e=r.Model.Id.toString();n.Dn.Model.choiceId=e;var i={elementKey:"choiceid_"+e,elementValue:t.description,locale:n.Dn.LocaleId,questionId:n.Dn.QuestionId};return(0,f.m)(i,n.Dn.FormId).then((function(){return{choiceId:e,description:t.description}}))}))}return Promise.reject()},n.delete=function(t){throw Error("No scenario to call this method currently.")},n.query=function(t){throw Error("No scenario to call this method currently.")},n.update=function(t,n){if(!n.ValuesBefore||this.Dn.Form.SyncContext!==d.y.DesignTimeForm)return Promise.resolve();if(t.choiceId||void 0===t.description)throw Error("No valid payload to update.");var e={elementKey:"choiceid_"+this.Dn.ChoiceId,elementValue:t.description,locale:this.Dn.LocaleId,questionId:this.Dn.QuestionId};return null!==n.ValuesBefore.description?this.Lt.updateLocaleItem(this.Dn.FormId,e):this.Lt.createLocaleItem(this.Dn.FormId,e)},t}(),v={choiceId:u.J4.string({IsKeyField:!0}),description:u.J4.string(),key:u.J4.string({IsLocalField:!0})},p=function(t){function n(e){var r=t.call(this,e,{Scheduler:new a.b(n.name)})||this;if(!r.Model.key){if(!r.Model.choiceId)throw Error("Current choice localized master doesn't has key and choiceId.");e.MasterTreeReady&&e.MasterTreeReady.then((function(){return r.Form.fieldsReady([r.Form.Schema.Questions])})).then((function(){var t=r.Form.getQuestionById(r.QuestionId).getChoiceById(Number(r.Model.choiceId));t&&(r.Model.key=t.Model.Key)}))}return r}(0,r.ZT)(n,t);var e=n.prototype;return Object.defineProperty(e,"QuestionLocalizedMaster",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Form",{get:function(){return this.QuestionLocalizedMaster.Form},enumerable:!1,configurable:!0}),Object.defineProperty(e,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(e,"QuestionId",{get:function(){return this.QuestionLocalizedMaster.Model.questionId},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LocaleId",{get:function(){return this.QuestionLocalizedMaster.Model.localeId},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ChoiceId",{get:function(){return this.Model.choiceId},enumerable:!1,configurable:!0}),n}(s.d.createObjectMasterClass("ChoiceLocalizedItemMaster",v,(function(t){return new m(t)}))),g=e(91091),b=function(){function t(t){this.Dn=t,this.Lt=(0,h.lK)(this.Dn.Form)}var n=t.prototype;return n.add=function(t){var n=this;if(this.Dn.Form.SyncContext!==d.y.DesignTimeForm)return Promise.resolve();var e=this.Dn.QuestionId;if(e){var r=this.Dn.Form.getElementById(e);if(r)return r.Synchronizer.existingInDataSource().then((function(){var e,r=[];for(e in t)if(t.hasOwnProperty(e)){var o=(0,g.e0)(i.pick(t,[e]));o.elementKey&&(o.locale=n.Dn.Model.localeId,o.questionId=n.Dn.QuestionId,r.push((0,f.m)(o,n.Dn.FormId)))}return Promise.all(r).then((function(t){}))}))}return Promise.reject()},n.delete=function(t){throw Error("No scenario to call this method currently.")},n.query=function(t){throw Error("No scenario to call this method currently.")},n.update=function(t,n){if(!n.ValuesBefore||this.Dn.Form.SyncContext!==d.y.DesignTimeForm)return Promise.resolve();var e,r=[];for(e in t)if(t.hasOwnProperty(e)){var o=null!==n.ValuesBefore[e],s=(0,g.e0)(i.pick(t,[e]));s.locale=this.Dn.Model.localeId,s.questionId=this.Dn.QuestionId,r.push(o?this.Lt.updateLocaleItem(this.Dn.FormId,s):this.Lt.createLocaleItem(this.Dn.FormId,s))}return Promise.all(r).then((function(){}))},t}(),w={choices:u.J4.collectionOf((function(){return p})),choicesV1:u.J4.collectionOf({choiceId:u.J4.string({IsLocalField:!0}),description:u.J4.string({SourceFieldName:"Description"}),formsProDisplayRTText:u.J4.string({SourceFieldName:"FormsProDisplayRTText"})},{IsLocalField:!0}),formsprortlocaleldescription:u.J4.string(),formsprortlocalerdescription:u.J4.string(),formsprocustomplaceholder:u.J4.string(),formsprortlocalesubtitle:u.J4.string(),formsprortlocaletitle:u.J4.string(),leftDescription:u.J4.string(),localeId:u.J4.string({IsKeyField:!0}),localeName:u.J4.string(),option:u.J4.string(),questionId:u.J4.string({IsKeyField:!0}),rightDescription:u.J4.string(),subtitle:u.J4.string(),title:u.J4.string(),cascadeChoices:u.J4.collectionOf({choiceId:u.J4.string({IsLocalField:!0}),elementValue:u.J4.string({IsLocalField:!0}),locale:u.J4.string({IsLocalField:!0}),questionId:u.J4.string({IsLocalField:!0})},{IsLocalField:!0})},y=function(t){function n(e){var r=this,i=new o.wU;return(r=t.call(this,e,{MasterReady:i.promise(),Scheduler:new a.b(n.name)})||this).$e(e),i.resolve(),r}(0,r.ZT)(n,t);var e=n.prototype;return n.handleChoicesV1Deleted=function(t,n,e){t<0||i.forEach(e.Model.LocalizedResources,(function(e){i.filter(e.questionResources,(function(t){return t.questionId===n})).forEach((function(n){n.choicesV1.length>t&&s.d.Collection.itemsDeletedInSource(n.choicesV1,[n.choicesV1[t]])}))}))},n.handleChoicesV1Exchange=function(t,n,e,r){i.forEach(r.Model.LocalizedResources,(function(r){s.d.getCollectionMasterFromModel(r.questionResources).bulkEdit((function(r){i.filter(r,(function(t){return t.questionId===e})).forEach((function(e){var r,o,s=e.choicesV1;for(t>n?(r=n,o=t):(r=t,o=n);s.length<=o+1;)(0,g.Mn)(e);var u=i.map(s,(function(t){return t.description})),a=u.splice(t,1);u.splice(n,0,a[0]);for(var c=r;c<=o;++c)s[c].description=u[c]}))}))}))},Object.defineProperty(e,"Form",{get:function(){return this.FormLocalizedMaster.Form},enumerable:!1,configurable:!0}),Object.defineProperty(e,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(e,"FormLocalizedMaster",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(e,"QuestionId",{get:function(){return this.Model.questionId},enumerable:!1,configurable:!0}),e.getChoiceLocalizedMaster=function(t){var n=this,e=i.find(this.Form.Model.Questions,(function(t){return t.Id===n.QuestionId}));if(e){var r=i.find(e.ChoiceGroup,(function(n){return n.Id.toString()===t}));if(r){var o=s.d.Collection.getItemWithKeyFields(this.Model.choices,{choiceId:t});return o?s.d.getObjectMasterFromModel(o):(0,g.fp)(t,r.Key,this.Model)}}throw Error("Question or Chocie don't exist for localization.")},e.getChoiceV1LocalizedMaster=function(t){var n=this,e=i.find(this.Form.Model.Questions,(function(t){return t.Id===n.QuestionId}));if(e&&e.Choices.length>t){for(;this.Model.choicesV1.length<e.Choices.length;)(0,g.Mn)(this.Model);return s.d.getObjectMasterFromModel(this.Model.choicesV1[t])}return null},e.$e=function(t){n.Schema.option&&(this.We=new c.S(this,n.Schema.option,n.ChoicesV1FieldSet),t.InitialData&&this.isFieldReady(n.Schema.option)&&(t.ExistingInDataSource||t.InitialData.option?this.We.deserialize():this.We.serialize()))},Object.defineProperty(n,"ChoicesV1FieldSet",{get:function(){return n.choicesV1FieldSet||(n.choicesV1FieldSet=new l.C([n.Schema.choicesV1])),n.choicesV1FieldSet},enumerable:!1,configurable:!0}),n}(s.d.createObjectMasterClass("QuestionLocalizedItemMaster",w,(function(t){return new b(t)})))},64966:function(t,n,e){"use strict";e.d(n,{LN:function(){return m},yN:function(){return h},pg:function(){return d}});var r=e(59312),i=e(26203),o=e(39923),s=e(41293),u=e(9743),a=e(81380),c=function(){function t(t,n){this.Je=t,this.Lt=(0,a.lK)(this.Je.Form)}var n=t.prototype;return Object.defineProperty(n,"FormId",{get:function(){return this.Je.FormId},enumerable:!1,configurable:!0}),n.add=function(t){return this.Je.Form.SyncContext===u.y.AdminPhishingReviewForm?this.Lt.createAdminPhishingReviewPermissionLink(this.FormId,t):this.Lt.createPermissionLink(this.FormId,t)},n.delete=function(t){return this.Lt.deletePermissionLink(this.FormId,t.principalId)},n.query=function(t){return(0,s._y)("No scenario to call this method currently.")},n.update=function(t,n){if("OrgLink"===n.Snapshot.type||"Link"===n.Snapshot.type||"ShareToPeople"===n.Snapshot.type){var e={permissionSet:n.Snapshot.permissionSet,type:n.Snapshot.type};return this.Je.Form.SyncContext===u.y.AdminPhishingReviewForm?this.Lt.createAdminPhishingReviewPermissionLink(this.FormId,e):this.Lt.createPermissionLink(this.FormId,e)}return(0,s._y)("No scenario to call this method currently.")},t}(),l=e(82205),f={PrincipalId:o.J4.string({SourceFieldName:"principalId"}),PermissionSet:o.J4.string({SourceFieldName:"permissionSet"}),Type:o.J4.reference({SourceFieldName:"type"}),FormId:o.J4.string({IsSourceGenerated:!0,SourceFieldName:"formId"}),IsOwner:o.J4.boolean({IsSourceGenerated:!0,SourceFieldName:"isOwner"}),PrincipalEmailAddress:o.J4.string({IsSourceGenerated:!0,SourceFieldName:"principalEmailAddress"}),PrincipalName:o.J4.string({IsSourceGenerated:!0,SourceFieldName:"principalName"}),SavingState:o.J4.reference({IsLocalField:!0})};function h(t){return{PermissionSet:"Read, Write, Share",Type:t}}function d(t){return i.d.getObjectMasterFromModel(t)}var m=function(t){function n(n){var e=t.call(this,n)||this;return(0,l.vG)(e),e}(0,r.ZT)(n,t);var e=n.prototype;return Object.defineProperty(e,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(e,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),n}(i.d.createObjectMasterClass("Permission",f,(function(t,n){return new c(t,n)})))},99374:function(t,n,e){"use strict";e.d(n,{p:function(){return f},R:function(){return l}});var r=e(59312),i=e(26203),o=e(39923),s=e(41293),u=e(81380),a=function(){function t(t,n){this.Xe=t,this.Lt=(0,u.lK)(this.Xe.getForm())}var n=t.prototype;return n.Ye=function(){return this.Xe.getFormId()},n.add=function(t){return this.Lt.createPermissionToken(this.Ye(),t)},n.delete=function(t){return this.Lt.deletePermissionToken(this.Ye(),t.principalId)},n.query=function(t){return(0,s._y)("No scenario to call this method currently.")},n.update=function(t,n){return(0,s._y)("No scenario to call this method currently.")},t}(),c={PrincipalId:o.J4.string({IsSourceGenerated:!0,SourceFieldName:"principalId"}),Type:o.J4.reference({SourceFieldName:"type"}),Name:o.J4.string({SourceFieldName:"name"})};function l(t){return i.d.getObjectMasterFromModel(t)}var f=function(t){function n(n){return t.call(this,n)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.getForm=function(){return this.Parent.Parent},e.getFormId=function(){return this.getForm().Model.Id},n}(i.d.createObjectMasterClass("PermissionToken",c,(function(t,n){return new a(t,n)})))},39271:function(t,n,e){"use strict";e.d(n,{Z:function(){return v},I:function(){return r}});var r,i=e(59312),o=e(36215),s=e(26203),u=e(39923),a=e(67661),c=e(51586),l=e(41448),f=function(){function t(t){this.Ze=t}var n=t.prototype;return n.add=function(t){throw Error("No scenario to call this method currently.")},n.delete=function(t){throw Error("No scenario to call this method currently.")},n.query=function(t){var n,e=(0,l.d8)();switch(this.Ze.Model.Extension){case r.Form:n="User";break;case r.GroupForm:n="Group";break;default:n=null}return e.getRecentForms(n).then((function(t){return{documents:t}}))},n.update=function(t,n){return new Promise((function(){}))},t}(),h={App:u.J4.string({SourceFieldName:"app"}),Category:u.J4.string({SourceFieldName:"category"}),Extension:u.J4.string({SourceFieldName:"extension"}),FormCategory:u.J4.string({SourceFieldName:"formCategory"}),FormType:u.J4.string({SourceFieldName:"formType"}),IsPinned:u.J4.boolean({SourceFieldName:"isPinned"}),MruId:u.J4.string({SourceFieldName:"mruId"}),NotExist:u.J4.boolean({IsLocalField:!0}),OwnerId:u.J4.string({SourceFieldName:"ownerId"}),OwnerName:u.J4.string({SourceFieldName:"ownerName"}),OwnerTenantId:u.J4.string({SourceFieldName:"ownerTenantId"}),OwnerType:u.J4.reference({SourceFieldName:"ownerType"}),ServerDocId:u.J4.string({SourceFieldName:"serverDocId"}),Timestamp:u.J4.string({SourceFieldName:"timestamp"}),Title:u.J4.string({SourceFieldName:"title"}),Type:u.J4.string({SourceFieldName:"type"}),Url:u.J4.string({SourceFieldName:"url"})},d=function(t){function n(n){var e=t.call(this,n)||this;return e.Model.NotExist=!1,e}(0,i.ZT)(n,t);var e=n.prototype;return Object.defineProperty(e,"FormMaster",{get:function(){return this._e||(this._e=(0,c.Si)({Id:this.Model.ServerDocId})),this._e},enumerable:!1,configurable:!0}),e.matchSearchStrings=function(t){var n=(this.Model.Title+" "+(this.Model.OwnerName||"")).toLowerCase();return o.all(t,(function(t){return n.indexOf(t)>=0}))},n}(s.d.createObjectMasterClass("MruDocument",h)),m={Extension:u.J4.enumeration((function(){return r}),{IsLocalField:!0}),Knowledge:u.J4.string({IsSourceGenerated:!0,SourceFieldName:"knowledge"}),MruDocuments:u.J4.collectionOf((function(){return d}),{SourceFieldName:"documents"}),ResponseCode:u.J4.string({IsSourceGenerated:!0,SourceFieldName:"responseCode"})};!function(t){t[t.Form=0]="Form",t[t.GroupForm=1]="GroupForm",t[t.Unspecified=2]="Unspecified"}(r||(r={}));var v=function(t){function n(){var n=t.call(this,{ExistingInDataSource:!0,InitialData:{Extension:r.GroupForm,Knowledge:""}})||this;return n.tr=[],n}(0,i.ZT)(n,t);var e=n.prototype;return n.getInstance=function(){return this.instance||(this.instance=new n),this.instance},Object.defineProperty(e,"Documents",{get:function(){return this.isFieldReady(this.Schema.MruDocuments)?s.d.convertToArray(this.Model.MruDocuments).sort((function(t,n){return Date.parse(n.Timestamp)-Date.parse(t.Timestamp)})).map((function(t){return s.d.getObjectMasterFromModel(t)})):[]},enumerable:!1,configurable:!0}),e.removeDocument=function(t){this.isFieldReady(this.Schema.MruDocuments)&&s.d.Collection.deleteItems(this.Model.MruDocuments,o.filter(this.Model.MruDocuments,(function(n){return n.ServerDocId===t})))},e.initializeFormList=function(){var t=this,e=n.Schema;return this.ensureFieldsReady([e.Knowledge,e.MruDocuments]).then((function(){o.forEach(t.Model.MruDocuments,(function(t){var n=(0,c.ZP)({Id:t.ServerDocId},!1);n.fieldsReady([a.x.Schema.Title]).then((function(){n.observe((function(e){e.BeingDeleted||(t.Title=n.Model.Title)}),[a.x.Schema.Title]),t.Title=n.Model.Title}))}))}),(function(){}))},e.observeListChange=function(t){if(this.nr(t)<0){var n=function(n){(n.AddedModels.length||n.RemovedModels.length)&&t()};this.tr.push({originCallback:t,registeredCallback:n}),this.er().then((function(t){return t.observe(n)}))}},e.unobserveListChange=function(t){var n=this.nr(t);if(n>=0){var e=this.tr[n];this.tr.splice(n,1),this.er().then((function(t){return t.unobserve(e.registeredCallback)}))}},e.er=function(){var t=this;return this.fieldsReady([this.Schema.MruDocuments]).then((function(){return s.d.getCollectionMasterFromModel(t.Model.MruDocuments)}))},e.nr=function(t){return o.findIndex(this.tr,(function(n){return n.originCallback===t}))},n}(s.d.createObjectMasterClass("MruDocumentCollection",m,(function(t){return new f(t)})));Forms.Mru.MruDocumentCollectionMaster=v},20469:function(t,n,e){"use strict";e.d(n,{Qq:function(){return d},kF:function(){return f},cp:function(){return h}});var r=e(59312),i=e(26203),o=e(39923),s=e(41293),u=e(81380),a=function(){function t(t,n){this.Je=t,this.Lt=(0,u.lK)(this.Je.Form)}var n=t.prototype;return Object.defineProperty(n,"FormId",{get:function(){return this.Je.FormId},enumerable:!1,configurable:!0}),n.add=function(t){return this.Lt.createResponderPermissionLink(this.FormId,t)},n.delete=function(t){return this.Lt.deleteResponderPermissionLink(this.FormId,t.principalId)},n.query=function(t){return(0,s._y)("No scenario to call this method currently.")},n.update=function(t,n){return(0,s._y)("No scenario to call this method currently.")},t}(),c=e(82205),l={PrincipalId:o.J4.string({SourceFieldName:"principalId"}),PermissionSet:o.J4.string({SourceFieldName:"permissionSet"}),Type:o.J4.reference({SourceFieldName:"type"}),FormId:o.J4.string({IsSourceGenerated:!0,SourceFieldName:"formId"}),IsOwner:o.J4.boolean({IsSourceGenerated:!0,SourceFieldName:"isOwner"}),PrincipalEmailAddress:o.J4.string({IsSourceGenerated:!0,SourceFieldName:"principalEmailAddress"}),PrincipalName:o.J4.string({IsSourceGenerated:!0,SourceFieldName:"principalName"}),SavingState:o.J4.reference({IsLocalField:!0})};function f(t){return{PermissionSet:"DataCreator",Type:t}}function h(t){return i.d.getObjectMasterFromModel(t)}var d=function(t){function n(n){var e=t.call(this,n)||this;return(0,c.vG)(e),e}(0,r.ZT)(n,t);var e=n.prototype;return Object.defineProperty(e,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(e,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),n}(i.d.createObjectMasterClass("ResponderPermission",l,(function(t,n){return new a(t,n)})))},41275:function(t,n,e){"use strict";e.d(n,{KJ:function(){return b},q4:function(){return g},_p:function(){return p}});var r=e(59312),i=e(37890),o=e(82205),s=e(26203),u=e(39923),a=e(41293),c=e(9743),l=e(81380),f=function(){function t(t,n){this.rr=t,this.ir=n,this.Lt=(0,l.lK)(this.rr.Form)}var n=t.prototype;return n.Ye=function(){return this.rr.FormId},n.sr=function(){return this.rr.ResponseId},n.add=function(t){return(0,a._y)("No scenario to call this method currently.")},n.delete=function(t){return this.Lt.deleteFormResponse(this.Ye(),t.id)},n.query=function(t){return(0,a._y)("No scenario to call this method currently.")},n.update=function(t,n){var e=t.releaseDate,r=this.rr.Form.SyncContext;return r!==c.y.DesignTimeForm&&r!==c.y.AnalysisTimeForm?new Promise((function(){})):void 0!==e?this.Lt.setResponseReleaseDate(this.Ye(),this.sr(),e):Promise.resolve()},t}(),h=e(82963),d=e(94956),m=e(86415),v={Id:u.J4.number({IsKeyField:!0,SourceFieldName:"id"}),Comments:u.J4.collectionOf((function(){return m.k}),{SourceFieldName:"comments"}),AnswersAsString:u.J4.string({SourceFieldName:"answers"}),StartDateAsString:u.J4.string({SourceFieldName:"startDate"}),SubmitDateAsString:u.J4.string({SourceFieldName:"submitDate"}),Responder:u.J4.string({SourceFieldName:"responder"}),ResponderName:u.J4.string({SourceFieldName:"responderName"}),QuizResult:u.J4.string({SourceFieldName:"quizResult"}),ReleaseDateAsString:u.J4.string({SourceFieldName:"releaseDate"}),Answers:u.J4.collectionOf({QuestionId:u.J4.string({IsKeyField:!0,SourceFieldName:"questionId"}),Answer:u.J4.reference({SourceFieldName:"answer1"}),Feedback:u.J4.string({IsLocalField:!0}),Score:u.J4.number({IsLocalField:!0}),IsAutoGraded:u.J4.boolean({IsLocalField:!0}),IsMathAnswer:u.J4.boolean({IsLocalField:!0})},{IsLocalField:!0}),StartDate:u.J4.reference({IsLocalField:!0}),SubmitDate:u.J4.reference({IsLocalField:!0}),ReleaseDate:u.J4.reference({IsLocalField:!0}),Feedback:u.J4.string({IsLocalField:!0}),TotalScore:u.J4.number({IsLocalField:!0}),IntegratedSavingState:u.J4.reference({IsLocalField:!0}),SavingState:u.J4.reference({IsLocalField:!0}),EmailReceiptConsent:u.J4.boolean({SourceFieldName:"emailReceiptConsent"}),SubmitLanguage:u.J4.string({SourceFieldName:"submitLanguage"}),MSRewardsData:u.J4.reference({SourceFieldName:"msRewardsData"}),FormsProData:u.J4.reference({SourceFieldName:"formsProData"})};v.Answers[0];function p(t){return s.d.getObjectMasterFromModel(t)}function g(t,n){return(0,h.q4)(t.Model.Id,n)}var b=function(t){function n(e){var r=this,o=new i.wU;return(r=t.call(this,e,{Scheduler:new d.b(n.name),MasterReady:o.promise()})||this).ar(),n.Rules.forEach((function(t){return r.addRule(t)})),o.resolve(),r}(0,r.ZT)(n,t);var e=n.prototype;return Object.defineProperty(e,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(e,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ResponseId",{get:function(){return this.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Comment",{get:function(){return this.getCommentByQuestionId(null)},enumerable:!1,configurable:!0}),e.updateWithNormalizedResponse=function(t){var e=this;this.bulkEdit((function(){e.Synchronizer.onSourceDataReceived(s.d.convertToSourceData(t,n.Schema)),e.setData(t)}))},e.getAnswerByQuestionId=function(t){var n=s.d.Collection.getItemWithKeyFields(this.Model.Answers,{QuestionId:t});return n&&s.d.getObjectMasterFromModel(n)},e.getCommentByQuestionId=function(t){var n=s.d.Collection.getItemWithKeyFields(this.Model.Comments,{QuestionId:t});return n&&(0,m.I)(n)},e.setAnswerGrading=function(t,n,e){var r=this.Form.getQuestionById(t);if(r){var i=r.SubQuestionMasters;i.length>0&&(t=i[i.length-1].Model.Id);var o=this.getCommentByQuestionId(t);if(o)o.bulkEdit((function(){void 0!==n&&(o.Model.Score=n),void 0!==e&&(o.Model.Feedback=e)}));else{var u=this.getAnswerByQuestionId(t);n=null!=n?n:u.Model.Score;var a={QuestionId:t,Feedback:e,Score:n};try{s.d.Collection.addItems(this.Model.Comments,[a])}catch(r){this.getCommentByQuestionId(t)&&this.setAnswerGrading(t,n,e)}}}},e.ar=function(){var t=this;this.lr="Idle";var n=s.d.getCollectionMasterFromModel(this.Model.Comments);(0,o.v)(n,n.Schema[0].SavingState,(function(n){t.lr=n,t.Fn()})),(0,o.vG)(this),this.Fn()},e.hr=function(t){var n=this.getAnswerByQuestionId(t);if(n)return n;var e=s.d.Collection.addItems(this.Model.Answers,[{QuestionId:t}])[0];return s.d.getObjectMasterFromModel(e)},e.Fn=function(){this.Model.IntegratedSavingState=(0,o.IM)([this.Model.SavingState,this.lr])},Object.defineProperty(n,"Rules",{get:function(){if(!n.rules){var t=n.Schema;n.rules=[{Name:"ResponseComment",InterestedFields:[t.Feedback,t.TotalScore],onChange:function(t){var n=t.Master,e=n.getCommentByQuestionId(null);e?e.bulkEdit((function(){e.Model.Feedback=n.Model.Feedback,e.Model.Score=n.Model.TotalScore})):s.d.Collection.addItems(n.Model.Comments,[{QuestionId:null,Feedback:n.Model.Feedback,Score:n.Model.TotalScore}])}},{Name:"AnswerComment",InterestedFields:[t.Answers[0].Feedback,t.Answers[0].Score,t.Answers[0].IsAutoGraded],onChange:function(t){var n=t.Master,e=n.Model.Answers,r=function(t){t.IsAutoGraded||n.setAnswerGrading(t.QuestionId,t.Score,t.Feedback)};t.SubChanges.filter((function(t){return t.Master.Model===e})).forEach((function(t){t.AddedModels.forEach(r),t.SubChanges.forEach((function(t){return r(t.Master.Model)}))}))}},{Name:"ApplyCommentChange",InterestedFields:[t.Comments],onChange:function(t){var n=t.Master,e=n.Model.Comments,r=function(t){var e=t.QuestionId;if(e){var r=n.hr(e);r.bulkEdit((function(){r.Model.Feedback=t.Feedback,r.Model.Score=t.Score,r.Model.IsAutoGraded=!1}))}else n.bulkEdit((function(){n.Model.Feedback=t.Feedback,n.Model.TotalScore=t.Score}))};t.SubChanges.filter((function(t){return t.Master.Model===e})).forEach((function(t){t.AddedModels.forEach(r),t.SubChanges.forEach((function(t){return r(t.Master.Model)}))}))}}],n.rules=n.rules.concat(n.getRulesForSyncBetweenDateFields(t.StartDate,t.StartDateAsString),n.getRulesForSyncBetweenDateFields(t.SubmitDate,t.SubmitDateAsString),n.getRulesForSyncBetweenDateFields(t.ReleaseDate,t.ReleaseDateAsString))}return n.rules},enumerable:!1,configurable:!0}),n.getRulesForSyncBetweenDateFields=function(t,n){var e=s.d.getFieldSchemaInfo(t).Name,r=s.d.getFieldSchemaInfo(n).Name;return[{Name:"update "+e,InterestedFields:[n],onChange:function(t){var n=t.Master.Model;n[e]=new Date(n[r])}},{Name:"update "+r,InterestedFields:[t],onChange:function(t){var n=t.Master.Model;n[r]=n[e].toISOString()}}]},n}(s.d.createObjectMasterClass("Response",v,(function(t,n){return new f(t,n)})))},71683:function(t,n,e){"use strict";e.d(n,{X:function(){return s}});var r=e(36215),i=e(25366),o=e(72374),s=function(){function t(t){this.dr=[],this.mr=this.mr.bind(this),this.vr=t}var n=t.prototype;return t.getBranchedSections=function(n,e){for(var s=[],u=[],a=0,c=function(){var c=n[a];if(r.findIndex(s,(function(t){return t.Section===c.Section}))>=0)return"break";for(var l=[],f=void 0,h=c.TopQuestionMasters[0],d=function(){if(r.include(u,h))return"break";u.push(h),l.push(h);var t=e(h,c.TopQuestionMasters),s=t.TargetElement;s instanceof o.MF?h=s:(s&&i.H.isSection(s.Model.Type)?f=r.findIndex(n,(function(t){return t.Section===s})):"End"===t.Type&&(f=-1),h=null)};h;){if("break"===d())break}s.push({Section:c.Section,TopQuestionMasters:l}),a=void 0!==f?f:t.getNextSectionFromSection(c,n)};a<=n.length-1&&a>=0;){if("break"===c())break}return s},n.calculateQuestionRuntimeList=function(n){var e=[],r=this.gr(n);this.formRuntimeMaster.IsDisableBranching||(r=t.getBranchedSections(r,this.mr));var i=this.dr,o=this.br(r,e);if(this.vr||t.isBranchingResultChanged(i,o)){this.dr=o;var s=this.formRuntimeMaster.Model;this.formRuntimeMaster.bulkEdit((function(){s.QuestionRuntimeMasters=e,s.BranchChangeVersion=(s.BranchChangeVersion||0)+1}))}},n.hasPrevSection=function(){return this.wr()>0},n.gotoPrevSection=function(){var t=this.wr();if(t>0){var n=this.dr[t-1];this.formRuntimeMaster.Model.RuntimeSectionId=n.Section&&n.Section.Model.Id}},n.hasNextSection=function(){return this.wr()<this.dr.length-1},n.gotoNextSection=function(){var t=this.yr();t&&(this.formRuntimeMaster.Model.RuntimeSectionId=t)},n.getAllSections=function(){return this.dr},n.getCurrentSection=function(){return this.Ir(this.formRuntimeMaster.Model.RuntimeSectionId)},n.isFirstPage=function(){var t=this.getCurrentSection();return 0===this.dr.indexOf(t)},t.isBranchingResultChanged=function(t,n){if(t.length!==n.length)return!0;for(var e=0;e<t.length;e++){if(t[e].Section!==n[e].Section||t[e].TopQuestionMasters.length!==n[e].TopQuestionMasters.length)return!0;for(var r=0;r<t[e].TopQuestionMasters.length;r++)if(t[e].TopQuestionMasters[r]!==n[e].TopQuestionMasters[r])return!0}return!1},n.mr=function(t,n){var e=this.formRuntimeMaster.getOrCreateQuestionRuntime(t),r=e.Model.BranchingType,i=e.Model.BranchedElement;return i instanceof o.MF&&-1===n.indexOf(i)&&(i=n[n.indexOf(t)+1]),{TargetElement:i,Type:r}},n.br=function(t,n){var e=this;return t.map((function(t){return{Section:t.Section,TopQuestionMasters:t.TopQuestionMasters.map((function(t){var r=e.formRuntimeMaster.getOrCreateQuestionRuntime(t);return n.push(r),t.SubQuestionMasters.forEach((function(t){var r=e.formRuntimeMaster.getOrCreateQuestionRuntime(t);n.push(r)})),r}))}}))},t.getNextSectionFromSection=function(t,n){var e=t.Section,i=e&&e.Model.BranchInfo;if(i){if(i.ToTheEnd)return-1;var o=r.findIndex(n,(function(t){return t.Section&&t.Section.Model.Id===i.TargetQuestionId}));if(o>=0)return o}return r.findIndex(n,t)+1},n.Ir=function(t){var n=this,e=r.find(this.dr,(function(n,e){return t?n.Section&&t===n.Section.Model.Id:0===e}));return t&&!e&&(e=this.dr[0],setTimeout((function(){n.formRuntimeMaster.Model.RuntimeSectionId=null}))),e},n.wr=function(){return r.indexOf(this.dr,this.getCurrentSection())},n.gr=function(t){var n=this.formRuntimeMaster.Form;return n.hasSection()?n.FormElementManager.getSectionNodes():[{TopQuestionMasters:t.filter((function(t){return!t.Model.GroupId}))}]},n.yr=function(){var t=this.wr();if(t<this.dr.length-1&&t>=0){var n=this.dr[t+1];return n.Section&&n.Section.Model.Id}},t}()},22530:function(t,n,e){"use strict";e.d(n,{r:function(){return v}});var r=e(59312),i=e(64459),o=e(26203),s=e(39923),u=e(10836),a=e(687),c=e(43367),l=e(90710),f=e(64290),h=e(55890),d=e(72374),m={Answer:s.J4.reference(),AnswerEntity:s.J4.reference(),BranchedElement:s.J4.reference(),BranchingType:s.J4.string(),NextQuestionInOrder:s.J4.reference(),NextQuestionInitialized:s.J4.boolean(),QuizResult:s.J4.reference(),Visible:s.J4.reference(),FormsProOrdinal:s.J4.reference(),FormsProRuntimeTitle:s.J4.reference(),FormsProRuntimeSubtitle:s.J4.reference(),InitialFormsProLocalizedRuntimeTitle:s.J4.reference(),InitialFormsProLocalizedRuntimeSubtitle:s.J4.reference(),SelectedChoice:s.J4.reference(),CDSFileResponseId:s.J4.reference(),CDSFileId:s.J4.reference(),HasSensitiveInfo:s.J4.boolean()},v=function(t){function n(n,e){var r=t.call(this)||this;return r.Sr=function(){return r.updateBranchedQuestion()},r.he=n,r.he.observe(r.Sr),r.Cr=e,(0,f.hl)((function(){r.addRule({Name:"UpdateBranchedQuestion",onChange:function(t){return r.updateBranchedQuestion()}})})),(0,f.md)((function(){var t;if(r.addRule({Name:"executeFormsProBranching",onChange:function(t){return r.Fr()},InterestedFields:[r.Schema.Answer]}),null===(t=null==e?void 0:e.Form)||void 0===t?void 0:t.SettingMaster.Model.PauseAndResumeSurvey){var n=(0,l.NW)().vt;if(n){var i=n.split("_")[1];r.addRule({Name:"updatePausedResponse",onChange:function(t){return r.Nr(i,n)},InterestedFields:[r.Schema.Answer]})}}})),r}(0,r.ZT)(n,t);var e=n.prototype;return Object.defineProperty(e,"Question",{get:function(){return this.he},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SubQuestions",{get:function(){return this.Question.SubQuestionMasters},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SubQuestionRuntimeMasters",{get:function(){var t=this;return this.SubQuestions.map((function(n){return t.getSubQuestionRuntimeById(n.Model.Id)}))},enumerable:!1,configurable:!0}),e.getSubQuestionRuntimeById=function(t){return this.Cr?this.Cr.getOrCreateQuestionRuntimeById(t):null},e.verifyAnswer=function(){if(0===this.SubQuestionRuntimeMasters.length){if(this.Question.Model.IsMathQuiz){var t=(0,i.d)(this.Model.Answer||"{}"),n=null==t.Answer?this.Model.Answer:t.Answer;return this.Question.verify(n)===d.ej.Success}return this.Question.verify(this.Model.Answer)===d.ej.Success}return this.SubQuestionRuntimeMasters.every((function(t){return t.Question.verify(t.Model.Answer)===d.ej.Success}))},e.release=function(){this.he.unobserve(this.Sr)},e.getAnswerEntity=function(){return{Answer:this.Question.getNormalizedAnswer(this.Model.Answer),QuestionId:this.Question.Model.Id}},e.calculateQuizResultFromModel=function(){0===this.SubQuestionRuntimeMasters.length?this.Model.QuizResult=this.Question.createQuizResult(this.Model.Answer):this.Model.QuizResult={IsAnswerCorrect:!1}},e.getScore=function(){var t=this.Model.AnswerEntity,n=t&&t.Score;return null!=n?n:this.Question.autoGradeWithQuizResult(this.Model.Answer,this.Model.QuizResult)},e.updateBranchedQuestion=function(){if(!this.Question.Deleted){var t=this.Model,n=this.Question.getBranchedResult(t.Answer,t.NextQuestionInOrder);this.bulkEdit((function(t){t.BranchedElement=n.TargetElement,t.BranchingType=n.Type}))}},e.Fr=function(){this.Cr&&(this.Cr.CurrentRuleManager()?this.Cr.CurrentRuleManager().execute(this.Question.Model.Id,this.Cr.Answers):(this.Cr.ensureProRuleManager(),this.Cr.Form.Model.MfpBranchingData&&this.Cr.CurrentRuleManager().execute(this.Question.Model.Id,this.Cr.Answers)))},e.Nr=function(t,n){var e=this;(0,f.md)((function(){if("Question.TextField"!==e.Question.Model.Type){var r=(0,a.vT)();(0,u.cr)("CVPartialResponse")&&e.Cr.Form.SettingMaster.Model.RecordPartialResponse&&(r=e.Cr.Form.SettingMaster.Model.RecordPartialResponse,(0,h.JG)({type:"CustomerVoice_PartialResponseSettingTaken",eventInfo:{Component:"PartialResponse",Value:r}})),(0,c.aK)(t,e.Cr.Answers,e.Cr.Form.Model.Id,e.Cr.Model.RuntimeSectionId,n,r)}}))},n}(o.d.createObjectMasterClass("QuestionRuntime",m))},19976:function(t,n,e){"use strict";e.d(n,{a:function(){return o}});var r=e(55411),i=e(72467);function o(){return(0,r.sv)()?(0,i.uq)():(0,i.f5)()}},61859:function(t,n,e){"use strict";e.d(n,{n:function(){return c}});var r=e(59312),i=e(36215),o=e(18113),s=e(26203),u=e(71369),a=e(47143),c=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.Tr="answer_other",n}(0,r.ZT)(n,t);var e=n.prototype;return e.aggregate=function(t,n){t?this.aggregateInternal(t,n):this.setDefaultAggregateToModel(n)},e.aggregateInternal=function(t,n){var e=(0,a.S)(n).QuestionMaster,r=n.ChoiceQuestionAggregation;r.ChoiceSummary=s.d.convertToArray(e.Model.Choices).map((function(n){var e=i.find(t.formChoiceData,(function(t){return t.id===n.Description}));return{Choice:(0,o.fq)(n.FormsProDisplayRTText)||n.Description,Count:null==e?0:e.count,IsFormula:n.IsMathOption}}));var u=i.find(t.formChoiceData,(function(t){return"_Other"==t.id}));(u||(0,a.S)(n).QuestionMaster.Model.AllowOtherAnswer)&&s.d.Collection.addItems(r.ChoiceSummary,[{Choice:this.Tr,Count:u?u.count:0,IsFormula:!1}])},e.setDefaultAggregateToModel=function(t){var n=(0,a.S)(t).QuestionMaster,e=t.ChoiceQuestionAggregation;e.ChoiceSummary=s.d.convertToArray(n.Model.Choices).map((function(t){return{Choice:(0,o.fq)(t.FormsProDisplayRTText)||t.Description,Count:0,IsFormula:t.IsMathOption}})),(0,a.S)(t).QuestionMaster.Model.AllowOtherAnswer&&s.d.Collection.addItems(e.ChoiceSummary,[{Choice:this.Tr,Count:0,IsFormula:!1}])},n}(u.R)},39984:function(t,n,e){"use strict";e.d(n,{e:function(){return u}});var r=e(59312),i=e(9947),o=e(687),s=e(71369),u=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.aggregate=function(t,n){var e=this;if(t){var r=n.DateQuestionAggregation;r.ResponseCount=t.dateData.count,r.TopDate=t.dateData.recentValues.filter((function(t){return null!=t})).map((function(t){return{Id:void 0,Answer:e.kr(t)}}))}else this.setDefaultAggregateToModel(n)},e.setDefaultAggregateToModel=function(t){var n=t.DateQuestionAggregation;n.ResponseCount=0,n.TopDate=null},e.kr=function(t){var n=(0,o.gC)();return t.length>n.length?Date.parseDate(t,"MM/dd/yyyy hh:mm:ss tt",(0,i.k0)().cultureInfo):Date.parseDate(t,n,(0,i.k0)().cultureInfo)},n}(s.R)},45053:function(t,n,e){"use strict";e.d(n,{a:function(){return i}});var r=e(59312),i=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.aggregate=function(t,n){t?this.aggregateInternal(t,n):this.setDefaultAggregateToModel(n)},e.setDefaultAggregateToModel=function(t){var n=t.FileUploadQuestionAggregation;n.ResponseCount=0,n.RecentFile=null},n}(e(71369).R)},61499:function(t,n,e){"use strict";e.d(n,{f:function(){return I},G:function(){return S}});var r=e(59312),i=e(36215),o=e(64459),s=e(85708),u=e(26203),a=e(39923),c=e(72467),l=e(91367),f=e(55890),h=e(50627),d=e(25038),m=e(81380),v=e(9743),p=e(3864),g=e(31947),b=e(47143),w={SummaryAggregation:a.J4.fromMasterClass((function(){return g.D})),QuestionAggregations:a.J4.collectionOf((function(){return b.N}))};function y(t){return{SummaryAggregation:{AverageSubmitTime:0,FormStatus:t.SettingMaster.getFormStatus(),IsAggregationReady:!1,TotalResponseCount:t.Model.ResponsesCount},QuestionAggregations:i.map(t.Model.Questions,(function(t){return{IsAggregationReady:!1,QuestionId:t.Id,IsMathQuestion:t.IsMathQuiz}}))}}function I(t){if("poll"===t.Model.Type){var n=t.Model.Questions;return u.d.convertToArray(n).some((function(t){return t.IsQuiz}))}return t.SettingMaster.Model.IsQuizMode}var S=function(t){function n(n){var e=t.call(this,{InitialData:y(n)})||this;return e.Pr=[],e.Dr=function(){return e.Er()},e.Lr=function(t){e.bulkEdit((function(){var n,r=[];u.d.convertToArray(t.RemovedModels).forEach((function(t){var n=u.d.Collection.getItemWithKeyFields(e.Model.QuestionAggregations,{QuestionId:t.Id});r.push(n)})),u.d.Collection.deleteItems(e.Model.QuestionAggregations,r);var i=u.d.convertToArray(t.AddedModels).map((function(t){return t.Id}));n=u.d.convertToArray(y(e.FormMaster).QuestionAggregations).filter((function(t){return i.some((function(n){return n===t.QuestionId}))})),u.d.Collection.addItems(e.Model.QuestionAggregations,n)})),e.FormMaster.Model.Settings.IsQuizMode&&t.RemovedModels.length?e.Er():(t.RemovedModels.length||t.AddedModels.length)&&e.Ar()},e.qr=function(){return e.Ar()},e.Or=function(){return e.Er()},e.Zt=n,e.Ur().then((function(t){(0,d.ZV)(t)||e.Vr(t)})),e.Pr.length>0&&(e.Pr=[]),e._r(),e}(0,r.ZT)(n,t);var e=n.prototype;return Object.defineProperty(e,"FormMaster",{get:function(){return this.Zt},enumerable:!1,configurable:!0}),e.terminateSync=function(){this.Pr=[]},e.release=function(){var t=this;this.FormMaster&&(this.FormMaster.unobserve(this.Dr),u.d.getCollectionMasterFromModel(this.FormMaster.Model.Questions).unobserve(this.Lr),i.forEach(this.FormMaster.Model.Questions,(function(n){var e=t.FormMaster.getQuestionById(n.Id);e.unobserve(t.Or),e.unobserve(t.qr)})))},e.Ur=function(){var t=this;return(0,f.$U)(this.FormMaster.SyncContext===v.y.AnalysisTimeForm?"AnalysisPage.Responses.StartGetResponses":"DesignPage.Responses.StartGetResponses"),(0,h.IR)((0,s.dg)()),this.FormMaster.existingOnServerSide().then((function(){return t.serverAggregateAPI(t.FormMaster.Model.Id)})).then((function(n){return t.Gr=n,t.Br(),n})).catch((function(n){return(0,h.IR)(null),(0,f.zU)("ResposnesAggregateFailure",{Message:"FormAggregationMaster.getAggregateData: get aggregate data failed: "+n}),(0,d.ZV)(n)?n:((0,p.bh)("Aggregate",n,t.FormMaster.Model.Id),t.zr(),null)}))},Object.defineProperty(e,"serverAggregateAPI",{get:function(){return this.FormMaster.SyncContext==v.y.AnalysisTimeForm?I(this.FormMaster)?m.Ah:m.tx:I(this.FormMaster)?m.zg:m.GI},enumerable:!1,configurable:!0}),e.zr=function(){(0,g.V)(this.Model.SummaryAggregation).Model.IsAggregationFailed=!0,i.each(this.Model.QuestionAggregations,(function(t){t.IsAggregationFailed=!0}))},e.Br=function(){(0,g.V)(this.Model.SummaryAggregation).Model.IsAggregationFailed=!1,i.each(this.Model.QuestionAggregations,(function(t){t.IsAggregationFailed=!1}))},e.Vr=function(t){var n=this,e=i.find(t,(function(t){return"quizSummaryData"===t.aggregationDataType||"summaryData"===t.aggregationDataType})),r=(0,g.V)(this.Model.SummaryAggregation);r.Model.IsAggregationFailed||r.aggregate(e),i.each(this.Model.QuestionAggregations,(function(r){var o=n.FormMaster.getQuestionById(r.QuestionId);if(!r.IsAggregationFailed){if(!o.Model.GroupId){var s=void 0;if(s="Question.MatrixChoiceGroup"===o.Model.Type?n.Qr(o,t):i.find(t,(function(t){return t.columnPropertyName===r.QuestionId})),"Question.TextField"==o.Model.Type&&o.Model.IsMathQuiz){s=n.jr(o,s);var u=e,a=s;a&&(a.quizSummaryData.averageScore/=u.quizSummaryData.count,u.quizSummaryData.averageScore+=a.quizSummaryData.averageScore,n.Model.SummaryAggregation.AverageScore=u.quizSummaryData.averageScore)}(0,b.S)(r).aggregate(s)}r.IsAggregationReady=!0}}));var o=(0,h.rx)();if(o){var u=this.FormMaster.SyncContext===v.y.AnalysisTimeForm?"Share":"Survey";(0,f.in)("Endpoint."+u+"AnalysisPage",{timeToSpin:window.performance.timing.domInteractive-window.performance.timing.navigationStart,timeToChrome:(0,h.pE)(),timeToContentReady:(0,s.dg)()-o}),(0,h.IR)(null)}},e.Qr=function(t,n){var e=t.SubQuestionMasters.map((function(t){return t.Model.Id})),r=n.filter((function(t){return-1!==e.indexOf(t.columnPropertyName)}));if(r.length)return r[0].likertChoiceData=[],r.reduce((function(t,n){var e={subQuesionId:n.columnPropertyName,subQuestionData:n.choiceData};return t.likertChoiceData.push(e),t}),r[0])},e.jr=function(t,n){var e=new l.E(t.Model).getAnswers(),r=n;if(r&&r.quizTextData&&e.length>0&&!t.Model.Multiline){var s=[];r.quizTextData.forEach((function(t){if(t.quizData&&t.quizData.id){var n=(0,o.d)(t.quizData.id),e=null==n.Answer?t.quizData.id:n.Answer;if(s.length>0){var r=i.find(s,(function(t){if(t.quizData&&t.quizData.id){var n=(0,o.d)(t.quizData.id),r=null==n.Answer?t.quizData.id:n.Answer;if(e.trim().toUpperCase()===r.trim().toUpperCase())return!0}}));null!=r?r.quizData.count+=t.quizData.count:s.push(t)}else s.push(t)}})),r.correctCount=0,r.quizSummaryData.averageScore=0;var u=s.filter((function(n){if(n.quizData&&n.quizData.id){var s=(0,o.d)(n.quizData.id),u=null==s.Answer?n.quizData.id:s.Answer;return""===u?(r.totalCount-=n.quizData.count,!1):(null!=i.find(e,(function(t){return t.answer.trim().toUpperCase()===u.trim().toUpperCase()}))&&(r.correctCount+=n.quizData.count,r.quizSummaryData.averageScore+=n.quizData.count*t.Model.Point),!0)}}));r.quizTextData=u}return r},e.Ar=function(){var t=this;null!=this.Gr&&(this.bulkEdit((function(){t.Model=y(t.Zt)})),this.Vr(this.Gr))},e.Er=function(){var t=this;this.FormMaster.SyncContext!=v.y.AnalysisTimeForm&&(this.Pr.length>0||this.Pr.push(this.$r().then((function(){return t.Pr.pop()}))))},e.$r=function(){var t=this;return new Promise((function(e){window.setTimeout((function(){t.bulkEdit((function(){t.Model=y(t.Zt)})),t.Ur().then((function(n){return t.Vr(n)})),e()}),n.freezingTime)}))},e._r=function(){var t=this;this.FormMaster.observe(this.Dr,[this.FormMaster.Schema.ResponsesCount]),u.d.getCollectionMasterFromModel(this.FormMaster.Model.Questions).observe(this.Lr);var n=(0,c.zE)();i.forEach(this.FormMaster.Model.Questions,(function(e){var r=t.FormMaster.getQuestionById(e.Id);switch(r.observe(t.qr,[n.Schema.Title]),r.Model.Type){case"Question.Choice":r.observe(t.FormMaster.Model.Settings.IsQuizMode?t.Or:t.qr,[n.Schema.Choices,n.Schema.AllowOtherAnswer,n.Schema.ChoiceType]);break;case"Question.Ranking":r.observe(t.Or,[n.Schema.ChoiceGroup])}}))},n.freezingTime=2e3,n}(u.d.createObjectMasterClass("FormAggregation",w))},31947:function(t,n,e){"use strict";e.d(n,{D:function(){return d},V:function(){return h}});var r=e(59312),i=e(36215),o=e(26203),s=e(39923),u=e(19930),a=function(){function t(){}t.prototype;return t}(),c=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,r.ZT)(n,t),n.prototype.aggregate=function(t,n){var e,r=h(n),i=null===(e=t)||void 0===e?void 0:e.quizSummaryData;r&&r.isAverageResultEnabled?n.AverageScore=null==i?void 0:i.averageScore:n.AverageSubmitTime=1e3*(null==i?void 0:i.averageSubmitTimeSeconds),n.TotalResponseCount=(null==i?void 0:i.count)||0,n.IsAggregationReady=!0},n}(a),l=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,r.ZT)(n,t),n.prototype.aggregate=function(t,n){var e,r=null===(e=t)||void 0===e?void 0:e.summaryData;n.AverageSubmitTime=1e3*(null==r?void 0:r.averageSubmitTimeSeconds),n.TotalResponseCount=(null==r?void 0:r.count)||0,n.IsAggregationReady=!0},n}(a),f={AverageSubmitTime:s.J4.number(),FormStatus:s.J4.enumeration((function(){return u.r})),IsAggregationReady:s.J4.boolean(),IsAggregationFailed:s.J4.boolean(),TotalResponseCount:s.J4.number(),BranchPoint:s.J4.number(),AverageScore:s.J4.number()};function h(t){return o.d.getObjectMasterFromModel(t)}var d=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.aggregate=function(t){var n=this;this.bulkEdit((function(){(function(t){if(t)return t.SettingMaster.Model.IsQuizMode?new c:new l})(n.FormMaster).aggregate(t,n.Model),n.Model.FormStatus=n.FormMaster.SettingMaster.getFormStatus(),n.Model.IsAggregationReady=!0})),this.Model.TotalResponseCount!==this.FormMaster.Model.ResponsesCount&&this.FormMaster.getFormResponsesCountByAPICall()},Object.defineProperty(e,"isAverageResultEnabled",{get:function(){var t=0;return i.forEach(this.FormMaster.Model.Questions,(function(n){n.IsQuiz&&n.Point&&(t+=n.Point)})),this.FormMaster.Model.QuizQuestionsCount>0&&t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"FormMaster",{get:function(){return this.Parent.FormMaster},enumerable:!1,configurable:!0}),n}(o.d.createObjectMasterClass("FormSummaryAggregation",f))},63113:function(t,n,e){"use strict";e.d(n,{v:function(){return c}});var r=e(59312),i=e(36215),o=e(18113),s=e(64541),u=e(71369),a=e(47143),c=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.choiceIdsIndex={},n.likertStatistics={},n}(0,r.ZT)(n,t);var e=n.prototype;return e.aggregate=function(t,n){t?(this.initializeDelegator(n),this.aggregateInternal(t,n)):this.setDefaultAggregateToModel(n)},e.initializeDelegator=function(t){var n=this;this.questionMaster=(0,a.S)(t).QuestionMaster,this.subQuestions=i.pluck(this.questionMaster.SubQuestionMasters,"Model"),this.choiceGroup=this.questionMaster.Model.ChoiceGroup;var e=[];i.forEach(this.choiceGroup,(function(t,r){n.choiceIdsIndex[t.Id]=r,e.push(0)})),i.forEach(this.subQuestions,(function(t){n.likertStatistics[t.Id]={Name:t.FormsProRTQuestionTitle||t.Title,Statistics:e.slice()}}))},e.aggregateInternal=function(t,n){var e=this;t.likertChoiceData.forEach((function(t){t.subQuestionData.forEach((function(n){e.likertStatistics[t.subQuesionId].Statistics[e.choiceIdsIndex[n.id]]=n.count}))}));var r=i.map(this.choiceGroup,i.property("Description")),u=i.map(this.choiceGroup,i.property("FormsProDisplayRTText"));r=u.map((function(t,n){return(0,s.wg)(r[n],(0,o.fq)(t))})),n.LikertQuestionAggregation={Options:r,LikertResults:this.getLikertStatistics()}},e.setDefaultAggregateToModel=function(t){},e.getLikertStatistics=function(){var t=this;return i.map(this.subQuestions,(function(n){return{SubQuestionId:n.Id,SubQuestionName:t.likertStatistics[n.Id].Name,Statistics:t.likertStatistics[n.Id].Statistics}}))},n}(u.R)},49079:function(t,n,e){"use strict";e.d(n,{n:function(){return i}});var r=e(59312),i=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.aggregate=function(t,n){if(t){var e=this.Jr(t);n.NPSQuestionAggregation={Promoters:e.promoters,Passives:e.passives,Detractors:e.detractors,ResponseCount:t.npsData.count}}else this.setDefaultAggregateToModel(n)},e.setDefaultAggregateToModel=function(t){t.NPSQuestionAggregation={Promoters:0,Passives:0,Detractors:0,ResponseCount:0}},e.Jr=function(t){var n=t.npsData.distributed;return{promoters:0+n[9]+n[10],passives:0+n[7]+n[8],detractors:t.npsData.distributed.slice(0,7).reduce((function(t,n){return t+n}),0)}},n}(e(71369).R)},71369:function(t,n,e){"use strict";e.d(n,{R:function(){return r}});var r=function(){function t(){}t.prototype;return t}()},84745:function(t,n,e){"use strict";e.d(n,{n:function(){return r},r:function(){return w}});var r,i=e(49079),o=e(25549),s=e(60813),u=e(24106),a=e(63870),c=e(85017),l=e(42338),f=e(22744),h=e(82665),d=e(15545),m=e(33739),v=e(60577),p=e(77013),g=e(86784),b=e(46929);function w(t,n){var e=function(t,n){if(t===r.Quiz)switch(n){case"Question.Choice":return o.y;case"Question.DateTime":return s.O;case"Question.FileUpload":return u.m;case"Question.MatrixChoiceGroup":return a.Y;case"Question.Ranking":return c.W;case"Question.Rating":return l.t;case"Question.TextField":return f.f;case"Question.NPS":return i.n}else if(t===r.Survey)switch(n){case"Question.Choice":return h.j;case"Question.DateTime":return d.U;case"Question.FileUpload":return m.a;case"Question.MatrixChoiceGroup":return v.G;case"Question.Ranking":return p.w;case"Question.Rating":return g.n;case"Question.TextField":return b.b;case"Question.NPS":return i.n}}(n,t);if(!e)throw Error(t+" is not supported");return new e}!function(t){t.Survey="Survey",t.Quiz="Quiz"}(r||(r={}))},47143:function(t,n,e){"use strict";e.d(n,{S:function(){return a},N:function(){return c}});var r=e(59312),i=e(26203),o=e(39923),s=e(84745),u={QuestionId:o.J4.create(o.J4.string(),{IsKeyField:!0}),IsAggregationReady:o.J4.boolean(),IsAggregationFailed:o.J4.boolean(),IsMathQuestion:o.J4.boolean(),ChoiceQuestionAggregation:o.J4.create({ChoiceSummary:o.J4.collectionOf({Choice:o.J4.string(),Count:o.J4.number(),IsFormula:o.J4.boolean()})}),TextQuestionAggregation:o.J4.create({TopAnswers:o.J4.collectionOf({Id:o.J4.number(),Answer:o.J4.string(),IsMath:o.J4.boolean()}),ResponseCount:o.J4.number(),TextSummary:o.J4.collectionOf({Text:o.J4.string(),Count:o.J4.number(),IsMath:o.J4.boolean()})}),RatingQuestionAggregation:o.J4.create({AverageRating:o.J4.number(),ResponseCount:o.J4.number()}),DateQuestionAggregation:o.J4.create({TopDate:o.J4.collectionOf({Id:o.J4.number(),Answer:o.J4.reference()}),ResponseCount:o.J4.number()}),RankingQuestionAggregation:o.J4.collectionOf({Id:o.J4.number(),Name:o.J4.string(),Statistics:o.J4.collectionOf(o.J4.number()),Weight:o.J4.number()}),LikertQuestionAggregation:o.J4.create({Options:o.J4.collectionOf(o.J4.string()),LikertResults:o.J4.collectionOf({SubQuestionId:o.J4.string(),SubQuestionName:o.J4.string(),Statistics:o.J4.collectionOf(o.J4.number())})}),FileUploadQuestionAggregation:o.J4.create({RecentFile:o.J4.collectionOf({Answer:o.J4.string()}),ResponseCount:o.J4.number()}),NPSQuestionAggregation:o.J4.create({Promoters:o.J4.number(),Passives:o.J4.number(),Detractors:o.J4.number(),ResponseCount:o.J4.number()}),GradeStatistics:o.J4.create({CorrectCount:o.J4.number(),WrongCount:o.J4.number()})};function a(t){return i.d.getObjectMasterFromModel(t)}var c=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.getIoCQuestionMaster=function(){throw new Error("Method not implemented.")},e.aggregate=function(t){var n=this;this.bulkEdit((function(){var e=n.FormMaster.Model.Settings.IsQuizMode?s.n.Quiz:s.n.Survey;(0,s.r)(n.QuestionType,e).aggregate(t,n.Model)}))},Object.defineProperty(e,"FormMaster",{get:function(){return this.Parent.Parent.FormMaster},enumerable:!1,configurable:!0}),Object.defineProperty(e,"QuestionMaster",{get:function(){return this.FormMaster.getQuestionById(this.Model.QuestionId)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"QuestionType",{get:function(){return this.QuestionMaster.Model.Type},enumerable:!1,configurable:!0}),n}(i.d.createObjectMasterClass("QuestionAggregation",u))},25549:function(t,n,e){"use strict";e.d(n,{y:function(){return i}});var r=e(59312),i=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,r.ZT)(n,t),n.prototype.aggregateInternal=function(n,e){t.prototype.aggregateInternal.call(this,n,e);var r=n.correctCount,i=n.totalCount;e.GradeStatistics={CorrectCount:r,WrongCount:i-r}},n}(e(61859).n)},60813:function(t,n,e){"use strict";e.d(n,{O:function(){return i}});var r=e(59312),i=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,r.ZT)(n,t),n}(e(39984).e)},24106:function(t,n,e){"use strict";e.d(n,{m:function(){return i}});var r=e(59312),i=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,r.ZT)(n,t),n.prototype.aggregateInternal=function(t,n){var e=n.FileUploadQuestionAggregation,r=t.longTextData;e.ResponseCount=r.count;var i=[];r.recentValues.filter((function(t){return null!=t})).forEach((function(t){t&&JSON.parse(t).reverse().forEach((function(t){i.length<3&&i.push({Answer:t})}))})),e.RecentFile=i},n}(e(45053).a)},63870:function(t,n,e){"use strict";e.d(n,{Y:function(){return i}});var r=e(59312),i=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,r.ZT)(n,t),n}(e(63113).v)},85017:function(t,n,e){"use strict";e.d(n,{W:function(){return o}});var r=e(59312),i=e(36215),o=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.Kr=[],n}(0,r.ZT)(n,t);var e=n.prototype;return e.aggregateInternal=function(n,e){this.Xr(),t.prototype.aggregateInternal.call(this,n,e);var r=n.correctCount,i=n.totalCount;e.GradeStatistics={CorrectCount:r,WrongCount:i-r}},e.Xr=function(){var t=this,n=JSON.parse(this.questionMaster.Model.GradingBasis);this.Kr=i.map(Array.apply(null,Array(n.length)),Number.prototype.valueOf,0),i.forEach(this.choiceGroup,(function(e){return t.Kr[n.indexOf(e.Key)]=e.Id}))},e.getRankerStatistics=function(t){var n=this.Kr.indexOf(t.id)+1,e=i.find(t.rankingCount,(function(t){return t.rank===n})),r=e?e.count:0;return[r,t.rankingCount.map((function(t){return t.count})).reduce((function(t,n){return t+n}),0)-r]},e.getRankerWeight=function(t){return this.Kr.indexOf(t.id)},n}(e(46342).K)},42338:function(t,n,e){"use strict";e.d(n,{t:function(){return i}});var r=e(59312),i=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,r.ZT)(n,t),n}(e(68050).Q)},22744:function(t,n,e){"use strict";e.d(n,{f:function(){return u}});var r=e(59312),i=e(36215),o=e(64459),s=e(47143),u=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.Tr="answer_other",n}(0,r.ZT)(n,t);var e=n.prototype;return e.aggregateInternal=function(t,n){var e=(0,s.S)(n).QuestionMaster;e.Model.Multiline||!e.hasCorrectAnswers()?this.Yr(t,n):this.ti(t,n);var r=t.correctCount,i=t.totalCount;n.GradeStatistics={CorrectCount:r,WrongCount:i-r}},e.Yr=function(t,n){var e=n.TextQuestionAggregation,r=i.first(t.quizTextData).surveyData;e.ResponseCount=r.count,e.TopAnswers=r.recentValues.filter((function(t){return null!=t})).map((function(t){var e;if(n.IsMathQuestion&&"_Other"!=t){var r=(0,o.d)(t);t=null==r.Answer?t:r.Answer,e=r.IsMath}return{Id:void 0,Answer:t,IsMath:e}}))},e.ti=function(t,n){var e=this;n.TextQuestionAggregation.TextSummary=t.quizTextData.map((function(t){var r,i=t.quizData.id;if(n.IsMathQuestion&&"_Other"!=i){var s=(0,o.d)(i);i=null==s.Answer?i:s.Answer,r=s.IsMath}return{Text:"_Other"==i?e.Tr:i,Count:t.quizData.count,IsMath:r}})).sort((function(t,n){return n.Text==e.Tr?-1:n.Count-t.Count}))},n}(e(41748).z)},46342:function(t,n,e){"use strict";e.d(n,{K:function(){return a}});var r=e(59312),i=e(36215),o=e(64541),s=e(71369),u=e(47143),a=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.aggregate=function(t,n){t?(this.questionMaster=(0,u.S)(n).QuestionMaster,this.choiceGroup=this.questionMaster.Model.ChoiceGroup,this.aggregateInternal(t,n)):this.setDefaultAggregateToModel(n)},e.aggregateInternal=function(t,n){var e=this;n.RankingQuestionAggregation=i.map(this.choiceGroup,(function(n){var r=i.find(t.rankingData,(function(t){return t.id===n.Id}));return r=r||{id:n.Id,rankingCount:[]},{Id:n.Id,Name:(0,o.wg)(n.Description,n.FormsProDisplayRTText),Statistics:e.getRankerStatistics(r),Weight:e.getRankerWeight(r)}})).sort((function(t,n){return n.Weight-t.Weight}))},e.setDefaultAggregateToModel=function(t){},n}(s.R)},68050:function(t,n,e){"use strict";e.d(n,{Q:function(){return i}});var r=e(59312),i=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.aggregate=function(t,n){if(t){var e=n.RatingQuestionAggregation;e.ResponseCount=t.numberData.count,e.AverageRating=t.numberData.average}else this.setDefaultAggregateToModel(n)},e.setDefaultAggregateToModel=function(t){var n=t.RatingQuestionAggregation;n.ResponseCount=0,n.AverageRating=0},n}(e(71369).R)},82665:function(t,n,e){"use strict";e.d(n,{j:function(){return i}});var r=e(59312),i=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,r.ZT)(n,t),n}(e(61859).n)},15545:function(t,n,e){"use strict";e.d(n,{U:function(){return i}});var r=e(59312),i=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,r.ZT)(n,t),n}(e(39984).e)},33739:function(t,n,e){"use strict";e.d(n,{a:function(){return i}});var r=e(59312),i=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,r.ZT)(n,t),n.prototype.aggregateInternal=function(t,n){var e=n.FileUploadQuestionAggregation;e.ResponseCount=t.longTextData.count;var r=[];t.longTextData.recentValues.filter((function(t){return null!=t})).forEach((function(t){t&&JSON.parse(t).reverse().forEach((function(t){r.length<3&&r.push({Answer:t})}))})),e.RecentFile=r},n}(e(45053).a)},60577:function(t,n,e){"use strict";e.d(n,{G:function(){return i}});var r=e(59312),i=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,r.ZT)(n,t),n}(e(63113).v)},77013:function(t,n,e){"use strict";e.d(n,{w:function(){return s}});var r=e(59312),i=e(36215),o=e(55890),s=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.ni=function(t,n){var e=i.times(n,i.constant(0));return t.forEach((function(t){t.rank>n?(0,o.zU)("InvalidServerAggregatePayload","Fatal Error: RankingAggregationDelegatorBase.calculateRankerRenct ranker key shouldn't large than rankers count"):e[t.rank-1]=t.count})),e},e.getRankerStatistics=function(t){return this.ni(t.rankingCount,this.choiceGroup.length)},e.getRankerWeight=function(t){var n=this.choiceGroup.length;return t.rankingCount.map((function(t){return t.count*(n-t.rank)})).reduce((function(t,n){return t+n}),0)},n}(e(46342).K)},86784:function(t,n,e){"use strict";e.d(n,{n:function(){return i}});var r=e(59312),i=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,r.ZT)(n,t),n}(e(68050).Q)},46929:function(t,n,e){"use strict";e.d(n,{b:function(){return i}});var r=e(59312),i=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,r.ZT)(n,t),n.prototype.aggregateInternal=function(t,n){var e=n.TextQuestionAggregation;e.ResponseCount=t.textData.count,e.TopAnswers=t.textData.recentValues.filter((function(t){return null!=t})).map((function(t){return{Id:void 0,Answer:t,IsMath:void 0}}))},n}(e(41748).z)},41748:function(t,n,e){"use strict";e.d(n,{z:function(){return i}});var r=e(59312),i=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.aggregate=function(t,n){t?this.aggregateInternal(t,n):this.setDefaultAggregateToModel(n)},e.setDefaultAggregateToModel=function(t){},n}(e(71369).R)},90634:function(t,n,e){"use strict";e.d(n,{t:function(){return d}});var r=e(59312),i=e(36215),o=e(64459),s=e(9947),u=e(26203),a=e(39923),c=e(687),l=e(88807),f=(a.J4.reference(),a.J4.string(),a.J4.string(),a.J4.number(),a.J4.string(),a.J4.string(),a.J4.string(),a.J4.string(),a.J4.string(),{Answers:a.J4.collectionOf(a.J4.reference()),Questions:a.J4.collectionOf(a.J4.reference()),TopLevelQuestions:a.J4.collectionOf(a.J4.reference()),PagingSize:a.J4.number(),IsPagingReady:a.J4.boolean()}),h=300,d=function(t){function n(n,e){var r=t.call(this,e)||this;r._e=n,r.Model.PagingSize=h;var o=[];return i.forEach(n.Model.Questions,(function(t){o.push({Id:t.Id,GroupId:t.GroupId,Type:t.Type,Title:t.Title})})),r.Model.Questions=o,r.Model.TopLevelQuestions=i.filter(o,(function(t){return!t.GroupId})),r}(0,r.ZT)(n,t);var e=n.prototype;return e.getQuestionAnswers=function(t){var n=this;return t?i.filter(this.Model.Answers,(function(e){return n.ei(t,e)})):[]},e.getQuestionsAnswers=function(t){var n=[];return i.forEach(this._e.Model.BufferResponses,(function(e){var r=!1,o=t.map((function(t){var n=i.find(e.Answers,(function(n){return n.QuestionId===t}));return n&&n.Answer?(r=!0,n.Answer.displayText):""}));if(r){var s=!!e.SubmitLanguage&&JSON.parse(e.SubmitLanguage).localeName;n.push({Answer:o,ResponderName:e.ResponderName?e.ResponderName:e.Responder,Language:s||""})}})),n},e.ei=function(t,n){return"Question.Ranking"!==this.getQuestionType(t)?null!=t&&n.QuestionId===t&&null!=n.Answer&&""!==n.Answer:n.QuestionId===t&&n.Answer&&!/^\[(("",)*""|)\]$/.test(n.Answer)},e.getAnswersCount=function(){return this._e.Model.ResponsesCount},e.getPagingRegion=function(t){return{Start:isNaN(t)?0:t*h+1,End:isNaN(t)?0:Math.min((t+1)*h,this._e.Model.ResponsesCount)}},e.SyncPreviousPageData=function(){isNaN(this.ri)||this.syncData(this.ri-1)},e.SyncNextPageData=function(){isNaN(this.ri)||this.syncData(this.ri+1)},e.syncData=function(t){var n=this,e=this._e.Model.ResponsesCount,r=t*h;t>=0&&r<e&&(this.ri=t,this.Model.IsPagingReady=!1,this._e.syncFormResponsesByPaging(Math.min(e-r,h),r).then((function(){if(t==n.ri){var e=[];i.forEach(n._e.Model.BufferResponses,(function(t){var r=!!t.SubmitLanguage&&JSON.parse(t.SubmitLanguage).localeName;i.forEach(t.Answers,(function(i){e.push({Answer:n.ii(i.QuestionId,i.Answer),QuestionId:i.QuestionId.replace(/-/g,""),ResponderName:t.ResponderName?t.ResponderName:t.Responder,ResponseId:t.Id,Language:r||""})}))})),n.Model.Answers=e,n.Model.IsPagingReady=!0}})))},e.getQuestionType=function(t){return this._e.getQuestionById(t).Model.Type},e.getAnswerColumnCount=function(t){var n=this._e.getQuestionById(t);switch(n.Model.Type){case"Question.Ranking":return Math.max(1,n.Model.ChoiceGroup.length);case"Question.MatrixChoiceGroup":return i.filter(this.Model.Questions,(function(n){return n.GroupId===t})).length;case"Question.NPS":return 2;default:return 1}},e.getFileUploadFolder=function(t){var n=this._e.getQuestionById(t).Model.FileUploadSPOInfo;return n&&n.folderId?new l.L(this._e).getFileFolder(n.folderId):Promise.reject(new Error("Folder id is null"))},e.ii=function(t,n){var e=this._e.getQuestionById(t);if(e){if(n&&"Question.DateTime"===e.Model.Type){var r=(0,s.k0)().cultureInfo;return Date.parseDate(n,(0,c.gC)(),r).toDateShortString(r)}if(n&&e.isNumberType())return(0,o.d)(n);if("Question.Ranking"===e.Model.Type){var u={};i.forEach(e.Model.ChoiceGroup,(function(t){u[t.Id]=t.Description}));var a=n?i.sortBy(i.filter(n,(function(t){return void 0!==u[t.id]})),(function(t){return t.answerOrder})):[],l=i.size(u)?i.size(u)-a.length:1,f=i.map(Array.apply(null,Array(l)),String.prototype.valueOf,"");return JSON.stringify(i.map(a,(function(t){return u[t.id]})).concat(f))}}return n},n}(u.d.createObjectMasterClass("ResponsesDetailMaster",f))},48333:function(t,n,e){"use strict";e.d(n,{o:function(){return i},Q:function(){return s}});var r=e(36215);function i(t,n,e){for(var i=t,s=o(t);r.contains(e,i);)i=n.format(s.BaseName,++s.Count);return i}function o(t){var n=t+" ",e=1,r="",i=t.lastIndexOf("(");return t&&")"===t.slice(-1)&&i>=0&&parseInt(t.slice(i+1,t.length-1))&&(r=t.slice(i+1,t.length-1),e=parseInt(r),n=t.slice(0,i)),{BaseName:n,Count:e,CountStr:r}}function s(t,n){var e=t.copyTitle,r=t.copyRichTitle,i=t.newTitle,s=i;if(!r)return{newTitle:i,newRichTitle:r};if(e!==r){var u=o(e),a=o(r);u.CountStr===a.CountStr?s=n.format(a.BaseName,o(i).Count):(i=n.format(e+" ","2"),s=n.format(r+" ","2"))}return{newTitle:i,newRichTitle:s}}},16455:function(t,n,e){"use strict";e.d(n,{b:function(){return s}});var r=e(59312),i=e(63804),o=e(7645),s=function(t){function n(n){var e=t.call(this,n)||this;return e.state={ShowAltImg:!1},e}(0,r.ZT)(n,t);var e=n.prototype;return e.render=function(){return this.state.ShowAltImg?this.props.altImgUrl&&i.createElement("img",{className:"teaching-callout-img",src:this.props.altImgUrl,alt:(0,o.pm)().AltText_Gif}):i.createElement("img",{className:"teaching-callout-img",src:this.props.imgUrl,alt:(0,o.pm)().AltText_Gif})},e.componentDidMount=function(){this.oi()},e.componentDidUpdate=function(){this.oi()},e.oi=function(){var t=this;this.props.altTimeout&&!this.state.ShowAltImg&&(this.si&&clearTimeout(this.si),this.si=setTimeout((function(){return t.setState({ShowAltImg:!0})}),this.props.altTimeout))},n}(i.Component)},97586:function(t,n,e){"use strict";e.d(n,{BT:function(){return a},Mb:function(){return c},dq:function(){return l},Bi:function(){return f},yM:function(){return h}});var r=e(63804),i=e(262),o=e(7645),s=e(25306),u=e(16455),a=2,c=5e3;function l(t,n,e,o,s,u){return r.createElement("div",{className:"firstrun-callout-container","aria-live":"polite","aria-label":s},r.createElement("div",{id:e,className:"firstrun-callout"},r.createElement("div",{className:(0,i.j)("firstrun-callout-beak",o)}),r.createElement("div",{className:"teaching-callout-text-wrap"},u||function(t){return r.createElement("div",{className:"teaching-callout-text"},t)}(s)),r.createElement("div",{className:"teaching-callout-img-wrap"},t),n))}function f(t,n,e){return r.createElement(u.b,{imgUrl:t,altImgUrl:n,altTimeout:e})}function h(t){return(0,s.E)({HTMLAttributes:{className:"teaching-callout-button",onClick:t},Text:(0,o.pm)().TeachingUi_GotIt,ButtonStyle:1})}},2328:function(t,n,e){"use strict";e.d(n,{TK:function(){return o}});var r=e(36215),i=e(6917);e(67661),e(51586),e(55890);function o(){return(0,i.e_)().then((function(t){var n={},e=[];return Object.keys(t).map((function(n){return t[n].Questions})).forEach((function(t){r.forEach(t,(function(t){var i=r.find(e,(function(n){return n.GroupId===t.GroupId&&n.Title===t.Title}));t.GroupId&&"Question.MatrixChoice"===t.Type&&!i&&e.push(t),!!t.QuestionTagForIntelligence&&"Subjective"!==t.QuestionTagForIntelligence&&"Unknown"!==t.QuestionTagForIntelligence&&(n[t.QuestionTagForIntelligence]=t)}))})),{Item_1:n,Item_2:e}})).catch((function(t){return console.error(t),null}))}},72317:function(t,n,e){"use strict";e.d(n,{a:function(){return i}});var r=e(72377);function i(){return r.Pv.Resolve("IPageContext")}},19578:function(t,n,e){"use strict";e.d(n,{P:function(){return c}});var r=e(27196),i=e(94290),o=e(7645),s=e(41376),u=e(30521),a=e(64290);function c(t){(0,a.c2)(),(0,o.ay)().then((function(){r.render((0,u.a)({Error:t,ShowBackButton:(0,i.mF)(),OnBackButtonClicked:(0,i.mF)()?s.DO:null}),document.getElementById("content-root"))}))}},64290:function(t,n,e){"use strict";e.d(n,{pd:function(){return c},md:function(){return l},hl:function(){return f},c2:function(){return h},Xw:function(){return m}});var r,i,o=e(9947),s=e(262),u=e(55411),a=e(10836);function c(t,n){return d()?n():t()}function l(t){return d()?t():null}function f(t){return d()?null:t()}function h(){l((function(){r||(document.body.className=(0,s.j)(document.body.className,(0,s.j)("forms-pro",(0,u.cT)()?"customer-voice":null)),r=!0)}))}function d(){return void 0===i&&(i=!!(0,o.k0)().proEnabled&&(0,a.cr)("FormsPro")),i}FormsPro.initializeStyleBasis=h;var m={}},40947:function(t,n,e){"use strict";e.d(n,{B2:function(){return f},zg:function(){return d}});var r=e(59312),i=e(63804),o=e(27196),s=e(43209),u=e(72467),a=e(77494),c=e(90819),l=e(55890);function f(t){return i.createElement("div",{className:"image-spinner",id:t&&h(t)},i.createElement("div",{className:"common-spinner-circle"}))}function h(t){return"imageSpinner-"+t.ResourceId}var d=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.ui=!0,n.ai=function(){return n.forceUpdate()},n.ci=function(){return n.li()},n}(0,r.ZT)(n,t);var e=n.prototype;return e.componentDidMount=function(){var t=(0,u.Cu)().Schema,n=(0,u.BF)().Schema;this.props.ImageSettings.observe(this.ai),this.props.Image.observe(this.ai,[t.ResourceUrl,t.ContentType,t.OriginalFileName]),this.props.ImageSettings.observe(this.ci,[n.ContainerHeight,n.ContainerWidth,n.Left,n.Top]),this.props.Image.observe(this.ci,[t.AltText]),this.fi()},e.componentDidUpdate=function(){this.fi()},e.componentWillUnmount=function(){this.ui=!1,this.props.ImageSettings.unobserve(this.ai),this.props.Image.unobserve(this.ai),this.props.ImageSettings.unobserve(this.ci),this.props.Image.unobserve(this.ci)},e.render=function(){var t=this,n=this.props.Image.Model,e=this.props.ImageSettings.validateImageSettings(!0),r=0;return i.createElement("img",{src:n.ResourceUrl,alt:n.AltText,height:e.ContainerHeight+"px",width:e.ContainerWidth+"px",style:{visibility:"hidden"},onLoad:function(){(0,l.$U)("Image.ImageOnLoad.Success",{imageType:t.props.ImageType,location:"1"})},onError:function(e){if(r<3&&"Response"===(0,s.C2)()){var i=o.findDOMNode(t);r++;var u=n.ResourceUrl+"?"+r;window.setTimeout((function(){$(i).attr("src",u)}),1e3)}else(0,l.$U)("Image.ImageOnLoad.Failure",{imageSrc:n.ResourceUrl,imageType:t.props.ImageType,location:"1"})}})},e.fi=function(){var t=this,n=this.props.Image&&this.props.Image.Model;if(n&&n.ResourceUrl&&!this.hi()){var e=o.findDOMNode(this),r=0;e&&this.props.ImageSettings&&(e.onload=function(){return t.li()},e.onerror=function(i){if(r<3&&"Response"===(0,s.C2)()){r++;var o=n.ResourceUrl+"?"+r;window.setTimeout((function(){$(e).attr("src",o)}),1e3)}else{(0,l.$U)("Image.CanvasOnLoad.Failure",{imageSrc:e.src,imageType:t.props.ImageType,location:"1"});var u=document.getElementById(h(n));u&&$(u).css("display","none"),$(e).css("visibility","visible")}})}},e.li=function(){if(this.ui){var t=this.props.Image&&this.props.Image.Model;if(t&&t.ResourceUrl&&!this.hi()){var n=o.findDOMNode(this);if($(n).siblings("canvas").remove(),n&&this.props.ImageSettings)try{var e=document.createElement("canvas"),r=this.props.ImageSettings.validateImageSettings(!0);e.tabIndex=-1;var i=1*r.NaturalWidth/r.ActualWidth,s=Math.abs(r.Left*i);s=Math.floor(Math.min(s,r.NaturalWidth));var u=Math.abs(r.Top*i);u=Math.floor(Math.min(u,r.NaturalHeight));var c=r.ContainerWidth*i||r.NaturalWidth;c=Math.floor(Math.min(c,r.NaturalWidth));var f=r.ContainerHeight*i||r.NaturalHeight;f=Math.floor(Math.min(f,r.NaturalHeight));try{var d=isNaN(window.devicePixelRatio)?1:window.devicePixelRatio;d=Math.ceil(Math.max(d,i)),e.width=Math.floor(r.ContainerWidth*d),e.height=Math.floor(r.ContainerHeight*d),t.AltText&&(e.setAttribute("role","img"),e.setAttribute("aria-label",t.AltText)),e.getContext("2d").drawImage(n,s,u,c,f,0,0,e.width,e.height)}catch(t){$(n).css("visibility","visible");var m=t.message||void 0,v=t.stack||void 0;return void(0,l.$U)("Image.CanvasRender.Failure",{imageSrc:n.src,imageType:this.props.ImageType,location:"1",error:m+" "+v,Exception:"DrawImageCanvas"})}var p=document.getElementById(h(t));p&&$(p).css("display","none"),$(n).css("display","none"),$(n).parent().append(e),(0,l.$U)("Image.CanvasRender.Success",{imageType:this.props.ImageType,location:"1"}),(0,a.C_)()}catch(t){m=t.message||void 0,v=t.stack||void 0;throw(0,l.$U)("Image.CanvasRender.Failure",{imageSrc:n.src,imageType:this.props.ImageType,location:"1",error:m+" "+v,Exception:"CreateImageCanvas"}),t}}}},e.hi=function(){return this.props.Image.Model.ImageProcessingStatus!==c.nv.Idle},n}(e(23112).r)},14106:function(t,n,e){"use strict";e.d(n,{OS:function(){return c},Bz:function(){return l},tj:function(){return f}});var r=e(59312),i=e(63804),o=e(3424),s=e(7645),u=e(76795),a=e(46872);function c(t){var n=t.Master.Question.Model,e=t.Master.SubQuestionRuntimeMasters,r=e[e.length-1];if(t.IsStudentViewMode){if(!(l=(r||t.Master).getScore())&&!n.Point)return;var o=n.Point?n.Point:"-",u=null!=l?l:"-",c=(0,s.pm)().RuntimeView_TotalPoints_Content.format(u,o);return i.createElement("span",{className:"office-form-theme-quiz-point",key:"quizPointLabel"},(0,s.pm)().Quiz_Points_BracketsText.format(c))}if(n.IsQuiz&&!t.HiddenPoint){if(!n.Point)return;if(t.ShowDesignInfo||!t.ShowQuizResult&&!t.ShowPrintResult)return i.createElement("span",{className:"office-form-theme-quiz-point",key:"quizPointLabel"},(0,a.f)(n.Point));var l;u=null!=(l=(r||t.Master).getScore())?l:"-",c=(0,s.pm)().RuntimeView_TotalPoints_Content.format(u,n.Point);return i.createElement("span",{className:"office-form-theme-quiz-point",key:"quizPointLabel"},(0,s.pm)().Quiz_Points_BracketsText.format(c))}}function l(t){if(!t.IsMobile&&!t.ShowPrintResult&&f(t)){var n,e=(0,o.M)({Accessible:!0,FluentIcon:"Dismiss",HTMLAttributes:{className:"validation-error-message-wrong-Icon office-form-answerkey"}});return n=[i.createElement("div",{className:"validation-error-circle-big"}),i.createElement("div",{className:"validation-error-circle-small"}),e],i.createElement.apply(i,(0,r.ev)(["div",{"aria-live":"assertive",role:"alert","aria-label":(0,s.pm)().Response_Preview_WrongReponseIcon.format(t.Ordinal)}],n))}}function f(t){var n=t.Master.Model,e=t.Master.Question.Model,r=e.Type===u.L.getElementTypeName(),i="Question.TextField"===e.Type&&!e.Multiline,o="Question.Ranking"===e.Type,s=r||i||o;return!!(e.IsQuiz&&t.ShowQuizResult&&s&&n.QuizResult)&&!n.QuizResult.IsAnswerCorrect}},46872:function(t,n,e){"use strict";e.d(n,{f:function(){return i}});var r=e(7645);function i(t){var n=(0,r.pm)().Quiz_Points_BracketsText_Singular,e=(0,r.pm)().Quiz_Points_BracketsText_Plural;return(1===t?n:e).format(t)}},58537:function(t,n,e){"use strict";var r;e.d(n,{w:function(){return r}}),function(t){t[t.Desktop=0]="Desktop",t[t.Mobile=1]="Mobile",t[t.Auto=2]="Auto",t[t.Embed=3]="Embed"}(r||(r={}))},16311:function(t,n,e){"use strict";e.d(n,{N:function(){return i}});var r=e(63804),i=function(){var t=r.useState(!1)[1];return r.useCallback((function(){return t((function(t){return!t}))}),[])}},69856:function(t,n,e){"use strict";var r,i;e.d(n,{K:function(){return r},d:function(){return i}}),function(t){t[t.Unknown=0]="Unknown",t[t.Form=1]="Form",t[t.Meeting=2]="Meeting"}(r||(r={})),function(t){t[t.SummaryInsight=0]="SummaryInsight",t[t.CorrelationInsight=1]="CorrelationInsight",t[t.ExplainDiffInsight=2]="ExplainDiffInsight",t[t.Outstanding=3]="Outstanding",t[t.OutstandingCollection=4]="OutstandingCollection",t[t.AssociationRuleInsight=5]="AssociationRuleInsight",t[t.FunctionalDependency=6]="FunctionalDependency",t[t.IntraclassInsight=7]="IntraclassInsight",t[t.RatingKeywordsInsight=8]="RatingKeywordsInsight",t[t.LikertAssociationRuleInsight=9]="LikertAssociationRuleInsight",t[t.PartialOrderInsight=10]="PartialOrderInsight",t[t.NPSKeywordsInsight=11]="NPSKeywordsInsight",t[t.ResponseSentimentInsight=12]="ResponseSentimentInsight",t[t.KeywordSentimentInsight=13]="KeywordSentimentInsight",t[t.KeyPhrasesInsight=14]="KeyPhrasesInsight",t[t.SummaryDistribution=15]="SummaryDistribution",t[t.SummaryDistributionCollection=16]="SummaryDistributionCollection",t[t.CorrelationInsightCollection=17]="CorrelationInsightCollection",t[t.ResponseSentimentInsightCollection=18]="ResponseSentimentInsightCollection",t[t.RatingDistributionAnalysisInsight=21]="RatingDistributionAnalysisInsight",t[t.AllHandsSummaryInsight=22]="AllHandsSummaryInsight",t[t.RatingDistributionInsight=25]="RatingDistributionInsight",t[t.RatingImpactInsight=26]="RatingImpactInsight",t[t.TextClusterInsight=28]="TextClusterInsight",t[t.TimeDistributionInsight=29]="TimeDistributionInsight",t[t.LikertImpactAnalysisInsightCollection=30]="LikertImpactAnalysisInsightCollection",t[t.DrivingFactorAnalysisInsightCollection=31]="DrivingFactorAnalysisInsightCollection",t[t.ResponseWordCloudInsight=32]="ResponseWordCloudInsight",t[t.EngagementOverview=33]="EngagementOverview",t[t.EngagementTrendInsight=34]="EngagementTrendInsight"}(i||(i={}))},52220:function(t,n,e){"use strict";var r;e.d(n,{f:function(){return s}}),function(t){t.FP_PageBoot="FP_pageBoot",t.FP_PageFormData="FP_pageFormData",t.FP_PageLoc="FP_pageLoc",t.FP_PageRender="FP_pageRender"}(r||(r={}));window.performance;var i=window.performance,o=["FP_pageBoot","FP_pageFormData","FP_pageLoc","FP_pageRender"];function s(t){i&&i.getEntriesByName&&o.forEach((function(n){var e=i.getEntriesByName(n);if(e&&1===e.length){var r=e[0],o=r.duration,s=r.name;t[s]=o}}))}},55890:function(t,n,e){"use strict";e.d(n,{JG:function(){return c},O7:function(){return l},$U:function(){return f},zU:function(){return h},in:function(){return d},t0:function(){return m}});var r=e(33967),i=e(43209),o=e(72377),s=e(73546),u=e(38570),a=[];function c(t){(0,s.j)().logFormsProEvent(t)}function l(t){(0,s.j)().sendTeamsAppInitializationCompleteSignal(t)}function f(t,n,u,c){void 0===c&&(c=!1),(0,s.j)().logData({correlationId:u,eventName:t,eventType:"engagement_event",extraData:n},c),(0,r.x8)()||"Design"!==(0,i.C2)()||(0===a.length&&e.e(9410).then(e.t.bind(e,73531,19)).then((function(t){return t.default})).then((function(t){a=t})),t&&a.indexOf(t)>=0&&o.Pv.Resolve("IFormUserContextActionSignal").addUserActionSignal(t,6,null,!1))}function h(t,n,e,r){void 0===e&&(e=!1),(0,s.j)().logData({correlationId:r,eventName:t,eventType:"error_event",extraData:n},e)}function d(t,n){(0,s.j)().logData({eventName:t,eventType:"nav_perf_event",extraData:n},!1)}function m(t,n){(0,s.j)().logData({correlationId:n,eventName:"session_start",eventType:"session_start",extraData:t},!1)}var v=window.onerror;window.onerror=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];u.u.apply(void 0,t),v&&v.apply(this,t)}},50627:function(t,n,e){"use strict";e.d(n,{rx:function(){return g},pE:function(){return p},HC:function(){return b},IR:function(){return v},Hw:function(){return m},jE:function(){return w}});var r=e(9947),i=e(85708),o=e(90710),s=e(52220),u=/light-((assignments|teams)-)?response-page\.min\.[a-zA-Z0-9]{7}\.js/,a=/teams-(meeting-poll|poll-bubble)-page\.min\.[a-zA-Z0-9]{7}\.js/;function c(){if(window.performance&&window.performance.getEntriesByType){for(var t=function(){for(var t=[],n=window.performance.getEntriesByType("navigation"),e=0,r=n;e<r.length;e++){var i=r[e],o=l(i);o.connectStart=Math.round(i.connectStart),o.domainLookupStart=Math.round(i.domainLookupStart),o.redirectStart=Math.round(i.redirectStart),o.redirectEnd=Math.round(i.redirectEnd),o.domainLookupEnd=Math.round(i.domainLookupEnd),o.secureConnectionStart=Math.round(i.secureConnectionStart),o.connectEnd=Math.round(i.connectEnd),o.type=i.type,o.duration=Math.round(i.duration),t.push(o)}return t}(),n=0,e=window.performance.getEntriesByType("resource");n<e.length;n++){var r=e[n];r&&r.name&&((u.test(r.name.toLowerCase())||a.test(r.name.toLowerCase()))&&t.push(l(r)))}return t}}function l(t){var n,e;return{fetchStart:Math.round(t.fetchStart),name:(e=t.name,e.substring(e.lastIndexOf("/")+1,e.indexOf("?")>0?e.indexOf("?"):e.length)),requestStart:Math.round(t.requestStart),responseEnd:Math.round(t.responseEnd),responseStart:Math.round(t.responseStart),transferSize:(n=t.transferSize,void 0===n?-1:n),type:t.entryType}}var f,h,d={};function m(t){f=t}function v(t){h=t}function p(){return f}function g(){return h}function b(t){if(!window.performance)return{};var n=(0,r.k0)(),e=n.AuthDuration,u=void 0===e?0:e,a=n.IsSwReload,l=void 0!==a&&a,f=(0,o.NW)(),h=window.performance.timing.navigationStart,m=t||(0,i.dg)(),v=window.NavKeyPoints,p=d;p.navigationStart=h,p.serverPageTime=v?v.ServerPageTime:0,p.pageLoaded=v?v.PageStartTime:0,p.basicJsLoaded=v?v.BasicJsLoadedTime:0,p.mainJsLoaded=v?v.MainJsLoadedTime:0,p.formRenderEnd=m,p.timeToContentReady=m-h,p.timeToSpin=p.pageLoaded-h,(0,s.f)(p),f.Host&&(p.host=f.Host);var g=c();return p.resourceTiming=g,p.cacheHit=function(t){if(!t)return!1;for(var n=0,e=t;n<e.length;n++){var r=e[n];if("resource"===r.type)return 0===r.transferSize||r.responseEnd-r.fetchStart<=10}return!1}(g),p.mainJsStart=v?v.MainJsStartTime:0,p.mainCssStart=v?v.MainCssStartTime:0,p.mainCssLoaded=v?v.MainCssLoadedTime:0,p.PrefetchStart=v?v.PrefetchStart:0,p.PrefetchEnd=v?v.PrefetchEnd:0,p.fetchDataAndJsStart=v?v.FetchDataAndJsStart:0,p.fetchDataAndJsEnd=v?v.FetchDataAndJsEnd:0,p.lazyMainJsLoaded=v?v.LazyMainJsLoaded:0,p.getAuthTokenStart=v?v.GetAuthTokenStart:0,p.getAuthTokenEnd=v?v.GetAuthTokenEnd:0,p.getRuntimeFormEnd=v?v.GetRuntimeFormEnd:0,p.getResponsesEnd=v?v.GetResponsesEnd:0,p.getUserInfoEnd=v?v.GetUserInfoEnd:0,p.getThemesEnd=v?v.GetThemesEnd:0,p.authDuration=u,l&&v.LastNavStart&&(p.lastNavigationStart=v.LastNavStart),p}function w(t,n){d[t]=n}},38570:function(t,n,e){"use strict";e.d(n,{u:function(){return i}});var r=e(55890);function i(t,n,e,i,o){o&&console.error(o),(0,r.zU)("UnhandleException",{columnNo:i,error:o&&o.toString(),fileName:n,lineNo:e,message:t,stack:o&&o.stack})}},44644:function(t,n,e){"use strict";e.d(n,{P:function(){return s}});var r=e(94290),i=e(62662),o=e(90710);function s(){var t;if(t=(0,r.Eh)())return t;var n="origin",e=(0,o.NW)()[n];return e||(n="oembedsso",(0,o.NW)()[n]?"Forms WebPart":(0,i.ft)()?"PowerPoint":null)}},29542:function(t,n,e){"use strict";e.d(n,{f:function(){return m}});var r=e(36215),i=e(64459),o=e(9947),s=e(687),u=e(7645),a=e(76795),c=e(42304),l=e(91367),f=e(93224),h=e(71683),d=e(55890),m=function(){function t(){}t.prototype;return Object.defineProperty(t,"fieldPrefix",{get:function(){return"field_"},enumerable:!1,configurable:!0}),t.createAnalyzeViewData=function(n){return new Promise((function(e,i){r.defer((function(){var i=n.FormElementManager.TopQuestionMasters.map((function(n,e){return{Index:e,Field:t.createIQuestionInfoField(n.Model),Model:n.Model,Master:n}})),o=r.map(n.Model.Responses,(function(e,r){var i=t.getResponseWithIndexableQuestion(e,n);return i.field_created_time=e.StartDate.toString(),i.field_modified_time=e.SubmitDate.toString(),i.field_responder=e.Responder,i.field_responder_name=e.ResponderName?e.ResponderName:e.Responder,i}));e({Questions:i,Answers:o,Analyses:t.analyzeReponse(i,o),Changed:!0})}))}))},t.createIQuestionInfoField=function(n){return t.fieldPrefix+n.Id.replace(/-/g,"")},t.getResponseWithIndexableQuestion=function(t,n){var e={};return r.forEach(t.Answers,(function(t){var r=n.getQuestionById(t.QuestionId);if(r){var u="field_"+t.QuestionId.replace(/-/g,"");e[u]=t.Answer;var l=r.Model.Type;if(l===c.o.getElementTypeName()&&t.Answer){var h=Date.parseDate(t.Answer,(0,s.gC)(),(0,o.k0)().cultureInfo);e[u]=h.toDateShortString((0,o.k0)().cultureInfo)}else if(r.isNumberType())e[u]=(0,i.d)(t.Answer);else if((l===f.nv.getElementTypeName()||l===a.L.getElementTypeName())&&r.Model.IsMathQuiz){e[u+"_math"]=t.IsMathAnswer}}})),e.field_id=t.Id,e},t.analyzeReponse=function(n,e){var i=this,o={};return n.forEach((function(n){switch(n.Model.Type){case"Question.Choice":var s=new Object,u=new Object,c={correct:0,wrong:0};r.forEach(n.Model.Choices,(function(t){s[t.Description]=0,u[t.Description]=t.IsMathOption}));var f=r.filter(n.Model.Choices,(function(t){return t.IsAnswerKey})).map((function(t){return t.Description})).sort();e.map((function(t){return t[n.Field]})).map((function(t){var e=(0,a.P)(t,n.Model);e.IsLegacyChoiceAnswer&&(0,d.$U)("DesignPage.Responses.MeetLegacyChoiceAnswer"),e.SelectedOptions.forEach((function(t){s[t]=s[t]||0,++s[t]})),r.isEqual(f,e.SelectedOptions.sort())?++c.correct:++c.wrong}));var h=[];for(var m in s)m&&h.push({Title:m,Data:s[m],IsMath:u[m]});o[n.Field]={options:i.calculateOthers(h),gradeResults:c};break;case"Question.Rating":var v,p=0,g=0;e.forEach((function(t){t[n.Field]&&(p++,g+=t[n.Field])})),v=0===p?0:Math.round(g/p*100)/100,o[n.Field]={count:p,averageRating:v};break;case"Question.TextField":if(n.Master.hasCorrectAnswers()){var b=new l.E(n.Model),w=new Object,y={correct:0,wrong:0};r.forEach(b.getAnswers(),(function(t){w[t.answer]=0}));var I=[];e.forEach((function(e){if(t.hasValidAnswer(e,n)){var r=String(e[n.Field]);I.push(r)}})),I.map((function(t){w[t]=w[t]||0,w[t]++,b.isCorrect(t)?++y.correct:++y.wrong}));var S=[];for(var C in w)w.hasOwnProperty(C)&&C&&S.push({Title:C,Data:w[C],IsMath:!1});o[n.Field]={options:i.calculateOthers(S),gradeResults:y};break}var F,N,T,k=[],x=0,P=0;e.forEach((function(e){t.hasValidAnswer(e,n)&&(n.Model.IsNumber&&r.isNumber(e[n.Field])&&(P++,x+=e[n.Field]),k.push(e[n.Field]))})),F=k.length,T=0===P?0:x/P,N=F<=3?k:k.slice(F-3),o[n.Field]={count:F,recentAnswers:N,averageResult:Math.round(100*T)/100};break;case"Question.DateTime":var D,E,R=[];e.forEach((function(t){t[n.Field]&&R.push(t[n.Field])})),E=(D=R.length)<=3?R:R.slice(D-3),o[n.Field]={count:D,recentAnswers:E};break;case"Question.Ranking":var L,A=n.Master.Model.ChoiceGroup,q={},O=A.length,M=[],U={correct:0,wrong:0},V=n.Model.GradingBasis;n.Model.IsQuiz?(L=JSON.parse(V),r.forEach(A,(function(t,n){var i=t.Id;M.push(i),q[i]={description:t.Description,total:e.length,data:r.map(Array.apply(null,Array(O)),Number.prototype.valueOf,0),score:0},L[L.indexOf(t.Key)]=i}))):r.forEach(A,(function(t){var n=t.Id;M.push(n),q[n]={description:t.Description,total:e.length,data:r.map(Array.apply(null,Array(O)),Number.prototype.valueOf,0),score:0}})),e.map((function(t){var e=t[n.Field];if(e&&e.length>0){var i=e.sort((function(t,n){return t.answerOrder-n.answerOrder})).map((function(t){return t.id}));r.isEqual(L,i)?++U.correct:++U.wrong,i.forEach((function(t,n){var e=q[t];e&&n<O&&(e.data[n]++,e.score+=O-n)}))}else++U.wrong}));var _=[];if(n.Model.IsQuiz)for(var G=0;G<L.length;G++)_.push({Title:q[L[G]].description,Data:q[L[G]].data,Score:q[L[G]].score,Total:q[L[G]].total});else for(var B in q)_.push({Title:q[B].description,Data:q[B].data,Score:q[B].score,Total:q[B].total});o[n.Field]={rankResults:_,gradeResults:U};break;default:o[n.Field]=void 0}})),o},t.calculateOthers=function(t){var n=0;if((t=t.sort((function(t,n){return n.Data-t.Data}))).length>10){var e=t.length-10+1;t.splice(9).forEach((function(t){return n+=t.Data})),t.push({Title:(0,u.pm)().AnalyzeView_Chart_Others.format(e),Data:n,IsMath:!1})}return t},t.hasValidAnswer=function(t,n){var e=function(n){return null!=t[n]&&""!==t[n]&&t[n].toString().length},i=n.Master.SubQuestionMasters;if(i.length>0){var o=r.map(i,(function(t){return"field_"+t.Model.Id}));return r.filter(o,e).length>0}return e(n.Field)},t.getBranchedQuestions=function(n,e){var r=n.FormElementManager.QuestionMasters;if(r&&e&&r[0])return e.map((function(e){var r=t.getBranchedQuestionsV2(n,e);return{field_id:e.field_id,branchedQuestions:r.map((function(t){return t.Model}))}}))},t.getBranchedQuestionsV2=function(t,n){var e=t.FormElementManager.getSectionNodes(),r=[];return h.X.getBranchedSections(e,(function(t,e){var r=e.indexOf(t)+1,i=e[r];return t.getBranchedResult(n["field_"+t.Model.Id],i)})).forEach((function(t){t.TopQuestionMasters.forEach((function(t){r.push(t),t.SubQuestionMasters.forEach((function(t){r.push(t)}))}))})),r},t}()},98196:function(t,n,e){"use strict";e.d(n,{j:function(){return s}});var r=e(36215),i=e(91367),o=e(55890),s=function(){function t(){}t.prototype;return t.isAutogradableQuestion=function(t){var n=r.some(t.Choices,(function(t){return t.IsAnswerKey})),e="Question.TextField"===t.Type&&!t.Multiline&&new i.E(t).areAnyAnswersDefined(),o="Question.Ranking"===t.Type&&0!==JSON.parse(t.GradingBasis).length;return t.IsQuiz&&(n||e||o)},t.isCorrectAnswer=function(t,n){return t.Master.isCorrectAnswer(n[t.Field])},t.onDeleteCurrentResponse=function(t,n){(0,o.$U)("DesignPage.Responses.DeleteSingleResponse"),t.bulkEdit((function(){t.Model.Responses=r.without(t.Model.Responses,r.findWhere(t.Model.Responses,{Id:n}))}))},t}()},97694:function(t,n,e){"use strict";e.d(n,{K:function(){return _t}});var r=e(59312),i=e(63804),o=e(27196),s=e(36215),u=e(22707),a=e(33967),c=e(85708),l=e(72377),f=e(26203),h=e(55411),d=e(10836),m=e(57411),v=e(687),p=e(7899),g=e(7645),b=e(925),w=e(77494),y=e(46008),I=e(18260),S=e(64541),C=e(9743),F=e(67661),N=e(43691),T=e(3864),k=e(99374);function x(t,n){return{Name:n,Type:t}}function P(t){return s.filter(t.Model.PermissionTokens,(function(t){return"AnalyzerToken"===t.Type&&t.Name===(0,v.dD)()}))[0]}var D,E,R,L=e(61499),A=e(31947),q=e(47143),O=e(64290),M=e(55890),U=e(50627),V=e(3424),_=e(65863),G=e(77145),B=e(79068),z=e(25038),Q=e(23112),H=e(90927),j=e(29559),W=e(9947),J=e(2995),K=e(81380),X=e(20263),Y=e(16311),Z=e(87278),tt=e(41040),nt=e(33523),et=e(57707);!function(t){t[t.Prepare=0]="Prepare",t[t.Generating=1]="Generating",t[t.Completed=2]="Completed"}(D||(D={})),function(t){t[t.IsGenerating=0]="IsGenerating",t[t.IsGenerated=1]="IsGenerated"}(E||(E={})),function(t){t[t.Hours=0]="Hours",t[t.Minutes=1]="Minutes"}(R||(R={}));var rt=function(t){var n=(0,g.pm)(),e="downloadcsv-container",o="download-to-local-button",s="downloadcsv-title",u="progress-indicator",a="progress-description",c="download-description",l="download-descriptionLine",f="cancel-download-Button",h="latest-response-button",d="downloadcsv-feedback-container",m="feedback-button-content",v=i.useState(n.Start_Download_CSV_New),p=v[0],b=v[1],w=i.useState(void 0),y=w[0],I=w[1],S=i.useState(0),C=S[0],F=S[1],N=i.useState(!1),T=N[0],k=N[1],x=i.useState(!1),P=x[0],D=x[1],E=i.useState(0),R=E[0],L=E[1],A=i.useState(!0),q=A[0],O=A[1],U=(0,X.D)(),V=(0,Y.N)(),_=t.$form,G=t.$isMovingResponseData,B=_.Model.Id,z=U.Model.$CsvInfo,Q=z.FileName,H=z.GenerateStatus,$=z.TotalResponseCount,rt=_.Model.ResponsesCount+_.Model.ArchivedRowCount!==$,it=Math.ceil(z.EstimateTimeInMinutes),ot=new Date(z.FileGenerateUtcTime),st=(0,W.k0)().cultureInfo,ut=n.RelativeDate_TimeDayOfWeek.format((0,J.Ih)(ot,st),ot.toTimeShortString(st)),at=new Date(z.FileExpireUtcTime).getTime(),ct=i.useMemo((function(){var t=36e5,n=at-Date.now();return n<t?(L(1),parseInt((n/6e4).toString())):(L(0),parseInt((n/t).toString()))}),[at]),lt=i.useMemo((function(){var t=1024,e=z.FileSize*t;return e>t?n.Commen_Text_FileSize_MB.format(Math.round(e/t)):n.Commen_Text_FileSize_KB.format(Math.round(e))}),[n,z.FileSize]),ft=i.useMemo((function(){return(0,K.lK)(_)}),[_]),ht=i.useCallback((function(t){ft.getCSVInfo(t).then((function(t){U.Model.$CsvInfo=t.length>0?t[0]:{},O(!1)}))}),[U,ft]),dt=i.useCallback((function(t){ft.deleteCSVFile(t).then((function(){ht(t)}))}),[ft,ht]),mt=i.useCallback((function(t){ft.generateCSVFile(t).finally((function(){ht(t)}))}),[ft,ht]),vt=i.useCallback((function(t){ft.getCSVDownloadLink(t).then((function(t){window.location.href=t}))}),[ft]),pt=i.useCallback((function(){U.Model.$CsvLink=""}),[U]),gt=i.useCallback((function(t){return(0,r.mG)(void 0,void 0,void 0,(function(){return(0,r.Jh)(this,(function(n){return ft.deleteCSVFile(t).then((function(){pt(),mt({$formId:t.$formId})})),[2]}))}))}),[ft,pt,mt]);i.useEffect((function(){return U.observe(V,[U.Schema.$CsvInfo,U.Schema.$CsvLink]),function(){U.unobserve(V)}}),[U,V]),i.useEffect((function(){!G&&ht({$formId:B})}),[G,B,ht]),i.useEffect((function(){"number"==typeof H?1===H?(F(2),b(n.Get_Latest_Version_CSV),D(!1),T&&!(0,j.tq)()&&(vt({$formId:B,$fileName:Q}),(0,M.$U)("WarmToCold.AutoDownloadCSV"))):0===H&&(F(1),b(n.Common_Cancel_Text),k(!0),D(!1)):(F(0),b(n.Start_Download_CSV_New))}),[n,H,Q,B,T,vt]);var bt=i.useCallback((function(){1===H?gt({$fileName:Q,$formId:B}):mt({$formId:B}),D(!0)}),[H,Q,B,gt,mt]);i.useEffect((function(){if(1===C){var t=setInterval((function(){(!H&&0!==H||1===H)&&clearInterval(t),ht({$formId:B})}),6e4);return function(){return clearInterval(t)}}}),[H,B,C,ht]);var wt=i.useCallback((function(){var t={$onConfirm:function(){dt({$fileName:Q,$formId:B}),F(0),b(n.Start_Download_CSV_New),I(void 0)},$onDismiss:function(){return I(void 0)},$title:n.Common_Cancel_Text,$subText:1===it?n.Cancel_Download_Subtitle_One_Minute:n.Cancel_Download_Subtitle_New.format(it),$defaultButtonText:n.Button_Cancel_Anyway,$primaryButtonText:n.Button_Keep_Downloading};I(i.createElement(nt.N,(0,r.pi)({},t)))}),[n,Q,B,it,dt]),yt=i.useCallback((function(){if(0===C||2===C)bt();else{if(1!==C)return;wt()}}),[C,bt,wt]),It=i.useCallback((function(){vt({$formId:B,$fileName:Q}),(0,M.$U)("WarmToCold.ClickDownloadLink")}),[B,Q,vt]),St=n.AnalyzeView_NumberOfResponses_AccessibilityLabel.format($),Ct=0===R?n.Generate_Expires_Hours.format(ct):n.Generate_Expires_Mins.format(ct),Ft=1===it?n.Preparing_File_One_Minute:n.Preparing_File.format(it);return q&&!G?null:i.createElement(i.Fragment,null,i.createElement("div",{className:e},i.createElement("div",{"aria-label":n.Download_All_Responses,className:s},i.createElement("span",null,n.Download_All_Responses)),P&&i.createElement("div",{className:u},i.createElement(tt.P,(0,r.pi)({},{ClassName:"designPage-response-downloadcsv-spinner",Ignorable:!1})),i.createElement("span",null,n.Common_Loading_Text)),!P&&1===C&&i.createElement("div",{className:u},i.createElement("div",{"aria-label":Ft},i.createElement("span",null,Ft),i.createElement("span",{"aria-label":n.Come_Back_Later_New,className:a},n.Come_Back_Later_New),i.createElement("button",{className:f,onClick:yt},p))),!P&&2===C&&i.createElement(i.Fragment,null,i.createElement("button",{"aria-label":n.Download_To_Local_New,className:o,onClick:It},i.createElement(et.D$,null),i.createElement("span",null,n.Download_To_Local_New),i.createElement("span",null,lt)),i.createElement("div",{className:c},i.createElement("span",{"aria-label":St},St),i.createElement("span",{className:l},"|"),i.createElement("span",{"aria-label":ut},ut),i.createElement("span",{"aria-label":Ct},Ct))),!P&&0===C&&i.createElement("button",{className:(G?"":"office-form-theme-button")+" primary-download-button ",disabled:G,onClick:yt},i.createElement("div",null,p)),!P&&2===C&&rt&&i.createElement("button",{className:h,onClick:yt},p),y),i.createElement("div",{className:d},i.createElement("button",{onClick:Z.L},i.createElement(et.zt,null),i.createElement("span",{className:m},n.GradingView_GiveFeedbackButton_Label))))},it=function(){var t=(0,g.pm)(),n="downloadcsv-messagebar-container",e="downloadcsv-messagebar-messageBar",r="downloadcsv-messagebar-icon",o="downloadcsv-messagebar-content",s="downloadcsv-messagebar-dismiss",u=i.useState(!0),a=u[0],c=u[1],l=i.useCallback((function(){c(!1)}),[]);return a&&i.createElement("div",{className:n},i.createElement("div",{className:""+e},i.createElement("div",{className:r},i.createElement(et.pn,null)),i.createElement("div",{className:o},t.Form_Response_Quota_Message),i.createElement("div",{className:s},i.createElement("button",{"aria-label":t.Form_Response_Quota_Message+" "+t.Common_DismissButton,onClick:l,role:"button",title:t.Common_DismissButton},i.createElement(et.$j,null)))))},ot=e(38174),st=e(94978),ut=e(72467),at=e(78587),ct=e(83735),lt=e(97586);var ft=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.di=function(){return n.forceUpdate()},n}(0,r.ZT)(n,t);var e=n.prototype;return e.componentDidMount=function(){(0,ct.b4)().observe(this.di,[ct.TS.Schema.ExportToExcelCalloutVersion])},e.componentWillUnmount=function(){(0,ct.b4)().unobserve(this.di)},e.render=function(){var t=(0,ct.b4)().Model;if((0,ct.OT)(t.ExportToExcelCalloutVersion)){var n=(0,lt.Bi)((0,at.Jn)("/Images/export-to-excel.gif"),null,lt.Mb),e=(0,lt.yM)((function(){return t.ExportToExcelCalloutVersion=ct.BT.toString()}));return(0,lt.dq)(n,e,"teachingCallout-exportToExcel","teachingCallout-exportToExcel-direction",(0,g.pm)().TeachingUI_Export_To_Excel)}return null},n}(Q.r),ht=e(42605),dt=e(83894),mt=e(62662),vt=e(13877),pt=e(90710);var gt=function(){function t(t,n){if(this.mi="DownloadExcel",this.vi="DownloadFileSize",this.bi=1500,this.wi=5e3,this.form=t,this.Ci=[],this.Fi=!1,this.Ni()){var e=parseInt((0,pt.NW)()[this.vi]);this.wi=e}else if(this.form.isFieldReady(this.form.Schema.Id)){var r=parseInt((0,vt.G)().getItem(this.mi+"-"+this.form.Model.Id));r&&(this.wi=r)}n&&(this.Ti=n)}var n=t.prototype;return Object.defineProperty(n,"TotalFileCount",{get:function(){return this.ki},enumerable:!1,configurable:!0}),n.start=function(){this.xi()?this.Pi({innerCode:10204,failureType:"ExpectedFailure"}):this.Fi||((0,M.$U)("DesignPage.Responses.DownloadExcelFileStart",{totalResponseCountRange:Math.ceil(this.form.Model.ResponsesCount/this.wi),isQuiz:this.form.SettingMaster.Model.IsQuizMode,isIos:this.xi()}),this.Fi=!0,this.et=(new Date).getTime(),this.Di())},n.logDownloadStatus=function(t,n){(0,M.$U)(t,{ErrorCode:n,fileCount:Math.ceil(this.form.Model.ResponsesCount/this.wi),timeCost:(new Date).getTime()-this.et,isQuiz:this.form.SettingMaster.Model.IsQuizMode})},n.stop=function(){this.Fi=!1,this.Ci=[],this.Ri&&this.Ri()},n.downloadAllResponses=function(){this.Li(),this.start()},n.observeEveryDownloadComplete=function(t){this.qi=t},n.observeStop=function(t){this.Ri=t},n.shouldForceToDownloadExcel=function(){return this.Ni()},n.Li=function(){var t=this.form.Model.ResponsesCount;this.ki=Math.ceil(t/this.wi),this.finishedDownloadFileCount=0,this.Ci=[];for(var n=1;n<=t;n+=this.wi)this.Ci.push({minResponseId:n,maxResponseId:Math.min(n+this.wi-1,t)})},n.Ni=function(){var t=parseInt((0,pt.NW)()[this.vi]);return!isNaN(t)&&t>0},n.Di=function(){var t=this;if(this.Fi)if(this.ki>this.Ci.length&&this.qi&&(this.finishedDownloadFileCount=this.ki-this.Ci.length,this.qi()),this.Ci.length>0){var n=this.Ci.shift();window.setTimeout((function(){return t.Oi(n.minResponseId,n.maxResponseId)}))}else this.logDownloadStatus("DesignPage.Responses.DownloadExcelFileSuccess",10220),this.stop()},n.Mi=function(t){!this.Ni()&&t>=1e3&&this.form.isFieldReady(this.form.Schema.Id)&&(this.wi=100*Math.ceil(t/200),(0,vt.G)().setItem(this.mi+"-"+this.form.Model.Id,this.wi.toString()))},n.Oi=function(n,e){var r=this;(0,M.$U)("DesignPage.Responses.DownloadOnePagingExcelFile"),(0,T.qU)("DownloadExcelFile"),window.clearTimeout(t.hideErrorBarMessageTimeout),t.hideErrorBarMessageTimeout=null,this.form.downloadExcelFile(n,e).then((function(){(0,T.qU)("DownloadExcelFile"),r.Di()})).catch((function(t){switch(r.stop(),r.logDownloadStatus("DesignPage.Responses.DownloadExcelFileFailed",t.innerCode),t.innerCode){case 10206:r.wi=r.bi,r.Pi(t);break;case 10208:r.Ti?r.Ti(2):r.Ui("DownloadExcelLimitReached");break;case 10209:if(r.Ti){r.Ti(3),window.setTimeout((function(){r.Ti(0)}),5e3)}else{var i=(0,st.vj)("DownloadExcelThrottleMessageBarDelayTime",3e3);window.setTimeout((function(){r.Ui("DownloadExcelVMLimitReached")}),i)}break;case 10210:r.Mi(e-n+1),t.innerCode=10203,r.Pi(t);break;default:r.Pi(t)}}))},n.Pi=function(n){(0,T.bh)("DownloadExcelFile",n&&{statusCode:n.statusCode,statusText:n.statusText,type:n.failureType,innerCode:n.innerCode,innerMessage:n.innerMessage,correlationId:n.correlationId,isServerError:!0}),t.hideErrorBarMessageTimeout=window.setTimeout((function(){(0,T.qU)("DownloadExcelFile"),t.hideErrorBarMessageTimeout=null}),1e4)},n.Ui=function(n){(0,T.Yb)(n),t.hideErrorBarMessageTimeout=window.setTimeout((function(){(0,T.XA)(),t.hideErrorBarMessageTimeout=null}),5e3)},n.xi=function(){var t=window.navigator.platform.toLocaleLowerCase(),n=window.navigator.userAgent.toLocaleLowerCase();return t.match(/iphone|ipod|ipad/)||n.match(/iphone|ipod|ipad/)},t}(),bt=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.Vi=(0,ut.f5)(),n._i=function(){n.state.IsPreparingFile&&n.forceUpdate()},n.Gi=function(){n.props.Form.ensureFieldsReady([F.x.Schema.XlExportingLocalTag]).then((function(){var t=!1;n.props.Form.IsExporting()?t=!0:n.props.Form.IsExportingFailed()&&n.state.IsPreparingFile&&(0,T.bh)("ReexportToExcelFile",{innerCode:10205}),n.setState({IsPreparingFile:t})}))},n.zi=function(){return n.setState({IsPreparingFile:!1})},n.Qi=function(){return n.forceUpdate()},n.ji=function(){return n.$i()},n.Wi=function(){return n.Ji()},n.Ki=function(){return n.Xi()},n.Yi=function(t){return n.Zi(t)},n}(0,r.ZT)(n,t);var e=n.prototype;return e.showExcelThrottleDialog=function(t){this.props.showExcelThrottleDialog(t)},e.componentDidMount=function(){var t=this;this.no=this.no.bind(this),this.props.Form.ensureFieldsReady([F.x.Schema.Id]).then((function(){t.DownloadExcelProcessor.observeEveryDownloadComplete(t._i),t.DownloadExcelProcessor.observeStop(t.zi)}));var n=F.x.Schema;this.props.Form.observe(this.Gi,[n.XlExportingLocalTag]),this.props.Form.observe(this.Qi,[n.XlFileUnsynced]),this.Vi.observe(this.no,[this.Vi.Schema.ExecuteDownloadExcel])},e.componentWillUnmount=function(){this.props.Form.unobserve(this.Gi),this.Vi.unobserve(this.no),(0,T.qU)("ReexportToExcelFile")},e.render=function(){return i.createElement("div",null,this.eo(),this.io(),this.oo(),this.so())},e.eo=function(){var n,e,r,o=this;if(this.state.IsPreparingFile)return null;var s=t.prototype.shouldExportExcelToOneDrive.call(this);this.props.Form.Model.XlFileUnsynced&&s?(n=i.createElement("span",{key:"alert",className:"export-to-excel-button-alert"}),e=this.ji,r=(0,g.pm)().AnalyzeView_Export_Excel_File_Unsynced_Alert):(e=function(){return o.uo(o.Wi)},r=(0,g.pm)().AnalyzeView_Export_Excel);var u={title:r,className:"analyze-view-export-button-container",onClick:e,disabled:!this.props.Form.isFieldReady(F.x.Schema.Id)||this.props.Form.Model.ResponsesCount<=0&&!s};return(0,ht.F)({HTMLAttributes:u,Icon:s?"exportOnedriveIcon":"ExcelLogo",IconClassName:"forms-icon-size24x24",Text:(0,g.pm)().AnalyzeView_Export_Excel,TextClassName:"analyze-view-export-button-label",ButtonStyle:1,GlyphButtonStyle:"Horizontal",children:n})},e.uo=function(t){var n=(0,st.vj)("DownloadExcelThrottleLevel",0);this.shouldExportExcelToOneDrive()||1!==n?t():this.showExcelThrottleDialog(1)},e.oo=function(){return!this.state.IsPreparingFile&&this.shouldExportExcelToOneDrive()?(t={},i.createElement(ft,(0,r.pi)({},t))):null;var t},e.so=function(){return this.state.IsPreparingFile?(n=t.prototype.shouldExportExcelToOneDrive.call(this)?(0,g.pm)().ReExportToExcel_Loading_Message:this.DownloadExcelProcessor.TotalFileCount>1?(0,g.pm)().DownloadExcel_Preparing_For_Multiple_File.format(this.DownloadExcelProcessor.finishedDownloadFileCount,this.DownloadExcelProcessor.TotalFileCount):(0,g.pm)().DownloadExcel_Preparing_For_Single_File,i.createElement("div",{role:"alert"},this.ao(),i.createElement("span",{className:"download-excel-progress-description"},n))):null;var n},e.ao=function(){return i.createElement(tt.P,(0,r.pi)({},{ClassName:"download-excel-loading-container"}))},e.io=function(){if(this.state.ShowAlertCallout){var t=(0,g.pm)();return i.createElement("div",{className:"export-button-alert-callout",onBlur:this.Yi,ref:"alert-callout",tabIndex:-1},i.createElement("div",{className:"unsynced-message"},t.AnalyzeView_Export_Excel_File_Unsynced_Alert),i.createElement("button",{className:"analyze-view-link-button reexport-link",onClick:this.Ki,ref:"alert-link"},i.createElement("span",null,t.AnalyzeView_Export_Excel_File_Reexport)))}},e.$i=function(){(0,ut.f5)().Model.ShowXLUnsyncedDialog=!0},e.no=function(){this.Vi.Model.ExecuteDownloadExcel&&(this.Ji(),this.Vi.Model.ExecuteDownloadExcel=!1)},e.Ji=function(){this.shouldExportExcelToOneDrive()||this.setState({IsPreparingFile:!0}),t.prototype.onExportExcel.call(this)},e.Zi=function(t){var n=(0,ot.y3)(t),e=o.findDOMNode(this.refs["alert-callout"]);e&&!e.contains(n)&&this.setState({ShowAlertCallout:!1})},e.Xi=function(){(0,b.Wr)(this.props.Form.Model.Id),this.setState({ShowAlertCallout:!1,IsPreparingFile:!0})},n}(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return Object.defineProperty(e,"DownloadExcelProcessor",{get:function(){return this.co=this.co||(t=this.props.Form,n=this.props.showExcelThrottleDialog,new gt(t,n));var t,n},enumerable:!1,configurable:!0}),e.shouldExportExcelToOneDrive=function(){return!(0,dt.ro)()&&(!this.props.Form.Model.Settings.IsQuizMode&&(!this.DownloadExcelProcessor.shouldForceToDownloadExcel()&&((0,mt.Fd)()||!!this.props.Form.Model.XlWorkbookId)))},e.onExportExcel=function(){(0,M.$U)("DesignPage.Responses.OpenInExcel",{xlworkbookid:this.props.Form.Model.XlWorkbookId}),this.shouldExportExcelToOneDrive()?(this.lo(),(0,ct.b4)().Model.ExportToExcelCalloutVersion=lt.BT.toString()):((0,M.$U)("DesignPage.Responses.DownloadMultipleExcelFiles"),this.DownloadExcelProcessor.downloadAllResponses())},e.lo=function(){var t=this;(0,M.$U)("DesignPage.Responses.OpenExcelInOneDrive"),this.props.Form.ensureFieldsReady([F.x.Schema.Id]).then((function(){(0,b.U8)(t.props.Form.Model.Id)}))},n}(Q.r)),wt=e(40554);var yt=function(t){function n(n){var e=t.call(this,n)||this;return e.fo=(0,ut.f5)().Model,e}(0,r.ZT)(n,t);var e=n.prototype;return e.render=function(){switch(this.props.throttleDialogType){case 1:return this.ho();case 2:return this.do();case 3:return i.createElement("div",{className:"openinexcel-throttle-reachvmlimitation-message-container"},(t=(0,g.pm)().XLThrottleDialog_VMReachedLimitation_Message,n=(0,V.M)({FluentIcon:"Warning",HTMLAttributes:{className:"openinexcel-throttle-vmlimitation-alart-icon forms-icon-size16x16"}}),i.createElement("div",{className:"openinexcel-throttle-reachvmlimitation-title-container",role:"alert"},n,i.createElement("span",{className:"openinexcel-throttle-reachvmlimitation-title"},t))),i.createElement("div",{className:"openinexcel-throttle-reachvmlimitation-linebreak"}));default:return null}var t,n},e.ho=function(){return 1===(0,st.vj)("DownloadExcelThrottleLevel",0)?i.createElement("div",{className:"openinexcel-throttle-predialog-container"},this.mo()):null},e.do=function(){return i.createElement("div",{className:"openinexcel-throttle-predialog-container"},this.vo())},e.mo=function(){var t=this,n={ButtonsProps:[{ClassName:"openinexcel-throttle-continue-button",GlyphButtonStyle:"Horizontal",Key:"continueItem",onClick:function(){t.props.showExcelThrottleDialog(0),t.fo.ExecuteDownloadExcel=!0},Text:(0,g.pm)().Common_Yes_Text,Title:(0,g.pm)().Common_Yes_Text},{ClassName:"openinexcel-throttle-cancel-button",GlyphButtonStyle:"Horizontal",Key:"cancelItem",onClick:function(){t.props.showExcelThrottleDialog(0)},Text:(0,g.pm)().XLThrottleDialog_StrictMode_CancelButton,Title:(0,g.pm)().Designer_Cancel_Text}],ClassName:"openinexcel-throttle-button-container",Description:(0,g.pm)().XLThrottleDialog_StrictMode_Content,key:"deleteConfirmDialog",ShowDialog:!0};return i.createElement("div",{className:"openinexcel-throttle-dialog-container"},It(!0),this.po(),(0,wt.s)(n))},e.vo=function(){var t=this,n={ButtonsProps:[{ClassName:"openinexcel-throttle-gotit-button",GlyphButtonStyle:"Horizontal",Key:"gotItItem",onClick:function(){t.props.showExcelThrottleDialog(0)},Text:(0,g.pm)().TeachingUi_GotIt,Title:(0,g.pm)().TeachingUi_GotIt}],ClassName:"openinexcel-throttle-button-container",Description:(0,g.pm)().XLThrottleDialog_OwnerReachedLimitation_Content,key:"deleteConfirmDialog",ShowDialog:!0};return i.createElement("div",{className:"openinexcel-throttle-dialog-container"},It(!1),this.bo(),(0,wt.s)(n))},e.po=function(){var t=this;return(0,ht.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"openinexcel-throttle-dialog-close-button",onClick:function(){t.props.showExcelThrottleDialog(0)}},FluentIcon:"Dismiss",IconClassName:"openinexcel-throttle-dialog-close-icon forms-icon-size16x16",Text:(0,g.pm)().Common_Close_Text})},e.bo=function(){var t=this;return(0,ht.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"openinexcel-throttle-dialog-close-button",onClick:function(){t.props.showExcelThrottleDialog(0)},title:(0,g.pm)().Common_Close_Text},FluentIcon:"Dismiss",IconClassName:"openinexcel-throttle-dialog-close-icon forms-icon-size16x16"})},n}(Q.r);function It(t){var n=(0,g.pm)().XLThrottleDialog_OwnerReachedLimitation_Title,e="openinexcel-throttle-reachlimitation-title";t&&(n=(0,g.pm)().XLThrottleDialog_StrictMode_Title,e="openinexcel-throttle-strictmodeconfirm-title");var r=(0,V.M)({FluentIcon:"Warning",HTMLAttributes:{className:"office-form-alert-icon forms-icon-size20x20"}});return i.createElement("div",{className:"openinexcel-throttle-reachlimitation-title-container",role:"alert"},t?null:r,i.createElement("span",{className:e},n))}var St=e(84745),Ct=e(30359),Ft=e(43370),Nt=e(15694),Tt=e(13226),kt=e(18805),xt=e(45915),Pt=e(92578),Dt=e(30945),Et=e(48678),Rt=e(54676),Lt=e(17202),At=e(45040),qt=e(14101),Ot=e(36048),Mt=e(83057),Ut=e(92834);function Vt(t,n){var e=n+t.AggregationMaster.QuestionType,r=function(t,n){if(t===St.n.Survey)switch(n){case"Question.NPS":return qt.R;case"Question.FileUpload":return Lt.D;case"Question.TextField":return Ut.h;case"Question.MatrixChoiceGroup":return At.Z;case"Question.Rating":return Mt.m;case"Question.Choice":return Et.p;case"Question.DateTime":return Rt.X;case"Question.Ranking":return Ot.t}else if(t===St.n.Quiz)switch(n){case"Question.NPS":return kt.V;case"Question.FileUpload":return Nt.h;case"Question.TextField":return Dt.x;case"Question.MatrixChoiceGroup":return Tt.Y;case"Question.Rating":return Pt.g;case"Question.Choice":return Ct.q;case"Question.DateTime":return Ft.$;case"Question.Ranking":return xt.i}}(n,t.AggregationMaster.QuestionType);if(r)return t.key=t.key||t.AggregationMaster.Model.QuestionId,i.createElement(r,t);throw Error('Type "'+e+'" has not been registered.')}var _t=function(t){function n(n){var e=t.call(this,n)||this;return e.wo=function(){e.isComponentMounted&&e.forceUpdate()},e.yo=function(){(0,u.Ai)(e.props.FormMaster.Model.Flags)&&(0,T.r)((0,g.pm)().Error_Message_Is_Moving_Data,"Warning")},e.Io=function(){e.yo(),e.wo()},e.So=function(){var t=null,n=e.props.FormMaster.Model.PermissionTokens;if(n.length>0){var r=s.filter(n,(function(t){return"AnalyzerToken"===t.Type&&t.Name===(0,v.dD)()}))[0];if(r)f.d.getObjectMasterFromModel(r).Synchronizer.existingInDataSource().then((function(){t=n[0].PrincipalId,e.setState({ShareResultToken:t})}))}else e.setState({ShareResultToken:t})},e.Fo=e.Fo.bind(e),e.No=e.No.bind(e),e.Ti=e.Ti.bind(e),e.To=e.To.bind(e),e.ko=e.ko.bind(e),e.xo=e.xo.bind(e),e.Po=e.Po.bind(e),e}(0,r.ZT)(n,t);var e=n.prototype;return e.componentWillMount=function(){this.initialize(),this.registerObservers(),this.Do(),this.props.FormMaster.observe(this.Fo,[F.x.Schema.ReputationTier]),(0,B.s$)()&&this.formInsightMaster&&(this.formInsightMaster.observe(this.ko,[N.M.Schema.IsReady]),(0,d.cr)("GetInsightPerResponseChange")&&this.props.FormMaster.observe(this.Po,[F.x.Schema.ResponsesCount]))},e.render=function(){var t=(0,h.sv)()&&this.state.DetailDialogQuestionIndex>=0;return i.createElement("div",{className:"analyze-view-container",id:"analyzeViewPrintContainer",role:"main"},this.Eo(),this.Ro(),this.createOpenInExcelThrottleDialog(),this.createQuestionDetailDialog(),t&&this.Lo(),this.createInsightViewContainer(),this.Ao(),i.createElement(H.w,{ThemeMaster:this.props.FormMaster.ThemeMaster}))},e.componentDidMount=function(){var t,n=this;if(this.isComponentMounted=!0,this.qo(),(0,U.Hw)((0,c.dg)()-(0,U.rx)()),this.props.FormMaster.SyncContext===C.y.DesignTimeForm)(0,M.$U)("DesignPage.Responses.Navigate"),(t=this.props.FormMaster,t.Synchronizer.existingInDataSource().then((function(){var n=P(t);if(!n)return null;var e=(0,k.R)(n);return e?e.Synchronizer.existingInDataSource().then((function(){return e.Model.PrincipalId})):void 0}))).then((function(t){n.setState({ShareResultToken:t})})).catch((function(){n.setState({ShareResultToken:null})}));else if(this.props.FormMaster.SyncContext!==C.y.AnalysisTimeForm){var e="Fatal Error: AnalyzeViewBase.componentDidMount SyncContext: ["+this.props.FormMaster.SyncContext+"] shouldn't come to analyize view";throw(0,M.zU)("InvalidServerAggregatePayload",e),Error(e)}(0,w.x4)(this.props.FormMaster)},e.componentDidUpdate=function(){this.qo(),window.setTimeout(w.Tl,0)},e.componentWillUnmount=function(){this.unregisterObservers(),this.formAggregationMaster&&(this.formAggregationMaster.terminateSync(),this.formAggregationMaster.release()),this.props.FormMaster.unobserve(this.Fo),(0,B.s$)()&&this.formInsightMaster&&(this.formInsightMaster.unobserve(this.ko),(0,d.cr)("GetInsightPerResponseChange")&&this.props.FormMaster.unobserve(this.Po))},e.initialize=function(){this.formAggregationMaster=new L.G(this.props.FormMaster),(0,B.s$)()&&(this.formInsightMaster=new N.M(this.props.FormMaster),this.props.FormMaster.SyncContext!==C.y.AnalysisTimeForm&&this.formInsightMaster.loadInsight())},e.registerObservers=function(){if(this.yo(),this.props.FormMaster.observe(this.Io,[F.x.Schema.Flags]),this.formAggregationMaster.observe(this.wo,[L.G.Schema.SummaryAggregation]),this.props.FormMaster.SyncContext!==C.y.AnalysisTimeForm){var t=f.d.getCollectionMasterFromModel(this.props.FormMaster.Model.PermissionTokens);t.observe(this.So,[t.Schema[0].PrincipalId])}},e.unregisterObservers=function(){this.props.FormMaster.unobserve(this.Io),this.formAggregationMaster&&this.formAggregationMaster.unobserve(this.wo),this.props.FormMaster.SyncContext!==C.y.AnalysisTimeForm&&f.d.getCollectionMasterFromModel(this.props.FormMaster.Model.PermissionTokens).unobserve(this.So)},e.Do=function(){var t=this;Promise.all([(0,p.y)("DataTables"),(0,p.y)("Chart"),(0,p.y)("D3")]).then((function(){t.setState({LibraryLoaded:!0})}))},Object.defineProperty(e,"SummaryPanelProps",{get:function(){var t,n=this;return this.Oo()&&(t=function(){return n.Mo()}),{AggregationMaster:(0,A.V)(this.formAggregationMaster.Model.SummaryAggregation),Form:this.props.FormMaster,onDeleteResponses:function(){return n.Uo()},onExportExcel:t,onPrint:function(){return n.Vo()},onCreatePermissionToken:function(){return n._o()},onDeletePermissionToken:function(){return n.Go()},PermissionToken:this.state.ShareResultToken}},enumerable:!1,configurable:!0}),e.createInsightViewContainer=function(){return null},Object.defineProperty(e,"FocusRef",{set:function(t){this.Bo=t},enumerable:!1,configurable:!0}),e.Ro=function(){var t=this,n=(0,u.yH)((0,A.V)(this.formAggregationMaster.Model.SummaryAggregation),this.props.FormMaster.Model.Flags),e=(0,u.Ai)(this.props.FormMaster.Model.Flags);return(0,O.pd)((function(){return i.createElement("div",{className:"analyze-view-content",id:"analyzeViewPrintChildContainer"},n&&!e&&t.zo(),t.Qo(),t.createSummaryPanel(),!n&&i.createElement(i.Fragment,null,t.Ho(),t.createOpenInExcelThrottleMessage()),n&&t.jo(e),!n&&t.Wo())}),(function(){if((0,d.cr)("FormsProGCC"))return"survey"===t.props.FormMaster.Model.Type?i.createElement("div",{className:"analyze-view-content",id:"analyzeViewPrintChildContainer"},t.Wo()):i.createElement("div",{className:"analyze-view-content",id:"analyzeViewPrintChildContainer"},t.Qo(),t.createSummaryPanel(),t.Ho(),t.Wo())}))},e.Lo=function(){var t=this.props.FormMaster,n=this.state.DetailDialogQuestionIndex,e=t.FormElementManager.TopQuestionMasters[n];return l.Pv.Resolve("IMobileDesignPageUXFactory").createMobileResponseDetailPage({FormId:t.Model.Id,onBack:this.No,QuestionId:e.Model.Id,QuestionOrder:n+1,QuestionType:e.Model.Type,ResponseCount:t.Model.ResponsesCount,FormAggregationMaster:this.formAggregationMaster})},e.jo=function(t){var n=this.props.FormMaster;if(n.Synchronizer.isFieldReady(F.x.Schema.ArchivedRowCount)){var e=Math.floor((n.Model.ResponsesCount+n.Model.ArchivedRowCount)/1e3);return(0,M.$U)("WarmToCold.DownloadCSVEnabled",{responseCountRank:e}),i.createElement(rt,{$form:this.props.FormMaster,$isMovingResponseData:t})}},e.zo=function(){return i.createElement(it,null)},e.Qo=function(){var t=this.props.FormMaster,n=t.isFieldReady(F.x.Schema.FormsProRTTitle)?(0,S.wg)(t.Model.Title,t.Model.FormsProRTTitle):t.Model.Title;return!(0,h.sv)()&&i.createElement("div",{className:"analyze-view-formname",role:"heading","aria-level":1},i.createElement(_.D,{Text:n,RenderMode:"RichText",ContainsHtml:!0}))},e.Eo=function(){if(((0,m.gq)()||!(0,a.yv)())&&!this.props.isDesignTimeView)return i.createElement(G.d,{FormMaster:this.props.FormMaster,HTMLAttributes:{className:"analyze-view-dataclassification-label"},DesignTimeView:this.props.isDesignTimeView})},e.Ho=function(){var t;if((0,h.sv)()||(t=this.Jo()),this.formAggregationMaster.FormMaster.SyncContext!==C.y.AnalysisTimeForm)return i.createElement("div",{className:"analyze-view-nav-bar"},this.createExtensionReviewContent(),t)},e.Ti=function(t){this.setState({ShowExcelThrottleDialog:t})},e.createOpenInExcelThrottleDialog=function(){return function(t){switch(t.throttleDialogType){case 2:case 1:return i.createElement(yt,(0,r.pi)({},t));default:return null}}({throttleDialogType:this.state.ShowExcelThrottleDialog,showExcelThrottleDialog:this.Ti})},e.createOpenInExcelThrottleMessage=function(){var t,n={throttleDialogType:this.state.ShowExcelThrottleDialog,showExcelThrottleDialog:this.Ti};return 3===(t=n).throttleDialogType?i.createElement(yt,(0,r.pi)({},t)):null},e.Jo=function(){return i.createElement("div",{className:"analyze-view-export-to-excel-button"},i.createElement(bt,{Form:this.formAggregationMaster.FormMaster,showExcelThrottleDialog:this.Ti}))},e.Wo=function(){if(this.state.LibraryLoaded)return i.createElement("div",{className:"analyze-view-detail-content"},this.Ko(),this.Xo())},e.Ko=function(){return this.props.FormMaster.Model.ResponsesCount>0?this.Yo():null},e.Yo=function(){var t=this,n=f.d.convertToArray(this.formAggregationMaster.Model.QuestionAggregations),e=0;return n.map((function(n,r){var i,o,s=(0,q.S)(n);if(!(s&&s.QuestionMaster&&s.QuestionMaster.Model.GroupId)){if(t.formAggregationMaster.FormMaster.SyncContext!==C.y.AnalysisTimeForm){var u=e;i=function(){t.onDetailViewLinkClick(u)},o=function(){t.To(u)}}return Vt({AggregationMaster:s,Index:e++,QuestionViewInsight:{FormInsightMaster:t.formInsightMaster,InsightExploreViewOpened:t.state.InsightExploreViewOpened,InsightExploreViewIndex:t.state.InsightExploreViewIndex,InsightReady:t.state.InsightReady,onClickInsightButton:o,onCloseInsightExploreView:t.xo},onShowQuestionDetail:i},t.QuestionClassType)}}))},e.Xo=function(){if(this.props.FormMaster.Model.ResponsesCount>0)return i.createElement("div",{className:"analyze-view-detail-noresponses-container",key:"empty-questions-view",role:"status"});var t=(0,g.pm)().Analysis_Page_No_Responses_Message;return i.createElement("div",{className:"analyze-view-detail-noresponses-container",key:"empty-questions-view",role:"status"},i.createElement("div",{className:"analyze-view-warning-icon"},i.createElement(V.F,{FluentIcon:"Emoji Sad"})),i.createElement("div",{className:"analyze-view-detail-noresponse-message","aria-label":t},t),i.createElement("div",{className:"analyze-view-detail-noresponse-detail"},(0,g.pm)().Analysis_Page_No_Responses_Details))},e.Ao=function(){if(this.state.ShowPhishingWarningMessage&&(0,m.M5)()&&this.props.FormMaster.SyncContext===C.y.DesignTimeForm)return(0,I.vw)({formId:this.props.FormMaster.Model.Id})},e.Uo=function(){var t=this;(0,M.$U)("DesignPage.Responses.DeleteAllResponses"),this.props.FormMaster.deleteAllResponses().then((function(){(0,T.qU)("DeleteAllResponses",t.props.FormMaster.Model.Id),t.props.FormMaster.refreshFormResponsesCount(),(0,u.kR)(t.props.FormMaster.Model.Flags)&&t.props.FormMaster.Synchronizer.query([F.x.Schema.Flags])})).catch((function(n){(0,T.bh)("DeleteAllResponses",n,t.props.FormMaster.Model.Id)}))},e.Oo=function(){return!(0,h.sv)()&&this.props.FormMaster.SyncContext!==C.y.AnalysisTimeForm&&this.props.FormMaster.isFieldReady(F.x.Schema.XlWorkbookId)&&!!this.props.FormMaster.Model.XlWorkbookId},e.Mo=function(){(0,M.$U)("DesignPage.Responses.OpenInExcel"),(0,b.Wr)(this.props.FormMaster.Model.Id)},e.Vo=function(){var t=$("#analyzeViewPrintChildContainer").appendTo($("body")),n=$("#content-root"),e=$("#FormCenterHeader");n.hide(),e.hide(),(0,y.B6)((function(){t.appendTo($("#analyzeViewPrintContainer")),n.show(),e.show()}))},e._o=function(){var t,n,e,r,i,o=this;return(t=this.props.FormMaster,n="AnalyzerToken",e=(0,v.dD)(),r=f.d.Collection.addItems(t.Model.PermissionTokens,[x(n,e)]),i=(0,k.R)(r[0]),i.Synchronizer.existingInDataSource().then((function(){return i.Model.PrincipalId}))).then((function(t){return(0,M.$U)("DesignPage.Share.CreateAnalysisResulttLink"),o.setState({ShareResultToken:t}),t}))},e.Go=function(){var t=this,n=this.props.FormMaster,e=P(n);e&&function(t,n){if(n)return f.d.Collection.deleteItems(t.Model.PermissionTokens,[n]),(0,k.R)(n).Synchronizer.deletedFromDataSource().then()}(n,e).then((function(){(0,M.$U)("DesignPage.Share.DeleteAnalysisResultLink"),t.setState({ShareResultToken:null})}))},e.onDetailViewLinkClick=function(t){(0,M.$U)("DesignPage.Responses.ShowResponsesDetail"),this.setState({DetailDialogQuestionIndex:t})},e.qo=function(){var t=o.findDOMNode(this);if($(t).is(":visible")&&!this.Zo){var n=o.findDOMNode(this.refs[this.Bo]);this.Bo=void 0,n&&n.focus()}this.Zo=$(t).is(":visible")},e.Fo=function(){var t=this.props.FormMaster.Model;this.setState({ShowPhishingWarningMessage:(0,z.NT)(t.ReputationTier)})},e.No=function(){this.setState({DetailDialogQuestionIndex:-1})},e.ko=function(){this.formInsightMaster&&this.formInsightMaster.Model.InsightCount>0?this.setState({InsightReady:!0}):this.setState({InsightReady:!1})},e.To=function(t){this.setState({InsightExploreViewOpened:!0,InsightExploreViewIndex:t})},e.xo=function(){this.setState({InsightExploreViewOpened:!1})},e.Po=function(){this.formInsightMaster.loadInsight()},n}(Q.r)},77288:function(t,n,e){"use strict";e.d(n,{r:function(){return P}});var r=e(59312),i=e(63804),o=e(61499),s=e(64290),u=e(23112),a=e(36215),c=e(9947),l=e(26203),f=e(55411),h=e(7645),d=e(72467),m=e(3339),v=e(67661),p=e(84745),g=e(55890),b=e(25306),w=e(25038),y=e(29542),I=e(97694),S=e(38255),C=e(22707),F=e(66022),N=e(35230),T=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.statisticsContent=function(){if((0,C.yH)(this.props.AggregationMaster,this.props.Form.Model.Flags))return null;if(this.props.AggregationMaster.isAverageResultEnabled){var n=this.ts(),e=String(n),o={AccessibilityText:(0,h.pm)().AnalyzeView_Average_Score_Explicit.format(e),Data:e,Description:(0,h.pm)().AnalyzeView_Average_Score,Ignorable:!0,IsReady:0===this.props.AggregationMaster.Model.TotalResponseCount||this.IsAggregationReady||this.IsAggregationFailed};return i.createElement(N.V,(0,r.pi)({},o))}return t.prototype.statisticsContent.call(this)},e.ts=function(){var t=this.props.AggregationMaster;return 0===t.Model.TotalResponseCount?0:this.IsAggregationReady?Number((t.Model.AverageScore||0).toFixed(1)):-1},n}(F.y);var k=function(t){function n(n){var e=t.call(this,n)||this;e.es=function(t){return e.rs(t)},e.createQuestionDetailDialog.bind(e);var r=e.props.FormMaster.Model;return e.state={IsAnalyzeDataReady:!1,LibraryLoaded:!1,DetailDialogQuestionIndex:-1,ShareResultToken:null,InsightDialogOpened:(0,d.f5)().Model.DataIdeas,InsightExploreViewIndex:-1,InsightExploreViewOpened:!1,InsightReady:!1,InsightType:null,ShowPhishingWarningMessage:(0,w.NT)(r.ReputationTier),ShowExcelThrottleDialog:0},e.us=e.us.bind(e),e.cs=e.cs.bind(e),e.ls=e.ls.bind(e),e}(0,r.ZT)(n,t);var e=n.prototype;return Object.defineProperty(e,"QuestionClassType",{get:function(){return p.n.Quiz},enumerable:!1,configurable:!0}),e.createSummaryPanel=function(){return t=this.SummaryPanelProps,i.createElement(T,(0,r.pi)({},t));var t},e.registerObservers=function(){t.prototype.registerObservers.call(this),this.props.FormMaster.observe(this.es,[v.x.Schema.ResponsesCount,v.x.Schema.Questions])},e.unregisterObservers=function(){t.prototype.unregisterObservers.call(this),this.props.FormMaster.unobserve(this.es)},e.createExtensionReviewContent=function(){var t=this;if(!(0,f.sv)()){var n=this.props.FormMaster.Model.ResponsesCount>0,e=this.props.FormMaster.Model.QuizQuestionsCount>0,r=n&&e,o=(0,b.E)({HTMLAttributes:{className:"analyze-view-nav-button office-form-theme-button",onClick:function(){window.ClickReviewAnswersStart=new Date,t.FocusRef="review-answers-button";var n=(0,d.f5)();n.bulkEdit((function(){n.Model.Grading=m.Z.ByStudent,n.Model.TopView="Grading_ReviewAnswers"}))},disabled:!r},ButtonStyle:1,Text:(0,h.pm)().AnalyzeView_GradingButton_Label,ref:"review-answers-button"}),s=!(0,c.k0)().userInfo.IsMsa&&(0,b.E)({HTMLAttributes:{className:"analyze-view-nav-button office-form-theme-button",onClick:function(){(0,g.$U)("DesignPage.Responses.ReleaseResults"),t.FocusRef="post-grades-button",t.fs().then((function(){(0,d.f5)().Model.TopView="Grading_PostGrades"}))},disabled:!r},ButtonStyle:1,Text:(0,h.pm)().AnalyzeView_ReleaseResultsButton_Label,ref:"post-grades-button"});return i.createElement("div",{className:"analyze-view-nav-bar-left-button-container"},o,s)}},e.createQuestionDetailDialog=function(){var t=this.state.DetailDialogQuestionIndex,n=l.d.convertToArray(a.filter(this.props.FormMaster.Model.Questions,(function(t){return!t.GroupId})));if(!(t<0)){if(!(t>=n.length))return this.state.IsAnalyzeDataReady?this.hs(t,n):void this.fs();(0,g.zU)("UnexpectedDetailQuestionIndex",{index:String(t)})}},e.hs=function(t,n){var e="field_"+n[t].Id;return(0,S.D)({QuestionId:e,AnalyzeViewData:this.ds,goToNextModalCallback:this.us,goToPreviousModalCallback:this.cs,closeSelf:this.ls})},e.us=function(){var t=this.state.DetailDialogQuestionIndex,n=l.d.convertToArray(a.filter(this.props.FormMaster.Model.Questions,(function(t){return!t.GroupId})));t>=0&&t<n.length-1&&((0,g.$U)("DesignPage.Responses.DetailDialogQuestionNavigate",{entry:"NextQuestion"}),this.setState({DetailDialogQuestionIndex:t+1}))},e.cs=function(){var t=this.state.DetailDialogQuestionIndex,n=l.d.convertToArray(a.filter(this.props.FormMaster.Model.Questions,(function(t){return!t.GroupId})));t>0&&t<n.length&&((0,g.$U)("DesignPage.Responses.DetailDialogQuestionNavigate",{entry:"PreviouseQuestion"}),this.setState({DetailDialogQuestionIndex:t-1}))},e.ls=function(){this.setState({DetailDialogQuestionIndex:-1})},e.fs=function(){var t=this,n=Promise.resolve();return this.state.IsAnalyzeDataReady||this.props.FormMaster.Model.Responses&&this.props.FormMaster.Model.Responses.length||(n=this.props.FormMaster.syncFormResponses()),n.then((function(){return y.f.createAnalyzeViewData(t.props.FormMaster)})).then((function(n){t.ds=n,t.setState({IsAnalyzeDataReady:!0})}))},e.rs=function(t){var n=t.NewValues.ResponsesCount!=t.OldValues.ResponsesCount,e=!a.isEqual(t.NewValues.Questions,t.OldValues.Questions);this.setState({IsAnalyzeDataReady:!n&&!e&&!!this.ds})},n}(I.K),x=e(26526);function P(t){return i.createElement(D,(0,r.pi)({},t))}var D=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,r.ZT)(n,t),n.prototype.render=function(){var t=this,n=this.props.Form;return(0,s.pd)((function(){var e,s=t.props.showErrorPage;return(0,o.f)(n)?(e={FormMaster:n,showErrorPage:s,isDesignTimeView:t.props.isDesignTimeView},i.createElement(k,(0,r.pi)({},e))):(0,x.p)({FormMaster:n,showErrorPage:s,isDesignTimeView:t.props.isDesignTimeView})}),(function(){return FormsPro.createProAnalyzeViewContainer(n,t.props.openInvitationPage)}))},n}(u.r)},62396:function(t,n,e){"use strict";e.d(n,{Z:function(){return N}});var r=e(59312),i=e(63804),o=e(22707),s=e(33967),u=e(29559),a=e(9947),c=e(7645),l=e(90710),f=e(28087),h=e(72467),d=e(67661),m=e(3864),v=e(55890),p=e(3424),g=e(42605),b=e(41040),w=e(48280),y=e(40554),I=e(25306),S=e(23112),C=e(17111),F=e(63481);var N=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.vs=!1,n.ps=i.createRef(),n.gs=(0,h.f5)().Model,n.bs=function(){var t=n.gs.FormsTenantSettings;n.setState({IsExternalSharingAllowed:null==t||t.externalShareResult})},n.ws=function(){return n.forceUpdate()},n.state={ConfirmDialogPrompt:void 0,ResetMenu:!1,ShowShareSummaryResultContainer:!1,ShowDeleteShareResultLinkContainer:!1,ShowSpinner:!0,ShowErrorBox:!1,PermissionToken:"",IsExternalSharingAllowed:null==n.gs.FormsTenantSettings||n.gs.FormsTenantSettings.externalShareResult,TooltipClassName:"button-tooltip-analyze-view-ellipsis-button"},n.ys=function(){return n.props.Form.isCurrentUserFormOwnerOrGroupMember()||n.props.Form.canEditPermissionTokenByCoauthor()},n.Is=function(t){var e=n.ps.current;n.state.ShowShareSummaryResultContainer&&t.target&&e&&!e.contains(t.target)&&!n.Ss(t,e)&&n.setState({ShowShareSummaryResultContainer:!1,ShowDeleteShareResultLinkContainer:!1})},n}(0,r.ZT)(n,t);var e=n.prototype;return e.componentDidUpdate=function(){var t=document.getElementById("share-result-container-textbox-link")||document.getElementById("share-result-cancel-button");t&&(t.focus(),this.vs&&(document.getElementById("share-result-container-copy-button").click(),t.select(),this.vs=!1))},e.componentDidMount=function(){this.Fs=this.Ns("#share-result-container-copy-button","#share-result-container-copy-button-status",(0,c.pm)().SharePane_Link_SuccessMessage,(0,c.pm)().SharePane_Link_FailedMessage);var t=(0,h.f5)();t.observe(this.bs,[t.Schema.FormsTenantSettings]),this.props.onReExportToExcel&&this.props.Form.observe(this.ws,[d.x.Schema.XlExportingLocalTag]),document.addEventListener("mouseup",this.Is)},e.componentWillUnmount=function(){document.removeEventListener("mouseup",this.Is),this.Fs&&this.Fs.destroy(),this.Fs=void 0,(0,h.f5)().unobserve(this.bs),this.props.onReExportToExcel&&this.props.Form.unobserve(this.ws)},e.render=function(){return this.Ts()?i.createElement("div",null,this.ks(),this.xs(),this.Ps()):null},e.Ts=function(){var t=!!this.props.onDelete||!!this.props.onPostScore;return(0,u.tq)()?t:t||!!this.props.onPrint},e.Ds=function(){var t=this;if(this.props.onDelete){var n={Action:function(){return t.props.onDelete()},ActionButtonText:(0,c.pm)().Common_Delete_Text,CancelButtonText:(0,c.pm)().Common_Cancel_Text,DialogDescription:this.Rs()};return{Checked:!1,Description:this.props.DeleteAllResponses?(0,c.pm)().AnalyzeView_ResetResponses_ButtonText:(0,c.pm)().AnalyzeView_DeleteSingleResponse_ButtonText,Key:"deleteResponseItem",onExecute:function(){t.props.onBeforeDeletedDialogShown&&t.props.onBeforeDeletedDialogShown(),t.setState({ConfirmDialogPrompt:n})},IsDisabled:!this.props.HasAnswers||this.props.IsMovingData}}return null},e.Ls=function(){var t=this;if(!(0,u.tq)()&&this.props.onPrint){return{Checked:!1,Description:this.props.DeleteAllResponses?(0,c.pm)().AnalyzeView_PrintResponses_ItemText:(0,c.pm)().AnalyzeView_PrintSingleResponse_ItemText,Key:"printItem",onExecute:function(){(0,v.$U)("DesignPage.Responses.PrintAnalyzeView"),t.props.onPrint()},IsDisabled:!this.props.HasAnswers}}return null},e.As=function(){var t=this;if(this.props.onPostScore&&!(0,a.k0)().userInfo.IsMsa){var n={Action:this.props.onPostScore,ActionButtonText:(0,c.pm)().GradingView_ReleaseResponse_Confirm_Release,CancelButtonText:(0,c.pm)().Common_Cancel_Text,DialogDescription:(0,c.pm)().GradingView_ReleaseResponse_Confirm_Description};return{Checked:!1,Description:this.props.IsScoreReleased?(0,c.pm)().GradingView_AlreadyReleased:(0,c.pm)().GradingView_Release,IsDisabled:this.props.IsScoreReleased,Key:"postScoreItem",onExecute:function(){return t.setState({ConfirmDialogPrompt:n})}}}return null},e.Os=function(){var t=this;if(!(0,u.tq)()&&this.props.onReExportToExcel){var n={Action:function(){t.props.Form.ensureFieldsReady([d.x.Schema.XlExportingLocalTag]).then((function(){t.props.Form.SetToExporting(),(0,v.$U)("DesignPage.Responses.PopupReExportToExcelDialog"),t.props.onReExportToExcel()})),(0,m.qU)("ReexportToExcelFile")},ActionButtonText:(0,c.pm)().VirtualKeyboard_Button_Enter,CancelButtonText:(0,c.pm)().Common_Cancel_Text,DialogDescription:(0,c.pm)().ReExportToExcel_Confirm_Message},e=(0,c.pm)().ReExportToExcel;return{Checked:!1,IsDisabled:this.props.Form.IsExporting(),Description:e,Key:"ReExportToExcelItem",onExecute:function(){(0,v.$U)("DesignPage.Responses.PopupReExportToExcelDialog"),t.setState({ConfirmDialogPrompt:n})}}}return null},e.ks=function(){var t,n=this;return t=(t=this.props.DeleteAllResponses&&(0,o.yH)(this.props.AggregationMaster,this.props.Form.Model.Flags)?[this.Ds()]:[this.Ds(),this.Ls(),this.Ms(),this.As(),this.Os()]).filter((function(t){return!!t})),i.createElement(w.Th,{ButtonStyle:1,ClassNameForContainer:"analyze-view-menu-control-container",Disabled:this.props.Disabled,TooltipClassName:this.state.TooltipClassName,HTMLAttributes:{className:"analyze-view-ellipsis-button","aria-label":(0,c.pm)().Responses_Options_Tootip,title:(0,c.pm)().Responses_Options_Tootip,children:(0,p.M)({FluentIcon:"More Horizontal",HTMLAttributes:{className:"forms-icon-size20x20"}})},MenuItemType:0,Reset:this.state.ResetMenu,UnorderListMenuItems:t,onMenuReset:function(){return n.setState({ResetMenu:!1})}})},e.xs=function(){var t=this,n=this.state.ConfirmDialogPrompt;if(n){var e={ButtonStyle:2,ClassName:"delete-confirm-control-reset-button",GlyphButtonStyle:"Horizontal",Key:"d",Text:n.ActionButtonText,onClick:function(){t.setState({ConfirmDialogPrompt:void 0,ResetMenu:!0}),n.Action&&n.Action(),t.props.onDeleteDialogDismissed&&t.props.onDeleteDialogDismissed()}},o={ButtonStyle:2,ClassName:"delete-confirm-control-cancel-button",GlyphButtonStyle:"Horizontal",Key:"c",Text:n.CancelButtonText,onClick:function(){t.setState({ConfirmDialogPrompt:void 0,ResetMenu:!0}),t.props.onDeleteDialogDismissed&&t.props.onDeleteDialogDismissed()}},s={ButtonStyle:1,ClassName:"delete-confirm-control-close-button",GlyphButtonStyle:"GlyphOnly",Key:"x",Text:(0,c.pm)().Common_Close_Text,FluentIcon:"Dismiss",IconClassName:"forms-icon-size16x16",onClick:function(){t.setState({ConfirmDialogPrompt:void 0,ResetMenu:!0}),t.props.onDeleteDialogDismissed&&t.props.onDeleteDialogDismissed()}},u={ButtonsProps:[e,o].filter((function(t){return!!t})),ClassName:"delete-confirm-control-container",CloseButtonProps:s,Description:n.DialogDescription,HTMLAttributes:{"aria-label":this.Rs()},ShowDialog:!!n,TextClassName:this.props.ConfirmDialogTextClassName,onBlur:function(){window.setTimeout((function(){t.setState({ConfirmDialogPrompt:void 0})}),0)},onDismiss:function(){return t.setState({ConfirmDialogPrompt:void 0,ResetMenu:!0})}};return i.createElement(y.o,(0,r.pi)({},u))}},e.Rs=function(){return this.props.DeleteAllResponses?(0,c.pm)().AnalyzeView_ResetResponses_DescriptionText:(0,c.pm)().AnalyzeView_ResetResponse_DescriptionText},e.Ms=function(){var t=this;if(this.props.onShareResult){return{Checked:!1,Description:this.props.PermissionToken?(0,c.pm)().AnalyzeView_Get_Share_Result_Link:(0,c.pm)().AnalyzeView_Create_Share_Result_Link,IsDisabled:!this.props.PermissionToken&&!this.ys(),Key:"shareResultItem",onExecute:function(){(0,v.$U)("DesignPage.Responses.GetSummaryResult"),window.setTimeout((function(){return t.setState({ShowShareSummaryResultContainer:!0,ShowDeleteShareResultLinkContainer:!1},(function(){return(0,F.mZ)(t.ps.current)}))})),t.props.PermissionToken?t.setState({PermissionToken:t.props.PermissionToken,ShowSpinner:!1}):t.props.onCreatePermissionToken().then((function(n){t.setState({PermissionToken:n,ShowSpinner:!1})})).catch((function(n){t.setState({ShowSpinner:!1,ShowErrorBox:!0});var e=(0,c.pm)().Error_Message_Failed_Create_Permission_Token;t.Us(e,"#share-result-error-status")})),t.vs=!0},Title:(0,c.pm)().AnalyzeView_Get_Summary_Link_Tooltip}}return null},e.Ps=function(){if(this.state.ShowShareSummaryResultContainer)return i.createElement("div",{className:"delete-confirm-control-container share-result",ref:this.ps},this.Vs(),this._s())},e.Vs=function(){var t=this;if(!this.state.ShowDeleteShareResultLinkContainer){var n=(0,c.pm)(),e={id:(0,l.$p)().FormId,AnalyzerToken:this.state.PermissionToken},r="../Pages/AnalysisPage.aspx?"+jQuery.param(e),o=(0,f.WN)(r),u=this.state.IsExternalSharingAllowed&&!(0,s.j4)()?n.AnalyzeView_Share_Result_Link_External_Title:n.AnalyzeView_Share_Result_Link_Internal_Title,a=!this.state.IsExternalSharingAllowed&&!(0,s.j4)()&&i.createElement(p.F,{FluentIcon:"Error Circle",HTMLAttributes:{title:n.AnalyzeView_Share_Result_Link_Warning_Message,className:"flex-pane-dropdown-option-alert"}}),h=i.createElement("div",{className:"share-result-container-title"},u,a),d=i.createElement("input",{disabled:!1,readOnly:!0,value:o,className:"share-result-container-textbox",id:"share-result-container-textbox-link",onClick:function(){var t=$("#share-result-container-textbox-link");t.focus(),t.select()},"aria-label":n.AnalyzeView_Share_Result_Link_External_Title}),m={className:"share-result-contaienr-copy-button office-form-theme-button",id:"share-result-container-copy-button",disabled:this.state.ShowSpinner,onClick:function(){(0,v.$U)("DesignPage.Share.CopyAnalysisResultLink")},"aria-label":n.Mobile_Share_Copy_Link,"data-clipboard-target":"#share-result-container-textbox-link"},b=(0,I.E)({HTMLAttributes:m,ButtonStyle:1,Text:n.Common_Copy_Text,ref:"copyButton",key:"copyButton"}),w=(0,g.F)({HTMLAttributes:{className:"share-result-contaienr-delete-button",onClick:function(){return t.setState({ShowDeleteShareResultLinkContainer:!0})},disabled:this.state.ShowSpinner||!this.ys()},ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",FluentIcon:"Delete",IconClassName:"share-result-contaienr-delete-button-icon forms-icon-size18x18",Text:n.AnalyzeView_Delete_Share_Result_Link_Button}),y=i.createElement("div",{className:"share-result-status",id:"share-result-container-copy-button-status",role:"alert"}),S=void 0;return this.state.ShowErrorBox&&(S=i.createElement("div",{className:"share-result-error-status",id:"share-result-error-status"})),i.createElement("div",{"aria-label":u,className:"share-result-content"},this.Gs(),h,d,b,w,y,S,this.zs())}},e._s=function(){var t=this;if(this.state.ShowDeleteShareResultLinkContainer){var n=(0,c.pm)().AnalyzeView_Delete_Share_Result_Link_Title,e=i.createElement("div",{className:"share-result-confirm-delete-text"},n),r=(0,I.E)({HTMLAttributes:{className:"share-result-confirm-cancel-button",id:"share-result-cancel-button",onClick:function(){t.setState({ShowDeleteShareResultLinkContainer:!1,ResetMenu:!0}),t.vs=!0}},Text:(0,c.pm)().Common_Back_Text,ButtonStyle:1}),o=(0,I.E)({HTMLAttributes:{className:"share-result-confirm-delete-button",onClick:function(){t.setState({ShowShareSummaryResultContainer:!1,ResetMenu:!0}),t.props.onDeletePermissionToken&&(t.props.onDeletePermissionToken(),t.setState({ShowSpinner:!0}))}},Text:(0,c.pm)().AnalyzeView_Delete_Share_Result_Link_Button,ButtonStyle:1});return i.createElement("div",{"aria-label":n,className:"share-result-delete-content"},this.Gs(),e,i.createElement("div",{className:"share-result-confirm-delete-buttons"},r,o))}},e.Gs=function(){var t=this,n=this.state.ShowDeleteShareResultLinkContainer;return(0,g.F)({HTMLAttributes:{className:"share-result-close-button",onClick:function(){n?(t.setState({ShowDeleteShareResultLinkContainer:!1,ResetMenu:!0}),t.vs=!0):t.setState({ShowShareSummaryResultContainer:!1})}},FluentIcon:"Dismiss",IconClassName:"share-result-close-button-icon forms-icon-size14x14",ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",Text:(0,c.pm)().Common_Close_Text})},e.zs=function(){var t=i.createElement(b.P,(0,r.pi)({},{ClassName:"designPage-share-result-spinner",Ignorable:!1}));if(this.state.ShowSpinner)return i.createElement("div",{className:"share-result-spinner-container"},i.createElement("div",{className:"share-resilt-spinner"},t))},e.Ns=function(t,n,e,r){var i=this;return(0,C.w)(t,(function(){i.props.Form.triggerShareAction(),(0,v.$U)("DesignPage.Responses.CopySummaryLink");var t=$(n);t.removeClass("flex-pane-status-error"),t.addClass("flex-pane-status-success"),t.text(e),t.show(),setTimeout((function(){t.fadeOut("slow",(function(){t.hide()}))}),3e3)}),(function(){(0,v.$U)("DesignPage.Send.ActionFailed",{action:t});var e=$(n);e.removeClass("flex-pane-status-success"),e.text(r),e.addClass("flex-pane-status-error")}),!0)},e.Us=function(t,n){var e=$(n);e.addClass("flex-pane-status-error"),e.removeClass("flex-pane-status-success"),e.text(t),e.show(),setTimeout((function(){e.fadeOut("slow")}),3e3)},e.Ss=function(t,n){var e=n.getBoundingClientRect();return t.clientX>=e.left&&t.clientX<=e.right&&t.clientY>=e.top&&t.clientY<=e.bottom},n}(S.r)},66022:function(t,n,e){"use strict";e.d(n,{y:function(){return m}});var r=e(59312),i=e(63804),o=e(22707),s=e(55411),u=e(7645),a=e(19930),c=e(9743),l=e(67661),f=e(23112),h=e(62396),d=e(35230),m=function(t){function n(n){var e=t.call(this,n)||this;e.Qs=function(){return e.forceUpdate()};var r=n.Form;return r.Synchronizer.ensureFieldsReady([l.x.Schema.ArchivedRowCount]),r.observe(e.Qs,[l.x.Schema.ArchivedRowCount]),e}(0,r.ZT)(n,t);var e=n.prototype;return e.componentWillUnmount=function(){this.props.Form.unobserve(this.Qs)},e.render=function(){if(this.props.AggregationMaster)return i.createElement("div",{className:this.SummaryViewContentClassName},i.createElement("div",{className:"analyze-view-summary-table"},i.createElement("div",{className:"analyze-view-summary-container"},this.Hs(),this.statisticsContent(),this.$s()),this.Ws()),this.insightContent(),i.createElement("div",{className:"analysis-page-row-line"}))},Object.defineProperty(e,"IsAggregationReady",{get:function(){return this.props.AggregationMaster.Model.IsAggregationReady},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SummaryViewContentClassName",{get:function(){return"analyze-view-summary-content"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"IsAggregationFailed",{get:function(){return this.props.AggregationMaster.Model.IsAggregationFailed},enumerable:!1,configurable:!0}),e.getAverageTimeProps=function(){var t=this.Js(),n=(0,s.sv)()?(0,u.pm)().Mobile_AnalyzeView_Average_Fill_Time:(0,u.pm)().AnalyzeView_Average_Fill_Time;return{AccessibilityText:(0,u.pm)().AnalyzeView_Average_Fill_Time_Minutes_Seconds_Explicit.format(t.minutes,t.seconds),Data:(0,u.pm)().AnalyzeView_Average_Fill_Time_Minutes_Seconds_Short.format(t.minutes<10?"0"+t.minutes:t.minutes,t.seconds<10?"0"+t.seconds:t.seconds),Description:n,Ignorable:!0,IsReady:0===this.props.AggregationMaster.Model.TotalResponseCount||this.IsAggregationReady||this.IsAggregationFailed}},e.statisticsContent=function(){return!(0,o.yH)(this.props.AggregationMaster,this.props.Form.Model.Flags)&&i.createElement(d.V,(0,r.pi)({},this.getAverageTimeProps()))},e.insightContent=function(){return null},e.Hs=function(){var t=this.props.AggregationMaster.Model,n=this.props.Form,e=n.Synchronizer.isFieldReady(l.x.Schema.ArchivedRowCount),s=(e?n.Model.ArchivedRowCount:0)+t.TotalResponseCount,a=(0,o.kR)(n.Model.Flags)?e:null!==t.TotalResponseCount,c={AccessibilityText:(0,u.pm)().AnalyzeView_NumberOfResponses_AccessibilityLabel.format(s),Data:s,Description:(0,u.pm)().Common_Responses_Text,Ignorable:!1,IsReady:a};return i.createElement(d.V,(0,r.pi)({},c))},e.Js=function(){if(this.props.AggregationMaster.Model.TotalResponseCount>0){var t=this.props.AggregationMaster.Model.AverageSubmitTime/1e3;return{minutes:Math.floor(t/60),seconds:Math.floor(t%60)}}return{minutes:0,seconds:0}},e.$s=function(){var t=this.Ks(),n={AccessibilityText:(0,u.pm)().AnalyzeView_FormStatus_AccessibilityLabel.format(t),Data:t,Description:(0,u.pm)().AnalyzeView_Status_Label,Ignorable:!1,IsReady:null!=this.props.AggregationMaster.Model.FormStatus};return i.createElement(d.V,(0,r.pi)({},n))},e.Ks=function(){switch(this.props.AggregationMaster.Model.FormStatus){case a.r.Opened:return(0,u.pm)().AnalyzeView_Status_Active;case a.r.Closed:case a.r.Expired:case a.r.NotStarted:return(0,u.pm)().AnalyzeView_Status_Closed;default:return(0,u.pm)().AnalyzeView_Status_Unknown}},e.Ws=function(){if(!(0,s.sv)()&&this.props.AggregationMaster.FormMaster.SyncContext!==c.y.AnalysisTimeForm){var t=this.props.Form,n=(0,o.Ai)(t.Model.Flags),e={DeleteAllResponses:!0,Form:t,HasAnswers:!1,onDelete:this.props.onDeleteResponses,onCreatePermissionToken:this.props.onCreatePermissionToken,onDeletePermissionToken:this.props.onDeletePermissionToken,onPrint:this.props.onPrint,onShareResult:!0,onReExportToExcel:this.props.onExportExcel,PermissionToken:this.props.PermissionToken,IsMovingData:n},u=t.Synchronizer.isFieldReady(l.x.Schema.ArchivedRowCount)?t.Model.ArchivedRowCount:0;if(this.IsAggregationReady||this.IsAggregationFailed){var a=this.props.AggregationMaster;e.AggregationMaster=a,e.HasAnswers=this.props.AggregationMaster.Model.TotalResponseCount+((0,o.kR)(t.Model.Flags)?u:0)>0}return i.createElement(h.Z,(0,r.pi)({},e))}},n}(f.r)},5161:function(t,n,e){"use strict";e.d(n,{m:function(){return l}});var r=e(59312),i=e(63804),o=e(36215),s=e(26203),u=e(55411),a=e(7645),c=e(45142),l=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.getPreviewImageName=function(){return this.props.AggregationMaster.QuestionMaster.Model.Choices.length<=5?"pie.png":"bar.png"},e.createQuestionViewContent=function(){return[this.Xs()]},e.Xs=function(){var t=this,n=s.d.convertToArray(this.props.AggregationMaster.Model.ChoiceQuestionAggregation.ChoiceSummary),e=o.map(n,(function(n){return{labelName:"answer_other"===n.Choice?(0,a.pm)().Designer_OtherAnswer:n.Choice,displayElement:t.createDisplayElement(n),labelData:n.Count,lableClass:t.Ys(n)?"choice-chart-control-legend-label":void 0,onClick:t.Ys(n)?t.props.onShowQuestionDetail:void 0}})),u={Animation:this.props.AggregationMaster.Model.IsAggregationReady,Data:{data:n.map((function(t){return t.Count}))},Labels:e,HasLegend:!0,TagLabels:this.CorrectOptions,Type:n.length<=5?1:0};return i.createElement(c.r,(0,r.pi)({},u,{key:"chartControl"}))},e.Ys=function(t){return(0,u.sv)()&&"answer_other"===t.Choice&&t.Count>0},n}(e(79608).E)},70623:function(t,n,e){"use strict";e.d(n,{e:function(){return d}});var r=e(59312),i=e(63804),o=e(36215),s=e(9947),u=e(72377),a=e(26203),c=e(55411),l=e(7645),f=e(79608),h=e(35230),d=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.getPreviewImageName=function(){return"text.png"},e.createQuestionViewContent=function(){return[this.Zs(),this.nu()]},e.Zs=function(){var t={Data:this.props.AggregationMaster.Model.DateQuestionAggregation.ResponseCount,Description:(0,l.pm)().Common_Responses_Text,Ignorable:!1,IsReady:!0,AccessibilityText:(0,l.pm)().AnalyzeView_NumberOfResponses_AccessibilityLabel.format(this.props.AggregationMaster.Model.DateQuestionAggregation.ResponseCount)};return i.createElement(h.V,(0,r.pi)({},t,{key:"responseCount"}))},e.nu=function(){var t=this.props.AggregationMaster.Model.DateQuestionAggregation.ResponseCount,n=(0,c.sv)()&&t>0&&u.Pv.Resolve("IMobileDesignPageUXFactory").createMobileResponseDetailEntrance(this.props.onShowQuestionDetail);return i.createElement("div",{className:"survey-analyze-view-detail-text-recent",key:"latestResponses"},i.createElement("a",{className:"screenReaderVisible",role:"presentation"},""+(0,l.pm)().Analyze_View_Text_Recent_Responses+this.eu),i.createElement("div",{"aria-hidden":!0,className:"analyze-view-summary-status-label"},(0,l.pm)().Analyze_View_Text_Recent_Responses),this.iu(),n)},e.iu=function(){var t=this,n=o.pluck(a.d.convertToArray(this.props.AggregationMaster.Model.DateQuestionAggregation.TopDate),"Answer");return this.eu="",o.map(n,(function(n,e){var r=n&&n.toDateShortString((0,s.k0)().cultureInfo);return t.eu=t.eu+' ."'+r+'"',i.createElement("div",{"aria-hidden":!0,className:"analyze-view-detail-text-lines",key:e},'"'+r+'"')}))},n}(f.E)},33523:function(t,n,e){"use strict";e.d(n,{N:function(){return f}});var r=e(59312),i=e(63804),o=e(27196),s=e(29559),u=e(7645),a=e(23112),c=e(63481),l=e(57707),f=function(t){function n(n){return t.call(this,n)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.render=function(){var t=(0,u.pm)(),n=!(0,s.tq)(),e={$modal:"downloadcsv-dialog-modal",$overlay:"downloadcsv-dialog-overlay",$root:"downloadcsv-dialog-container",$header:"downloadcsv-dialog-header",$title:"downloadcsv-dialog-title",$dismiss:"downloadcsv-dialog-dismiss",$content:"downloadcsv-dialog-content",$buttonContainer:"downloadcsv-dialog-button-container",$buttonStack:"downloadcsv-dialog-button-stack",$defaultButton:n?"downloadcsv-dialog-default-button":"office-form-theme-primary-foreground",$primaryButton:n?"office-form-theme-button downloadcsv-dialog-primary-button":"office-form-theme-primary-foreground"};return i.createElement("div",{className:e.$modal},i.createElement("div",{className:e.$overlay,"aria-hidden":!0}),i.createElement("div",{className:e.$root},i.createElement("div",{className:e.$header},i.createElement("div",{className:e.$title},this.props.$title),n&&i.createElement("div",{className:e.$dismiss},i.createElement("button",{onClick:this.props.$onDismiss,role:"button",autoFocus:!0,"aria-label":t.Common_DismissButton},i.createElement(l.$j,null)))),i.createElement("div",{className:e.$content},i.createElement("span",null,this.props.$subText)),i.createElement("div",{className:e.$buttonContainer},i.createElement("div",{className:e.$buttonStack},this.props.$defaultButtonText&&i.createElement("button",{"aria-label":this.props.$title+" "+this.props.$subText+" "+this.props.$defaultButtonText,className:e.$defaultButton,onClick:this.props.$onConfirm},this.props.$defaultButtonText),this.props.$primaryButtonText&&i.createElement("button",{"aria-label":this.props.$title+" "+this.props.$subText+" "+this.props.$primaryButtonText,className:e.$primaryButton,onClick:this.props.$onDismiss},this.props.$primaryButtonText)))))},e.componentDidMount=function(){(0,c.mZ)(o.findDOMNode(this))},n}(a.r)},57707:function(t,n,e){"use strict";e.d(n,{D$:function(){return o},pn:function(){return s},$j:function(){return u},zt:function(){return a}});var r=e(63804),i="downloadcsv-icon-container",o=function(){return r.createElement("span",{className:i},r.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.createElement("path",{d:"M18.2498 20.4999C18.664 20.4998 19 20.8355 19 21.2497C19 21.6639 18.6644 21.9998 18.2502 21.9999L5.25022 22.0037C4.836 22.0038 4.5 21.6681 4.5 21.2539C4.5 20.8397 4.83557 20.5038 5.24978 20.5037L18.2498 20.4999ZM11.6482 2.01173L11.75 2.00488C12.1297 2.00488 12.4435 2.28704 12.4932 2.65311L12.5 2.75488L12.499 16.4399L16.2208 12.7196C16.4871 12.4533 16.9038 12.4291 17.1974 12.647L17.2815 12.7197C17.5477 12.986 17.5719 13.4026 17.354 13.6962L17.2814 13.7803L12.2837 18.7769C12.0176 19.043 11.6012 19.0673 11.3076 18.8498L11.2235 18.7772L6.22003 13.7806C5.92694 13.4879 5.92661 13.0131 6.21931 12.72C6.48539 12.4535 6.90204 12.429 7.1958 12.6467L7.27997 12.7192L10.999 16.4329L11 2.75488C11 2.37519 11.2822 2.06139 11.6482 2.01173L11.75 2.00488L11.6482 2.01173Z"})))},s=function(){return r.createElement("span",{className:i},r.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.createElement("path",{d:"M20.0256 12.1922C19.8772 12.4296 19.6806 12.6332 19.4486 12.7899L13.3987 16.8736C12.5535 17.4441 11.4465 17.4441 10.6013 16.8736L4.55142 12.7899C3.79043 12.2762 3.49533 11.3306 3.77229 10.5003L10.6132 15.0598C11.4005 15.5847 12.4112 15.6175 13.2264 15.1582L13.3867 15.0598L20.2271 10.4998C20.4088 11.0459 20.3545 11.666 20.0256 12.1922ZM20.2271 13.7498C20.4088 14.2959 20.3545 14.916 20.0256 15.4422C19.8772 15.6796 19.6806 15.8832 19.4486 16.0399L13.3987 20.1236C12.5535 20.6941 11.4465 20.6941 10.6013 20.1236L4.55142 16.0399C3.79043 15.5262 3.49533 14.5806 3.77229 13.7503L10.6132 18.3098C11.4005 18.8347 12.4112 18.8675 13.2264 18.4082L13.3867 18.3098L20.2271 13.7498ZM13.3867 3.42476L19.7519 7.66821C20.2115 7.97456 20.3356 8.59543 20.0293 9.05496C19.956 9.16481 19.8618 9.25907 19.7519 9.33231L13.3867 13.5758C12.547 14.1356 11.453 14.1356 10.6132 13.5758L4.24807 9.33231C3.78854 9.02595 3.66437 8.40509 3.97072 7.94556C4.04396 7.8357 4.13822 7.74144 4.24807 7.66821L10.6132 3.42476C11.453 2.86492 12.547 2.86492 13.3867 3.42476ZM11.5608 4.60648L11.4453 4.67283L5.705 8.50026L11.4453 12.3277C11.7439 12.5267 12.1228 12.5488 12.4392 12.394L12.5547 12.3277L18.294 8.50026L12.5547 4.67283C12.2561 4.47378 11.8772 4.45166 11.5608 4.60648Z"})))},u=function(){return r.createElement("span",{className:i},r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048"},r.createElement("path",{d:"M1115 1024l690 691-90 90-691-690-691 690-90-90 690-691-690-691 90-90 691 690 691-690 90 90-690 691z"})))},a=function(){return r.createElement("span",{className:i},r.createElement("svg",{viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},r.createElement("path",{d:"M8.75 12C9.9926 12 11 13.0074 11 14.25V15.752L10.9921 15.8604C10.6814 17.9866 8.7715 19.009 5.56679 19.009C2.37361 19.009 0.4333 17.9983 0.0144601 15.8966L0 15.75V14.25C0 13.0074 1.00736 12 2.25 12H8.75ZM8.75 13.5H2.25C1.83579 13.5 1.5 13.8358 1.5 14.25V15.6704C1.77979 16.8708 3.05063 17.509 5.56679 17.509C8.0829 17.509 9.2966 16.8777 9.5 15.6932V14.25C9.5 13.8358 9.1642 13.5 8.75 13.5ZM5.5 4C7.433 4 9 5.567 9 7.5C9 9.433 7.433 11 5.5 11C3.567 11 2 9.433 2 7.5C2 5.567 3.567 4 5.5 4ZM17.75 0C18.9926 0 20 1.00736 20 2.25V5.75C20 6.99264 18.9926 8 17.75 8H16.2951L14.1286 10.1414C13.6375 10.6266 12.846 10.6219 12.3608 10.1308C12.1296 9.8968 12 9.5812 12 9.2526L11.9994 7.9862C10.8747 7.86155 10 6.90792 10 5.75V2.25C10 1.00736 11.0074 0 12.25 0H17.75ZM5.5 5.5C4.39543 5.5 3.5 6.39543 3.5 7.5C3.5 8.6046 4.39543 9.5 5.5 9.5C6.60457 9.5 7.5 8.6046 7.5 7.5C7.5 6.39543 6.60457 5.5 5.5 5.5ZM17.75 1.5H12.25C11.8358 1.5 11.5 1.83579 11.5 2.25V5.75C11.5 6.16421 11.8358 6.5 12.25 6.5H13.4986L13.4997 8.6539L15.6789 6.5H17.75C18.1642 6.5 18.5 6.16421 18.5 5.75V2.25C18.5 1.83579 18.1642 1.5 17.75 1.5Z"})))}},87335:function(t,n,e){"use strict";e.d(n,{d:function(){return f}});var r=e(59312),i=e(63804),o=e(36215),s=e(26203),u=e(7645),a=e(50434),c=e(79608),l=e(35230),f=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.getPreviewImageName=function(){return"text.png"},e.createQuestionViewContent=function(){return[this.Zs(),this.ou()]},e.Zs=function(){var t={Data:this.props.AggregationMaster.Model.FileUploadQuestionAggregation.ResponseCount,Description:(0,u.pm)().Common_Responses_Text,Ignorable:!1,IsReady:!0,AccessibilityText:(0,u.pm)().AnalyzeView_NumberOfResponses_AccessibilityLabel.format(this.props.AggregationMaster.Model.FileUploadQuestionAggregation.ResponseCount)};return i.createElement(l.V,(0,r.pi)({},t,{key:"responseCount"}))},e.ou=function(){return i.createElement("div",{className:"survey-analyze-view-detail-text-recent",key:"latestResponses"},i.createElement("a",{className:"screenReaderVisible",role:"presentation"},(0,u.pm)().Analyze_View_Text_Recent_Responses+" "+this.uu),i.createElement("div",{"aria-hidden":!0,className:"analyze-view-summary-status-label"},(0,u.pm)().Analyze_View_Text_Recent_Responses),this.au())},e.au=function(){var t=this,n=o.pluck(s.d.convertToArray(this.props.AggregationMaster.Model.FileUploadQuestionAggregation.RecentFile),"Answer");return this.uu="",o.map(n,(function(n,e){if(n){var r=n.name,o=(0,a.LP)(r);return t.uu=t.uu+" "+r+". ",i.createElement("div",{"aria-hidden":!0,className:"analyze-view-detail-text-lines",key:e},o,i.createElement("span",{className:"analyze-view-detail-fileName"},r))}}))},n}(c.E)},39436:function(t,n,e){"use strict";e.d(n,{a:function(){return p}});var r=e(59312),i=e(63804),o=e(36215),s=e(26203),u=e(27196),a=e(35705),c=e(29559),l=e(81620),f=e(7645),h=e(64541),d=e(23112),m=e(65863),v=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.render=function(){if(this.cu()){var t={className:"chart-control-container chart-likert-control-container",tabIndex:-1};return t["aria-label"]=(0,f.pm)().ChartControl_GroupContainer,i.createElement("div",(0,r.pi)({},t),this.lu(),i.createElement("div",{className:"chart-likert-body-control-container"},this.fu(),this.du()))}return null},e.componentWillMount=function(){this.mu()},e.componentDidMount=function(){this.vu()},e.shouldComponentUpdate=function(t){return!o.isEqual(this.props,t)||!this.pu},e.componentDidUpdate=function(){this.vu()},e.componentWillUnmount=function(){this.gu()},e.cu=function(){return this.props.Labels&&this.props.Labels.length>0&&this.props.Data&&this.props.Data.length>0},e.gu=function(){this.bu&&(this.bu.destroy(),this.bu=null)},e.vu=function(){if(this.cu()){var t=u.findDOMNode(this.refs.canvas);if(this.pu=$(t).is(":visible"),this.pu){var n=t.getContext("2d");this.wu(n),this.yu()}}},e.Iu=function(){var t=this,n="'Segoe UI','Segoe WP',Tahoma, Arial, sans-serif";return{responsive:!1,scales:{xAxes:[{gridLines:{display:!0,drawTicks:!1,drawBorder:!0,zeroLineColor:"#ECECEC",zeroLineWidth:1,zeroLineBorderDash:[5]},ticks:{display:!0,beginAtZero:!0,fontFamily:n,fontSize:12,min:-100,max:100,maxTicksLimit:3,callback:function(t){return Math.abs(+t)+"%"}},stacked:!0}],yAxes:[{barPercentage:.67,categoryPercentage:1,gridLines:{display:!1,drawTicks:!1,drawBorder:!1},ticks:{display:!1},stacked:!0}]},tooltips:{enabled:!1,mode:"nearest",intersect:!0,bodyFontSize:12,bodyFontFamily:n,custom:function(n){var e=t.bu.canvas.parentNode,r=e.getElementsByClassName("chart-custom-tooltip")[0];if(r||((r=document.createElement("div")).className="chart-custom-tooltip",r.appendChild(document.createElement("table")),e.appendChild(r)),0!==n.opacity){if(n.body){var i=n.body.map((function(t){return t.lines}));if(i.length>1){var o=i.length/2;t.Su&&(i.splice(o,1),n.labelColors.splice(o,1));var s=i.splice(0,o).reverse();s=s.concat(i);var u=n.labelColors.splice(0,o).reverse();u=u.concat(n.labelColors),i=[];var a=[];s.forEach((function(t,n){/\:\s0%$/g.test(t[0].xLabel)||(i.push(t),a.push(u[+n]))})),n.labelColors=a}var c="";i.forEach((function(t,e){var r=(0,l.F1)(""+t[0].xLabel,!0),i=(0,l.F1)(""+t[0].yLabel,!0),o=n.labelColors[e],s="background:"+o.backgroundColor+";border-color:"+o.borderColor+"; border-width: 2px;";c+="<tr><td>"+('<span class="chart-custom-tooltip-statement-text">'+i+"</span>")+"</td></tr>",c+="<tr><td>"+('<span class="chart-custom-tooltip-box" style="'+s+'"></span>')+('<span class="chart-custom-tooltip-text">'+r+"</span>")+"</td></tr>"})),c+="</tbody>",r.querySelector("table").innerHTML=c}var f=t.bu.canvas.offsetTop,h=t.bu.canvas.offsetLeft;r.style.opacity="1",r.style.left=h+n.caretX+"px",r.style.top=f+n.caretY+"px",r.style.fontFamily=n._bodyFontFamily,r.style.fontSize=n._bodyFontSize,r.style.fontStyle=n._fontStyle,r.style.padding=n.yPadding+"px "+n.xPadding+"px"}else r.style.opacity="0"},callbacks:{label:function(n,e){var r=e.datasets[n.datasetIndex].label,i=((0,h.Mw)(r,!0)||r)+": ",o=n.xLabel;return t.Su&&(0!==n.datasetIndex&&e.datasets.length/2!==n.datasetIndex||(o*=2)),{yLabel:n.yLabel,xLabel:i+Math.abs(o)+"%"}}}},legend:{display:!1}}},e.wu=function(t){var n,e,i=Math.floor(this.Fu.length/2);if(this.Fu.length%2==0){this.Su=!1,(s=this.Fu.splice(0,i)).reverse().forEach((function(t,n){t.data=t.data.map((function(t){return-t}))})),(n=this.Fu).splice.apply(n,(0,r.ev)([0,0],s))}else{var s;this.Su=!0,(s=this.Fu.splice(0,i+1)).reverse(),s[0].data=s[0].data.map((function(t){return+t/2}));var u=o.clone(s[0]);s.forEach((function(t){t.data=t.data.map((function(t){return-t}))})),s.push(u),(e=this.Fu).splice.apply(e,(0,r.ev)([0,0],s))}var a={labels:this.props.Labels.map((function(t){return t&&(0,h.Mw)(t.toString(),!0)||t})),datasets:this.Fu},c=this.Iu();this.gu(),this.bu=new Chart(t,{type:"horizontalBar",data:a,options:c})},e.mu=function(){for(var t=this,n=[],e=function(t){n.push(r.props.Data.reduce((function(n,e){return n+ +e.data[t]}),0))},r=this,i=0;i<this.props.Data[0].data.length;i++)e(i);var o=[[0],[0,10],[0,5,10],[0,2,8,10],[0,2,5,8,10],[0,2,4,6,8,10],[0,2,4,5,6,8,10],[0,2,3,4,6,7,8,10],[0,2,3,4,5,6,7,8,10],[0,1,2,3,4,6,7,8,9,10]];this.Nu=o[Math.min(this.props.Data.length,o.length)-1].map(a.T),this.Fu=this.props.Data.map((function(e,r){var i=e.backgroundColor?e.backgroundColor:t.Nu[r%t.Nu.length];return{label:e.label,backgroundColor:i,hoverBackgroundColor:t.Tu(""+i,10),data:e.data.map((function(t,e){return n[e]?Math.round(1e3*+t/n[e])/10:0}))}}))},e.Tu=function(t,n){return o.isArray(t)?t.map((function(t){return e(t,n)})):e(t,n);function e(t,n){var e=parseInt(t.slice(1),16),r=Math.round(2.55*n),i=(e>>16)+r,o=(e>>8&255)+r,s=(255&e)+r;return"#"+(16777216+65536*(i<255?i<1?0:i:255)+256*(o<255?o<1?0:o:255)+(s<255?s<1?0:s:255)).toString(16).slice(1)}},e.yu=function(){var t=this;if(this.props.HasLegend){var n=u.findDOMNode(this.refs["legend-contaner"]),e=n.childNodes;e&&e.length>0&&(o.each(e,(function(n,e){Chart.helpers.addEvent(n,"mouseover",(function(){t.ku("mouseover",e)}))})),Chart.helpers.addEvent(n,"mouseout",(function(){t.ku("mouseout",0)})));var r=u.findDOMNode(this.refs["stacked-detail-container"]).getElementsByClassName("chart-control-detail-canvas");r&&r.length>0&&o.each(r,(function(n,e){var r=n.getContext("2d");r.fillStyle=t.props.Data[e].backgroundColor?t.props.Data[e].backgroundColor:t.Nu[e%t.Nu.length],r.beginPath(),r.fillRect(0,0,8,8),r.closePath(),r.fill()}))}},e.ku=function(t,n){var e=this;this.bu.active="mouseout"===t?[]:this.bu.data.datasets.map((function(t,r){return e.bu.getDatasetMeta(r).data[n]})),this.bu.lastActive=this.bu.lastActive||[],this.bu.lastActive.length&&this.bu.updateHoverStyle(this.bu.lastActive,this.bu.options.hover.mode,!1),this.bu.active.length&&this.bu.updateHoverStyle(this.bu.active,this.bu.options.hover.mode,!0);var r=!Chart.helpers.arrayEquals(this.bu.active,this.bu.lastActive);if(r){this.bu.lastActive=this.bu.active;var i=this.bu.tooltip;i._active=this.bu.active,i._lastActive=i._lastActive||[],i.update(!0),i.pivot();var o=this.bu._bufferedRequest;o?this.bu.render(o.duration,o.lazy):r&&!this.bu.animating&&(this.bu.stop(),this.bu.render(this.bu.options.hover.animationDuration,!0)),this.bu._bufferedRender=!1,this.bu._bufferedRequest=null}},e.fu=function(){if(this.props.HasLegend){var t={className:"chart-likert-control-legend",tabIndex:-1,ref:"legend-contaner"};t["aria-label"]=(0,f.pm)().ChartControl_LegendGroup;var n=this.props.Labels.map((function(t,n){var e=t?t.toString():"";return i.createElement("div",{className:"chart-likert-control-legend-row",key:n},i.createElement("span",{className:"chart-likert-control-legend-label",title:e&&(0,h.Mw)(e,!0)||e},i.createElement(m.D,{Text:e,RenderMode:"RichText",ContainsHtml:!0})))}));return i.createElement("div",(0,r.pi)({},t),n)}},e.du=function(){var t=(0,c.fM)()<400||(0,c.tq)(),n=t?300:432,e=18+48*this.props.Labels.length,o={className:"chart-control-canvas",width:n,height:e=t?300*e/350:e,ref:"canvas","aria-label":(0,f.pm)().ChartControl_AriaLabel};return i.createElement("div",(0,r.pi)({},{className:"chart-likert-control",tabIndex:-1}),i.createElement("canvas",(0,r.pi)({},o)))},e.lu=function(){return i.createElement("div",{className:"chart-likert-control-detail-container",ref:"stacked-detail-container"},this.props.Data.map((function(t){return i.createElement("div",{className:"chart-likert-control-detail-item","aria-label":t.label,key:t.label},i.createElement("canvas",{role:"presentation",className:"chart-control-detail-canvas",width:"8",height:"8"}),i.createElement(m.D,{Text:t.label,RenderMode:"RichText",ContainsHtml:!0}))})))},n}(d.r),p=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.getPreviewImageName=function(){return"bar.png"},e.createStackedBarControlContainer=function(){var t=this.props.AggregationMaster.Model.LikertQuestionAggregation;if(t.LikertResults.length&&t.Options.length){for(var n=s.d.convertToArray(t.Options),e=[],u=function(r){e[r]={label:n[r],data:o.map(t.LikertResults,(function(t){return t.Statistics[r]}))}},a=0;a<t.Options.length;a++)u(a);var c={Data:e,Type:2,Labels:o.map(t.LikertResults,(function(t){return t.SubQuestionName})),HasLegend:!0};return i.createElement(v,(0,r.pi)({},c,{key:"likertChartControl"}))}},e.createQuestionViewContent=function(){return[this.createStackedBarControlContainer()]},n}(e(79608).E)},96251:function(t,n,e){"use strict";e.d(n,{T:function(){return v}});var r=e(59312),i=e(63804),o=e(7645),s=e(36215),u=e(23112),a=e(80820),c={ArrowAngle:60,ArrowHeight:12,BackgroundColor:"#F2F2F2",BorderColors:["#FF9224",a.tu],BorderWidth:12,Bottom:0,CircleMargin:3,Color:"#333333",FontFamily:"'wf_segoe-ui_normal','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif",FontSize:12,LabelSize:15,ScoreColors:["#B15509","#333333",a.tu],ScoreFontFamily:"'wf_segoe-ui_semibold','Segoe UI Semibold','Segoe WP Semibold','Segoe UI','Segoe WP',Tahoma, Arial, sans-serif",ScoreFontSizes:[38,45],Top:16},l=180,f=10*Math.PI/l,h=45*Math.PI/l,d=function(){function t(t,n,e){this.xu=t,this.ee(n,e),this.Pu(t)}var n=t.prototype;return n.destroy=function(){this.xu.clearRect(0,0,this.xu.canvas.width,this.xu.canvas.height)},n.ee=function(t,n){this.Du=s.extend({},c,n);var e=this.Du,r=e.Color,i=e.FontSize,o=e.Top,u=e.Bottom,a=e.CircleMargin,l=e.BorderWidth,f=e.FontFamily;this.xu.font=i+"px "+f,this.xu.fillStyle=r,this.xu.textAlign="center",this.xu.textBaseline="middle";var h=this.xu.canvas.width,d=this.xu.canvas.height;this.Eu=Math.min((h-2*(l+a))/2,(d-o-l-2*a-u)/2);var m=this.Eu+o+a+l;this.xu.translate(this.xu.canvas.width/2,m),this.Ru=this.Eu+a+l,this.qu=t},n.Pu=function(t){this.Ou(t),this.Mu(t),this.Uu(t)},n.Mu=function(n){n.save();var e=Math.sin(f)*this.Ru,r=this.Ru+2,i=r;"rtl"===this.xu.direction&&(i+=26),t.drawText(n,i,e,"+100","start","middle"),t.drawText(n,0,-r,"0","center","bottom"),t.drawText(n,-i,e,"-100","end","middle"),n.restore()},n.Uu=function(n){var e,r,i,o=this.Du,s=o.ScoreColors,u=o.ScoreFontSizes;this.qu>=0?(r=0!==this.qu?s[2]:s[1],e=this.qu-90):(r=s[0],e=this.qu-90),i=100===Math.abs(this.qu)?u[0]:u[1];var a=t.fitScoreText(this.xu,"100",this.Eu/Math.cos(h));i=Math.min(i,a);var c=Math.tan(this.Du.ArrowAngle/2*Math.PI/l)*this.Du.ArrowHeight;this.Vu(n,this.qu.toString(),e,this.Eu,this.Du.ArrowHeight,c,i,r)},n.Vu=function(n,e,r,i,o,s,u,a){t.drawDial(n,r,i,o,s,this.Du.BackgroundColor),n.save(),t.drawText(n,0,this.Eu/2,"NPS®",void 0,void 0,this.Du.LabelSize+"px "+this.Du.FontFamily),n.fillStyle=a,t.drawText(n,0,-.25*u,e,void 0,void 0,"bold "+u+"px "+this.Du.ScoreFontFamily),n.restore()},t.drawDial=function(t,n,e,r,i,o){var s=e+r;t.save(),t.fillStyle=o,t.rotate(n*Math.PI/l),t.beginPath(),t.moveTo(s,0);var u=i/e,a=Math.asin(u);t.arc(0,0,e,-a,a,!0),t.fill(),t.restore()},n.Ou=function(n){var e=this.Du,r=e.BorderWidth,i=e.BorderColors;t.drawDoughnut(n,0,0,f,-90*Math.PI/l,this.Ru,r,i[1],!0),t.drawDoughnut(n,0,0,-90*Math.PI/l,-190*Math.PI/l,this.Ru,r,i[0],!0),n.clearRect(-1,-this.Ru,2,r)},t.fitScoreText=function(t,n,e){t.save();var r=14;for(t.font="bold "+r+"px Arial";t.measureText(n).width<e;)r++,t.font="bold "+r+"px Arial";return t.restore(),r},t.drawDoughnut=function(t,n,e,r,i,o,s,u,a){t.save(),t.beginPath(),t.fillStyle=u,t.arc(n,e,o,r,i,a),t.save(),t.rotate(i),t.lineTo(o-s,0),t.restore(),t.arc(n,e,o-s,i,r,!a),t.fill(),t.restore()},t.drawText=function(t,n,e,r,i,o,s){i&&(t.textAlign=i),o&&(t.textBaseline=o),s&&(t.font=s),t.fillText(r,n,e)},t}(),m=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n._u=i.createRef(),n}(0,r.ZT)(n,t);var e=n.prototype;return e.render=function(){if(this.cu()){var t={className:"chart-control-container",tabIndex:-1};return t["aria-label"]=(0,o.pm)().ChartControl_GroupContainer,i.createElement("div",(0,r.pi)({},t),this.fu(),this.du())}return null},e.componentDidMount=function(){this.vu()},e.shouldComponentUpdate=function(t){return!s.isEqual(this.props,t)||!this.pu},e.componentDidUpdate=function(){this.vu()},e.componentWillUnmount=function(){this.gu()},e.cu=function(){return this.props.Labels&&this.props.Data&&this.props.Labels.length===this.props.Data.length&&this.props.Labels.length>0},e.gu=function(){this.bu&&(this.bu.destroy(),this.bu=null)},e.vu=function(){if(this.cu()){var t=this._u.current;if(this.pu=$(t).is(":visible"),this.pu){var n=t.getContext("2d");this.gu(),this.bu=new d(n,this.props.Score,{BorderColors:["#FF9224","#03787C"],ScoreColors:["#B15509","#333333","#03787C"]})}}},e.fu=function(){if(this.props.HasLegend){var t={className:"chart-control-legend",tabIndex:-1};return t["aria-label"]=(0,o.pm)().ChartControl_LegendGroup,i.createElement("div",(0,r.pi)({},t),i.createElement("table",{className:"chart-control-legend-table"},i.createElement("tbody",null,this.Gu())))}},e.Gu=function(){var t=this,n="";return this.props.Labels.map((function(e,r){return n=t.props.Labels[r]+". "+(0,o.pm)().AnalyzeView_NumberOfResponses_AccessibilityLabel.format(t.props.Data[r]),i.createElement("tr",{className:"nps-chart-control-legend-table-row",key:r},i.createElement("td",{"aria-hidden":!0,role:"presentation",className:"chart-control-legend-label"},t.props.Labels[r]),i.createElement("td",{"aria-label":n,className:"chart-control-legend-value"},t.props.Data[r]))}))},e.du=function(){var t={className:"chart-control",tabIndex:-1};t["aria-label"]=(0,o.pm)().ChartControl_ChartValueForNPS.format(this.props.Score);var n={height:150,ref:this._u,width:300,"aria-label":(0,o.pm)().ChartControl_AriaLabel};return i.createElement("div",(0,r.pi)({},t),i.createElement("canvas",(0,r.pi)({},n)))},n}(u.r),v=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.getPreviewImageName=function(){return"nps.png"},e.createQuestionViewContent=function(){var t=this.props.AggregationMaster.Model.NPSQuestionAggregation,n=t.ResponseCount,e=[t.Promoters,t.Passives,t.Detractors],r=e.map((function(t){return t&&Math.round(100*t/n)})),s=[(0,o.pm)().NPS_Promoters,(0,o.pm)().NPS_Passives,(0,o.pm)().NPS_Detractors];return[i.createElement(m,{key:"chartControl",Data:e,HasLegend:!0,Labels:s,Percentage:r,Score:r[0]-r[2]})]},n}(e(79608).E)},79608:function(t,n,e){"use strict";e.d(n,{E:function(){return w}});var r=e(59312),i=e(63804),o=e(78587),s=e(55411),u=e(7645);var a=e(54569),c=e(47143),l=e(41040),f=e(25306),h=e(79068),d=e(23112),m=e(63481),v=e(9743),p=e(42605),g=function(t){function n(n){var e=t.call(this,n)||this;return e.Bu=i.createRef(),e.zu="",e.focus=e.focus.bind(e),e.Qu=e.Qu.bind(e),e}(0,r.ZT)(n,t);var e=n.prototype;return e.render=function(){var t=!(this.props.FormInsightMaster.FormMaster.SyncContext===v.y.AnalysisTimeForm),n=this.props.Index+1;if(t&&this.props.FormInsightMaster.Model.IsReady&&this.Hu().length>0&&!(0,s.sv)()){var e=void 0;e=this.props.Clicked?"analyze-view-detail-show-insight-button clicked optional-button":"analyze-view-detail-show-insight-button optional-button";var r={ref:this.Bu,"aria-label":(0,u.pm)().AnalyzeView_InteractiveInsight_AriaDescription.format(n),className:e,onClick:this.Qu};return(0,p.F)({HTMLAttributes:r,FluentIcon:"Lightbulb Filament",IconClassName:"forms-icon-size14x14 analyze-view-insight-button-icon",Text:"Insights",TextClassName:"analyze-view-insight-button-label",ButtonStyle:1,GlyphButtonStyle:"Horizontal"})}return null},e.focus=function(){this.Bu.current&&this.Bu.current.focus()},e.Qu=function(){var t=this.Hu();this.props.FormInsightMaster.logEngage("Explore",t,this.zu,0,0,this.props.QuestionMaster.Model.Id),this.props.openInsightExploreView()},e.Hu=function(){var t=this.props.QuestionMaster,n=this.props.FormInsightMaster.Insights.filter((function(n){return n.CalculationQuestion.Id===t.Model.Id&&n.IsStatisticSignificant}))||[],e=n.map((function(t){return t.InsightId}))||[];return this.zu=n.length>0?n[0].SuggestionId:"",e},n}(d.r),b=e(59415),w=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.ju=function(){return n.forceUpdate()},n.$u=i.createRef(),n.Wu=i.createRef(),n}(0,r.ZT)(n,t);var e=n.prototype;return e.componentWillMount=function(){if(this.Ju=this.Ju.bind(this),this.props.AggregationMaster.observe(this.ju,[c.N.Schema.IsAggregationReady,c.N.Schema.IsAggregationFailed]),(0,h.s$)()){this.ai=this.ai.bind(this),this.Ku=this.Ku.bind(this),this.Xu=this.Xu.bind(this);var t=this.props.AggregationMaster.QuestionMaster;t.observe(this.ai,[t.Schema.InsightsInfo]);var n=this.props.QuestionViewInsight.FormInsightMaster,e=n.FormMaster;n.observe(this.ai,[n.Schema.InsightCount]),e.observe(this.ai,[e.Schema.FormsInsightsInfo])}},e.render=function(){if(this.props.AggregationMaster){var t=(0,u.pm)(),n=this.props.AggregationMaster.QuestionMaster.Model,e=this.props.Index+1+"."+n.Title+"."+(n.Required?t.Accessibility_RequiredAnswer+".":"")+function(t,n,e){var r="";switch(n){case"Question.Choice":r=e?t.QuestionType_MultiChoice:t.QuestionType_SingleChoice;break;case"Question.DateTime":r=t.QuestionType_DateTime;break;case"Question.Rating":r=t.QuestionType_Rating;break;case"Question.TextField":r=e?t.QuestionType_MultiLineText:t.QuestionType_SingleLineText;break;case"Question.Ranking":r=t.QuestionType_Ranking;break;case"Question.MatrixChoiceGroup":r=t.QuestionType_MatrixChoiceGroup;break;case"Question.FileUpload":r=t.QuestionType_UploadFile;break;case"Question.NPS":r=t.QuestionType_NPS;break;case"Question.ColumnGroup":r=t.DesciptiveElementType_Section}return r}(t,n.Type,n.Multiline)+".";return i.createElement("div",{className:"analyze-view-detail","aria-label":e},this.Yu(this.props.Index),this.Zu(),i.createElement("div",{className:"analyze-view-detail-linebreak"}))}},e.componentWillUnmount=function(){this.props.AggregationMaster.unobserve(this.ju,[c.N.Schema.IsAggregationReady]),(0,h.s$)()&&(this.props.AggregationMaster.QuestionMaster&&this.props.AggregationMaster.QuestionMaster.unobserve(this.ai),this.props.QuestionViewInsight.FormInsightMaster&&(this.props.QuestionViewInsight.FormInsightMaster.unobserve(this.ai),this.props.QuestionViewInsight.FormInsightMaster.FormMaster.unobserve(this.ai)))},e.ai=function(){this.forceUpdate()},e.Yu=function(t){return i.createElement("div",{className:"analzye-view-detail-question"},i.createElement("div",{className:"analzye-view-detail-ordinal"},t+1+"."),this.createQuestionTitleContent())},e.Zu=function(){return i.createElement("div",{className:"survey-analyze-view-detail-container"},this.ta(this.props.Index),this.na(this.props.Index),this.ea(),this.ra(),this.ia(),this.oa(),this.ua())},e.ta=function(t){var n=t+1;if(this.props.onShowQuestionDetail&&!(0,s.sv)()){var e={HTMLAttributes:{"aria-label":(0,u.pm)().QuestionView_Detail_Label_Index?(0,u.pm)().QuestionView_Detail_Label_Index.format(n):void 0,className:"analyze-view-link-button",onClick:this.Ju},Text:(0,u.pm)().QuestionView_Detail_Label,Tooltip:(0,u.pm)().AnalyzeView_ShowDetailResponses_Button.format(n),ref:this.$u};return i.createElement("div",{className:"question-view-detail-label"},i.createElement(f.A,(0,r.pi)({},e)))}},e.ea=function(){if(this.props.AggregationMaster.Model.IsAggregationReady)return i.createElement("div",{className:"question-view-content-container"},this.createQuestionViewContent())},e.ra=function(){if(!this.props.AggregationMaster.Model.IsAggregationReady&&!this.props.AggregationMaster.Model.IsAggregationFailed)return i.createElement("div",{className:"question-view-loading-content-container"},this.aa(),this.ao())},e.ia=function(){if(this.props.AggregationMaster.Model.IsAggregationFailed)return i.createElement("div",{className:"question-view-loading-content-container"},this.aa())},e.aa=function(){var t=(0,o.Jn)("/Images/question_backgrounds/"+this.getPreviewImageName());return i.createElement("div",{className:"question-view-background-image"},i.createElement("img",{src:t}))},e.ao=function(){return i.createElement(l.P,(0,r.pi)({},{ClassName:"question-view-loading-spinner-container",Ignorable:!1}))},e.Ju=function(){var t=this;(0,m.cz)(b.u.name,(function(){t.$u.current&&t.$u.current.focus()})),this.props.onShowQuestionDetail&&this.props.onShowQuestionDetail()},e.shouldShowInsightEntryPoint=function(){return!1},e.na=function(t){if((0,h.s$)()&&!(0,s.sv)()){var n=this.props.QuestionViewInsight.InsightExploreViewOpened&&this.props.QuestionViewInsight.InsightExploreViewIndex===this.props.Index,e=this.shouldShowInsightEntryPoint();return i.createElement(g,{openInsightExploreView:this.Xu,ref:this.Wu,Clicked:n,FormInsightMaster:this.props.QuestionViewInsight.FormInsightMaster,Index:t,QuestionMaster:this.props.AggregationMaster.QuestionMaster,ShowEntryPoint:e})}},e.ua=function(){if((0,h.s$)()&&!(0,s.sv)())return(0,a.u5)({QuestionIndex:this.props.Index,FormInsightMaster:this.props.QuestionViewInsight.FormInsightMaster,QuestionMaster:this.props.AggregationMaster.QuestionMaster})},e.oa=function(){if((0,h.s$)()&&!(0,s.sv)()&&this.props.QuestionViewInsight.InsightExploreViewOpened&&this.props.QuestionViewInsight.InsightExploreViewIndex===this.props.Index)return(0,a.os)({closeInsightExploreView:this.Ku,FormInsightMaster:this.props.QuestionViewInsight.FormInsightMaster,QuestionMaster:this.props.AggregationMaster.QuestionMaster})},e.Ku=function(){this.props.QuestionViewInsight.onCloseInsightExploreView(),this.Wu.current&&this.Wu.current.focus()},e.Xu=function(){this.props.QuestionViewInsight.onClickInsightButton()},n}(d.r)},30359:function(t,n,e){"use strict";e.d(n,{q:function(){return f}});var r=e(59312),i=e(63804),o=e(36215),s=e(7645),u=e(22768),a=e(65863),c=e(5161),l=e(10514),f=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.createQuestionTitleContent=function(){return i.createElement(l.A,{AggregationMaster:this.props.AggregationMaster})},Object.defineProperty(e,"CorrectOptions",{get:function(){var t={},n=o.filter(this.props.AggregationMaster.QuestionMaster.Model.Choices,(function(t){return t.IsAnswerKey}));return o.forEach(n,(function(n){return t[n.Description]=!0})),t},enumerable:!1,configurable:!0}),e.createDisplayElement=function(t){return t.IsFormula?(0,u.Rq)({Formula:t.Choice,DisableLinebreaks:!0}):(0,a.q)({Text:"answer_other"===t.Choice?(0,s.pm)().Designer_OtherAnswer:t.Choice,RenderMode:"RichText",ContainsHtml:!0})},n}(c.m)},43370:function(t,n,e){"use strict";e.d(n,{$:function(){return u}});var r=e(59312),i=e(63804),o=e(70623),s=e(10514),u=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,r.ZT)(n,t),n.prototype.createQuestionTitleContent=function(){return i.createElement(s.A,{AggregationMaster:this.props.AggregationMaster})},n}(o.e)},15694:function(t,n,e){"use strict";e.d(n,{h:function(){return u}});var r=e(59312),i=e(63804),o=e(87335),s=e(10514),u=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,r.ZT)(n,t),n.prototype.createQuestionTitleContent=function(){return i.createElement(s.A,{AggregationMaster:this.props.AggregationMaster})},n}(o.d)},13226:function(t,n,e){"use strict";e.d(n,{Y:function(){return u}});var r=e(59312),i=e(63804),o=e(39436),s=e(10514),u=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,r.ZT)(n,t),n.prototype.createQuestionTitleContent=function(){return i.createElement(s.A,{AggregationMaster:this.props.AggregationMaster})},n}(o.a)},18805:function(t,n,e){"use strict";e.d(n,{V:function(){return u}});var r=e(59312),i=e(63804),o=e(96251),s=e(10514),u=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,r.ZT)(n,t),n.prototype.createQuestionTitleContent=function(){return i.createElement(s.A,{AggregationMaster:this.props.AggregationMaster})},n}(o.T)},10514:function(t,n,e){"use strict";e.d(n,{A:function(){return c}});var r=e(59312),i=e(63804),o=e(7645),s=e(22768),u=e(64541),a=e(65863),c=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.render=function(){return i.createElement("div",null,this.ca(),this.la(),this.fa())},e.ca=function(){var t=this.QuestionMaster.Model;return i.createElement("div",{className:"analzye-view-detail-title"},i.createElement(a.D,{Text:(0,u.wg)(t.Title,t.FormsProRTQuestionTitle),RenderMode:"RichText",ContainsHtml:!0}),this.ha())},e.ha=function(){if(this.IsShowPointsEnabled){var t=this.QuestionMaster.Model.Point,n=t<=1?(0,o.pm)().Quiz_Points_LowerText:(0,o.pm)().Quiz_Points_LowerTextPlural;return i.createElement("span",{className:"analyze-view-quiz-point"},"("+t+" "+n+")")}},e.la=function(){if(this.IsShowSubtitleEnabled)return i.createElement("div",{className:"analyze-view-question-title-formula"},(0,s.Rq)({Formula:this.SubtitleContext}))},e.fa=function(){if(this.IsStatisticsEnabled){var t=this.props.AggregationMaster.Model.GradeStatistics,n=t.CorrectCount,e=t.WrongCount;return i.createElement("div",{className:"analyze-details-quiz-results"},(0,o.pm)().AnalyzeView_QuizResults.format((n/(n+e)*100).toFixed(0),n,n+e))}},e.da=function(t){return null!=t},Object.defineProperty(e,"QuestionMaster",{get:function(){return this.props.AggregationMaster.QuestionMaster},enumerable:!1,configurable:!0}),Object.defineProperty(e,"IsShowPointsEnabled",{get:function(){return this.QuestionMaster.Model.IsQuiz&&this.QuestionMaster.Model.Point},enumerable:!1,configurable:!0}),Object.defineProperty(e,"IsShowSubtitleEnabled",{get:function(){return this.QuestionMaster&&this.QuestionMaster.Model.IsMathQuiz&&!this.QuestionMaster.Model.IsPlainTextInMathField&&this.QuestionMaster.Model.ShowSubtitle&&this.SubtitleContext},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SubtitleContext",{get:function(){return this.QuestionMaster.Model.Subtitle},enumerable:!1,configurable:!0}),Object.defineProperty(e,"IsStatisticsEnabled",{get:function(){var t=this.props.AggregationMaster.Model.GradeStatistics;return this.QuestionMaster.Model.IsQuiz&&this.QuestionMaster.hasCorrectAnswers()&&this.da(t.CorrectCount)&&this.da(t.WrongCount)&&(t.CorrectCount||t.WrongCount)},enumerable:!1,configurable:!0}),n}(e(23112).r)},45915:function(t,n,e){"use strict";e.d(n,{i:function(){return l}});var r=e(59312),i=e(63804),o=e(26203),s=e(7645),u=e(82741),a=e(11253),c=e(10514),l=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.createQuestionTitleContent=function(){return i.createElement(c.A,{AggregationMaster:this.props.AggregationMaster})},e.createStackedBarControlContainer=function(){var t=o.d.convertToArray(this.props.AggregationMaster.Model.RankingQuestionAggregation);if(t&&t.length>0){var n=[],e=[];t.forEach((function(t,r){n.push(t.Statistics[0]),e.push(t.Statistics[1])}));var r=[{backgroundColor:"#06B65F",label:(0,s.pm)().AnalyzeView_Correct,data:n},{backgroundColor:"#FF1225",label:(0,s.pm)().AnalyzeView_InCorrect,data:e}];return i.createElement(u.Q,{Type:0,Labels:t.map((function(t){return t.Name})),Data:r,HasLegend:!0,key:"rankingChartControl"})}},n}(a.U)},92578:function(t,n,e){"use strict";e.d(n,{g:function(){return u}});var r=e(59312),i=e(63804),o=e(42402),s=e(10514),u=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,r.ZT)(n,t),n.prototype.createQuestionTitleContent=function(){return i.createElement(s.A,{AggregationMaster:this.props.AggregationMaster})},n}(o.K)},30945:function(t,n,e){"use strict";e.d(n,{x:function(){return m}});var r=e(59312),i=e(63804),o=e(36215),s=e(26203),u=e(7645),a=e(22768),c=e(91367),l=e(45142),f=e(65863),h=e(21163),d=e(10514),m=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.createQuestionTitleContent=function(){return i.createElement(d.A,{AggregationMaster:this.props.AggregationMaster})},e.createQuestionViewContent=function(){return this.props.AggregationMaster.QuestionMaster.hasCorrectAnswers()?[this.Xs()]:[t.prototype.createResponsesCountLabel.call(this),t.prototype.createLatestTextsView.call(this)]},e.Xs=function(){var t=this.ma(),n=o.map(t,(function(t){var n;return n=t.IsMath?(0,a.Rq)({Formula:t.Text}):(0,f.q)({Text:t.Text,RenderMode:"RichText"}),{labelData:t.Count,labelName:t.Text,displayElement:n}})),e={Animation:this.props.AggregationMaster.Model.IsAggregationReady,Data:{data:t.map((function(t){return t.Count}))},Labels:n,HasLegend:!0,TagLabels:this.va(),Type:t.length<=5?1:0};return i.createElement(l.r,(0,r.pi)({},e,{key:"chartControl"}))},e.ma=function(){var t=s.d.convertToArray(this.props.AggregationMaster.Model.TextQuestionAggregation.TextSummary),n=o.last(t);return n&&"answer_other"===n.Text&&(t[t.length-1].Text=(0,u.pm)().AnalyzeView_Chart_Others.format(n.Count)),t},e.va=function(){var t={},n=new c.E(this.props.AggregationMaster.QuestionMaster.Model);return o.forEach(n.getAnswers(),(function(n){return t[n.answer]=!0})),t},n}(h.a)},11253:function(t,n,e){"use strict";e.d(n,{U:function(){return i}});var r=e(59312),i=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.getPreviewImageName=function(){return"bar.png"},e.createQuestionViewContent=function(){return[this.createStackedBarControlContainer()]},n}(e(79608).E)},42402:function(t,n,e){"use strict";e.d(n,{K:function(){return f}});var r=e(59312),i=e(63804),o=e(27196),s=e(7645),u=e(72374),a=e(94154),c=e(79608),l=e(35230),f=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.getPreviewImageName=function(){return"rating.png"},e.createQuestionViewContent=function(){return[this.Zs(),this.pa()]},e.componentDidMount=function(){this.ga()},e.componentDidUpdate=function(){this.ga()},e.ga=function(){$(".rateit").rateit();var t=o.findDOMNode(this.refs.star);t&&$(t).rateit("value",this.ba())},e.Zs=function(){var t={Data:this.props.AggregationMaster.Model.RatingQuestionAggregation.ResponseCount,Description:(0,s.pm)().Common_Responses_Text,Ignorable:!1,IsReady:!0,AccessibilityText:(0,s.pm)().AnalyzeView_NumberOfResponses_AccessibilityLabel.format(this.props.AggregationMaster.Model.RatingQuestionAggregation.ResponseCount)};return i.createElement(l.V,(0,r.pi)({},t,{key:"responseCount"}))},e.pa=function(){switch(this.props.AggregationMaster.QuestionMaster.Model.RatingShape){case u.le.Number:return this.wa();case u.le.Star:default:return this.ya()}},e.wa=function(){return i.createElement("div",{className:"survey-analyze-view-rating-container",key:"numberAverage"},i.createElement("a",{className:"screenReaderVisible",role:"presentation"},this.ba()+". "+(0,s.pm)().AnalyzeView_Average_Result),i.createElement("div",{"aria-hidden":!0,className:"analyze-average-rating simple-data-control-content office-form-theme-primary-foreground"},this.ba()),i.createElement("div",{"aria-hidden":!0,className:"analyze-view-summary-status-label"},(0,s.pm)().AnalyzeView_Average_Result))},e.ya=function(){var t=(0,a.w)({Disabled:!0,HTMLAttributes:{className:"analyze-view-details-rating office-form-theme-primary-foreground",title:this.ba().toFixed(2).toString()},Length:this.props.AggregationMaster.QuestionMaster.Model.Length,onValueChange:void 0,ShowRatingLabel:!1,Value:this.ba(),key:"rateit"});return i.createElement("div",{className:"survey-analyze-view-rating-container",key:"starAverage"},t,i.createElement("div",{className:"analyze-view-summary-status-label"},(0,s.pm)().AnalyzeView_Average_Rating.format(this.ba().toFixed(2))))},e.ba=function(){var t=this.props.AggregationMaster.Model.RatingQuestionAggregation.AverageRating;return t?Math.round(100*t)/100:0},n}(c.E)},38255:function(t,n,e){"use strict";e.d(n,{D:function(){return N}});var r=e(59312),i=e(63804),o=e(27196),s=e(36215),u=e(81620),a=e(18113),c=e(7645),l=e(24209),f=e(88807),h=e(22768),d=e(72374),m=e(55890),v=e(3424),p=e(42605),g=e(65863),b=e(71170),w=e(25306),y=e(50434),I=e(23112),S=e(63481),C=e(29542),F=e(98196);function N(t){return i.createElement(T,t)}var T=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.Ia=i.createRef(),n.Sa=i.createRef(),n.Ca=i.createRef(),n.Fa=i.createRef(),n}(0,r.ZT)(n,t);var e=n.prototype;return e.componentDidMount=function(){this.Ia.current&&this.Ia.current.focus(),(0,S.mZ)(o.findDOMNode(this)),this.Na(),this.Ta()},e.shouldComponentUpdate=function(t,n){var e=!s.isEqual(t,this.props),r=!s.isEqual(n,this.state);return e||r},e.componentDidUpdate=function(){var t=this,n=this.props.AnalyzeViewData.Questions.filter((function(n){return n.Field===t.props.QuestionId}))[0];this.ka(n).length>0&&(this.Na(),this.Ta())},e.componentWillUnmount=function(){},e.render=function(){var t=this;return i.createElement("div",{className:"response-dialog-container",onKeyDown:function(n){(8===n.keyCode||37===n.keyCode&&n.altKey)&&(n.stopPropagation(),n.preventDefault()),27===n.keyCode&&t.props.closeSelf()}},this.xa(),this.hs(),this.Pa())},e.hs=function(){var t=this,n=this.props.AnalyzeViewData,e=n.Questions.filter((function(n){return n.Field===t.props.QuestionId}))[0],r=i.createElement("div",{className:"response-dialog-title"},(0,g.q)({Text:(0,c.pm)().AnalyzeView_QuestionTitle.format(e.Index+1,e.Model.Title),RenderMode:"RichText"})),o=this.ka(e),u=i.createElement("div",{className:"response-dialog-summary"},i.createElement("div",{className:"response-dialog-response-count office-form-theme-primary-foreground"},o.length),(0,c.pm)().Common_Responses_Text),a=i.createElement("button",{ref:this.Ia,className:"response-dialog-close-button",title:(0,c.pm)().Common_Close_Text,onClick:function(){return t.props.closeSelf()}},(0,v.M)({FluentIcon:"Dismiss",HTMLAttributes:{className:"forms-icon-size16x16"}})),l={"aria-label":(0,c.pm)().AnalyzeView_Detail_DialogTitle.format(e.Index+1),className:"response-dialog",ref:this.Ca,role:"dialog"};if(0===o.length){var f=i.createElement("div",{className:"response-dialog-no-responses-message"},(0,c.pm)().AnalyzeView_DetailResponses_NoResponses_Message);return i.createElement("div",l,a,r,u,f)}var h=i.createElement("div",{className:"response-dialog-content",ref:this.Fa},i.createElement("div",{className:"response-dialog-table-container"},i.createElement("table",{className:"response-dialog-table hover stripe cell-border"})));"Question.FileUpload"===s.findWhere(n.Questions,{Field:this.props.QuestionId}).Model.Type&&(u=this.Da(o));var d=i.createElement("div",{ref:this.Sa},a,r,u);return i.createElement("div",l,d,h)},e.Da=function(t){var n=this;if(t[0][this.props.QuestionId]){var e=(0,w.E)({HTMLAttributes:{className:"response-dialog-folder-button office-form-theme-button",onClick:function(){var t=n.props,e=s.findWhere(t.AnalyzeViewData.Questions,{Field:t.QuestionId}),r=e.Model.FileUploadSPOInfo;r&&r.folderId&&new f.L(e.Master.Form).getFileFolder(r.folderId).then((function(t){(0,m.$U)("DesignPage.Responses.OpenFileFolder"),(0,l.K)(t)})).catch((function(t){t&&t.response&&404===t.response.statusCode&&n.setState({ShowErrorMessage:!0})}))}},ButtonStyle:1,Text:(0,c.pm)().UploadFile_OpenFolder_Button}),r=this.state.ShowErrorMessage?i.createElement("div",{className:"response-dialog-folder-button-error-message"},(0,c.pm)().UploadFile_FolderNotExist_ErrorMessage):void 0;return i.createElement("div",null,i.createElement("div",{className:"response-dialog-summary"},i.createElement("div",{className:"response-detail-dialog-container"},i.createElement("span",{className:"response-dialog-response-count office-form-theme-primary-foreground"},t.length),(0,c.pm)().UploadFile_Files_DetailPage_Subtitle),e),r)}},e.Pa=function(){var t=this,n=this.props.AnalyzeViewData.Questions.filter((function(n){return n.Field===t.props.QuestionId}))[0];if(null!=this.props.goToNextModalCallback&&n.Index!==this.props.AnalyzeViewData.Questions.length-1){var e={className:"response-dialog-next-button",title:(0,c.pm)().AnalyzeView_DetailResponses_Next_Button,onClick:function(){t.props.goToNextModalCallback(),setTimeout((function(){t.Ia.current&&t.Ia.current.focus()}),0)}};return(0,p.F)({HTMLAttributes:e,FluentIcon:"Chevron Right",GlyphButtonStyle:"GlyphOnly",ButtonStyle:2})}},e.xa=function(){var t=this,n=this.props.AnalyzeViewData.Questions.filter((function(n){return n.Field===t.props.QuestionId}))[0];if(null!=this.props.goToPreviousModalCallback&&0!==n.Index)return(0,p.F)({HTMLAttributes:{className:"response-dialog-previous-button",onClick:function(){t.props.goToPreviousModalCallback(),setTimeout((function(){t.Ia.current&&t.Ia.current.focus()}),0)}},FluentIcon:"Chevron Left",GlyphButtonStyle:"GlyphOnly",ButtonStyle:2,Text:(0,c.pm)().AnalyzeView_DetailResponses_Previous_Button})},e.Ea=function(t,n,e){var r=[(0,c.pm)().AnalyzeView_Sort_First,(0,c.pm)().AnalyzeView_Sort_Second,(0,c.pm)().AnalyzeView_Sort_Third,(0,c.pm)().AnalyzeView_Sort_Fourth,(0,c.pm)().AnalyzeView_Sort_Fifth,(0,c.pm)().AnalyzeView_Sort_Sixth,(0,c.pm)().AnalyzeView_Sort_Seventh,(0,c.pm)().AnalyzeView_Sort_Eighth,(0,c.pm)().AnalyzeView_Sort_Ninth,(0,c.pm)().AnalyzeView_Sort_Tenth],i=[(0,c.pm)().Common_Responses_Text],o=[{title:(0,c.pm)().AnalyzeView_Response_ID},{title:(0,c.pm)().AnalyzeView_ExcelHeader_ResponderName}],u=this.Ra(n),a=[],l=60/u+"%";switch(t){case"Question.Ranking":$(".response-dialog-table").addClass("response-dialog-table-ranking"),a=s.first(r,u);break;case"Question.MatrixChoiceGroup":a=i;for(var f=1;f<u;f++)a.push("");break;case"Question.NPS":a=[(0,c.pm)().AnalyzeView_NPS_Score,(0,c.pm)().AnalyzeView_NPS_Category];break;default:$(".response-dialog-table").removeClass("response-dialog-table-ranking"),a=i}return a=a.map((function(t){return{title:t,width:l}})),e&&a.push({title:(0,c.pm)().AnalyzeView_Quiz_Validation,width:l}),o.concat(a)},e.Na=function(){var t,e=this,a=this.props,c=a.AnalyzeViewData,l=s.findWhere(c.Questions,{Field:a.QuestionId}),f=F.j.isAutogradableQuestion(l.Model);this.La&&($(".dataTables_wrapper").remove(),$(".response-dialog-table").remove(),$(".response-dialog-table-container").append("<table class='response-dialog-table hover stripe cell-border'></table>"),this.La.destroy(),this.La=void 0);var m=this.ka(l).map((function(t){return t.field_responder_name=(0,u.F1)(t.field_responder_name,!0),t}));if("Question.Ranking"===l.Model.Type){var v=this.Ra(a.QuestionId),p=l.Model.ChoiceGroup;t=m.map((function(t,n){var r=[];r=[n+1,t.field_responder_name];var i=t[l.Field]||[],o=i.slice(0,Math.min(i.length,v)).sort((function(t,n){return t.answerOrder-n.answerOrder})).map((function(t,n){return f?"<span style='color:"+(p[n].Id===t.id?"#107C10":"#A80000")+"'>"+e.Aa(t.displayText)+"</span>":e.Aa(t.displayText)}));r=r.concat(o);for(var s=0;s<v-o.length;s++)r.push("");return f&&r.push(l.Master.isCorrectAnswer(t[l.Field])),r}))}else"Question.MatrixChoiceGroup"===l.Model.Type?(t=m.map((function(t,n){var r=[n+1,t.field_responder_name],i=s.map(l.Master.SubQuestionMasters,(function(n){var r="field_"+n.Model.Id;return t[r]?e.Aa(t[r].displayText):""}));return r.concat(i)}))).splice(0,0,["",""].concat(s.map(l.Master.SubQuestionMasters,(function(t){return e.Aa(t.Model.Title)})))):"Question.FileUpload"===l.Model.Type?(t=[],m.forEach((function(n,r){var i="";if(n[a.QuestionId]){var o=JSON.parse(n[a.QuestionId]);if(o.length>0){var s=o,u=[r+1,n.field_responder_name];s.forEach((function(t,n){var r=(0,y.UV)(t.name),o=e.qa(t.name),u=t.link.split('"')[0];n+1!==s.length?i+=r+'<a href="'+u+"\" target='_blank' class='response-dialog-fileName'>"+o+"</a></br>":i+=r+'<a href="'+u+"\" target='_blank' class='response-dialog-fileName'>"+o+"</a>"})),u.push(i),f&&u.push(F.j.isCorrectAnswer(l,n)),t.push(u)}}}))):t="Question.NPS"===l.Model.Type?m.map((function(t,n){var e=t[a.QuestionId];return[n+1,t.field_responder_name,e,(0,b.J)(e)]})):m.map((function(t,n){var r=[n+1,t.field_responder_name,e.Aa(t[a.QuestionId])];return l.Model.IsMathQuiz&&r.push(t[a.QuestionId+"_math"]),f&&r.push(F.j.isCorrectAnswer(l,t)),r}));var g=f?1:0;g+=l.Model.IsMathQuiz?1:0,this.La=$(".response-dialog-table").DataTable({data:f?t.map((function(t){var n=t.slice(0,t.length-g);return n.push(""),n})):t,columns:this.Ea(l.Model.Type,a.QuestionId,f),searching:!1,paging:!1,info:!1,autoWidth:!0,rowCallback:function(e,u,a){if(f){var c=t[u[0]-1][t[0].length-1],m=n.createCorrectnessIcon(c),v=$(e).find("td:eq("+(t[0].length-g)+")").get(0);u[u.length-1]=c,o.render(m,v)}if(l.Model.IsMathQuiz)if("Question.TextField"===l.Model.Type){var p=t[u[0]-1][t[0].length-g];if(p){var b=$(e).find("td:eq("+(t[0].length-g-1)+")").get(0),w=(0,h.Rq)({Formula:u[2]});o.render(w,b)}u[t[0].length-1]=p}else if("Question.Choice"===l.Model.Type){var y=u[2],I=$(e).find("td:eq("+(t[0].length-g-1)+")").get(0);if(l.Model.ChoiceType===d.T6.MultiChoice){var S,C=[];try{C=JSON.parse(y),S=["["]}catch(t){}C&&C.length>0?(s.forEach(C,(function(n){s.forEach(l.Model.Choices,(function(e){if(n===e.Description)return u[t[0].length-1]=e.IsMathOption,S.push('"'),e.IsMathOption?S.push((0,h.Rq)({Formula:n})):S.push(n),S.push('",'),!1}))})),S.pop(),S.push('"]'),o.render(i.createElement.apply(i,(0,r.ev)(["div",{className:"multi-formula-response-row"}],S)),I)):s.forEach(l.Model.Choices,(function(n){if(y===n.Description){if(n.IsMathOption){var e=(0,h.Rq)({Formula:y});o.render(e,I)}return u[t[0].length-1]=n.IsMathOption,!1}}))}else s.forEach(l.Model.Choices,(function(n){if(y===n.Description){if(n.IsMathOption){var e=(0,h.Rq)({Formula:y});o.render(e,I)}return u[t[0].length-1]=n.IsMathOption,!1}}))}}})},e.Ta=function(){var t=$(this.Ca.current).height()-$(this.Sa.current).outerHeight(!0);$(this.Fa.current).outerHeight(t)},e.qa=function(t){return t&&(0,u.F1)(""+t,!0)},e.Aa=function(t){return(0,a.ZP)(t)},e.ka=function(t){var n=this.props,e=n.AnalyzeViewData.Answers;n.ShouldIncludeInvalidAnswers||(e=e.filter((function(n){return C.f.hasValidAnswer(n,t)})));var r=n.filterResponses;return null!=r&&(e=e.filter(r)),e},n.createCorrectnessIcon=function(t){return t?i.createElement("div",{title:(0,c.pm)().GradingView_CorrectAnswer_AccessibilityLabel},i.createElement("a",{className:"screenReaderVisible"},(0,c.pm)().GradingView_CorrectAnswer_AccessibilityLabel),(0,v.M)({FluentIcon:"Checkmark",HTMLAttributes:{className:"forms-icon-size16x16 office-form-right-answerkey"}})):i.createElement("div",{title:(0,c.pm)().GradingView_IncorrectAnswer_AccessibilityLabel},i.createElement("a",{className:"screenReaderVisible"},(0,c.pm)().GradingView_IncorrectAnswer_AccessibilityLabel),(0,v.M)({HTMLAttributes:{className:"forms-icon-size16x16 office-form-wrong-answerkey"},IconName:"Cancel"}))},e.Ra=function(t){var n=s.findWhere(this.props.AnalyzeViewData.Questions,{Field:this.props.QuestionId});switch(n.Model.Type){case"Question.Ranking":return n.Model.ChoiceGroup.length||1;case"Question.MatrixChoiceGroup":return n.Master.SubQuestionMasters.length||1;case"Question.NPS":return 2;default:return 1}},n}(I.r)},35230:function(t,n,e){"use strict";e.d(n,{V:function(){return a}});var r=e(59312),i=e(63804),o=e(36215),s=e(262),u=e(41040),a=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.render=function(){var t=(0,s.j)(this.props.ClassName,"simple-data-control-container");this.props.Ignorable&&(t=(0,s.j)(t,"optional-cell"));var n=o.extend({},this.props.HTMLAttributes);return n.className=(0,s.j)(n.className,t),i.createElement("div",(0,r.pi)({},n,{role:"list"}),this.Oa(),i.createElement("div",(0,r.pi)({className:"simple-data-control-description"},this.Ma()),this.props.Description))},e.Oa=function(){if(this.props.IsReady)return i.createElement("div",{className:"simple-data-control-content office-form-theme-primary-foreground",role:"listitem","aria-label":this.props.AccessibilityText},this.props.Data);return i.createElement(u.P,(0,r.pi)({},{ClassName:"designPage-response-averageTime-spinner",Ignorable:!1}))},e.Ma=function(){if(this.props.AccessibilityText)return{"aria-hidden":!0,role:"presentation"}},n}(e(23112).r)},26526:function(t,n,e){"use strict";e.d(n,{p:function(){return _}});var r=e(59312),i=e(63804),o=e(55411),s=e(7645),u=e(72467),a=e(54569),c=e(84745),l=e(90634),f=e(55890),h=e(25306),d=e(27196),m=e(78587),v=e(262),p=e(7899),g=e(54496),b=e(43691),w=e(72317),y=e(69856),I=e(36465),S=e(85977),C=e(24753),F=e(72581),N=e(84280),T=e(12180);function k(t){var n=t.Insight.Type,e=function(t){switch(t){case y.d.AssociationRuleInsight:return S.W;case y.d.AllHandsSummaryInsight:return I.Y;case y.d.DrivingFactorAnalysisInsightCollection:return C.F;case y.d.LikertImpactAnalysisInsightCollection:return F.q;case y.d.ResponseSentimentInsightCollection:return N.C;case y.d.TextClusterInsight:return T.W}}(n);if(e)return i.createElement(e,(0,r.pi)((0,r.pi)({},t),{key:t.Index}));throw Error('Type "'+n+'" has not been registered.')}var x=e(42605),P=e(23112),D=function(t){function n(n){var e=t.call(this,n)||this;return e.state={Feedback:0,FeedbackOptions:[]},e.Ua=e.Ua.bind(e),e.Va=e.Va.bind(e),e}(0,r.ZT)(n,t);var e=n.prototype;return e.shouldComponentUpdate=function(t){return this.props.InsightIndex!==t.InsightIndex&&0!==this.state.Feedback&&(this._a(),this.setState({Feedback:0,FeedbackOptions:[]})),!0},e.componentWillUnmount=function(){0!==this.state.Feedback&&this._a()},e.render=function(){var t=2===this.state.Feedback?"insight-view-feedback-container expended":"insight-view-feedback-container";return i.createElement("div",{className:t},this.Ga(),this.Ba())},e.Ba=function(){var t=this;if(2!==this.state.Feedback)return null;var n=[{key:"Visual_Not_Intuitive",value:(0,s.pm)().AnalyzeView_Insight_Feedback_Visual_Not_Intuitive},{key:"Description_Not_Clear",value:(0,s.pm)().AnalyzeView_Insight_Feedback_Description_Not_Clear},{key:"Not_Relevant",value:(0,s.pm)().AnalyzeView_Insight_Feedback_Not_Relevant},{key:"Incorrect",value:(0,s.pm)().AnalyzeView_Insight_Feedback_Incorrect},{key:"Not_Meaningful",value:(0,s.pm)().AnalyzeView_Insight_Feedback_Not_Meaningful},{key:"Too_Similar",value:(0,s.pm)().AnalyzeView_Insight_Feedback_Too_Similar}].map((function(n){var e="insight-view-feedback-option";t.state.FeedbackOptions.indexOf(n.key)>=0&&(e=(0,v.j)(e,"selected"));var o={className:e,tabIndex:0,id:n.key,title:n.value,onClick:t.za.bind(t),onKeyDown:function(n){13!==n.keyCode&&32!==n.keyCode||t.za(n)}};return i.createElement("span",(0,r.pi)({},o),n.value)}));return i.createElement("div",{className:"insight-view-feedback-option-container"},n)},e.Ga=function(){var t=(0,v.j)("insight-view-feedback-button-like",1===this.state.Feedback?"selected":"unselected"),n=(0,v.j)("insight-view-feedback-button-dislike",2===this.state.Feedback?"selected":"unselected");return i.createElement("div",{className:"insight-view-feedback-button-container"},i.createElement("div",{"aria-label":(0,s.pm)().AnalyzeView_Insight_Feedback_Description,className:"insight-view-feedback-description",tabIndex:0},(0,s.pm)().AnalyzeView_Insight_Feedback_Description),this.Qa(t,(0,s.pm)().Common_Yes_Text),this.Qa(n,(0,s.pm)().Common_No_Text))},e.Qa=function(t,n){return(0,h.E)({ButtonStyle:0,HTMLAttributes:{className:t,onClick:this.Ua,onKeyDown:this.Va,tabIndex:0},Text:n})},e.Ua=function(t){var n=t.currentTarget.className.indexOf("insight-view-feedback-button-like")>=0?1:2;this.Ha=this.props.getCurrentViewInsight(),this.setState({Feedback:this.state.Feedback===n?0:n,FeedbackOptions:[]})},e.Va=function(t){if(13===t.keyCode||32===t.keyCode){t.preventDefault(),t.stopPropagation();var n=t.currentTarget.className.indexOf("like")>=0?1:2;this.Ha=this.props.getCurrentViewInsight(),this.setState({Feedback:this.state.Feedback===n?0:n,FeedbackOptions:[]})}},e.za=function(t){var n=this.state.FeedbackOptions,e=t.currentTarget.id;if(n.indexOf(e)>=0){var r=n.indexOf(e);n.splice(r,1)}else n.push(e);this.setState({FeedbackOptions:n})},e._a=function(){(0,f.$U)("DesignPage.Feedback.Insights",{InsightType:this.Ha.Type,InsightScore:this.Ha.Score,Feedback:this.state.Feedback,FeedbackOptions:this.state.FeedbackOptions})},n}(P.r),E=e(63481);var R=function(t){function n(n){var e=t.call(this,n)||this;return e.ko=function(){(0,f.$U)("DesignPage.Responses.ShowInsights",{InsightCount:e.ja.Insights.length,InsightTypes:e.ja.Insights.map((function(t){return y.d[t.Type]}))}),e.setState({DialogCount:e.ja.Insights.length,InsightReady:e.ja.Model.IsReady})},e.$a=function(){var t=d.findDOMNode(e.refs.insightDialog);t&&t.focus()},e.state={DialogCount:0,InsightIndex:0,InsightReady:!1,LibraryLoaded:!1,showAlert:!1},e.Wa=e.Wa.bind(e),e.Ja=e.Ja.bind(e),e.ja=new b.M(e.props.FormMaster),e.ja.observe(e.ko,[b.M.Schema.IsReady]),e.ja.loadInsight(),e}(0,r.ZT)(n,t);var e=n.prototype;return e.componentDidMount=function(){this.Do(),this.setState({showAlert:!0}),(0,E.mZ)(d.findDOMNode(this))},e.componentWillUnmount=function(){this.ja.unobserve(this.ko)},e.render=function(){return i.createElement("div",{className:"form-insight-container"},i.createElement("div",{className:"form-insight-frost",role:"presentation"}),this.Ka(),this.Xa(),this.Ya())},e.Do=function(){var t=this;(0,p.m)(["D3"]).then((function(){t.setState({LibraryLoaded:!0})}))},e.Xa=function(){var t={"aria-label":(0,s.pm)().AnalyzeView_Insight_Dialog,className:"form-insight-dialog",ref:"insightDialog",tabIndex:0};if(this.state.InsightReady&&this.state.LibraryLoaded){if(0===this.ja.Insights.length)return i.createElement("div",(0,r.pi)({},t),this.Za(),this.ec(),this.rc());var n=null;if(this.state.InsightIndex<this.ja.Insights.length){var e={InsightIndex:this.state.InsightIndex,getCurrentViewInsight:this.Ja};n=i.createElement(D,(0,r.pi)({},e))}return i.createElement("div",(0,r.pi)({},t),this.Za(),this.ec(),this.ic(),n,this.sc())}return i.createElement("div",(0,r.pi)({},t),this.Za(),this.ec(),this.uc())},e.sc=function(){var t=this;if(1===this.state.DialogCount)return null;for(var n=[],e=function(e){var s="form-insight-dialog-gallery-dot";s=(0,v.j)(s,e===o.state.InsightIndex?"active":"inactive");var u={key:e,className:s,tabIndex:0,onClick:function(){t.setState({InsightIndex:e})},onKeyDown:function(n){13!==n.keyCode&&32!==n.keyCode||t.setState({InsightIndex:e})}};n.push(i.createElement("div",(0,r.pi)({},u)))},o=this,s=0;s<this.state.DialogCount;s++)e(s);return i.createElement("div",{className:"form-insight-dialog-gallery"},i.createElement("div",{className:"form-insight-dialog-gallery-dots-container"},n))},e.uc=function(){var t="";this.state.showAlert&&(t=(0,s.pm)().AnalyzeView_Insight_Loading_Message);return i.createElement("div",{"aria-live":"polite",className:"form-insight-loading-container"},i.createElement("div",{className:"form-insight-loading-animation"},i.createElement("div",{className:"common-spinner-circle"})),i.createElement("div",{className:"form-insight-loading-message"},t))},e.rc=function(){var t=(0,g.Nw)((0,s.pm)().AnalyzeView_Insight_Default_View_Description),n=(0,s.pm)().AnalyzeView_Insight_Default_View_Title;return i.createElement("div",{className:"form-insight-default-view-container"},i.createElement("div",{className:"form-insight-default-img-container"},i.createElement("div",{className:"form-insight-default-img"},i.createElement("img",{className:"form-insight-default-image",src:(0,m.Jn)("/Images/insight/insight_default_pic.png")}))),i.createElement("div",{className:"form-insight-default-message-container"},i.createElement("div",{className:"form-insight-default-title",tabIndex:0},n),i.createElement("div",{className:"form-insight-default-description",dangerouslySetInnerHTML:{__html:t},tabIndex:0})))},e.Ka=function(){var t=this;if(this.state.InsightIndex>0&&this.state.InsightIndex<this.state.DialogCount){var n={HTMLAttributes:{className:"form-insight-dialog-previous-button",onClick:function(){(0,f.$U)("DesignPage.Responses.ClickInsightPreviousButton",{InsightCount:t.ja.Insights.length,InsightIndex:t.state.InsightIndex}),t.setState({InsightIndex:t.state.InsightIndex-1})}},FluentIcon:"Chevron Left",GlyphButtonStyle:"GlyphOnly",ButtonStyle:1,Text:(0,s.pm)().AnalyzeView_Insight_Previous_Insight};return(0,x.F)(n)}},e.Ya=function(){var t=this;if(this.state.InsightIndex>=0&&this.state.InsightIndex<this.state.DialogCount-1){var n={HTMLAttributes:{className:"form-insight-dialog-next-button",onClick:function(){(0,f.$U)("DesignPage.Responses.ClickInsightNextButton",{InsightCount:t.ja.Insights.length,InsightIndex:t.state.InsightIndex}),t.setState({InsightIndex:t.state.InsightIndex+1})}},FluentIcon:"Chevron Right",GlyphButtonStyle:"GlyphOnly",ButtonStyle:1,Text:(0,s.pm)().AnalyzeView_Insight_Next_Insight};return i.createElement("div",{className:"form-insight-head-button"},(0,x.F)(n))}},e.ic=function(){var t=this.state.InsightIndex,n=this.ja.Insights;if(t>=0&&t<n.length)return k({Insight:n[t],Index:t,focusOnInsightDialog:this.$a,setCurrentViewInsight:this.Wa})},e.ec=function(){var t={HTMLAttributes:{onClick:this.props.onClose,className:"form-insight-dialog-close-button"},FluentIcon:"Dismiss",IconClassName:"forms-icon-size16x16",ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",Text:(0,s.pm)().AnalyzeView_Insight_Close_Insight};return(0,x.F)(t)},e.Za=function(){return i.createElement("div",{className:"form-insight-preview-label-container"},i.createElement("div",{className:"form-insight-preview-label"},i.createElement("div",{className:"form-insight-preview-label-text"},(0,s.pm)().Common_Preview_Text)))},e.Wa=function(t){this.ac=t},e.Ja=function(){return this.ac},n}(P.r),L=e(79068),A=e(25038),q=e(97694),O=e(36215),M=e(9743);var U=function(t){function n(n){var e=t.call(this,n)||this;return e.cc=i.createRef(),e.lc=e.lc.bind(e),e.fc=e.fc.bind(e),e.hc=e.hc.bind(e),e.dc=e.dc.bind(e),e}(0,r.ZT)(n,t);var e=n.prototype;return e.componentDidMount=function(){(0,L.s$)()&&this.mc()&&(0,f.$U)("DesignPage.Responses.ShowInsightEntryPoint")},e.insightContent=function(){if(!(0,L.s$)()||(0,o.sv)())return null;if(this.props.AggregationMaster.FormMaster.SyncContext===M.y.AnalysisTimeForm)return null;if(!this.mc())return null;var t=(0,s.pm)().AnalyzeView_Ideas_Button,n={HTMLAttributes:{className:"insight-view-summery-button",onClick:this.dc,onKeyDown:this.fc},ButtonStyle:0,GlyphButtonStyle:"Vertical",FluentIcon:"Flash On",IconClassName:"insight-view-summary-button-icon office-form-theme-primary-foreground",ref:this.cc,Text:t,TextClassName:"insight-view-summary-button-text"};return i.createElement("div",{className:"analyze-view-summary-table analyze-view-insight-container"},i.createElement("div",{className:"analyze-view-summary-container"},(0,x.F)(n)))},e.getAverageTimeProps=function(){return t.prototype.getAverageTimeProps.call(this)},e.lc=function(t){32!==t.keyCode&&13!==t.keyCode||this.props.onClickInsightEntryPoint("TimeDistribution")},e.hc=function(t){this.props.onClickInsightEntryPoint("TimeDistribution")},e.fc=function(t){32!==t.keyCode&&13!==t.keyCode||this.props.onClickInsightEntryPoint("Insights")},e.dc=function(t){var n=this;this.props.onClickInsightEntryPoint("Insights"),(0,E.cz)("ideas-entry-button",(function(){n.cc&&n.cc.current&&n.cc.current.focus()}))},e.mc=function(){var t=this.props,n=t.Form.Model.Questions;if(!(t.AggregationMaster.Model.TotalResponseCount>=10))return!1;var e=!1;if((0,L._I)()&&(e=O.any(n,(function(t){var n=t.QuestionTagForIntelligence;return!!n&&n.indexOf("ScenarioTag")>=0}))),(0,L.s$)()&&!e)return!1;var r=O.filter(n,(function(t){return"Question.Rating"===t.Type})).length,i=O.filter(n,(function(t){return"Question.Choice"===t.Type})).length;return r+i>=4||1===r&&i>=2||e},n}(e(66022).y),V=e(59415);function _(t){return i.createElement(G,(0,r.pi)({},t))}var G=function(t){function n(n){var e=t.call(this,n)||this;e.vc=e.gc.bind(e);var r=e.props.FormMaster.Model;return e.bc=e.bc.bind(e),e.wc=e.wc.bind(e),e.state={LibraryLoaded:!1,DetailDialogQuestionIndex:-1,ShareResultToken:null,InsightDialogOpened:(0,u.f5)().Model.DataIdeas,InsightExploreViewIndex:-1,InsightExploreViewOpened:!1,InsightReady:!1,InsightType:null,ShowPhishingWarningMessage:(0,A.NT)(r.ReputationTier),ShowExcelThrottleDialog:0},e}(0,r.ZT)(n,t);var e=n.prototype;return e.initialize=function(){t.prototype.initialize.call(this),this.yc=new l.t(this.props.FormMaster)},e.registerObservers=function(){t.prototype.registerObservers.call(this),window.addEventListener("message",this.vc,!1)},e.unregisterObservers=function(){t.prototype.unregisterObservers.call(this),window.removeEventListener("message",this.vc)},Object.defineProperty(e,"QuestionClassType",{get:function(){return c.n.Survey},enumerable:!1,configurable:!0}),e.createSummaryPanel=function(){var t,n=this.SummaryPanelProps;return(0,L.s$)()&&this.formInsightMaster&&!this.formInsightMaster.isValidFormScenario()?(0,a.YW)({AggregationMaster:n.AggregationMaster,Form:this.props.FormMaster,InsightMaster:this.formInsightMaster,onDeleteResponses:n.onDeleteResponses,onExportExcel:n.onExportExcel,onPrint:n.onPrint,onCreatePermissionToken:n.onCreatePermissionToken,onDeletePermissionToken:n.onDeletePermissionToken,PermissionToken:n.PermissionToken}):(t={onClickInsightEntryPoint:this.bc,AggregationMaster:n.AggregationMaster,Form:this.props.FormMaster,onDeleteResponses:n.onDeleteResponses,onExportExcel:n.onExportExcel,onPrint:n.onPrint,onCreatePermissionToken:n.onCreatePermissionToken,onDeletePermissionToken:n.onDeletePermissionToken,PermissionToken:n.PermissionToken},i.createElement(U,(0,r.pi)({},t)))},e.createQuestionDetailDialog=function(){var t=this;if(!(0,o.sv)()&&this.state.DetailDialogQuestionIndex>=0){var n={Index:this.state.DetailDialogQuestionIndex,QuestionDetailMaster:this.yc,onClose:function(){t.setState({DetailDialogQuestionIndex:-1},(function(){(0,E.r8)(V.u.name)}))},EnableSubmitLanguage:this.props.FormMaster.Model.LocaleList.length>0};return i.createElement(V.u,(0,r.pi)({},n))}},e.createExtensionReviewContent=function(){if(!(0,o.sv)()){var t=(0,h.E)({HTMLAttributes:{className:"analyze-view-nav-button office-form-theme-button",onClick:this.wc,disabled:0===this.props.FormMaster.Model.ResponsesCount},ButtonStyle:1,Text:(0,s.pm)().AnalyzeView_ViewResultsButton_Label,ref:"view-survey-results-button"});return i.createElement("div",{className:"analyze-view-nav-bar-left-button-container"},t)}},e.onDetailViewLinkClick=function(n){t.prototype.onDetailViewLinkClick.call(this,n),this.yc=new l.t(this.props.FormMaster)},e.createInsightViewContainer=function(){var t,n=this;if(this.state.InsightDialogOpened){var e={FormMaster:this.props.FormMaster,ShowInsight:this.state.InsightType,onClose:function(){return n.Sc()}};return t=e,(0,w.a)().Flighting.isEnabled_Deprecated("FormInsight")?i.createElement(R,(0,r.pi)({},t)):null}},e.Cc=function(t){(0,f.$U)("DesignPage.Responses.ClickInsightEntryPoint",{InsightType:t}),this.setState({InsightDialogOpened:!0,InsightType:t})},e.bc=function(t){this.Cc(t)},e.Sc=function(){this.setState({InsightDialogOpened:!1}),(0,E.r8)("ideas-entry-button"),(0,u.f5)().Model.DataIdeas=!1},e.gc=function(t){var n=this,e="string"==typeof t.data?t.data.toLowerCase():"";if(e.startsWith("formreexporterror:")){if(e.indexOf(5117..toString())>=0){var r={innerCode:5117,type:e.indexOf("expectedfailure")>=0?"ExpectedFailure":"Failure"};this.props.showErrorPage&&this.props.showErrorPage(r)}}else switch(e){case"formreexportsuccess":B("formreexportsuccess");break;case"openinexcelreachvmlimitationthrottle":this.setState({ShowExcelThrottleDialog:3}),window.setTimeout((function(){n.setState({ShowExcelThrottleDialog:0})}),5e3),B();break;case"openinexcelreachownerlimitationthrottle":this.setState({ShowExcelThrottleDialog:2}),B()}},e.wc=function(){(0,o.sv)()?(0,u.uq)().Model.SurveyResults=!0:((0,f.$U)("DesignPage.Responses.ViewResults"),(0,u.f5)().Model.TopView="SurveyResults"),this.FocusRef="view-survey-results-button"},n}(q.K);function B(t){void 0===t&&(t="");var n=(0,u.f5)().Model.FormMaster;n&&(n.Model.XlExportingLocalTag="","formreexportsuccess"===t&&n.Synchronizer.onSourceDataReceived({xlFileUnSynced:!1}))}},48678:function(t,n,e){"use strict";e.d(n,{p:function(){return u}});var r=e(59312),i=e(63804),o=e(5161),s=e(28206),u=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.createQuestionTitleContent=function(){return i.createElement(s.A,{AggregationMaster:this.props.AggregationMaster})},Object.defineProperty(e,"CorrectOptions",{get:function(){return{}},enumerable:!1,configurable:!0}),e.createDisplayElement=function(t){return null},e.shouldShowInsightEntryPoint=function(){return!0},n}(o.m)},54676:function(t,n,e){"use strict";e.d(n,{X:function(){return u}});var r=e(59312),i=e(63804),o=e(70623),s=e(28206),u=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,r.ZT)(n,t),n.prototype.createQuestionTitleContent=function(){return i.createElement(s.A,{AggregationMaster:this.props.AggregationMaster})},n}(o.e)},17202:function(t,n,e){"use strict";e.d(n,{D:function(){return u}});var r=e(59312),i=e(63804),o=e(87335),s=e(28206),u=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,r.ZT)(n,t),n.prototype.createQuestionTitleContent=function(){return i.createElement(s.A,{AggregationMaster:this.props.AggregationMaster})},n}(o.d)},45040:function(t,n,e){"use strict";e.d(n,{Z:function(){return u}});var r=e(59312),i=e(63804),o=e(39436),s=e(28206),u=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,r.ZT)(n,t),n.prototype.createQuestionTitleContent=function(){return i.createElement(s.A,{AggregationMaster:this.props.AggregationMaster})},n}(o.a)},14101:function(t,n,e){"use strict";e.d(n,{R:function(){return u}});var r=e(59312),i=e(63804),o=e(96251),s=e(28206),u=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,r.ZT)(n,t),n.prototype.createQuestionTitleContent=function(){return i.createElement(s.A,{AggregationMaster:this.props.AggregationMaster})},n}(o.T)},28206:function(t,n,e){"use strict";e.d(n,{A:function(){return u}});var r=e(59312),i=e(63804),o=e(64541),s=e(65863),u=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.render=function(){var t=this.QuestionMaster.Model,n=(0,o.wg)(t.Title,t.FormsProRTQuestionTitle);return i.createElement("div",{className:"analzye-view-detail-title"},i.createElement(s.D,{Text:n,RenderMode:"RichText",ContainsHtml:!0}))},Object.defineProperty(e,"QuestionMaster",{get:function(){return this.props.AggregationMaster.QuestionMaster},enumerable:!1,configurable:!0}),n}(e(23112).r)},36048:function(t,n,e){"use strict";e.d(n,{t:function(){return f}});var r=e(59312),i=e(63804),o=e(36215),s=e(26203),u=e(7645),a=e(82741),c=e(11253),l=e(28206),f=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.createQuestionTitleContent=function(){return i.createElement(l.A,{AggregationMaster:this.props.AggregationMaster})},e.createStackedBarControlContainer=function(){var t=s.d.convertToArray(this.props.AggregationMaster.Model.RankingQuestionAggregation);if(t&&t.length>0){for(var n=t.length,e=[(0,u.pm)().AnalyzeView_Sort_First,(0,u.pm)().AnalyzeView_Sort_Second,(0,u.pm)().AnalyzeView_Sort_Third,(0,u.pm)().AnalyzeView_Sort_Fourth,(0,u.pm)().AnalyzeView_Sort_Fifth,(0,u.pm)().AnalyzeView_Sort_Sixth,(0,u.pm)().AnalyzeView_Sort_Seventh,(0,u.pm)().AnalyzeView_Sort_Eighth,(0,u.pm)().AnalyzeView_Sort_Ninth,(0,u.pm)().AnalyzeView_Sort_Tenth],c=(0,u.pm)().AnalyzeView_Chart_Pick,l=[],f=0;f<n;f++)l[f]={label:c.format(e[f]||f+1),data:[]};var h=[],d=t[0].Weight,m=1;o.forEach(t,(function(t,n){d!==t.Weight&&m++,h.push(m),d=t.Weight,o.forEach(t.Statistics,(function(e,r){l[r].data[n]=t.Statistics[r]}))}));var v={Type:1,Labels:t.map((function(t){return t.Name})),Data:l,HasLegend:!0,yLabels:h};return i.createElement(a.Q,(0,r.pi)({},v,{key:"rankingChartControl"}))}},n}(c.U)},83057:function(t,n,e){"use strict";e.d(n,{m:function(){return u}});var r=e(59312),i=e(63804),o=e(42402),s=e(28206),u=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.createQuestionTitleContent=function(){return i.createElement(s.A,{AggregationMaster:this.props.AggregationMaster})},e.shouldShowInsightEntryPoint=function(){return!0},n}(o.K)},59415:function(t,n,e){"use strict";e.d(n,{u:function(){return S}});var r=e(59312),i=e(63804),o=e(27196),s=e(36215),u=e(81620),a=e(18113),c=e(7645),l=e(24209),f=e(90634),h=e(55890),d=e(42605),m=e(41040),v=e(65863),p=e(77309),g=e(71170),b=e(25306),w=e(50434),y=e(23112),I=e(63481),S=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.Nc=s.uniqueId("dd"),n.Tc=n.Nc+"-rs",n.Ia=i.createRef(),n.Fa=i.createRef(),n.Sa=i.createRef(),n.Ca=i.createRef(),n.wo=function(){n.ui&&n.forceUpdate()},n.state={PagingIndex:0,QuestionIndex:-1,ShowErrorMessage:!1,ShowOpenFolderSpinner:!1},n}(0,r.ZT)(n,t);var e=n.prototype;return e.componentWillMount=function(){this.props.QuestionDetailMaster&&(this.props.QuestionDetailMaster.observe(this.wo,[f.t.Schema.Answers,f.t.Schema.IsPagingReady]),this.props.QuestionDetailMaster.syncData(0)),this.setState({QuestionIndex:this.props.Index})},e.componentDidMount=function(){this.ui=!0,this.Ia.current&&this.Ia.current.focus(),(0,I.mZ)(o.findDOMNode(this)),this.Na(),this.Ta()},e.componentDidUpdate=function(){this.Na(),this.Ta()},e.componentWillUnmount=function(){this.props.QuestionDetailMaster&&this.props.QuestionDetailMaster.unobserve(this.wo),this.ui=!1},e.render=function(){var t=this;if(this.props.QuestionDetailMaster&&this.state.QuestionIndex>=0)return i.createElement("div",{className:"response-dialog-container",onKeyDown:function(n){(8===n.keyCode||37===n.keyCode&&n.altKey)&&(n.stopPropagation(),n.preventDefault()),27===n.keyCode&&t.props.onClose&&t.props.onClose()}},this.xa(),this.xc(),this.Pa())},e.xa=function(){var t=this,n=this.props.QuestionDetailMaster.Model.TopLevelQuestions.length;if(this.state.QuestionIndex>0&&this.state.QuestionIndex<n){var e={HTMLAttributes:{className:"response-dialog-previous-button",onClick:function(){(0,h.$U)("DesignPage.Responses.DetailDialogQuestionNavigate",{entry:"PreviouseQuestion"}),t.setState({QuestionIndex:t.state.QuestionIndex-1},(function(){t.Ia.current&&t.Ia.current.focus()}))}},FluentIcon:"Chevron Left",GlyphButtonStyle:"GlyphOnly",ButtonStyle:2,Text:(0,c.pm)().AnalyzeView_DetailResponses_Previous_Button};return(0,d.F)(e)}},e.Pa=function(){var t=this,n=this.props.QuestionDetailMaster.Model.TopLevelQuestions.length;if(this.state.QuestionIndex>=0&&this.state.QuestionIndex<n-1){var e={HTMLAttributes:{className:"response-dialog-next-button",onClick:function(){(0,h.$U)("DesignPage.Responses.DetailDialogQuestionNavigate",{entry:"NextQuestion"}),t.setState({QuestionIndex:t.state.QuestionIndex+1},(function(){t.Ia.current&&t.Ia.current.focus()}))}},FluentIcon:"Chevron Right",GlyphButtonStyle:"GlyphOnly",ButtonStyle:2,Text:(0,c.pm)().AnalyzeView_DetailResponses_Next_Button};return(0,d.F)(e)}},e.xc=function(){var t=(0,c.pm)().AnalyzeView_Detail_DialogTitle.format(this.state.QuestionIndex+1);return i.createElement("div",{"aria-label":t,className:"response-dialog",role:"dialog",ref:this.Ca},i.createElement("div",{ref:this.Sa},this.ec(),this.Pc(),this.Dc()),this.ao(),this.Ec())},e.ec=function(){var t={HTMLAttributes:{onClick:this.props.onClose,className:"response-dialog-close-button"},FluentIcon:"Dismiss",IconClassName:"forms-icon-size16x16",ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",Text:(0,c.pm)().Common_Close_Text,ref:this.Ia,TooltipClassName:"button-tooltip SurveyResponsesDetailDialog-CloseButton"};return(0,d.F)(t)},e.Pc=function(){var t=this.props.QuestionDetailMaster.Model.TopLevelQuestions[this.state.QuestionIndex].Title;return i.createElement("div",{className:"response-dialog-title"},i.createElement(v.D,{Text:(0,c.pm)().AnalyzeView_QuestionTitle.format(this.state.QuestionIndex+1,t),RenderMode:"RichText"}))},e.Dc=function(){var t,n,e=this,r=this.props.QuestionDetailMaster.Model.TopLevelQuestions[this.state.QuestionIndex].Id,o="Question.FileUpload"===this.props.QuestionDetailMaster.getQuestionType(r),s=this.Rc(),u=(0,c.pm)().Common_Responses_Text;if(o&&s.length>0&&(u=(0,c.pm)().UploadFile_Files_DetailPage_Subtitle,t=(0,b.E)({HTMLAttributes:{className:"survey-response-dialog-folder-button office-form-theme-button",disabled:this.state.ShowOpenFolderSpinner,onClick:function(){e.setState({ShowOpenFolderSpinner:!0}),e.props.QuestionDetailMaster.getFileUploadFolder(r).then((function(t){e.ui&&e.setState({ShowOpenFolderSpinner:!1}),(0,h.$U)("DesignPage.Responses.OpenFileFolder"),(0,l.K)(t)})).catch((function(t){t&&t.response&&404===t.response.statusCode&&e.setState({ShowErrorMessage:!0,ShowOpenFolderSpinner:!1})}))}},ButtonStyle:1,Text:(0,c.pm)().UploadFile_OpenFolder_Button}),n=this.state.ShowErrorMessage&&i.createElement("div",{className:"response-dialog-folder-button-error-message"},(0,c.pm)().UploadFile_FolderNotExist_ErrorMessage)),this.props.QuestionDetailMaster.getAnswersCount()<this.props.QuestionDetailMaster.Model.PagingSize)return s.length>0?i.createElement("div",null,i.createElement("div",{className:"survey-response-dialog-summary"},i.createElement("div",{className:"survey-response-dialog-container",id:this.Tc},i.createElement("span",{className:"survey-response-dialog-response-count office-form-theme-primary-foreground"},s.length),u),i.createElement("div",null,t,this.Lc())),n):void 0;var a=this.props.QuestionDetailMaster.getPagingRegion(this.state.PagingIndex),f=a.Start.toString(),d=a.End.toString(),m=this.props.QuestionDetailMaster.getAnswersCount().toString();return i.createElement("div",{className:"survey-response-dialog-paging-summary"},i.createElement("div",{className:"survey-response-dialog-paging-info-container",id:this.Tc},i.createElement("span",{className:"survey-response-dialog-region-info"},(0,c.pm)().AnalyzeView_DetailResponses_PagingRegion_Message.format(f,d)),i.createElement("span",{className:"survey-response-dialog-region-separator"},"|"),m),this.Ac(),this.qc())},e.Lc=function(){if(this.state.ShowOpenFolderSpinner){return i.createElement("div",{className:"open-folder-spinner"},i.createElement("div",{className:"common-spinner-circle"},i.createElement(p.L,{HTMLAttributes:{className:"screenReaderVisible"},LazyRendering:!0,Role:"Log"},(0,c.pm)().Design_Page_Open_OneDrive_Folder)))}},e.Ec=function(){if(this.Oc()){var t=(0,c.pm)().AnalyzeView_Detail_DialogTitle.format(this.state.QuestionIndex+1);return i.createElement("div",{className:"response-dialog-content",ref:this.Fa},i.createElement("div",{className:"response-dialog-table-container"},i.createElement("table",{"aria-label":t,"aria-describedby":this.Tc,className:"response-dialog-table hover stripe cell-border"})))}return i.createElement("div",{className:"response-dialog-no-responses-message"},(0,c.pm)().AnalyzeView_DetailResponses_NoResponses_Message)},e.Ta=function(){if(this.Oc()){var t=$(this.Ca.current).height()-$(this.Sa.current).outerHeight(!0);$(this.Fa.current).outerHeight(t)}},e.Ac=function(){var t=this,n={className:"question-detail-page-previous-button",disabled:0===this.state.PagingIndex,onClick:function(){t.state.PagingIndex>0&&((0,h.$U)("DesignPage.Responses.DetailDialogPaging",{entry:"PreviousPage"}),t.props.QuestionDetailMaster.SyncPreviousPageData(),t.setState({PagingIndex:t.state.PagingIndex-1}))}};return(0,d.F)({ButtonStyle:2,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:n,FluentIcon:"Chevron Left",Text:(0,c.pm)().AnalyzeView_DetailResponses_PreviousPage})},e.qc=function(){var t=this,n=this.props.QuestionDetailMaster.Model.PagingSize,e=this.props.QuestionDetailMaster.getAnswersCount(),r=(this.state.PagingIndex+1)*n>=e,i={className:"question-detail-page-next-button",disabled:r,onClick:function(){t.state.PagingIndex>=0&&!r&&((0,h.$U)("DesignPage.Responses.DetailDialogPaging",{entry:"NextPage"}),t.props.QuestionDetailMaster.SyncNextPageData(),t.setState({PagingIndex:t.state.PagingIndex+1}))}};return(0,d.F)({ButtonStyle:2,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:i,FluentIcon:"Chevron Right",Text:(0,c.pm)().AnalyzeView_DetailResponses_NextPage})},e.ao=function(){if(this.Oc()&&!this.props.QuestionDetailMaster.Model.IsPagingReady){this.Mc();var t={ClassName:"survey-reponse-detail-loading-container survery-response-more-detail-message-container",LoadingDescription:(0,c.pm)().Common_Loading_Text};return i.createElement(m.P,(0,r.pi)({},t))}},e.Oc=function(){return this.props.QuestionDetailMaster.getAnswersCount()>0},e.Na=function(){if(this.Oc()&&this.props.QuestionDetailMaster.Model.IsPagingReady){this.Mc();var t=this.props.QuestionDetailMaster.Model.TopLevelQuestions[this.state.QuestionIndex].Id;this.Uc=$(".response-dialog-table").DataTable({data:this.Vc(t),columns:this.Ea(t),columnDefs:[{targets:2,createdCell:function(t){$(t).attr("aria-disabled","true")}}],searching:!1,paging:!1,info:!1,autoWidth:!0})}},e.Ea=function(t){var n=[(0,c.pm)().AnalyzeView_Sort_First,(0,c.pm)().AnalyzeView_Sort_Second,(0,c.pm)().AnalyzeView_Sort_Third,(0,c.pm)().AnalyzeView_Sort_Fourth,(0,c.pm)().AnalyzeView_Sort_Fifth,(0,c.pm)().AnalyzeView_Sort_Sixth,(0,c.pm)().AnalyzeView_Sort_Seventh,(0,c.pm)().AnalyzeView_Sort_Eighth,(0,c.pm)().AnalyzeView_Sort_Ninth,(0,c.pm)().AnalyzeView_Sort_Tenth],e=[(0,c.pm)().Common_Responses_Text],r=[{title:(0,c.pm)().AnalyzeView_Response_ID},{title:(0,c.pm)().AnalyzeView_ExcelHeader_ResponderName}];this.props.EnableSubmitLanguage&&r.push({title:(0,c.pm)().AnalyzeView_ExcelHeader_Language});var i=[],o=this.props.QuestionDetailMaster.getAnswerColumnCount(t),u=60/o+"%";switch(this.props.QuestionDetailMaster.getQuestionType(t)){case"Question.Ranking":$(".response-dialog-table").addClass("response-dialog-table-ranking"),i=s.first(n,o);break;case"Question.MatrixChoiceGroup":$(".response-dialog-table").removeClass("response-dialog-table-ranking");for(var a=1;a<o;a++)e.push("");i=e;break;case"Question.NPS":$(".response-dialog-table").removeClass("response-dialog-table-ranking"),i=[(0,c.pm)().AnalyzeView_NPS_Score,(0,c.pm)().AnalyzeView_NPS_Category];break;default:i=e}return i=s.map(i,(function(t){return{title:t,width:u}})),r.concat(i)},e.Vc=function(t){var n,e=this,r=this.props.QuestionDetailMaster.getPagingRegion(this.state.PagingIndex).Start,i=this.Rc();switch(this.props.QuestionDetailMaster.getQuestionType(t)){case"Question.Ranking":n=s.map(i,(function(t,n){return e._c(r+n,t).concat(JSON.parse(t.Answer).map((function(t){return e.Gc(t)})))}));break;case"Question.MatrixChoiceGroup":n=s.map(i,(function(t,n){return e._c(r+n,t).concat(t.Answer.map((function(t){return e.Gc(t)})))}));var o=s.filter(this.props.QuestionDetailMaster.Model.Questions,(function(n){return n.GroupId===t})),u=s.map(o,(function(t){return e.Gc(t.Title)}));this.props.EnableSubmitLanguage?n.length&&n.splice(0,0,["","",""].concat(u)):n.length&&n.splice(0,0,["",""].concat(u));break;case"Question.NPS":n=s.map(i,(function(t,n){var i=t.Answer;return e._c(r+n,t).concat([i,(0,g.J)(i)])}));break;case"Question.FileUpload":n=[],s.forEach(i,(function(t,i){if(t.Answer){var o=JSON.parse(t.Answer);if(o.length>0){var s=o,u=e._c(r+i,t),a="";s.forEach((function(t,n){var r=(0,w.UV)(t.name),i=e.Bc(t.name),o=t.link.split('"')[0];n+1!==s.length?a+=r+'<a href="'+o+'" target="_blank" class="response-dialog-fileName">'+i+"</a></br>":a+=r+'<a href="'+o+'" target="_blank" class="response-dialog-fileName">'+i+"</a>"})),n.push(u.concat(a))}}}));break;default:n=s.map(i,(function(t,n){return e._c(r+n,t).concat([e.Gc(t.Answer)])}))}return n},e.Bc=function(t){return t&&(0,u.F1)(""+t,!0)},e._c=function(t,n){var e=[t,this.Bc(n.ResponderName)];return this.props.EnableSubmitLanguage&&(e=e.concat(n.Language)),e},e.Mc=function(){this.Uc&&(this.Uc.destroy(),this.Uc=void 0,$(".response-dialog-table").empty())},e.Gc=function(t){return(0,a.ZP)(t)},e.Rc=function(){var t=this.props.QuestionDetailMaster.Model.TopLevelQuestions[this.state.QuestionIndex],n=t?t.Id:void 0;if("Question.MatrixChoiceGroup"===t.Type){var e=s.pluck(s.filter(this.props.QuestionDetailMaster.Model.Questions,(function(t){return t.GroupId===n})),"Id");return this.props.QuestionDetailMaster.getQuestionsAnswers(e)}return this.props.QuestionDetailMaster.getQuestionAnswers(n)},n}(y.r)},92834:function(t,n,e){"use strict";e.d(n,{h:function(){return u}});var r=e(59312),i=e(63804),o=e(21163),s=e(28206),u=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.createQuestionTitleContent=function(){return i.createElement(s.A,{AggregationMaster:this.props.AggregationMaster})},e.shouldShowInsightEntryPoint=function(){return!0},n}(o.a)},21163:function(t,n,e){"use strict";e.d(n,{a:function(){return d}});var r=e(59312),i=e(63804),o=e(36215),s=e(72377),u=e(26203),a=e(55411),c=e(7645),l=e(22768),f=e(79608),h=e(35230),d=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.getPreviewImageName=function(){return"text.png"},e.createQuestionViewContent=function(){return[this.createResponsesCountLabel(),this.createLatestTextsView()]},e.createResponsesCountLabel=function(){var t={Data:this.props.AggregationMaster.Model.TextQuestionAggregation.ResponseCount,Description:(0,c.pm)().Common_Responses_Text,Ignorable:!1,IsReady:!0,AccessibilityText:(0,c.pm)().AnalyzeView_NumberOfResponses_AccessibilityLabel.format(this.props.AggregationMaster.Model.TextQuestionAggregation.ResponseCount)};return i.createElement(h.V,(0,r.pi)({},t,{key:"responseCount"}))},e.createLatestTextsView=function(){var t=this.props.AggregationMaster.Model.TextQuestionAggregation.ResponseCount,n=(0,a.sv)()&&t>0&&s.Pv.Resolve("IMobileDesignPageUXFactory").createMobileResponseDetailEntrance(this.props.onShowQuestionDetail);return i.createElement("div",{className:"survey-analyze-view-detail-text-recent",key:"latestResponses"},i.createElement("a",{className:"screenReaderVisible",role:"presentation"},""+(0,c.pm)().Analyze_View_Text_Recent_Responses+this.zc),i.createElement("div",{"aria-hidden":!0,className:"analyze-view-summary-status-label"},(0,c.pm)().Analyze_View_Text_Recent_Responses),this.au(),n)},e.au=function(){var t=this,n=u.d.convertToArray(this.props.AggregationMaster.Model.TextQuestionAggregation.TopAnswers);return this.zc="",o.map(n,(function(n,e){if(!(t.props.AggregationMaster.Model.IsMathQuestion&&n.Answer.length>120)){if(n.IsMath){var r=(0,l.Rq)({Formula:'"'+n.Answer+'"'});return t.zc=t.zc+" ."+r,i.createElement("div",{"aria-hidden":!0,className:"analyze-view-detail-text-lines",key:e},r)}return t.zc=t.zc+' ."'+n.Answer+'"',i.createElement("div",{"aria-hidden":!0,className:"analyze-view-detail-text-lines",key:e},'"'+n.Answer+'"')}}))},n}(f.E)},93387:function(t,n,e){"use strict";e.d(n,{ax:function(){return l},zx:function(){return f}});var r=e(59312),i=e(63804),o=e(29559),s=e(262),u=e(65274),a=e(88744),c=e(23112);function l(t){return i.createElement(f,(0,r.pi)({},t))}var f=function(t){function n(n){var e=t.call(this,n)||this;return e.Ne=(0,u.EL)("b"),e.Qc=i.createRef(),e.Hc=0,e.state={ShowTooltip:!1},e.jc=e.jc.bind(e),e}(0,r.ZT)(n,t);var e=n.prototype;return e.componentWillUnmount=function(){window.clearTimeout(this.Hc)},e.componentDidUpdate=function(){var t=this.Qc.current;if(this.state.ShowTooltip&&t){var n=t.getBoundingClientRect(),e=this.getHtmlElement();if(n.right>window.innerWidth){var r=e.getBoundingClientRect();t.style.left="auto",t.style.right=(0,o.tq)()?window.innerWidth-r.right+"px":r.right-window.innerWidth+"px"}n.bottom>window.innerHeight&&(t.style.bottom=e.clientHeight+"px")}},e.render=function(){var t=this,n=(0,u.l7)({},this.props.HTMLAttributes);switch(n.className=(0,s.j)(n.className,"button-control"),n["aria-pressed"]=this.props.ToggleActive,this.props.ToggleActive&&(n.className=(0,s.j)(n.className,"active")),this.props.ButtonStyle){case 1:n.className=(0,s.j)(n.className,"light-background-button");break;case 2:n.className=(0,s.j)(n.className,"dark-background-button")}var e=null,o=this.props.Tooltip,c=n.title;if(o||c){var l=void 0;c&&c!==o&&(l=i.createElement("span",{key:"s"},c));var f=void 0;if(o){var d=void 0;n["aria-label"]===o||n["aria-describedby"]||(d=this.Ne+"-tooltip",n["aria-describedby"]=d),f=i.createElement("span",{id:d,key:"t"},o)}var m=void 0;m=this.state.ShowTooltip?this.props.TooltipClassName||"button-tooltip":"screenReaderReference",e=i.createElement("div",{className:m,key:"t",onClick:h,ref:this.Qc},l,f),n.title=void 0,n.onKeyUp=(0,a.F)(n.onKeyUp,this.jc),n.onFocus=(0,a.F)(n.onFocus,(function(){return t.$c(!0)})),n.onMouseOver=(0,a.F)(n.onMouseOver,(function(){return t.$c(!0)})),n.onBlur=(0,a.F)(n.onBlur,(function(){return t.$c(!1)})),n.onMouseOut=(0,a.F)(n.onMouseOut,(function(){return t.$c(!1)}))}return i.createElement("button",(0,r.pi)({},n),i.createElement("div",{className:"button-content"},this.props.children),e)},e.focus=function(){this.getHtmlElement().focus()},e.jc=function(t){this.state.ShowTooltip&&27===t.keyCode&&(t.stopPropagation(),this.setState({ShowTooltip:!1}))},e.$c=function(t){var n=this;window.clearTimeout(this.Hc),this.state.ShowTooltip!==t&&(this.Hc=window.setTimeout((function(){n.setState({ShowTooltip:t}),n.Hc=0}),t?500:300))},n}(c.r);function h(t){t.stopPropagation()}},45142:function(t,n,e){"use strict";e.d(n,{r:function(){return m}});var r=e(59312),i=e(63804),o=e(27196),s=e(36215),u=e(35705),a=e(29559),c=e(7645),l=e(64541),f=e(3424),h=e(65863);function d(t,n){return s.isEqual(t.labelName,n.labelName)&&s.isEqual(t.lableClass,n.lableClass)&&s.isEqual(t.labelData,n.labelData)}var m=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.Wc=[],n}(0,r.ZT)(n,t);var e=n.prototype;return e.render=function(){return this.cu()?i.createElement("div",{"aria-label":(0,c.pm)().ChartControl_GroupContainer,className:"chart-control-container"},this.fu(),this.du()):null},e.componentDidMount=function(){this.vu()},e.shouldComponentUpdate=function(t){return!function(t,n){if(!(s.isEqual(t.Animation,n.Animation)&&s.isEqual(t.Data,n.Data)&&s.isEqual(t.HasLegend,n.HasLegend)&&s.isEqual(t.TagLabels,n.TagLabels)&&s.isEqual(t.Type,n.Type)))return!1;if(!t.Labels&&!n.Labels)return!0;if(t.Labels&&n.Labels&&t.Labels.length===n.Labels.length){for(var e=0;e<t.Labels.length;e++)if(!d(t.Labels[e],n.Labels[e]))return!1;return!0}return!1}(this.props,t)||!this.pu},e.componentDidUpdate=function(){this.vu()},e.componentWillUnmount=function(){this.gu()},e.cu=function(){return this.props.Labels&&this.props.Data&&this.props.Labels.length===this.props.Data.data.length&&this.props.Labels.length>0},e.gu=function(){this.bu&&(this.bu.destroy(),this.bu=null)},e.vu=function(){if(this.cu()){var t=o.findDOMNode(this.refs.canvas);if(this.pu=$(t).is(":visible"),this.pu){var n=t.getContext("2d");if(n)switch(this.Jc(),this.props.Type){case 0:this.Xc(n),this.yu();break;case 1:this.Yc(n),this.yu()}}}},e.Zc=function(){if(this.props.Labels)return this.props.Labels.map((function(t,n){return null!=t.labelName?(0,l.Mw)(t.labelName,!0):(0,c.pm)().Designer_Choices_DefaultDescription.format(n+1)}))},e.Xc=function(t){var n="'Segoe UI','Segoe WP',Tahoma, Arial, sans-serif",e={responsive:!1,layout:{padding:{left:10}},animation:{duration:1e3},scales:{yAxes:[{ticks:{fontSize:10,min:0,fontFamily:n,fontColor:"#000000",callback:function(t){if(+t%1==0)return t}}}],xAxes:[{ticks:{fontSize:10,fontFamily:n,fontColor:"#000000",callback:function(){return""}}}]},legend:{display:!1}};this.gu(),this.bu=new Chart(t,{type:"bar",data:this.tl(),options:e})},e.Jc=function(){var t=this;this.Nu=this.props.Data.data.map((function(n,e){var r=(0,u.L)(e);return t.Wc.push(t.Tu(r,10)),r}))},e.tl=function(){return{labels:this.Zc(),datasets:[{backgroundColor:this.Nu,data:this.props.Data.data,hoverBackgroundColor:this.Wc}]}},e.Yc=function(t){var n={responsive:!1,animation:{duration:1e3},cutoutPercentage:0,tooltips:{callbacks:{label:function(t,n){return n.labels[t.index]+": "+n.datasets[t.datasetIndex].data[t.index]+" ("+Math.round(this._active[0]._view.circumference/6.283*100)+"%)"}}},legend:{display:!1}};this.gu(),this.bu=new Chart(t,{type:"pie",data:this.tl(),options:n})},e.Tu=function(t,n){var e=parseInt(t.slice(1),16),r=Math.round(2.55*n),i=(e>>16)+r,o=(e>>8&255)+r,s=(255&e)+r;return"#"+(16777216+65536*(i<255?i<1?0:i:255)+256*(o<255?o<1?0:o:255)+(s<255?s<1?0:s:255)).toString(16).slice(1)},e.yu=function(){var t=this;if(this.props.HasLegend){var n=o.findDOMNode(this.refs["legend-table"]),e=o.findDOMNode(this.refs["legend-table-tbody"]).childNodes;e&&e.length>0&&(s.each(e,(function(n,e){Chart.helpers.addEvent(n,"mouseover",(function(){t.ku("mouseover",e)}));var r=n.getElementsByClassName("chart-control-legend-canvas-color");if(r){var i=r[0].getContext("2d");i.fillStyle=t.bu.data.datasets[0].backgroundColor[e],i.beginPath(),i.arc(7.5,7.5,7.5,0,2*Math.PI,!0),i.closePath(),i.fill()}})),Chart.helpers.addEvent(n,"mouseout",(function(){t.ku("mouseout",0)})))}},e.ku=function(t,n){var e=this.bu.getDatasetMeta&&this.bu.getDatasetMeta(0)&&this.bu.getDatasetMeta(0).data[n];this.bu.active=e&&"mouseout"===t?[]:[e],this.bu.lastActive=this.bu.lastActive||[],this.bu.lastActive.length&&this.bu.updateHoverStyle(this.bu.lastActive,this.bu.options.hover.mode,!1),this.bu.active.length&&this.bu.updateHoverStyle(this.bu.active,this.bu.options.hover.mode,!0);var r=!Chart.helpers.arrayEquals(this.bu.active,this.bu.lastActive);if(r){this.bu.lastActive=this.bu.active;var i=this.bu.tooltip;i._active=this.bu.active,i._lastActive=i._lastActive||[],i.update(!0),i.pivot();var o=this.bu._bufferedRequest;o?this.bu.render(o.duration,o.lazy):r&&!this.bu.animating&&(this.bu.stop(),this.bu.render(this.bu.options.hover.animationDuration,!0)),this.bu._bufferedRender=!1,this.bu._bufferedRequest=null}},e.fu=function(){var t=this;if(this.props.HasLegend){return i.createElement("div",{"aria-label":(0,c.pm)().ChartControl_LegendGroup,className:"chart-control-legend",tabIndex:-1},i.createElement("table",{className:"chart-control-legend-table",ref:"legend-table"},i.createElement("tbody",{ref:"legend-table-tbody",role:"list"},this.props.Labels.map((function(n,e){var r=n.labelName+". "+(0,c.pm)().AnalyzeView_NumberOfResponses_AccessibilityLabel.format(n.labelData);return t.props.TagLabels[n.labelName]&&(r=(0,c.pm)().Common_Labels_CommaSeparated.format(r,(0,c.pm)().Quiz_CorrectAnswer)),i.createElement("tr",{className:"chart-control-legend-table-row "+n.lableClass,key:e,role:"listitem","aria-label":r},i.createElement("td",{role:"presentation"},i.createElement("canvas",{role:"presentation",className:"chart-control-legend-canvas-color",width:"15px",height:"15px"})),i.createElement("td",{"aria-hidden":!0,role:"presentation",className:"chart-control-legend-label"},null!=n.displayElement?n.displayElement:i.createElement(h.D,{Text:n.labelName,RenderMode:"RichText",ContainsHtml:!0})),i.createElement("td",{className:"chart-control-legend-value",onClick:n.onClick},n.labelData,n.onClick&&i.createElement("span",{"aria-hidden":!0}," >")),t.nl(n.labelName))})))))}},e.du=function(){var t,n=(0,a.fM)()<400||(0,a.tq)(),e=n?187:250,o=n?300:400;return t=0===this.props.Type?{className:"chart-control-canvas",width:o,height:e,ref:"canvas","aria-label":(0,c.pm)().ChartControl_AriaLabel}:{className:"",width:300,height:150,ref:"canvas","aria-label":(0,c.pm)().ChartControl_AriaLabel},i.createElement("div",(0,r.pi)({},{className:"chart-control",tabIndex:-1}),i.createElement("canvas",(0,r.pi)({},t)))},e.nl=function(t){var n;return this.props.TagLabels[t]&&(n=i.createElement(f.F,{FluentIcon:"Checkmark",HTMLAttributes:{className:"forms-icon-size14x14"}})),i.createElement("td",(0,r.pi)({},{role:"presentation",className:"chart-control-legend-table-correct"}),n)},n}(e(23112).r)},74302:function(t,n,e){"use strict";e.d(n,{i:function(){return u}});var r=e(59312),i=e(63804),o=e(36215),s=e(262),u=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.render=function(){var t=o.extend({},this.props.HTMLAttributes);return this.props.ValidationStyle&&(t.className=(0,s.j)(t.className,this.props.ValidationStyle)),this.props.Hidden&&(t.style=t.style||{},t.style.display="none"),i.createElement("div",t,this.createReactNodes())},e.createReactNodes=function(){throw Error("to be overridden.")},n}(i.Component)},35929:function(t,n,e){"use strict";e.d(n,{R:function(){return o}});var r=e(59312),i=e(63804),o=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,r.ZT)(n,t),n.prototype.render=function(){return i.createElement("span",{className:"required-star"})},n}(e(23112).r)},3424:function(t,n,e){"use strict";e.d(n,{M:function(){return u},F:function(){return a}});var r=e(59312),i=e(63804),o=e(262),s=e(65274);function u(t){return i.createElement(a,(0,r.pi)({},t))}var a=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,r.ZT)(n,t),n.prototype.render=function(){var t=(0,s.d9)(this.props.HTMLAttributes)||{};if(this.props.FluentIcon){var n=this.props.FluentIcon.replaceAll(" ","");t.className=(0,o.j)("ff-icon ff-icon-"+n,this.props.className,t.className)}else t.className=(0,o.j)("ms-Icon",this.props.IconName?"ms-Icon--"+this.props.IconName:"",this.props.className,t.className);return this.props.Accessible||(t.role="presentation",t["aria-hidden"]="true"),i.createElement("i",(0,r.pi)({},t))},n}(e(23112).r)},42605:function(t,n,e){"use strict";e.d(n,{F:function(){return c}});var r=e(59312),i=e(63804),o=e(36215),s=e(262),u=e(93387),a=e(3424);function c(t){var n,e,c=o.clone(t)||{},l=o.clone(c.HTMLAttributes)||{};switch(c.HTMLAttributes=l,t.GlyphButtonStyle){case 1:case"Vertical":l.className=(0,s.j)(l.className,"glyph-button-control-vertical");break;case 2:case"GlyphOnly":case 0:case"Horizontal":default:l.className=(0,s.j)(l.className,"glyph-button-control-horizontal")}if(l["aria-label"]=l["aria-label"]||t.Text,t.Icon||t.FluentIcon){var f={FluentIcon:t.FluentIcon,HTMLAttributes:{className:t.IconClassName},IconName:t.Icon,key:"icon"};n=i.createElement(a.F,(0,r.pi)({},f))}switch("GlyphOnly"!==t.GlyphButtonStyle&&2!==t.GlyphButtonStyle?e=i.createElement("span",{className:t.TextClassName,key:"text"},t.Text):t.Text&&(c.Tooltip=c.Tooltip||t.Text,c.Tooltip!==t.Text&&(l.title=t.Text)),t.GlyphLocation){case 1:case"Right":c.children=[e,t.children,n];break;case 0:default:c.children=[n,e,t.children]}return(0,u.ax)(c)}},17764:function(t,n,e){"use strict";e.d(n,{_:function(){return c}});var r=e(59312),i=e(63804),o=e(65863),s=e(74302),u=e(35929),a=e(3424);function c(t){return i.createElement(l,t)}var l=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.el=!1,n.ui=!1,n}(0,r.ZT)(n,t);var e=n.prototype;return e.componentDidMount=function(){var t=this;this.ui=!0,this.el||window.setTimeout((function(){t.el=!0,t.ui&&t.forceUpdate()}))},e.componentWillUnmount=function(){this.ui=!1},e.createReactNodes=function(){var t,n=this.props,e=n.ShowRequiredStar?i.createElement(u.R):void 0,r=n.ShowOrdinal?i.createElement("span",{className:"ordinal-number",key:"ordinalNumber"},this.props.Ordinal+"."):void 0;n.Alert&&!this.el||(t=(0,o.q)({ContainsHtml:!!n.HtmlContent,Text:n.Label,RenderMode:"RichText"}));var s=n.ShowWarningIcon&&(0,a.M)({FluentIcon:"Error Circle",HTMLAttributes:{className:"forms-icon-size20x20 warning-icon-style",title:n.WarningIconTooltip},Accessible:!0});return n.Bold?i.createElement(i.Fragment,{},i.createElement("b",void 0,r,t,e),n.children):i.createElement(i.Fragment,{},r,t,e,s,n.children)},n}(s.i)},41040:function(t,n,e){"use strict";e.d(n,{P:function(){return s}});var r=e(59312),i=e(63804),o=e(262),s=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.render=function(){var t=this.props.Ignorable?(0,o.j)(this.props.ClassName,"optional-cell"):this.props.ClassName;return i.createElement("div",{className:t},i.createElement("div",{className:"common-spinner-circle"}),this.il())},e.il=function(){if(this.props.LoadingDescription)return i.createElement("div",{className:"loading-control-description",role:"status"},this.props.LoadingDescription)},n}(e(23112).r)},48280:function(t,n,e){"use strict";e.d(n,{Th:function(){return d}});var r=e(59312),i=e(63804),o=e(36215),s=e(262),u=e(38174),a=e(54496),c=e(64290),l=e(3424),f=e(23112),h=e(93387);var d=function(t){function n(n){var e=t.call(this,n)||this;return e.ol=i.createRef(),e.ul=i.createRef(),e.al=i.createRef(),e.cl=null,e.ll=null,e.fl=!1,e.dl=null,e.ml=o.uniqueId("menu"),e.vl=!e.props.SubMenu,e.state={MenuExpanded:!1,DisableButtonFocused:!1},e.pl=e.pl.bind(e),e.gl=e.gl.bind(e),e.bl=e.bl.bind(e),e.wl=e.wl.bind(e),e.yl=e.yl.bind(e),e.Il=e.Il.bind(e),e.Sl=e.Sl.bind(e),e.Cl=e.Cl.bind(e),e.Fl=e.Fl.bind(e),e.Nl=e.Nl.bind(e),e}(0,r.ZT)(n,t);var e=n.prototype;return e.componentWillReceiveProps=function(t){t.Reset&&(this.setState({MenuExpanded:!1}),t.onMenuReset&&t.onMenuReset(),this.focus())},e.componentDidMount=function(){window.addEventListener("resize",this.yl)},e.componentDidUpdate=function(t,n){var e=this;!this.state.MenuExpanded&&this.fl&&(this.focus(),this.fl=!1),!n.MenuExpanded&&this.state.MenuExpanded&&(this.props.DisableAdjustPopupPosition||this.xl(),setTimeout((function(){var t;e.Pl(null===(t=e.Dl())||void 0===t?void 0:t[0])}),0),this.props.onMenuExpand&&this.props.onMenuExpand()),n.MenuExpanded&&!this.state.MenuExpanded&&(this.dl=null,this.props.onMenuCollapse&&this.props.onMenuCollapse())},e.componentWillUnmount=function(){window.removeEventListener("resize",this.yl),this.cl&&window.clearTimeout(this.cl),this.ll&&window.clearTimeout(this.ll)},e.render=function(){var t,n=(0,s.j)(this.props.ClassNameForContainer,"menu-control-dropup");return(t=this.El()).ref=this.ul,this.props.SubMenu?t.className=(0,s.j)(t.className,n):t={className:n},i.createElement("div",(0,r.pi)({},t),this.Rl(),this.Ll())},n.setReservedWidthToRight=function(t){n.reservedWidthToRight=t},e.yl=function(){var t=this;this.cl||(this.cl=window.setTimeout((function(){t.cl=null,t.xl()}),100))},e.focus=function(){var t=this.props.SubMenu?this.ul.current:this.ol.current;t&&!this.state.MenuExpanded&&t.focus()},e.Pl=function(t){t&&t.focus()},e.Al=function(t){this.fl=this.state.MenuExpanded&&!!t,this.setState({MenuExpanded:!this.state.MenuExpanded})},e.Nl=function(){this.setState({MenuExpanded:!1})},e.Rl=function(){return this.props.SubMenu?this.props.HTMLAttributes.children:(0,h.ax)({HTMLAttributes:this.El(),TooltipClassName:this.props.TooltipClassName,ButtonStyle:this.props.ButtonStyle,children:this.props.HTMLAttributes.children,ref:this.ol})},e.Cl=function(t){this.props.SubMenu&&this.props.setSelectedElement(t.currentTarget),this.props.onButtonFocus&&this.props.onButtonFocus()},e.El=function(){var t={tabIndex:this.props.SubMenu?-1:0,autoFocus:this.props.AutoFocused,"aria-expanded":this.state.MenuExpanded,"aria-haspopup":!0,"aria-disabled":this.props.Disabled,"aria-controls":this.state.MenuExpanded?this.ml:void 0,className:"menu-control-trigger"};return this.props.Disabled||(t=o.extend(t,{onClick:this.Fl,onFocus:this.Cl,onKeyDown:this.bl})),(0,a.p2)(t,this.props.HTMLAttributes)},e.ql=function(t){switch(t){case 0:return"menuitem";case 2:return"menuitemradio";case 1:default:return"menuitemcheckbox"}},e.gl=function(t){var n=this;t.stopPropagation();var e=(0,u.y3)(t);if(this.props.SubMenu){var r=this.props.Root.current;if(!r||!r.contains(e))return void(this.ll=window.setTimeout((function(){n.ll=null,n.props.collapseRootMenu()}),150))}var i=this.al.current;i&&i.contains(e)||(this.ll=window.setTimeout((function(){n.ll=null,n.Nl()}),150))},e.Ml=function(t,n,e){var o=this,u=!!t.IsDisabled,a=function(){if(!u)return t.onExecute()},c={"aria-disabled":u,className:(0,s.j)("separator",u?"menu-item-disabled highContrast-text-disabled":"menu-item-active",t.Checked?"checked":""),key:t.Key,"aria-setsize":e,"aria-posinset":n+1,onFocus:this.Il,title:t.Title,role:this.ql(this.props.MenuItemType),tabIndex:u?void 0:-1,onClick:function(){o.Al(!a())},onBlur:this.gl,onKeyDown:function(t){return o.Ul(t,a)}};0!==this.props.MenuItemType&&(c["aria-checked"]=t.Checked);var f=t.Checked?i.createElement(l.F,(0,r.pi)({},{FluentIcon:"Checkmark",HTMLAttributes:{className:"forms-icon-size18x18 question-menu-check-icon"}})):void 0;return i.createElement("li",(0,r.pi)({},c),f,i.createElement("span",null,t.Description))},e.Vl=function(){var t=this,n=[],e=this.props.UnorderListMenuItems,o=!1;if(e){var u=e.filter((function(t){return!!t}));u.forEach((function(e,r){n.push(t.Ml(e,r,u.length)),o=o||e.Checked}))}var a={className:(0,s.j)("menu-control-options-box",this.props.ClassName),id:this.ml,ref:this.al,role:"menubar",tabIndex:-1,onBlur:this.gl,onKeyUp:this.wl},c=(0,s.j)("menu-control-options-content","menu-control","border-no-radius",o?"checked":"");return i.createElement("div",(0,r.pi)({},a),i.createElement("ul",{className:c,role:"presentation"},n))},e._l=function(){var t=this.Gl(),n={"aria-label":this.props.AriaLabel||"",className:(0,s.j)("menu-control-options-box",this.props.ClassName),id:this.ml,ref:this.al,role:"menu",tabIndex:-1,onKeyUp:this.wl,onBlur:this.gl,style:this.vl?{overflowY:"auto"}:void 0};return i.createElement("div",(0,r.pi)({},n),i.createElement("div",{className:"menu-control-options-content"},t))},e.Gl=function(){var t=this,e=i.Children.toArray(this.props.children).filter((function(t){return t.props.Active})).length,r=0;return i.Children.map(this.props.children,(function(u,l){u=i.Children.only(u);var f=o.clone(u.props);if(f.Active){var h=t.ql(t.props.MenuItemType),d=o.extend({key:l.toString(),"aria-disabled":f.Disabled,"aria-posinset":++r,"aria-setsize":e,role:h,tabIndex:-1},f.HTMLAttributes);return f.Disabled?d.className=(0,s.j)(d.className,"menu-item-disabled highContrast-text-disabled"):d.className=(0,s.j)(d.className,"menu-item-active"),f.SubMenu?(t.vl=!1,i.createElement(n,{AriaLabel:t.props.AriaLabelForSubmenu,MenuItemType:t.props.MenuItemType,SubMenu:!0,Disabled:f.Disabled,TooltipClassName:t.props.TooltipClassName,setSelectedElement:t.Sl,HTMLAttributes:d,collapseRootMenu:t.props.collapseRootMenu||t.Nl,Root:t.props.Root||t.al},f.children)):(d=f.Disabled?(0,a.p2)(d,{onFocus:function(n){t.dl=n.currentTarget,t.state.MenuExpanded&&t.props.onMenuItemMouseOver&&n.currentTarget.getAttribute("aria-disabled")&&(t.props.onMenuItemMouseOver(n),t.setState({DisableButtonFocused:!0}))},onBlur:function(n){t.props.onMenuItemMouseLeave&&(t.props.onMenuItemMouseLeave(n),t.setState({DisableButtonFocused:!1}))}}):(0,a.p2)(d,{onFocus:t.Il,onClick:function(n){n.stopPropagation(),n.preventDefault(),(0,c.pd)((function(){return f.onClick()}),(function(){return f.onClick(f.HTMLAttributes["aria-posinset"])})),t.props.SubMenu?t.props.collapseRootMenu():t.Al()},onKeyDown:function(n){return t.Ul(n,f.onClick)}}),f.HTMLAttributes=d,i.cloneElement(u,f))}return u}))},e.Sl=function(t){this.dl=t},e.pl=function(){return this.al},e.Ll=function(){return this.state.MenuExpanded?this.props.UnorderListMenuItems?this.Vl():this._l():null},e.Fl=function(t){this.props.SubMenu&&(t.stopPropagation(),t.preventDefault()),this.Al()},e.Il=function(t){t.stopPropagation(),this.dl=t.currentTarget},e.wl=function(t){switch(t.keyCode){case 36:t.stopPropagation(),t.preventDefault(),this.Pl(this.Dl()[0]);break;case 35:t.stopPropagation(),t.preventDefault();var n=this.Dl();this.Pl(n[n.length-1]);break;case 38:t.stopPropagation(),t.preventDefault(),this.Pl(this.Bl());break;case 39:case 40:t.stopPropagation(),t.preventDefault(),this.Pl(this.zl());break;case 37:case 27:case 9:t.stopPropagation(),t.preventDefault(),this.state.DisableButtonFocused?(this.props.onMenuItemMouseLeave&&this.props.onMenuItemMouseLeave(t),this.setState({DisableButtonFocused:!1})):this.Al(!0)}},e.Dl=function(){var t=this.al.current;return t?t.firstElementChild.querySelectorAll(".menu-item-active,.menu-item-disabled"):null},e.Bl=function(){var t=this,n=this.Dl();if(n.length>0){if(this.dl&&this.dl!==n[0]){var e=o.findIndex(n,(function(n){return t.dl===n}));return n[--e]}return n[n.length-1]}},e.zl=function(){var t=this,n=this.Dl();if(n.length>0){if(this.dl&&this.dl!==n[n.length-1]){var e=o.findIndex(n,(function(n){return t.dl===n}));return n[++e]}return n[0]}},e.bl=function(t){switch(t.keyCode){case 40:this.props.SubMenu||(t.preventDefault(),this.Al());break;case 13:t.stopPropagation(),t.preventDefault(),this.Al();break;case 39:this.state.MenuExpanded||(t.stopPropagation(),t.preventDefault(),this.Al())}},e.Ul=function(t,n){switch(t.keyCode){case 32:t.stopPropagation(),t.preventDefault(),n&&n(),1!==this.props.MenuItemType&&(this.props.SubMenu?this.props.collapseRootMenu():this.Al());break;case 13:t.stopPropagation(),t.preventDefault();var e=n&&n(),r=void 0!==e&&e;this.props.SubMenu?this.props.collapseRootMenu():this.Al(!r)}},e.xl=function(){var t;t=this.props.SubMenu?this.ul.current:this.ol.current&&this.ol.current.getHtmlElement();var e=this.al.current;if(t&&e){var r=e.offsetWidth,i=e.offsetHeight,o=e.offsetParent;if(!o)return;for(e.style.display="none";o;){var s=window.getComputedStyle(o,""),u=s.overflowX,a=s.overflowY;if(u&&"visible"!==u||a&&"visible"!==a||"BODY"===o.tagName)break;o=o.parentElement}var c=o.getBoundingClientRect(),l=t.getBoundingClientRect(),f=void 0,h=void 0;this.props.SubMenu?(f=o.clientWidth+c.left-l.right-r>0?l.width:-r,h=o.clientHeight+c.top-l.top-i>0?0:-i):(f=Math.min(o.clientWidth+c.left-l.left-r-n.reservedWidthToRight,0),h=Math.min(o.clientHeight+c.top-l.top-i-5,l.height)),e.style.display="block",e.style.left=f+"px",e.style.top=h+"px"}},n.reservedWidthToRight=0,n}(f.r)},94154:function(t,n,e){"use strict";e.d(n,{w:function(){return k}});var r=e(59312),i=e(63804),o=e(27196),s=e(36215),u=e(29559),a=e(262),c=e(64290),l=e(64541),f=e(65863);var h=function(t){for(var n=t.numOfStars,e=t.initialValue,r=t.onRatingChange,o=t.isDisabled,s=t.leftDesc,u=t.leftDescRT,a=t.rightDesc,c=t.rightDescRT,l=i.useState(e),f=l[0],h=l[1],v=i.useState(e),p=v[0],g=v[1],b=[],w=function(t){b.push(i.createElement("div",{className:"rateit-star-container"},i.createElement(m,{isFilled:!o&&t<=p,isDisabled:o,onClick:function(){o||(h(t),g(t),r(t))},onHover:function(){!o&&g(t)},onHoverEnd:function(){!o&&g(f)}}),i.createElement("span",{className:"rateit-star-label"},t)))},y=1;y<=n;y++)w(y);return i.createElement("div",null,i.createElement("div",{className:"rateit-container",tabIndex:0,onKeyDown:function(t){var e=0,i=!1;("ArrowUp"===t.key||"ArrowRight"===t.key)&&f<n?(t.preventDefault(),i=!0,e=f+1):("ArrowDown"===t.key||"ArrowLeft"===t.key)&&f>0&&(t.preventDefault(),i=!0,e=f-1),i&&!o&&(h(e),g(e),r(e))}},b),i.createElement(d,{leftDesc:s,rightDesc:a,leftDescRT:u,rightDescRT:c}))},d=function(t){var n=t.leftDesc,e=t.leftDescRT,r=t.rightDesc,o=t.rightDescRT,s=i.createElement(f.D,{Text:(0,l.wg)(n,e),RenderMode:"RichText",ContainsHtml:!0}),u=i.createElement(f.D,{Text:(0,l.wg)(r,o),RenderMode:"RichText",ContainsHtml:!0});return i.createElement("div",{className:"cv-rating-control-description-container"},i.createElement("div",{className:"cv-rating-control-left-description"},s||n),i.createElement("div",{className:"cv-rating-control-right-description"},u||r))},m=function(t){var n=t.isFilled,e=t.isDisabled,r=t.onClick,o=t.onHover,s=t.onHoverEnd;return i.createElement("div",{className:(0,a.j)("rate-it-star-icon-container",n?"rate-it-star-filled":"rate-it-star-outlined",e&&"rate-it-star-disabled"),onClick:r,onMouseOver:o,onMouseOut:s},i.createElement(v,null))},v=i.memo((function(){return i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"34",height:"33",viewBox:"0 0 34 33",className:"office-form-theme-primary-stroke office-form-theme-primary-fill"},i.createElement("path",{d:"M22.4184 10.4045L22.5348 10.6402L22.7949 10.678L31.6365 11.9628C32.974 12.1571 33.508 13.8007 32.5402 14.7441L26.1424 20.9805L25.9541 21.1639L25.9986 21.423L27.5089 30.2289C27.7374 31.561 26.3392 32.5768 25.143 31.9479L17.2348 27.7903L17.0021 27.668L16.7694 27.7903L8.86126 31.9479C7.66499 32.5768 6.26685 31.561 6.49532 30.2289L8.00565 21.423L8.05009 21.1639L7.86185 20.9805L1.46399 14.7441C0.496196 13.8007 1.03024 12.1571 2.3677 11.9628L11.2093 10.678L11.4695 10.6402L11.5858 10.4045L15.5399 2.3926C16.138 1.18066 17.8662 1.18066 18.4643 2.3926L22.4184 10.4045Z"}))})),p=e(32782),g=e(72377),b=e(10836),w=e(7645),y=e(15305);var I=i.lazy((function(){return(0,r.mG)(this,void 0,void 0,(function(){return(0,r.Jh)(this,(function(t){switch(t.label){case 0:return[4,(0,y.l)().then((function(){return e.e(1778).then(e.bind(e,14179))}))];case 1:return[2,{default:t.sent().Rating}]}}))}))})),S=e(83726),C=e(55890),F=e(74302),N=e(40959),T=e(34328);function k(t){return i.createElement(x,t)}var x=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.Ql=i.createRef(),n.Hl=0,n.jl=n.$l(),n.Wl=!(0,b.VE)(),n.Jl=(0,b.cr)("FluentRating"),n.Kl=!1,n.Xl=s.uniqueId("rd"),n}(0,r.ZT)(n,t);var e=n.prototype;return e.createReactNodes=function(){var t,n,e=this,o=this.props;if(this.Jl){var s=null===(t=o.Options)||void 0===t?void 0:t.HTMLPropsForInnerElement,u=null==s?void 0:s["aria-labelledby"];o.ShowRatingLabel&&(u=(0,a.j)(u,this.Xl));var l=i.createElement(T.T,{Config:this.jl,NumStar:o.Length});n=i.createElement("div",{className:"office-form-theme-primary-foreground"},i.createElement(p.Z,{fallback:l},i.createElement(I,{allowZeroStars:!0,ariaLabel:this.props.Label,ariaLabelFormat:(0,w.pm)().Renderer_RatingControlText,"aria-describedby":null==s?void 0:s["aria-describedby"],"aria-labelledby":u,disabled:this.props.NoTabFocus,getAriaLabel:function(t){return(0,w.pm)().Renderer_RatingControlText.format(t)},max:this.props.Length,onChange:function(t,n){return e.props.onValueChange(n)},rating:this.props.Value,readOnly:!this.props.NoTabFocus&&this.props.Disabled,styles:{ratingButton:{height:this.jl.FontSize,padding:0},ratingStar:{fontSize:this.jl.FontSize,lineHeight:"1em",marginLeft:this.jl.MarginLeft,marginRight:this.jl.MarginRight},ratingStarBack:{color:"#959595"},ratingStarFront:{color:"inherit"},ratingFocusZone:{display:"flex"}}})))}else{var f={className:"rateit margin-left office-form-theme-primary-foreground","data-rateit-icon":"","data-rateit-iconforempty":"","data-rateit-mode":"font","data-rateit-marginleft":this.jl.MarginLeft,"data-rateit-marginright":this.jl.MarginRight,"data-rateit-starwidth":this.jl.FontSize,"data-rateit-max":o.Length,"data-rateit-value":o.Value,"data-rateit-step":1,"data-rateit-resetable":!1,"data-rateit-ispreset":!0,style:{fontSize:this.jl.FontSize},ref:"rateit"};n=i.createElement("div",f,this.Yl()),(0,c.md)((function(){(0,b.cr)("CVLeapFrogVisualRefresh")&&(n=function(t){return i.createElement(h,(0,r.pi)({},t))}({numOfStars:o.Length,initialValue:o.Value,onRatingChange:o.onValueChange,isDisabled:o.Disabled,leftDesc:o.LeftDescription,leftDescRT:o.FormsProRTLeftDescription,rightDesc:o.RightDescription,rightDescRT:o.FormsProRTRightDescription}))}))}return o.ShowRatingLabel?(0,N.yR)(0,this.Ql,o.LeftDescription,o.RightDescription,o.LeftDescriptionTitle,o.RightDescriptionTitle,n,o.Length,10,this.Xl,o.FormsProRTLeftDescription,o.FormsProRTRightDescription):i.createElement("div",{className:"office-form-question-rating-container",key:"c",ref:this.Ql},n)},e.componentWillMount=function(){this.Zl=this.Zl.bind(this)},e.componentDidMount=function(){var t=this;this.Jl||(this.tf=(0,S.d)(),this.tf.then((function(){t.Wl||(t.Wl=!0,t.forceUpdate()),t.nf()}))),this.rf(null),window.addEventListener("resize",this.Zl)},e.componentWillUnmount=function(){window.removeEventListener("resize",this.Zl)},e.componentDidUpdate=function(t){this.rf(t)},e.Yl=function(){if(!this.Wl)return g.Pv.Resolve("IRatingStarsFactory").createRatingStar({NumStar:this.props.Length,Config:this.jl})},e.rf=function(t){var n=this;this.if()?this.forceUpdate():this.Jl||this.tf.then((function(){return n.sf(t)}))},e.if=function(){var t=this.Ql.current;if(t&&t.clientWidth>0){this.Hl=t.clientWidth;var n=this.$l();if(!s.isEqual(n,this.jl))return this.jl=n,this.Kl=!0,!0}return!1},e.nf=function(){var t=this,n=this.props,e=$(o.findDOMNode(this.refs.rateit));e.rateit(),e.on("rated",(function(){var t=e.rateit("value");t>=0&&t<=n.Length&&n.onValueChange(t)})),e.on("over",(function(n,e){return t.uf(e)}));var r=e.find(".rateit-range");if(r&&n.Options&&n.Options.HTMLPropsForInnerElement)for(var i in r.removeAttr("aria-label"),n.Options.HTMLPropsForInnerElement)r.attr(i,n.Options.HTMLPropsForInnerElement[i]);if(r&&n.ShowRatingLabel){var s=r.attr("aria-labelledby");s&&(s=(0,a.j)(s,this.Xl),r.attr("aria-labelledby",s))}r&&n.Disabled&&r.attr("aria-disabled","true")},e.Zl=function(){var t=this;this.cl||(this.cl=window.setTimeout((function(){t.cl=null,t.if()&&t.forceUpdate()}),100))},e.sf=function(t){if(this.props.Value>this.props.Length)(0,C.$U)("DesignPage.Questions.RatingValueOutOfBounds",{operation:"RatingValueOutOfBounds"});else{var n=$(o.findDOMNode(this.refs.rateit));if(!this.Kl&&t&&this.props.Disabled==t.Disabled&&this.props.Value===t.Value&&this.props.Length===t.Length||(this.Kl=!1,n.rateit("batchUpdate",{value:this.props.Value,max:this.props.Length,readonly:this.props.Disabled,starwidth:this.jl.FontSize,marginleft:this.jl.MarginLeft,marginright:this.jl.MarginRight}),this.uf()),this.props.NoTabFocus){var e=n.find(".rateit-range");e&&e.removeAttr("tabindex")}n.children(".rateit-range").removeAttr("aria-readonly")}},e.uf=function(t){t=t||this.props.Value||0;var n=$(o.findDOMNode(this.refs.rateit)),e=(0,w.pm)().Renderer_RatingControlText.format(t);n.attr("title",e)},e.$l=function(){var t=this.props.IsRtlLanguage,n={MarginLeft:4,MarginRight:4,FontSize:24,IsRtlLanguage:t};if(this.Hl>0)if(this.af()){n.MarginLeft=4;var e=this.props.Length,r=e>6?24:28;if(n.FontSize=r,e<4)n.MarginRight=27;else{var i=this.Jl?0:1;n.MarginRight=(this.Hl-n.MarginLeft*(e+i)-r*e)/(e-i)}}else if(this.Hl>380)return{MarginLeft:5,MarginRight:5,FontSize:this.props.Compact?24:28,IsRtlLanguage:t};return n},e.af=function(){return this.props.IsMobile||(0,u.tq)()},n}(F.i)},40959:function(t,n,e){"use strict";e.d(n,{yR:function(){return l}});var r=e(59312),i=e(63804),o=e(262),s=e(7645),u=e(64541),a=e(64290),c=e(65863);function l(t,n,e,l,f,h,d,m,v,p,g,b){var w=0===t?"star":"number",y="office-form-question-rating-description-"+w,I="office-form-rating-container-"+w+" container-margin-right",S="office-form-rating-container-"+w+" container-margin-left";""===e&&(I=(0,o.j)(I,"container-empty")),m===v&&(I=(0,o.j)(I,"container-"+w+"-max-width"),S=(0,o.j)(S,"container-"+w+"-max-width"));var C=i.createElement(c.D,{Text:(0,u.wg)(e,g),RenderMode:"RichText",ContainsHtml:!0}),F=i.createElement(c.D,{Text:(0,u.wg)(l,b),RenderMode:"RichText",ContainsHtml:!0}),N=i.createElement("div",{className:I},i.createElement("div",{className:y},C||e)),T=i.createElement("div",{className:S},i.createElement("div",{className:y},F||l));return i.createElement(i.Fragment,null,i.createElement("div",{className:"office-form-question-rating-container",key:"d",ref:n},N,d,T),(e||l)&&function(t,n,e,o,l,f,h){var d=(0,u.wg)(t,f),m=(0,u.wg)(n,h);(0,a.md)((function(){d=d?d.replace(/<[^>]*>/g,""):d,m=m?m.replace(/<[^>]*>/g,""):m}));var v=i.createElement("div",{className:"office-form-response-rating-description"},i.createElement("div",{className:"office-form-rating-description-label"},e),i.createElement("div",{className:"rating-option-description"},i.createElement(c.D,{Text:(0,s.pm)().Colon.format(d),RenderMode:"RichText",ContainsHtml:!0}))),p=i.createElement("div",{className:"office-form-response-rating-description"},i.createElement("div",{className:"office-form-rating-description-label"},o),i.createElement("div",{className:"rating-option-description"},i.createElement(c.D,{Text:(0,s.pm)().Colon.format(m),RenderMode:"RichText",ContainsHtml:!0}))),g={className:"office-form-rating-description-container",id:l};return i.createElement("div",(0,r.pi)({},g),v,p)}(e,l,f,h,p,g,b))}},34328:function(t,n,e){"use strict";e.d(n,{T:function(){return o}});var r=e(59312),i=e(63804),o=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.cf="",n}(0,r.ZT)(n,t);var e=n.prototype;return e.render=function(){for(var t=[],n=0;n<this.props.NumStar;n++)t.push(i.createElement("span",{style:{margin:this.lf()}},this.cf));return i.createElement("div",{className:"rateit-empty",style:{fontSize:this.props.Config.FontSize}},t)},e.lf=function(){return"0px "+this.props.Config.MarginRight+"px 0px "+this.props.Config.MarginLeft+"px"},n}(e(23112).r)},61111:function(t,n,e){"use strict";e.d(n,{E:function(){return m}});var r=e(59312),i=e(63804),o=e(27196),s=e(36215),u=e(29559),a=e(262),c=e(38174),l=e(54496),f=e(23112),h=e(3424),d=e(65863);function m(t){return i.createElement(v,(0,r.pi)({},t))}var v=function(t){function n(e){var r=t.call(this,e)||this;r.ff=!0,r.ml=s.uniqueId(n.name),r.hf=r.ml+"_placeholder",r.mf=i.createRef(),r.vf=r.vf.bind(r),r.gf=r.gf.bind(r),r.bf=r.bf.bind(r),r.wf=r.wf.bind(r);var o=r.yf(),u=s.findIndex(o,(function(t){return t.Value===r.props.Value}));return r.If=u<0?void 0:o[u].Key,r.state={Expanded:!1},r}(0,r.ZT)(n,t);var e=n.prototype;return e.componentWillUpdate=function(t,e){var r=n.GetSelectOptions(t),i=s.findIndex(r,(function(n){return n.Value===t.Value}));this.If=i<0?void 0:r[i].Key},e.componentDidMount=function(){this.ff=!1},e.componentDidUpdate=function(){if(this.Sf(),this.state.Expanded){if(this.Cf(),this.props.NeedScroll){var t=this.mf.current;if(t){var n=$(".office-form-content"),e=t.getBoundingClientRect().bottom,r=n.height()-e;if(r<70){var i=o.findDOMNode(this.refs.menu);n.scrollTop(n.scrollTop()+i.offsetHeight-r)}}}var s=this.refs[this.If];if(s){var u=o.findDOMNode(s);u&&u.focus()}}},e.Cf=function(){var t=document.getElementById(this.ml),n=window.getComputedStyle(t),e=t.offsetWidth,r=o.findDOMNode(this.refs.menu);(this.props.AllowWrap||r.offsetWidth<e)&&(r.style.width=e+"px"),r.style.top=t.offsetHeight-parseInt(n.borderTopWidth)+"px",r.style.left="-"+n.borderLeftWidth},e.render=function(){var t=this,n=s.extend({},this.props.HTMLAttributes),e=(0,l.p2)(n,{className:"select-control",id:this.ml,onBlur:this.vf,onClick:n.disabled?void 0:function(){return t.Qu()},onKeyUp:this.gf,onKeyDown:this.bf,ref:this.mf,tabIndex:n.disabled?-1:0});return this.props.IsMobile||(e=(0,l.p2)(e,{"aria-describedby":this.hf,"aria-expanded":this.state.Expanded,"aria-haspopup":"listbox","aria-label":this.props.Label,"aria-required":!!this.props.required,role:"listbox"})),i.createElement("div",(0,r.pi)({},e),this.Ff(),this.Nf())},n.GetSelectOptions=function(t){var n=t.SelectOptions;if(n)return n;var e=t.SelectOptionGroups;return s.flatten(e.map((function(t){return t.SelectOptions})))},e.yf=function(){return n.GetSelectOptions(this.props)},e.Tf=function(){return!!this.xf()},e.xf=function(){return this.props.SelectOptionGroups},e.Ff=function(){var t,n=this,e=this.yf(),o=s.findIndex(e,(function(t){return void 0===n.If?t.Value===n.props.Value:t.Key===n.If})),a=this.If?"select-placeholder-text":"select-placeholder-text default",c=this.props.IsMobile;o>=0&&(t=e[o].DisplayContent||e[o].DisplayName),t||(t=this.props.Placeholder||"");var f=(this.props.PlaceholderIcon||this.props.PlaceholderFluentIcon)&&i.createElement("div",{className:"select-placeholder-icon","aria-hidden":"true"},i.createElement(h.F,{FluentIcon:this.props.PlaceholderFluentIcon,IconName:this.props.PlaceholderIcon,HTMLAttributes:{className:"forms-icon-size14x14"}})),m={className:"select-placeholder","aria-hidden":(0,u.Dt)(),"aria-label":c?this.props.Label:this.Pf(e[o]),"aria-live":this.state.Expanded||this.ff?"off":"polite","aria-selected":!0,"aria-posinset":o>0?o+1:void 0,"aria-setsize":o>0?e.length:void 0,id:this.hf,role:this.props.IsMobile?"button":"option"};return c&&(m=(0,l.p2)(m,{"aria-expanded":this.state.Expanded,"aria-haspopup":"listbox"})),i.createElement("div",(0,r.pi)({},m),f,i.createElement("span",{className:a},"string"==typeof t?i.createElement(d.D,{Text:t,RenderMode:"RichText",ContainsHtml:!0}):i.createElement("span",null,t)),this.Df())},e.Pf=function(t){return t&&t.DisplayName?t.DisplayName:this.props.Placeholder||""},e.Df=function(){var t={FluentIcon:this.state.Expanded?"Chevron Up":"Chevron Down",HTMLAttributes:{className:"select-placeholder-arrow forms-icon-size14x14"},IconName:this.state.Expanded?"ChevronUp":"ChevronDown"};return i.createElement(h.F,(0,r.pi)({},t))},e.Nf=function(){var t=this;if(this.state.Expanded){var n={"aria-label":this.props.Label,className:"select-option-menu-container",ref:"menu",role:"listbox",onWheel:function(n){n.preventDefault();var e=n.deltaY,r=o.findDOMNode(t.refs.menu),i=r.scrollTop+e;if(e>=0){var s=r.scrollHeight-r.clientHeight;r.scrollTop=Math.min(i,s)}else r.scrollTop=Math.max(i,0)}};return i.createElement("div",(0,r.pi)({},n),this.Ef())}},e.Ef=function(){var t=this;return this.Tf()?this.xf().map((function(n,e){return t.Rf(n,e)})):this.Lf(this.yf())},e.Rf=function(t,n){var e=!(!t.SelectOptions.length||!t.DisplayName)&&i.createElement("h5",{className:"select-group-header office-form-theme-primary-color",key:"group_header"+n},t.DisplayName);return i.createElement(i.Fragment,{key:"group_"+n},e,this.Lf(t.SelectOptions))},e.Lf=function(t){var n=this;return t.map((function(t,e,r){return n.Af(t,e,r.length)}))},e.Af=function(t,n,e){var s=this,u=t.Key===this.If,c={"aria-label":t.AriaLabel||t.DisplayName,"aria-selected":u,"aria-disabled":t.Disabled,"aria-posinset":n+1,"aria-setsize":e,className:this.props.AllowWrap?"select-option-nocheck":"select-option",tabIndex:u?0:-1,key:t.Key,ref:t.Key&&t.Key.toString(),role:"option"};t.Disabled?(c.className=(0,a.j)(c.className,"disabled"),c["aria-labelledby"]=t.ArialLabelId||void 0,c.onFocus=function(n){n.stopPropagation(),t.showToolTip&&t.showToolTip(),t.DisableFocused=!0},c.onBlur=function(n){n.stopPropagation(),t.hideToolTip&&t.hideToolTip(),t.DisableFocused=!1}):c.onClick=function(n){n.stopPropagation(),s.If&&s.If===t.Key||s.props.onValueChange(t.Value),s.setState({Expanded:!1},(function(){o.findDOMNode(s).focus()}))};var l,f="select-option-state forms-icon-size14x14";(this.props.PlaceholderIcon||this.props.PlaceholderFluentIcon)&&(f=(0,a.j)(f,"hasPlaceholderIcon")),this.props.AllowWrap||(l=i.createElement(h.F,{FluentIcon:"Checkmark",HTMLAttributes:{className:f}})),u&&(c.className=(0,a.j)(c.className,"selected"));var m=t.DisplayContent;return m||(m=i.createElement("span",{"aria-hidden":"true"},i.createElement(d.D,{Text:t.DisplayName,RenderMode:"RichText",ContainsHtml:!0}))),i.createElement("div",(0,r.pi)({},c),i.createElement("div",{className:"select-option-content"},l,m))},e.vf=function(t){var n=this,e=this.mf.current;t.persist(),window.setTimeout((function(){var r=(0,c.y3)(t);e&&!e.contains(r)&&n.state.Expanded&&"HTML"!==r.nodeName&&n.setState({Expanded:!1})}),0)},e.bf=function(t){if(this.state.Expanded&&27===t.keyCode&&(t.stopPropagation(),this.wf()),(0,u.Dt)())switch(t.keyCode){case 32:case 13:t.preventDefault(),t.stopPropagation()}},e.gf=function(t){var n=this;switch(t.keyCode){case 32:this.setState({Expanded:!0}),t.stopPropagation();break;case 13:this.Qu(!0),t.stopPropagation();break;case 9:this.state.Expanded&&(t.stopPropagation(),this.wf());break;case 38:case 40:t.altKey?this.setState({Expanded:!this.state.Expanded},(function(){var t=n.mf.current;!n.state.Expanded&&t&&t.focus()})):38===t.keyCode?this.qf():this.Of(),t.stopPropagation(),t.preventDefault()}},e.qf=function(){var t=this,n=this.yf(),e=s.findIndex(n,(function(n){return n.Key===t.If}));if(e>0){var r=n[e-1];if(this.If=r.Key,r.Disabled||this.props.disableSelectOnArrowKeys){var i=o.findDOMNode(this.refs[r.Key]);i&&i.focus()}else this.props.onValueChange(r.Value)}},e.Of=function(){var t=this,n=this.yf(),e=s.findIndex(n,(function(n){return n.Key===t.If}));if(e<n.length-1){var r=n[e+1];this.If=r.Key;var i=o.findDOMNode(this.refs[r.Key]);i&&i.focus(),r.Disabled||this.props.disableSelectOnArrowKeys||this.props.onValueChange(r.Value)}},e.Qu=function(t){var n=this,e=this.yf();if(this.state.Expanded){if(o.findDOMNode(this).focus(),this.props.disableSelectOnArrowKeys){var r=s.findIndex(e,(function(t){return t.Key===n.If}));this.props.onValueChange(e[r].Value)}}else t&&void 0===this.If&&e[0]&&this.props.onValueChange(e[0].Value);this.setState({Expanded:!this.state.Expanded})},e.Sf=function(){if(this.state.Expanded){var t=$(o.findDOMNode(this.refs.menu)),n=t.find(".select-option.selected");(0,l.n1)(n,t)}},e.wf=function(){var t=this,n=this.yf();s.some(n,(function(t){return t.DisableFocused}))?n.forEach((function(t){t.Disabled&&t.hideToolTip&&(t.hideToolTip(),t.DisableFocused=!1)})):this.setState({Expanded:!1},(function(){t.mf.current&&t.mf.current.focus()}))},e.focus=function(){o.findDOMNode(this).focus()},n}(f.r)},40554:function(t,n,e){"use strict";e.d(n,{s:function(){return v},o:function(){return p}});var r=e(59312),i=e(63804),o=e(27196),s=e(36215),u=e(29559),a=e(262),c=e(38174),l=e(54496),f=e(3424),h=e(23112),d=e(63481),m=e(42605);function v(t){return i.createElement(p,(0,r.pi)({},t))}var p=function(t){function n(e){var r=t.call(this,e)||this;return r.Mf=s.uniqueId(n.name),r.Uf=r.Uf.bind(r),r}(0,r.ZT)(n,t);var e=n.prototype;return e.componentDidMount=function(){(void 0===this.props.TrapFocus||this.props.TrapFocus)&&(0,d.mZ)(o.findDOMNode(this))},e.shouldComponentUpdate=function(t){return!s.isEqual(this.props,t)},e.render=function(){var t=this;if(this.props.ShowDialog){var n=(0,l.p2)(this.props.HTMLAttributes,{className:this.props.ClassName||"simple-dialog-container",key:"dialogContainer",ref:"dialogContainer",tabIndex:-1,onBlur:function(n){var e=(0,c.y3)(n);o.findDOMNode(t.refs.dialogContainer).contains(e)||t.props.onBlur&&t.props.onBlur()},onKeyDown:function(n){return t.bf(n)},onMouseLeave:this.props.onMouseLeave,onMouseOver:this.props.onMouseOver}),e=!(0,u.tq)();return i.createElement("div",(0,r.pi)({},n),this.props.children,this.Vf(),e&&this.props.CloseButtonProps&&this.ec(),this._f(),this.Gf(),this.Bf())}return null},e.Vf=function(){var t=this.props;if(t.IconName||t.FluentIcon){var n={FluentIcon:t.FluentIcon,HTMLAttributes:{className:t.IconClassName},IconName:t.IconName,key:"icon"};return i.createElement(f.F,(0,r.pi)({},n))}},e.ec=function(){return this.Uf(this.props.CloseButtonProps,this.props.ButtonsProps.length+1)},e._f=function(){if(this.props.Description){var t=(0,a.j)("description-container",this.props.TextClassName);return i.createElement("div",{className:t,id:this.Mf,key:"descriptionContainer"},this.props.Description)}return null},e.Bf=function(){return this.props.WarningMessage?i.createElement("div",{className:"warning-container",id:this.Mf+"_warning",key:"warningContainer"},this.props.WarningMessage):null},e.Uf=function(t,n){return(0,m.F)({ButtonStyle:t.ButtonStyle,GlyphButtonStyle:t.GlyphButtonStyle,FluentIcon:t.FluentIcon,HTMLAttributes:{"aria-describedby":t.ConveyDescription?this.Mf:"",autoFocus:0===n,className:t.ClassName,title:t.Title,onClick:function(n){n.preventDefault(),n.stopPropagation(),t.onClick&&t.onClick(n)}},Icon:t.IconClass,IconClassName:(0,a.j)(t.IconClassName,"forms-icon-size24x24"),IsDisabled:t.IsDisabled,key:t.Key,ref:t.ref,Text:t.Text,TextClassName:t.TextClassName})},e.Gf=function(){var t=this.props.ButtonsProps||[];return t.length>0?i.createElement("div",{className:"buttons-container",key:"buttonsContainer"},t.filter((function(t){return!!t})).map(this.Uf)):null},e.bf=function(t){27===t.keyCode&&(t.stopPropagation(),t.preventDefault(),this.props.onDismiss&&this.props.onDismiss())},n}(h.r)},20572:function(t,n,e){"use strict";e.d(n,{ZA:function(){return C},ZN:function(){return F}});var r=e(59312),i=e(63804),o=e(27196),s=e(36215),u=e(29559),a=e(262),c=e(63795),l=e(10836),f=e(687),h=e(7645),d=e(54496),m=e(32782),v=e(29295);function p(){return(0,r.mG)(this,void 0,void 0,(function(){return(0,r.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(757).then(e.bind(e,14310))];case 1:return[2,{default:t.sent().EditorRibbonCombination}]}}))}))}function g(t){var n=(0,v.J)(g,p);return i.createElement(m.Z,null,i.createElement(n,(0,r.pi)({},t)))}var b=e(64290),w=e(55890),y=e(23112);var I=e(74302),S=e(35929);function C(t){return i.createElement(N,t)}function F(t,n,e,r,i,o,s,u,a){return(0,b.pd)((function(){return C(t)}),(function(){return b.Xw.createTextFieldWithCKEditor(t,n,e,r,i,o,s,u,a)}))}var N=function(t){function n(n){var e=t.call(this,n)||this;return e.lt=i.createRef(),e.zf=e.zf.bind(e),e}(0,r.ZT)(n,t);var e=n.prototype;return e.componentDidMount=function(){this.props.AutoFocus&&this.focus()},e.focus=function(){if(this.lt.current)this.lt.current.focus();else{var t=o.findDOMNode(this),n=$(t).find(".roosterjs-editor-box");n&&n.focus()}},e.createReactNodes=function(){return i.createElement(i.Fragment,{},this.Qf(),this.Hf())},e.Qf=function(){var t=this.props,n=t.Options;if(t.Label||t.ShowRequiredStar)return i.createElement("div",null,i.createElement("span",{className:n&&n.classNameForInnerLabel},t.Label),t.ShowRequiredStar?i.createElement(S.R):void 0)},e.jf=function(){var t=this,e=this.props,r=e.Options,i="DesignPage.ShortCut.Clipboard",s="office-form-textfield-input form-control border-no-radius";return(0,b.md)((function(){t.props.AddTextToClassName&&(s=s+" cv-"+t.props.HTMLAttributes.className)})),(0,d.p2)(r&&r.HTMLPropsForInnerElement,{value:e.Value||"",className:s,rows:this.props.Rows,placeholder:e.Placeholder,ref:this.lt,"aria-required":e.Required,style:{height:e.MinimalHeight?e.MinimalHeight+"px":void 0,overflowY:1===e.TextFieldType?"auto":void 0},spellCheck:!0,disabled:e.Disabled,onChange:this.$f.bind(this),maxLength:e.MaxLength?e.MaxLength:(0,f.LY)(),onFocus:e.AutoSelection?function(){if(t.lt.current){var n=o.findDOMNode(t.lt.current);n&&n.select()}}:void 0,onClick:function(){var n;return(0,u.gn)()&&(null===(n=t.lt.current)||void 0===n?void 0:n.focus())},onKeyDown:(0,d.IB)((function(r){if(r.ctrlKey||r.metaKey){var o=new Date,s=String.fromCharCode(r.keyCode),u=(r.ctrlKey?"Ctrl":"Meta")+"+"+s;switch(s){case"B":case"I":case"U":(0,w.$U)("TextFormatShortcutEvent",{TextFormatFlight:!0,Shortcut:u,Location:e.TextFieldLocation});break;case"C":case"X":t.Wf(n.prevTimeKeyDown,o.getTime())>n.minDuration&&t.Jf(r,i,u),n.prevTimeKeyDown=o.getTime();break;case"V":t.Jf(r,i,u);break;case"Y":case"Z":t.Jf(r,"DesignPage.ShortCut.UndoRedo",u)}}})),onCopy:function(e){var r=new Date;t.Wf(n.prevTimeOnCopy,r.getTime())>n.minDuration&&t.Jf(e,i,"onCopy"),n.prevTimeOnCopy=r.getTime()},onPaste:function(n){t.Jf(n,i,"onPaste")},onCut:function(e){var r=new Date;t.Wf(n.prevTimeOnCut,r.getTime())>n.minDuration&&t.Jf(e,i,"onCut"),n.prevTimeOnCut=r.getTime()}})},e.Hf=function(){var t,n,e,r,o,s,u=this.props,c=this.jf(),f=(0,a.j)("office-form-textfield",null===(t=u.Options)||void 0===t?void 0:t.classNameForInnerDiv);if(u.Disabled||!u.AllowRichText||(0,l._y)())switch(u.TextFieldType){case 2:var d=c,m=null==u.MinimalHeight?80:u.MinimalHeight>0?u.MinimalHeight:0;d.MinHeight=m.toString()+"px",e=function(t){return i.createElement(T,t)}(d);break;case 1:r=i.createElement("textarea",c);break;case 0:default:o=i.createElement("input",c)}else{f=(0,a.j)(f,"textfield-with-text-format");var v=(0,a.j)("roosterjs-editor-box",c.className);(2===u.TextFieldType||u.AllowHeightAdjustment)&&(v=(0,a.j)(v,"auto-height-div"),delete c.style.height,c.style.minHeight=u.MinimalHeight?u.MinimalHeight+"px":void 0),n=g({$ariaLabel:c["aria-label"],$autoFocus:u.AutoFocus,$className:v,$disableRibbon:u.DisableRibbon,$leaveFirstLineOnlyWhenPaste:u.LeaveFirstLineOnlyWhenPaste,$maxLength:c.maxLength,$placeHolder:c.placeholder,$preventMultiline:!u.TextFieldType,$style:c.style,$textFieldLocation:u.TextFieldLocation,$value:String(c.value),$context:{$flights:{$svgIcon:!1},$ls:(0,h.pm)(),$funcAdapters:{$logEngagement:w.$U}},$onKeyDown:c.onKeyDown,$onPaste:u.onRichEditorPaste,$updateContentToBindBox:this.zf})}if(u.ShowCharCounter){var p=!u.Value||c.maxLength>u.Value.length?"office-form-textfield-counter":"office-form-textfield-counter textfield-counter-warning";s=i.createElement("label",{className:p},this.Kf(u.Value,c.maxLength))}return i.createElement("div",{className:f},n,e,r,o,s)},e.zf=function(t){this.props.onValueChange(t)},e.$f=function(t){if(!this.props.Disabled){var n=t.target,e=(0,c.bC)(n.value);if(e&&e.length>n.maxLength&&(e=e.slice(0,n.maxLength)),this.props.onValueChange(e),this.props.ShowCharCounter){var r=o.findDOMNode(n).nextSibling;r&&(r.innerText=this.Kf(e,n.maxLength))}}},e.Kf=function(t,n){return(t||"").length.toString()+" / "+n.toString()},e.Jf=function(t,n,e){var r;this.props.HTMLAttributes&&(r=this.props.HTMLAttributes.className),(0,w.$U)(n,{targetClassName:r,operation:e})},e.Wf=function(t,n){return n-t},n.prevTimeKeyDown=0,n.prevTimeOnCopy=0,n.prevTimeOnCut=0,n.minDuration=500,n}(I.i);var T=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.lt=i.createRef(),n}(0,r.ZT)(n,t);var e=n.prototype;return e.componentDidMount=function(){this.Yf(),this.Zf=this.Yf.bind(this),window.addEventListener("resize",this.Zf)},e.componentDidUpdate=function(){this.Yf()},e.componentWillUnmount=function(){window.removeEventListener("resize",this.Zf)},e.focus=function(){this.lt.current&&this.lt.current.focus()},e.render=function(){var t=s.clone(this.props);return t.ref=this.lt,delete t.MinHeight,i.createElement("textarea",t)},e.Yf=function(){if(!this.lt.current.hasAttribute("rows")){var t=o.findDOMNode(this),n=this.props,e=t.parentElement,r=e.style.height;e.style.height=window.getComputedStyle(e).height,t.style.height=n.MinHeight;var i=t.offsetHeight-t.clientHeight;t.style.height=t.scrollHeight+i+"px",e.style.height=r,t.style.minHeight=n.MinHeight}},n}(y.r)},65863:function(t,n,e){"use strict";e.d(n,{D:function(){return l},q:function(){return c}});var r=e(59312),i=e(63804),o=e(23112),s=e(18113),u=e(64541),a=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,r.ZT)(n,t),n.prototype.render=function(){var t=this.props,n=t.Html;t.RenderHtml||(n=(0,s.ZP)(t.Html));var e=(0,u.gA)(n),o={id:t.Id,className:"text-format-content",dangerouslySetInnerHTML:{__html:e}};return i.createElement("span",(0,r.pi)({},o))},n}(o.r);function c(t){return i.createElement(l,(0,r.pi)({},t))}var l=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,r.ZT)(n,t),n.prototype.render=function(){var t;return"RichText"===(this.props.RenderMode||"PlainText")?(t={id:this.props.Id,Html:this.props.Text,RenderHtml:this.props.ContainsHtml},i.createElement(a,(0,r.pi)({},t))):(t={id:this.props.Id},i.createElement("span",(0,r.pi)({},t),this.props.Text))},n}(o.r)},77309:function(t,n,e){"use strict";e.d(n,{L:function(){return s}});var r=e(59312),i=e(63804),o=e(36215),s=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.componentDidMount=function(){var t=this;this.props.LazyRendering&&window.setTimeout((function(){return t.setState({Mounted:!0})}))},e.render=function(){var t=o.clone(this.props.HTMLAttributes||{});switch(this.props.Role){case"Alert":t.role="alert";break;case"Log":t.role="log",t["aria-live"]=t["aria-live"]||"polite",t["aria-relevant"]=t["aria-relevant"]||"additions text";break;case"Marquee":t.role="marquee";break;case"Status":t.role="status"}return this.props.LazyRendering&&!this.state.Mounted?(t["aria-label"]=void 0,t.children=null,i.createElement("div",(0,r.pi)({},t))):i.createElement("div",(0,r.pi)({},t),this.props.children)},n}(e(23112).r)},71170:function(t,n,e){"use strict";e.d(n,{J:function(){return h}});var r=e(59312),i=e(63804),o=e(36215),s=e(262),u=e(97265),a=e(7645),c=e(64290),l=e(23112),f=e(65863);l.r;function h(t){return t<7?(0,a.pm)().NPS_Detractors:t>8?(0,a.pm)().NPS_Promoters:(0,a.pm)().NPS_Passives}},82741:function(t,n,e){"use strict";e.d(n,{Q:function(){return m}});var r=e(59312),i=e(63804),o=e(27196),s=e(36215),u=e(18113),a=e(35705),c=e(29559),l=e(7645),f=e(64541),h=e(23112),d=e(65863),m=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.render=function(){if(this.cu()){var t={className:"chart-control-container chart-stacked-control-container",tabIndex:-1};return t["aria-label"]=(0,l.pm)().ChartControl_GroupContainer,i.createElement("div",(0,r.pi)({},t),this.fu(),this.du())}return null},e.componentWillMount=function(){this.mu()},e.componentDidMount=function(){this.vu()},e.shouldComponentUpdate=function(t){return!s.isEqual(this.props,t)||!this.pu},e.componentDidUpdate=function(){this.vu()},e.componentWillUnmount=function(){this.gu()},e.cu=function(){return this.props.Labels&&this.props.Labels.length>0&&this.props.Data&&this.props.Data.length>0},e.gu=function(){this.bu&&(this.bu.destroy(),this.bu=null)},e.vu=function(){if(this.cu()){var t=o.findDOMNode(this.refs.canvas);if(this.pu=$(t).is(":visible"),this.pu){var n=t.getContext("2d");this.wu(n),this.yu()}}},e.Iu=function(){return{responsive:!1,scales:{xAxes:[{gridLines:{display:!1,drawTicks:!0,drawBorder:!0},ticks:{display:!1,min:0,max:100},stacked:!0}],yAxes:[{gridLines:{display:!1,drawTicks:!1,drawBorder:!0},ticks:{display:!1},stacked:!0}]},tooltips:{enabled:!0,filter:function(t){return 0!==t.xLabel},callbacks:{title:function(t){return t.length?""+t[0].yLabel:""},label:function(t,n){return n.datasets[t.datasetIndex].label+": "+t.xLabel+"%"}}},legend:{display:!1}}},e.wu=function(t){var n={labels:this.props.Labels.map((function(t){return t&&(0,f.Mw)(t.toString(),!0)||t})),datasets:this.Fu},e=this.Iu();this.gu(),this.bu=new Chart(t,{type:"horizontalBar",data:n,options:e})},e.mu=function(){for(var t=this,n=[],e=function(t){n.push(r.props.Data.reduce((function(n,e){return n+ +e.data[t]}),0))},r=this,i=0;i<this.props.Data[0].data.length;i++)e(i);var o=[[0],[0,10],[0,5,10],[0,2,8,10],[0,2,5,8,10],[0,2,4,6,8,10],[0,2,4,5,6,8,10],[0,2,3,4,6,7,8,10],[0,2,3,4,5,6,7,8,10],[0,1,2,3,4,6,7,8,9,10]];this.Nu=o[Math.min(this.props.Data.length,o.length)-1].map(a.T),this.Fu=this.props.Data.map((function(e,r){var i=e.backgroundColor?e.backgroundColor:t.Nu[r%t.Nu.length];return{label:e.label,borderWidth:1,borderColor:"#FFFFFF",backgroundColor:i,hoverBackgroundColor:t.Tu(""+i,10),data:e.data.map((function(t,e){return n[e]?Math.round(1e3*+t/n[e])/10:0}))}}))},e.Tu=function(t,n){return s.isArray(t)?t.map((function(t){return e(t,n)})):e(t,n);function e(t,n){var e=parseInt(t.slice(1),16),r=Math.round(2.55*n),i=(e>>16)+r,o=(e>>8&255)+r,s=(255&e)+r;return"#"+(16777216+65536*(i<255?i<1?0:i:255)+256*(o<255?o<1?0:o:255)+(s<255?s<1?0:s:255)).toString(16).slice(1)}},e.yu=function(){var t=this;if(this.props.HasLegend){var n=o.findDOMNode(this.refs["legend-table"]),e=o.findDOMNode(this.refs["legend-table-tbody"]).childNodes;e&&e.length>0&&(s.each(e,(function(n,e){Chart.helpers.addEvent(n,"mouseover",(function(){t.ku("mouseover",e)}))})),Chart.helpers.addEvent(n,"mouseout",(function(){t.ku("mouseout",0)})));var r=o.findDOMNode(this.refs["stacked-detail-container"]).getElementsByClassName("chart-control-detail-canvas");r&&r.length>0&&s.each(r,(function(n,e){var r=n.getContext("2d");r.fillStyle=t.Fu[e].backgroundColor,r.beginPath(),r.fillRect(0,0,10,10),r.closePath(),r.fill()}))}},e.ku=function(t,n){var e=this;this.bu.active="mouseout"===t?[]:this.bu.data.datasets.map((function(t,r){return e.bu.getDatasetMeta(r).data[n]})),this.bu.lastActive=this.bu.lastActive||[],this.bu.lastActive.length&&this.bu.updateHoverStyle(this.bu.lastActive,this.bu.options.hover.mode,!1),this.bu.active.length&&this.bu.updateHoverStyle(this.bu.active,this.bu.options.hover.mode,!0);var r=!Chart.helpers.arrayEquals(this.bu.active,this.bu.lastActive);if(r){this.bu.lastActive=this.bu.active;var i=this.bu.tooltip;i._active=this.bu.active,i._lastActive=i._lastActive||[],i.update(!0),i.pivot();var o=this.bu._bufferedRequest;o?this.bu.render(o.duration,o.lazy):r&&!this.bu.animating&&(this.bu.stop(),this.bu.render(this.bu.options.hover.animationDuration,!0)),this.bu._bufferedRender=!1,this.bu._bufferedRequest=null}},e.fu=function(){var t=this;if(this.props.HasLegend){var n={className:"chart-control-legend",tabIndex:-1};n["aria-label"]=(0,l.pm)().ChartControl_LegendGroup;var e=void 0,o=void 0;return 0===this.props.Type?(e=i.createElement("tr",{className:"chart-control-legend-table-title"},i.createElement("th",{className:"chart-control-legend-label"}," "),i.createElement("th",{className:"chart-control-legend-value"}," ")),o=this.props.Labels.map((function(n,e){var r=n?n.toString():"";return i.createElement("tr",{className:"chart-control-legend-table-row",key:e},i.createElement("td",{role:"presentation",className:"chart-control-legend-label",title:r&&(0,f.Mw)(r,!0)||r},i.createElement(d.D,{Text:r,RenderMode:"RichText",ContainsHtml:!0})),i.createElement("td",{role:"presentation",className:"chart-control-legend-value"},t.Fu[0].data[e]+"%"))}))):(e=i.createElement("tr",{className:"chart-control-legend-table-title"},i.createElement("th",{role:"presentation",className:"chart-control-legend-value"},(0,l.pm)().AnalyzeView_Chart_Rank),i.createElement("th",{role:"presentation",className:"chart-control-legend-label"},(0,l.pm)().AnalyzeView_Chart_Options)),o=this.props.Labels.map((function(n,e){var r=n?n.toString():"";return i.createElement("tr",{className:"chart-control-legend-table-row",key:e},i.createElement("td",{role:"presentation",className:"chart-control-legend-value"},t.props.yLabels[e]),i.createElement("td",{role:"presentation",className:"chart-control-legend-label",title:r&&(0,f.Mw)(r,!0)||r},i.createElement(d.D,{Text:(0,u.fq)(r),RenderMode:"RichText",ContainsHtml:!0})))}))),i.createElement("div",(0,r.pi)({},n),i.createElement("table",{className:"chart-control-legend-table",ref:"legend-table"},i.createElement("thead",null,e),i.createElement("tbody",{ref:"legend-table-tbody"},o)))}},e.du=function(){var t=(0,c.fM)()<400||(0,c.tq)(),n=t?300:350,e=10+31*this.props.Labels.length,o={className:"chart-control-canvas",width:n,height:e=t?300*e/350:e,ref:"canvas","aria-label":(0,l.pm)().ChartControl_AriaLabel};return i.createElement("div",(0,r.pi)({},{className:"chart-control chart-control-stacked",tabIndex:-1}),this.lu(),i.createElement("canvas",(0,r.pi)({},o)))},e.lu=function(){var t=this;if(1===this.props.Type){var n=(0,l.pm)().AnalyzeView_Chart_Pick;return i.createElement("div",{className:"chart-control-stacked-detail-container",ref:"stacked-detail-container"},this.props.Labels.map((function(e,r){return 0===r?i.createElement("div",{className:"chart-control-stacked-detail-item",key:r.toString()},i.createElement("span",null,n.format((0,l.pm)().Ordinal_Numera_First)),i.createElement("canvas",{role:"presentation",className:"chart-control-detail-canvas",width:"10",height:"10"})):r===t.props.Labels.length-1?i.createElement("div",{className:"chart-control-stacked-detail-item",key:r.toString()},i.createElement("canvas",{role:"presentation",className:"chart-control-detail-canvas",width:"10",height:"10"}),i.createElement("span",null,n.format((0,l.pm)().Ordinal_Numera_Last))):i.createElement("div",{className:"chart-control-stacked-detail-item",key:r.toString()},i.createElement("canvas",{role:"presentation",className:"chart-control-detail-canvas",width:"10",height:"10"}))})))}return i.createElement("div",{className:"chart-control-stacked-detail-container",ref:"stacked-detail-container"},this.props.Data.map((function(t){return i.createElement("div",{className:"chart-control-stacked-detail-item",key:t.label},i.createElement("canvas",{role:"presentation",className:"chart-control-detail-canvas",width:"10",height:"10"}),i.createElement("span",null,t.label))})))},n}(h.r)},25306:function(t,n,e){"use strict";e.d(n,{A:function(){return u},E:function(){return a}});var r=e(59312),i=e(63804),o=e(36215),s=e(93387),u=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.th=i.createRef(),n}(0,r.ZT)(n,t);var e=n.prototype;return e.render=function(){var t;return(t=o.clone(this.props)||{}).children=this.props.Text,t.ref=this.th,t.HTMLAttributes=o.clone(t.HTMLAttributes)||{},t.HTMLAttributes["aria-label"]=t.HTMLAttributes["aria-label"]||this.props.Text,i.createElement(s.zx,(0,r.pi)({},t))},e.focus=function(){this.th.current&&this.th.current.focus()},n}(e(23112).r);function a(t){return i.createElement(u,(0,r.pi)({},t))}},50434:function(t,n,e){"use strict";e.d(n,{EE:function(){return S},KR:function(){return C},nX:function(){return F},uV:function(){return N},DQ:function(){return T},LP:function(){return k},UL:function(){return x},UV:function(){return D},q2:function(){return E},Iy:function(){return R},a1:function(){return A}});var r=e(63804),i=e(36215),o=e(13877),s=e(10836),u=e(7645),a=e(67661),c=e(64290),l=e(3424),f=["mp3","aif","iff","m3u","m4a","mid","mpa","ra","wav","wma"],h=["xls","xlt","xlm","xlsx","xlsm","xltx","xltm"],d=["jpg","jpeg","png","gif","bmp","tiff","psd","thm","yuv","ai","drw","eps","ps","svg","3dm","max"],m=["ppt","pot","pps","pptx","pptm","potx","potm","ppam","ppsx","ppsm","sldx","sldm"],v=["pdf"],p=["avi","mp4","mov","wmv","asf","3g2","3gp","asx","flv","mpg","rm","swf","vob"],g=["doc","dot","wbk","docx","docm","dotx","dotm","docb"],b={};f.forEach((function(t){return b[t]="Audio"})),h.forEach((function(t){return b[t]="Excel"})),d.forEach((function(t){return b[t]="Image"})),m.forEach((function(t){return b[t]="PowerPoint"})),v.forEach((function(t){return b[t]="PDF"})),p.forEach((function(t){return b[t]="Video"})),g.forEach((function(t){return b[t]="Word"}));var w={Audio:f,Excel:h,Image:d,PDF:v,PowerPoint:m,Video:p,Word:g},y={Audio:{Color:"#666666",Name:"Microphone"},Excel:{Color:"#217346",Name:"ExcelDocument"},Image:{Color:"#666666",Name:"Photo2"},PDF:{Color:"#666666",Name:"PDF"},PowerPoint:{Color:"#B7472A",Name:"PowerPointDocument"},Text:{Color:"#666666",Name:"TextField"},Video:{Color:"#666666",Name:"Video"},Word:{Color:"#2B579A",Name:"WordDocument"}},I="officeforms.fileuploaddialogmap",S={"10MB":10,"100MB":100,"1GB":1e3};function C(t){if((0,c.md)((function(){(0,s.cr)("CustomerVoiceCDSFileUpload")&&t.isFieldReady(a.x.Schema.FileUploadStorage)&&"cds"===t.Model.FileUploadStorage&&t.isFieldReady(t.Schema.FileUploadFormInfo)&&(t.Schema.FileUploadFormInfo=null)})),t.isFieldReady(t.Schema.FileUploadFormInfo)&&t.Model.FileUploadFormInfo&&t.Model.FileUploadFormInfo.errorCode&&"3"!==t.Model.FileUploadFormInfo.errorCode)return(0,u.pm)().UploadFile_ErrorMessage_PortalPage_FormCard_Bar}function F(t){var n=(0,u.pm)(),e="";switch(t){case"3":e=n.UploadFile_ErrorMessage_ErrorCode_3;break;case"6611":e=n.Error_Message_6611;break;case"6612":e=n.Error_Message_6612;break;case"6613":e=n.Error_Message_6613;break;case"6614":e=n.Error_Message_6614;break;default:e=n.UploadFile_Creation_Error_Message}return e}function N(t,n){var e="";switch(t){case 1:e=(0,u.pm)().UploadFile_ErrorMessage_DesignPage_1;break;case 14:e=(0,u.pm)().UploadFile_ErrorMessage_DesignPage_14;break;case 16:e=(0,u.pm)().UploadFile_ErrorMessage_DesignPage_16;break;default:e=(0,u.pm)().UploadFile_Creation_Error_Message}return n?e=(0,u.pm)().UploadFile_ErrorMessage_DesignPage_AnonymousDisabled+" "+e:e||(e=(0,u.pm)().UploadFile_Creation_Error_Message),e}function T(t){var n=[];return Object.keys(t).forEach((function(e){t[e]&&(n=n.concat(w[e]))})),n}function k(t){var n=P(t),e={className:"forms-icon-size20x20 office-form-theme-quiz-point analyze-view-file-icon",style:{color:n.Color}};return r.createElement(l.F,{HTMLAttributes:e,IconName:n.Name})}function x(t,n){switch(n){case"Audio":return t.UploadFile_Type_Audio;case"Excel":return t.UploadFile_Type_Excel;case"Image":return t.UploadFile_Type_Image;case"PowerPoint":return t.UploadFile_Type_PowerPoint;case"PDF":return t.UploadFile_Type_PDF;case"Video":return t.UploadFile_Type_Video;case"Word":return t.UploadFile_Type_Word;default:return""}}function P(t){var n=t.split("."),e=n[n.length-1].toLowerCase();return y[b[e]]||{Color:"#666666",Name:"TextDocument"}}function D(t){var n=P(t);return'<i class="ms-Icon ms-Icon--'+n.Name+' forms-icon-size20x20 response-dialog-fileIcon office-form-theme-quiz-point" style="color: '+n.Color+';"></i>'}function E(t,n){var e=t.Model.Id,r=!!i.find(t.Model.Questions,(function(t){return"Question.FileUpload"===t.Type}));if(R(e)||!r){var s=L(),u=i.find(s,(function(t){return t.FormId===e}));u?u.ShowConfirmDialog=u.ShowConfirmDialog&&n:s.push({FormId:e,ShowConfirmDialog:!0}),(0,o.$o)().setItem(I,JSON.stringify(s))}}function R(t){var n=i.find(L(),(function(n){return n.FormId===t}));return!!n&&n.ShowConfirmDialog}function L(){var t=[],n=(0,o.$o)().getItem(I);return n&&(t=JSON.parse(n)),t}function A(t){var n=t.Model.FileTypes;Object.keys(n).forEach((function(t){n[t]=!0}))}},77145:function(t,n,e){"use strict";e.d(n,{d:function(){return h}});var r=e(59312),i=e(63804),o=e(262),s=e(64459),u=e(7645),a=e(49306),c=e(67661),l=e(64290),f=e(77309),h=function(t){function n(n){var e=t.call(this,n)||this;return e.state={LabelDetailLoaded:!1,LabelsLoaded:!1},e.nh=function(){return e.forceUpdate()},e.props.FormMaster.observe(e.nh,[e.props.FormMaster.Schema.DataClassificationLabel]),e}(0,r.ZT)(n,t);var e=n.prototype;return e.componentDidMount=function(){var t=this;this.props.DesignTimeView&&(0,a.I)().then((function(n){t.eh=(0,s.d)(n),t.setState({LabelsLoaded:!0})})),!this.props.DesignTimeView&&this.props.FormMaster.isFieldReady(c.x.Schema.DataClassificationLabel)&&(0,a.F)(this.props.FormMaster.Model.OwnerTenantId,this.props.FormMaster.Model.DataClassificationLabel).then((function(n){t.ih=n,t.setState({LabelDetailLoaded:!0})}))},e.componentWillUnmount=function(){this.props.FormMaster.unobserve(this.nh,[this.props.FormMaster.Schema.DataClassificationLabel])},e.render=function(){if(!this.props.FormMaster.isFieldReady(c.x.Schema.DataClassificationLabel)||!this.props.FormMaster.Model.DataClassificationLabel||this.props.DesignTimeView&&!this.state.LabelsLoaded||!this.props.DesignTimeView&&(!this.state.LabelDetailLoaded||!this.ih))return null;var t=this.props.FormMaster.Model.DataClassificationLabel;if(this.props.DesignTimeView)for(var n=0,e=this.eh;n<e.length;n++){var r=e[n];if(r.level===t&&!r.showInFormContent)return null}var s=(0,o.j)(this.props.HTMLAttributes&&this.props.HTMLAttributes.className,"__data-classification-label__");return(0,l.pd)((function(){return i.createElement(f.L,{Role:"Status",LazyRendering:!0},i.createElement("div",{className:s,"aria-label":(0,u.pm)().DesignPage_SettingsPane_DataClassification_External_Title.format(t)},t))}),(function(){return i.createElement("div",{className:s},t)}))},n}(e(23112).r)},36465:function(t,n,e){"use strict";e.d(n,{Y:function(){return a}});var r=e(59312),i=e(63804),o=e(7645),s=e(54496),u=e(3424),a=function(t){function n(n){var e=t.call(this,n)||this;return e.state={HasTextCompliment:!!e.props.Insight.TextComplimentCluster&&!!e.props.Insight.TextCompliment,HasTextImprovement:!!e.props.Insight.TextImprovementCluster&&!!e.props.Insight.TextImprovement},e}(0,r.ZT)(n,t);var e=n.prototype;return e.updateContent=function(){},e.insightViewDescriptionDetail=function(){return i.createElement("div",{className:"all-hands-summary-insight-container"},i.createElement("div",{className:"all-hands-summary-insight-description"},this.oh(),this.sh(),this.uh()))},e.shouldShowSourceQuestions=function(){return!1},e.insightViewSourceQuestions=function(){return null},e.ah=function(t){var n,e,r="",s="";switch(this.props.Insight.MaxRatingScore){case 5:n=2.5,e=3.5;break;case 7:n=3.5,e=5;break;default:n=5,e=7}switch(this.props.Insight.AverageRating>=e?s=(0,o.pm)().All_Hands_Summary_Insight_Title1_High:this.props.Insight.AverageRating<e&&this.props.Insight.AverageRating>n?s=(0,o.pm)().All_Hands_Summary_Insight_Title1_Middle:this.props.Insight.AverageRating<=n&&(s=(0,o.pm)().All_Hands_Summary_Insight_Title1_Low),t){case 0:r=s;break;case 1:r=(0,o.pm)().All_Hands_Summary_Insight_Title2;break;case 2:r=(0,o.pm)().All_Hands_Summary_Insight_Title3}return i.createElement("div",{className:"all-hands-summary-insight-title","aria-label":r,tabIndex:0},r)},e.oh=function(){return i.createElement("div",null,this.ah(0),i.createElement("div",{className:"all-hands-summary-insight-row-container"},i.createElement("div",{className:"all-hands-summary-insight-row-rating"},i.createElement("div",{className:"all-hands-summary-insight-icon-and-text-rating"},i.createElement(u.F,{FluentIcon:"People Community",HTMLAttributes:{className:"forms-icon-size24x24 all-hands-summary-insight-icon-rating"}}),i.createElement("div",{className:"all-hands-summary-insight-rating-row-number","aria-label":this.props.Insight.TotalResponseCount.toString(),tabIndex:0},this.props.Insight.TotalResponseCount),i.createElement("div",{className:"all-hands-summary-insight-rating-row-text","aria-label":(0,o.pm)().All_Hands_Summary_Insight_Total_Responses_Title1+(0,o.pm)().All_Hands_Summary_Insight_Total_Responses_Title2,tabIndex:0},(0,o.pm)().All_Hands_Summary_Insight_Total_Responses_Title1,i.createElement("br",null),(0,o.pm)().All_Hands_Summary_Insight_Total_Responses_Title2)),i.createElement("div",{className:"all-hands-summary-insight-icon-and-text-rating"},i.createElement(u.F,{FluentIcon:"Star",HTMLAttributes:{className:"forms-icon-size24x24 all-hands-summary-insight-icon-rating"}}),i.createElement("div",{className:"all-hands-summary-insight-rating-row-number","aria-label":this.props.Insight.AverageRating.toString(),tabIndex:0},this.props.Insight.AverageRating.toFixed(1)),i.createElement("div",{className:"all-hands-summary-insight-rating-row-text","aria-label":(0,o.pm)().All_Hands_Summary_Insight_Average_Rating_Title1+(0,o.pm)().All_Hands_Summary_Insight_Average_Rating_Title2,tabIndex:0},(0,o.pm)().All_Hands_Summary_Insight_Average_Rating_Title1,i.createElement("br",null),(0,o.pm)().All_Hands_Summary_Insight_Average_Rating_Title2)))))},e.sh=function(){var t=this.props.Insight.LikertComplimentCluster===this.props.Insight.TextComplimentCluster,n=this.lh(3,t),e=this.lh(4,t);if(n||e)return i.createElement("div",null,this.ah(1),i.createElement("div",{className:"all-hands-summary-insight-row-container"},n,t?null:e))},e.uh=function(){var t=this.props.Insight.LikertImprovementCluster===this.props.Insight.TextImprovementCluster,n=this.lh(5,t),e=this.lh(6,t);if(n||e)return i.createElement("div",null,this.ah(2),i.createElement("div",{className:"all-hands-summary-insight-row-container"},n,t?null:e))},e.lh=function(t,n){var e,r,a,c;switch(t){case 3:e=this.props.Insight.LikertComplimentCluster,r=(0,o.pm)().All_Hands_Summary_Insight_Likert_Compliment_Description.format(this.props.Insight.LikertComplimentCluster),r=(0,s.Nw)(r),a="Thumb Like",c=!!this.props.Insight.LikertComplimentCluster;break;case 4:e=this.props.Insight.TextComplimentCluster,r=(0,o.pm)().All_Hands_Summary_Insight_Text_Compliment_Description.format(this.props.Insight.TextComplimentCluster),r=(0,s.Nw)(r),a="Gift",c=this.state.HasTextCompliment;break;case 5:e=this.props.Insight.LikertImprovementCluster,r=(0,o.pm)().All_Hands_Summary_Insight_Likert_Improvement_Description.format(this.props.Insight.LikertImprovementCluster),r=(0,s.Nw)(r),a="Lightbulb Filament",c=!!this.props.Insight.LikertImprovementCluster;break;case 6:e=this.props.Insight.TextImprovementCluster,r=(0,o.pm)().All_Hands_Summary_Insight_Text_Improvement_Description.format(this.props.Insight.TextImprovementCluster),r=(0,s.Nw)(r),a="Checkmark Circle",c=this.state.HasTextImprovement}if(n&&3===t?r=(0,o.pm)().All_Hands_Summary_Insight_Compliment_Same_Description.format(e):n&&5===t&&(r=(0,o.pm)().All_Hands_Summary_Insight_Improvement_Same_Description.format(e)),r=(0,s.Nw)(r),c)return i.createElement("div",{className:"all-hands-summary-insight-row"},i.createElement("div",{className:"all-hands-summary-insight-icon-and-text"},i.createElement(u.F,{HTMLAttributes:{className:"forms-icon-size24x24 all-hands-summary-insight-icon"},FluentIcon:a}),i.createElement("div",{className:"all-hands-summary-insight-row-title","aria-label":e,tabIndex:0},e)),i.createElement("div",{className:"all-hands-summary-insight-row-description","aria-label":r,tabIndex:0,dangerouslySetInnerHTML:{__html:r}}))},n}(e(34990).N)},85977:function(t,n,e){"use strict";e.d(n,{W:function(){return c}});var r=e(59312),i=e(63804),o=e(27196),s=e(7645),u=e(54496),a=e(34990),c=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.componentWillUnmount=function(){this.fh(),this.unregisterTooltipMouseOverEventHandler(),t.prototype.componentWillUnmount.call(this)},e.componentDidMount=function(){this.fh(),this.dh(),this.registerTooltipMouseOverEventHandler(),t.prototype.componentDidMount.call(this)},e.insightViewDescriptionDetail=function(){return i.createElement("div",{className:"association-rule-insight-container"},i.createElement("div",{className:"association-rule-insight-description"},this.mh(),this.ph()))},e.shouldShowSourceQuestions=function(){return!1},e.insightViewSourceQuestions=function(){return null},e.updateContent=function(){this.fh(),this.dh(),this.registerTooltipMouseOverEventHandler(),this.gh("chartDescription")},n.getAnswerValue=function(t){var n=t.Value[0].RawValue;if("Rating"===t.Question.Type||"NPS"===t.Question.Type){var e=a.N.getRatingRange(t.Question.Choices.length);switch(t.Value[0].RawValue){case"Detractors":n=(0,s.pm)().AnalyzeView_Insight_Association_Rule_Detractor_Answer;break;case"High":n=(0,s.pm)().AnalyzeView_Insight_Association_Rule_High_Rating_Template.format(e[1][0],e[1][1]);break;case"Low":n=(0,s.pm)().AnalyzeView_Insight_Association_Rule_Low_Rating_Template.format(e[0][0],e[0][1]);break;case"Passives":n=(0,s.pm)().AnalyzeView_Insight_Association_Rule_Passive_Answer;break;case"Promoters":n=(0,s.pm)().AnalyzeView_Insight_Association_Rule_Promoter_Answer}}return(0,u.Nw)(n)},n.isCategorizedType=function(t){var n=t.Type.toUpperCase();return"RATING"===n||"NPS"===n},e.mh=function(){var t,e=this.props.Insight,r=n.isCategorizedType(e.ConditionAnswers[0].Question),o=n.isCategorizedType(e.TargetAnswer.Question),a=(t=100===Math.ceil(100*e.ConfidenceValue)?r&&o?(0,s.pm)().AnalyzeView_Insight_Association_Rule_Description_Categorized_Categorized_All:r?(0,s.pm)().AnalyzeView_Insight_Association_Rule_Description_Categorized_Common_All:o?(0,s.pm)().AnalyzeView_Insight_Association_Rule_Description_Common_Categorized_All:(0,s.pm)().AnalyzeView_Insight_Association_Rule_Description_Common_Common_All:r&&o?(0,s.pm)().AnalyzeView_Insight_Association_Rule_Description_Categorized_Categorized:r?(0,s.pm)().AnalyzeView_Insight_Association_Rule_Description_Categorized_Common:o?(0,s.pm)().AnalyzeView_Insight_Association_Rule_Description_Common_Categorized:(0,s.pm)().AnalyzeView_Insight_Association_Rule_Description_Common_Common).format(n.getAnswerValue(e.ConditionAnswers[0]),n.createSourceQuestionTooltip(e.ConditionAnswers[0].Question),n.getAnswerValue(e.TargetAnswer),n.createSourceQuestionTooltip(e.TargetAnswer.Question)),c=t.format(n.getAnswerValue(e.ConditionAnswers[0]),(0,u.Nw)(e.ConditionAnswers[0].Question.Title),n.getAnswerValue(e.TargetAnswer),(0,u.Nw)(e.TargetAnswer.Question.Title));return i.createElement("div",{"aria-label":c,className:"association-rule-insight-description-text-container",dangerouslySetInnerHTML:{__html:a},tabIndex:0})},e.ph=function(){var t,e,r=this.props.Insight;t=n.isCategorizedType(r.ConditionAnswers[0].Question)?(0,s.pm)().AnalyzeView_Insight_Association_Rule_Legend_Support_Categorized:(0,s.pm)().AnalyzeView_Insight_Association_Rule_Legend_Support_Common,e=n.isCategorizedType(r.TargetAnswer.Question)?(0,s.pm)().AnalyzeView_Insight_Association_Rule_Legend_Target_Categorized:(0,s.pm)().AnalyzeView_Insight_Association_Rule_Legend_Target_Common;var o=t.format(Math.ceil(100*r.SupportValue),n.getAnswerValue(r.ConditionAnswers[0]),n.createSourceQuestionTooltip(r.ConditionAnswers[0].Question)),c=e.format(Math.ceil(100*r.ConfidenceValue),n.getAnswerValue(r.TargetAnswer),n.createSourceQuestionTooltip(r.TargetAnswer.Question)),l=t.format(Math.ceil(100*r.SupportValue),n.getAnswerValue(r.ConditionAnswers[0]),(0,u.Nw)(r.ConditionAnswers[0].Question.Title)),f=e.format(Math.ceil(100*r.ConfidenceValue),n.getAnswerValue(r.TargetAnswer),(0,u.Nw)(r.TargetAnswer.Question.Title)),h=a.A[this.props.Index%a.A.length][0],d=a.A[this.props.Index%a.A.length][1];return i.createElement("div",{"aria-label":l+" "+f,className:"association-rule-insight-view-charts-container",tabIndex:0},i.createElement("div",{className:"association-rule-insight-view-chart"},i.createElement("div",{className:"association-rule-insight-view-chart-row"},i.createElement("div",{className:"association-rule-insight-view-support-chart"}),i.createElement("div",{className:"association-rule-insight-view-target-chart"})),i.createElement("div",{className:"association-rule-insight-view-description-row animation",ref:"chartDescription"},i.createElement("div",{className:"association-rule-insight-view-legend-container support"},i.createElement("div",{className:"association-rule-insight-view-legend-dot",style:{background:h}}),i.createElement("div",{className:"association-rule-insight-view-legend-description",dangerouslySetInnerHTML:{__html:o}})),i.createElement("div",{className:"association-rule-insight-view-legend-container target"},i.createElement("div",{className:"association-rule-insight-view-legend-dot",style:{background:d}}),i.createElement("div",{className:"association-rule-insight-view-legend-description",dangerouslySetInnerHTML:{__html:c}})))))},e.dh=function(){var t=this.props.Insight,e=Math.ceil(100*t.SupportValue),r=t.ConditionAnswers.map((function(t){return n.getAnswerValue(t)}));this.wh(e,r,0);var i=Math.ceil(100*t.ConfidenceValue),o=[n.getAnswerValue(t.TargetAnswer)];this.wh(i,o,1)},e.fh=function(){d3&&d3.select(".association-rule-insight-view-charts-container").selectAll("svg").remove()},e.wh=function(t,n,e){var r=0===e;n=n.map((function(t){return t.length>=25?t.slice(0,22)+"...":t}));var i=[{name:"main",percent:t},{name:"other",percent:100-t}],o=r?150:300,s=r?74:45,u=r?62:38,c=r?75:250,l=r?0:1,f=a.A[this.props.Index%a.A.length][l],h=d3.scale.ordinal().range([f,"#E0E0E0"]),d=d3.layout.pie().value((function(t){return t.percent})).sort(null).padAngle(.03),m=d3.svg.arc().outerRadius(s).innerRadius(u),v=r?".association-rule-insight-view-support-chart":".association-rule-insight-view-target-chart",p=d3.select(v).append("svg").attr({width:o,height:150}).append("g").attr({transform:"translate("+c+",75)"});p.selectAll("path").data(d(i)).enter().append("path").attr({d:m,fill:function(t,n){return h(t.data.name)}}).transition().duration(1e3).attrTween("d",(function(t){var n=d3.interpolate({startAngle:0,endAngle:0},t);return function(t){return m(n(t))}}));setTimeout((function(){r||p.append("path").attr({class:"association-rule-chart-pointer",d:"M -25 -40 A 43 45 0 0 0 -25 40 L -250 0"}),p.selectAll("text").data(d(i)).enter().append("text").transition().duration(200).attr("dy",".4em").attr("text-anchor","middle").attr("class","association-rule-chart-percentage-text").text((function(t,n){if(0===n)return t.data.percent+"%"}))}),1e3)},e.gh=function(t){var n=$(o.findDOMNode(this.refs[t]));n&&n.length>0&&(n.removeClass("animation"),window.setTimeout((function(){return n.addClass("animation")}),0))},n}(a.N)},24753:function(t,n,e){"use strict";e.d(n,{F:function(){return c}});var r=e(59312),i=e(63804),o=e(7645),s=e(54496),u=e(42605),a=e(40807),c=function(t){function n(n){var e=t.call(this,n)||this;return e.state={CurrentInsight:e.props.Insight.DrivingFactorAnalysisInsights[0],CurrentInsightIndex:0,RatingValue:e.props.Insight.DrivingFactorAnalysisInsights[0].AverageRating,ShowScoreEstimater:!1},e}(0,r.ZT)(n,t);var e=n.prototype;return e.updateContent=function(){},e.shouldShowSourceQuestions=function(){return!1},e.insightViewSourceQuestions=function(){return null},e.insightViewDescriptionDetail=function(){return this.state.ShowScoreEstimater?i.createElement("div",{className:"driving-factor-insight-container"},this.createDrivingFactorView()):i.createElement("div",{className:"driving-factor-insight-container"},this.createSummaryView(),this.createTopicList(),this.yh())},e.createSummaryView=function(){var t=this.Sh()[0],n=(0,o.pm)().All_Hands_Driving_Factor_Analysis_Insight_Summary_Description.format(t);return n=(0,s.Nw)(n),i.createElement("div",{className:"driving-factor-insight-summary-container"},i.createElement("div",{className:"driving-factor-insight-summary-title-container"},i.createElement("div",{className:"driving-factor-insight-summary-title"},(0,o.pm)().All_Hands_Driving_Factor_Analysis_Insight_Summary_Title.format(t))),i.createElement("div",{className:"driving-factor-insight-summary-description-container"},i.createElement("div",{className:"driving-factor-insight-summary-description",dangerouslySetInnerHTML:{__html:n}})))},e.createTopicList=function(){var t=this,n=this.Sh(),e=[];return n.forEach((function(n,r){var i=t.state.CurrentInsight.Importance[n];i>.2?e[r]=(0,o.pm)().All_Hands_Driving_Factor_Analysis_Insight_Impact_Level_High:i>.1&&i<.2?e[r]=(0,o.pm)().All_Hands_Driving_Factor_Analysis_Insight_Impact_Level_Middle:i<.1&&(e[r]=(0,o.pm)().All_Hands_Driving_Factor_Analysis_Insight_Impact_Level_Low)})),i.createElement("div",{className:"driving-factor-insight-topic-list-container"},i.createElement("div",{className:"driving-factor-insight-topic-list-column-title"},i.createElement("div",{className:"driving-factor-insight-topic-list-column-topics"},(0,o.pm)().All_Hands_Driving_Factor_Analysis_Insight_Topics),i.createElement("div",{className:"driving-factor-insight-topic-list-column-impact-level"},(0,o.pm)().All_Hands_Driving_Factor_Analysis_Insight_Impact_Level)),i.createElement("div",{className:"driving-factor-insight-topic-list"},n.map((function(t,n){var r="driving-factor-insight-topic-list-item-topic",s="driving-factor-insight-topic-list-item-impact-level";return e[n]===(0,o.pm)().All_Hands_Driving_Factor_Analysis_Insight_Impact_Level_High&&(r="driving-factor-insight-topic-list-item-topic-highlight",s="driving-factor-insight-topic-list-item-impact-level-highlight"),i.createElement("div",{className:"driving-factor-insight-topic-list-item",key:n},i.createElement("div",{className:r},t),i.createElement("div",{className:s},e[n]))})),i.createElement("div",{className:"driving-factor-insight-score-estimater-button",onClick:function(){t.setState({ShowScoreEstimater:!0})}},(0,o.pm)().All_Hands_Driving_Factor_Analysis_Insight_Score_Estimate)))},e.createDrivingFactorView=function(){var t=this,n=this.Sh(),e=this.state.CurrentInsight.InitialPoints,r=this.state.CurrentInsight.Contributions,s=[];return n.forEach((function(n,e){var r=t.state.CurrentInsight.Importance[n];r>.2?s[e]=(0,o.pm)().All_Hands_Driving_Factor_Analysis_Insight_Impact_Level_With_Title_High:r>.1&&r<.2?s[e]=(0,o.pm)().All_Hands_Driving_Factor_Analysis_Insight_Impact_Level_With_Title_Middle:r<.1&&(s[e]=(0,o.pm)().All_Hands_Driving_Factor_Analysis_Insight_Impact_Level_With_Title_Low)})),i.createElement("div",{className:"driving-factor-insight-score-estimater-container"},i.createElement("div",{className:"driving-factor-insight-score-estimater-title-container"},this.Ch(),i.createElement("div",{className:"driving-factor-insight-score-estimater-title"},(0,o.pm)().All_Hands_Driving_Factor_Analysis_Insight_Score_Estimater_Title)),i.createElement("div",{className:"driving-factor-insight-detail-container"},i.createElement("div",{className:"driving-factor-insight-detail-description-container"},i.createElement("div",{className:"driving-factor-insight-detail-description"},(0,o.pm)().All_Hands_Driving_Factor_Analysis_Insight_Detail_Description),i.createElement("div",{className:"driving-factor-insight-detail-rating-container"},i.createElement("div",{className:"driving-factor-insight-detail-rating-title"},(0,o.pm)().All_Hands_Driving_Factor_Analysis_Insight_Detail_Rating_Title),i.createElement("div",{className:"driving-factor-insight-detail-rating-score"},this.state.RatingValue.toFixed(1)))),i.createElement("div",{className:"driving-factor-insight-key-influencer-list"},n.map((function(n,o){return i.createElement("div",{className:"driving-factor-insight-key-influencer-container",key:o},i.createElement("div",{className:"driving-factor-insight-key-influencer-title-dot"}),i.createElement("div",{className:"driving-factor-insight-key-influencer-title"},n),i.createElement("div",{className:"driving-factor-insight-key-influencer-impact-level"},s[o]),i.createElement("div",{className:"driving-factor-insight-key-influencer-slidebar-container"},i.createElement("div",{className:"driving-factor-insight-key-influencer-slidebar"},i.createElement("input",{type:"range",className:"driving-factor-insight-key-influencer-slidebar-slider",min:0,max:r[n].length-1,defaultValue:Math.floor(10*(e[n]-1)).toString(),onChange:function(e){t.Fh(o,r[n][parseInt(e.target.value)])}})),i.createElement("div",{className:"driving-factor-insight-key-influencer-endpoint-left"},t.state.CurrentInsight.EndPoints.m_Item1),i.createElement("div",{className:"driving-factor-insight-key-influencer-endpoint-right"},t.state.CurrentInsight.EndPoints.m_Item2)))})))))},e.Ch=function(){var t=this,n={ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"driving-factor-insight-score-estimater-back-button",onClick:function(){t.setState({RatingValue:t.state.CurrentInsight.AverageRating,ShowScoreEstimater:!1})}},FluentIcon:"Arrow Left",IconClassName:"forms-icon-size18x18"};return(0,u.F)(n)},e.Sh=function(){var t=this,n=Object.keys(this.state.CurrentInsight.InitialPoints);return n.sort((function(n,e){return t.state.CurrentInsight.Importance[n]-t.state.CurrentInsight.Importance[e]})),n.reverse(),n},e.Fh=function(t,n){var e=this,r=0,i=this.Sh(),o=[];i.forEach((function(t,n){var r=e.state.CurrentInsight.Contributions[t];o[n]=r[Math.floor(10*(e.state.CurrentInsight.InitialPoints[t]-1))]})),o[t]=n,o.forEach((function(t){r+=t})),r+=this.state.CurrentInsight.AverageRating,this.setState({RatingValue:r})},e.Nh=function(t){var n=this;this.setState({CurrentInsight:this.props.Insight.DrivingFactorAnalysisInsights[t],CurrentInsightIndex:t},(function(){n.setState({RatingValue:n.state.CurrentInsight.AverageRating})}))},e.yh=function(){var t={CurrentInsightIndex:this.state.CurrentInsightIndex,HandleInsightData:this.Nh,Questions:this.props.Insight.DrivingFactorAnalysisInsights.map((function(t){return t.LikertQuestion}))};return(0,a.T)(t)},n}(e(34990).N)},40807:function(t,n,e){"use strict";e.d(n,{T:function(){return a}});var r=e(59312),i=e(63804),o=e(7645),s=e(61111),u=function(t){function n(n){var e=t.call(this,n)||this;return e.state={currentQuestion:e.props.Questions[e.props.CurrentInsightIndex],currentQuestionIndex:e.props.CurrentInsightIndex},e}(0,r.ZT)(n,t);var e=n.prototype;return e.render=function(){var t=this,n=this.state.currentQuestion,e=(0,o.pm)().AnalyzeView_Insight_Response_Sentiment_Dropdown_Option,r=e.format(n.QuestionOrder,n.Title),u=this.props.Questions.map((function(n){return{Disabled:n.Id===t.state.currentQuestion.Id,DisplayName:e.format(n.QuestionOrder,n.Title),Key:n.QuestionOrder,Value:e.format(n.QuestionOrder,n.Title)}})),a=(0,s.E)({HTMLAttributes:{"aria-label":r,className:"response-sentiment-insight-collection-dropdown"},Label:r,onValueChange:this.kh,Placeholder:r,SelectOptions:u,Value:r});return i.createElement("div",{className:"all-hands-rating-distribution-insight-dropdown-container"},i.createElement("div",{className:"all-hands-rating-distribution-insight-dropdown-title"},(0,o.pm)().All_Hands_Insight_Dropdown_Title),i.createElement("div",{className:"insight-view-dropdown-element"},a))},e.kh=function(t){var n=this,e=(0,o.pm)().AnalyzeView_Insight_Response_Sentiment_Dropdown_Option;this.props.Questions.forEach((function(r,i){e.format(r.QuestionOrder,r.Title)!==t||n.setState({currentQuestionIndex:i},(function(){n.props.HandleInsightData(n.state.currentQuestionIndex)}))}))},n}(e(23112).r);function a(t){return i.createElement(u,(0,r.pi)({},t))}},34990:function(t,n,e){"use strict";e.d(n,{A:function(){return h},N:function(){return d}});var r=e(59312),i=e(63804),o=e(27196),s=e(36215),u=e(7645),a=e(54496),c=e(55890),l=e(3424),f=e(23112),h=[["#0078d8","#01439e"],["#ee2872","#a7183f"],["#8cc83f","#458114"],["#13a89f","#066a62"],["#922790","#5e115d"],["#e92224","#a3140b"],["#4655a0","#182d72"],["#672e91","#3a0f62"],["#117d10","#044604"]],d=function(t){function n(n){var e=t.call(this,n)||this;return e.xh=Date.now(),e.props.setCurrentViewInsight(e.props.Insight),e.Ph=e.Ph.bind(e),e}(0,r.ZT)(n,t);var e=n.prototype;return e.componentWillUpdate=function(t,n){this.Dh=!s.isEqual(this.props,t)||!s.isEqual(this.state,n)},e.componentDidUpdate=function(){this.Dh&&(this.registerTooltipMouseOverEventHandler(),this.Rh(),this.props.focusOnInsightDialog(),this.updateContent())},e.componentDidMount=function(){this.props.focusOnInsightDialog(),this.registerTooltipMouseOverEventHandler()},e.componentWillUnmount=function(){this.Rh(),this.unregisterTooltipMouseOverEventHandler()},e.render=function(){return i.createElement("div",{className:"insight-view-content",ref:"insight-content"},this.Lh(),this.qh())},e.Lh=function(){return i.createElement("div",{className:"insight-view-description-summary"},i.createElement("div",{className:"insight-view-description-summary-detail"},this.insightViewDescriptionDetail()))},e.qh=function(){var t=this;if(!this.shouldShowSourceQuestions())return null;var n=null;this.state.ShowSourceDetail&&(n=this.insightViewSourceQuestions());var e={"aria-label":this.getSourceButtonTitle(),className:"insight-view-descrption-source-title",onClick:function(){return t.setState({ShowSourceDetail:!t.state.ShowSourceDetail})},tabIndex:0,onKeyDown:function(n){13!==n.keyCode&&32!==n.keyCode||t.setState({ShowSourceDetail:!t.state.ShowSourceDetail})}};return i.createElement("div",{className:"insight-view-source-questions"},i.createElement("div",{className:"insight-view-description-source-container"},i.createElement("div",(0,r.pi)({},e),i.createElement("span",{className:"insight-view-description-source-text"},this.getSourceButtonTitle()),i.createElement(l.F,{FluentIcon:this.state.ShowSourceDetail?"Chevron Up":"Chevron Down",HTMLAttributes:{className:"insight-view-description-source-icon forms-icon-size14x14 select-placeholder-arrow"}}))),n)},e.shouldShowSourceQuestions=function(){return!0},e.getSourceButtonTitle=function(){return(0,u.pm)().AnalyzeView_Insight_Source_Title},e.createSourceQuestionTitle=function(t){return(0,u.pm)().AnalyzeView_Insight_Source_Question_Template.format(t.QuestionOrder,t.Title)},n.createSourceQuestionTooltip=function(t){return'<span class="insight-tooltip">'+(0,u.pm)().AnalyzeView_Insight_Tooltip_Template.format(t.QuestionOrder)+'<span class="insight-tooltip-text">'+(0,u.pm)().Analyze_Insight_summary_Question_Title.format(t.QuestionOrder,(0,a.Nw)(t.Title))+"</span></span>"},e.registerTooltipMouseOverEventHandler=function(){var t=this,n=document.getElementsByClassName("insight-tooltip");s.forEach(n,(function(n){n.addEventListener("mouseover",t.Ph)}))},e.unregisterTooltipMouseOverEventHandler=function(){var t=this,n=document.getElementsByClassName("insight-tooltip");s.forEach(n,(function(n){n.removeEventListener("mouseover",t.Ph)}))},n.getRatingRange=function(t){var n=0;switch(t){default:case 2:case 3:n=0;break;case 4:case 5:case 6:case 7:n=1;break;case 8:case 9:n=2;break;case 10:n=3}return[[1,1+n],[t-n,t]]},e.Ph=function(t){var n=t.currentTarget,e=o.findDOMNode(this.refs["insight-content"]),r=n.firstElementChild,i=n.getBoundingClientRect(),s=e.getBoundingClientRect();i.right+125>s.right?r.style.left="-"+r.clientWidth+"px":i.left-125<s.left&&(r.style.left="0px"),i.top+125>s.bottom&&(r.style.top="-"+(r.clientHeight+15)+"px")},e.Rh=function(){(0,c.$U)("DesignPage.Responses.ReleaseInsightView",{Duration:Date.now()-this.xh,InsightType:this.props.Insight.Type}),this.xh=Date.now()},n}(f.r)},72581:function(t,n,e){"use strict";e.d(n,{q:function(){return a}});var r=e(59312),i=e(63804),o=e(7645),s=e(54496),u=e(40807),a=function(t){function n(n){var e=t.call(this,n)||this;return e.state={CurrentInsight:e.props.Insight.LikertImpactAnalysisInsights[0],CurrentInsightIndex:0},e}(0,r.ZT)(n,t);var e=n.prototype;return e.shouldShowSourceQuestions=function(){return!1},e.insightViewSourceQuestions=function(){return null},e.updateContent=function(){},e.insightViewDescriptionDetail=function(){return i.createElement("div",{className:"likert-impact-insight-container"},this.createSummaryView(),this.Oh(),this.yh())},e.createSummaryView=function(){var t,n;return this.props.Insight.Flag?(t=this.state.CurrentInsight.KeyWords?(0,o.pm)().All_Hands_Likert_Impact_Analysis_Insight_Summary_Title_Positive_Keyword.format(this.state.CurrentInsight.KeyWords[0]):(0,o.pm)().All_Hands_Likert_Impact_Analysis_Insight_Summary_Title_Positive,n=this.state.CurrentInsight.KeyWords?(0,o.pm)().All_Hands_Likert_Impact_Analysis_Insight_Summary_Description_Positive_Keyword.format(this.state.CurrentInsight.KeyWords[0]):(0,o.pm)().All_Hands_Likert_Impact_Analysis_Insight_Summary_Description_Positive,n=(0,s.Nw)(n)):(t=this.state.CurrentInsight.KeyWords?(0,o.pm)().All_Hands_Likert_Impact_Analysis_Insight_Summary_Title_Negative_Keyword.format(this.state.CurrentInsight.KeyWords[0]):(0,o.pm)().All_Hands_Likert_Impact_Analysis_Insight_Summary_Title_Negative,n=this.state.CurrentInsight.KeyWords?(0,o.pm)().All_Hands_Likert_Impact_Analysis_Insight_Summary_Description_Negative_Keyword.format(this.state.CurrentInsight.KeyWords[0]):(0,o.pm)().All_Hands_Likert_Impact_Analysis_Insight_Summary_Description_Negative,n=(0,s.Nw)(n)),i.createElement("div",{className:"likert-impact-insight-summary-container"},i.createElement("div",{className:"likert-impact-insight-summary-title-container"},i.createElement("div",{className:"likert-impact-insight-summary-title"},t)),i.createElement("div",{className:"likert-impact-insight-summary-description-container"},i.createElement("div",{className:"likert-impact-insight-summary-description",dangerouslySetInnerHTML:{__html:n}})))},e.Oh=function(){return this.Uh(),i.createElement("div",{className:"likert-impact-insight-chart-container"},this.state.CurrentInsight.LikertStatement.map((function(t,n){var e=(0,o.pm)().All_Hands_Likert_Impact_Analysis_Insight_Chart_Data.format((100*t.m_Item2).toFixed(0)),r="likert-impact-insight-chart-item-dot-hidden",s="likert-impact-insight-chart-item-sentence",u="likert-impact-insight-chart-item-bar",a="likert-impact-insight-chart-item-data-hidden";return n<2&&(r="likert-impact-insight-chart-item-dot",s="likert-impact-insight-chart-item-sentence-highlight",u="likert-impact-insight-chart-item-bar-highlight",a="likert-impact-insight-chart-item-data"),i.createElement("div",{className:"likert-impact-insight-chart-item",key:n},i.createElement("div",{className:r}),i.createElement("div",{className:"likert-impact-insight-chart-item-sentence-container"},i.createElement("div",{className:s},t.m_Item1)),i.createElement("div",{className:"likert-impact-insight-chart-item-bar-container",id:"bar-"+n},i.createElement("div",{className:u})),i.createElement("div",{className:a},e))})))},e.Uh=function(){var t=this,n=this.state.CurrentInsight.LikertStatement[0].m_Item2;setTimeout((function(){t.state.CurrentInsight.LikertStatement.forEach((function(t,e){document.getElementById("bar-"+e).style.width=t.m_Item2/n*220+"px"}))}),100)},e.Nh=function(t){this.setState({CurrentInsight:this.props.Insight.LikertImpactAnalysisInsights[t],CurrentInsightIndex:t})},e.yh=function(){var t={CurrentInsightIndex:this.state.CurrentInsightIndex,HandleInsightData:this.Nh,Questions:this.props.Insight.LikertImpactAnalysisInsights.map((function(t){return t.LikertGroup}))};return(0,u.T)(t)},n}(e(34990).N)},84280:function(t,n,e){"use strict";e.d(n,{C:function(){return p}});var r,i=e(59312),o=e(63804),s=e(36215),u=e(262),a=e(7645),c=e(54496),l=e(46008),f=e(55890),h=e(3424),d=e(61111),m=e(25306),v=e(34990);!function(t){t[t.Positive=0]="Positive",t[t.Neutral=1]="Neutral",t[t.Negative=2]="Negative"}(r||(r={}));var p=function(t){function n(n){var e=t.call(this,n)||this;e._h=e._h.bind(e);var i=(0,l.Ei)(s.max(e.props.Insight.ResponseSentimentInsights,(function(t){return t.Score})));return e.props.setCurrentViewInsight(i),e.state={ActiveDetail:r.Negative,ActiveInsight:i},e}(0,i.ZT)(n,t);var e=n.prototype;return e.updateContent=function(){this.state.ShowSourceDetail&&this.Na()},e.getSourceButtonTitle=function(){return this.state.ShowSourceDetail?(0,a.pm)().AnalyzeView_Insight_Response_Sentiment_Hide_Detail:(0,a.pm)().AnalyzeView_Insight_Response_Sentiment_Show_Detail},e.insightViewSourceQuestions=function(){return o.createElement("div",{className:"response-sentiment-insight-detail-container"},o.createElement("div",{className:"response-sentiment-insight-detail-buttons-container"},this.ta(r.Negative),this.ta(r.Neutral),this.ta(r.Positive)),o.createElement("div",{className:"response-sentiment-insight-detail-grid-container"},o.createElement("div",{className:"response-sentiment-insight-detail-grid-wraper"})))},e.insightViewDescriptionDetail=function(){return o.createElement("div",{className:"response-sentiment-insight-container"},this.mh(),this.zh(),this.ph())},e.mh=function(){var t=(0,a.pm)().AnalyzeView_Insight_Response_Sentiment_Collection_Description;return o.createElement("div",{className:"insight-description-text-container"},o.createElement("div",{"aria-label":t,className:"insight-description-text",tabIndex:0},t))},e.zh=function(){var t=this.state.ActiveInsight,n=(0,a.pm)().AnalyzeView_Insight_Response_Sentiment_Dropdown_Option,e=n.format(t.TextQuestion.QuestionOrder,t.TextQuestion.Title),r=this.props.Insight.ResponseSentimentInsights.map((function(e){var r=e.TextQuestion;return{Disabled:e.TextQuestion.Id===t.TextQuestion.Id,DisplayName:n.format(r.QuestionOrder,r.Title),Key:r.QuestionOrder,Value:n.format(r.QuestionOrder,r.Title)}})),i=(0,d.E)({HTMLAttributes:{"aria-label":e,className:"response-sentiment-insight-collection-dropdown"},Label:e,onValueChange:this._h,Placeholder:e,SelectOptions:r,Value:e}),s=(0,a.pm)().AnalyzeView_Insight_Response_Sentiment_Dropdown_Title;return o.createElement("div",{className:"response-sentiment-insight-dropdown-container"},o.createElement("div",{className:"response-sentiment-insight-dropdown-title"},s),o.createElement("div",{className:"insight-view-dropdown-element"},i))},e.ph=function(){if(this.state.ShowSourceDetail)return null;var t=this.state.ActiveInsight,n=(0,a.pm)().AnalyzeView_Insight_Response_Sentiment_Description.format(t.TextQuestion.QuestionOrder,t.TextQuestion.Title);return o.createElement("div",{className:"response-sentiment-insight-chart-container"},o.createElement("div",{"aria-label":n,className:"response-sentiment-insight-chart",tabIndex:0},o.createElement("div",{className:"response-sentiment-insight-emojis-container"},this.Qh(r.Negative),this.Qh(r.Neutral),this.Qh(r.Positive))))},e.Qh=function(t){var e,i,s,c=this.state.ActiveInsight,l=n.getOutstandingSentiments(this.state.ActiveInsight);switch(t){case r.Positive:i="Emoji",e=(0,a.pm)().AnalyzeView_Insight_Response_Sentiment_Positive,s=c.PositiveResponses.length;break;case r.Negative:i="Emoji Sad",e=(0,a.pm)().AnalyzeView_Insight_Response_Sentiment_Negative,s=c.NegativeResponses.length;break;case r.Neutral:i="Emoji Meh",e=(0,a.pm)().AnalyzeView_Insight_Response_Sentiment_Neutral,s=c.NeutralResponses.length;break;default:return null}var f,d=(0,h.M)({FluentIcon:i,HTMLAttributes:{className:"response-sentiment-insight-emoji-icon"}}),m="response-sentiment-insight-element-emoji",v="response-sentiment-insight-element-title",p="response-sentiment-insight-element-number";return l.indexOf(t)>=0&&(m=(0,u.j)(m,r[t].toLowerCase()),v=(0,u.j)(v,r[t].toLowerCase()),p=(0,u.j)(p,r[t].toLowerCase())),f=1===s?(0,a.pm)().AnalyzeView_Insight_Response_Sentiment_Single_Response_Count.format(s):(0,a.pm)().AnalyzeView_Insight_Response_Sentiment_Multi_Response_Count.format(s),o.createElement("div",{className:"response-sentiment-insight-emoji-container"},o.createElement("div",{className:m},d),o.createElement("div",{className:v},e),o.createElement("div",{className:p},f))},e.Na=function(){var t,n=this.state.ActiveInsight;switch(this.state.ActiveDetail){case r.Positive:t=n.PositiveResponses;break;case r.Negative:t=n.NegativeResponses;break;case r.Neutral:t=n.NeutralResponses;break;default:t=new Array}var e=t.map((function(t){return[t.m_Item1,(0,c.Nw)(t.m_Item2.RawValue)]}));$(".response-sentiment-insight-detail-grid").remove(),$(".response-sentiment-insight-detail-grid-wraper").append("<table class='response-sentiment-insight-detail-grid hover stripe cell-border'>"),$(".response-sentiment-insight-detail-grid").DataTable({autoWidth:!0,columns:[{title:(0,a.pm)().AnalyzeView_Insight_Response_Sentiment_Id},{title:(0,a.pm)().Common_Responses_Text}],data:e,info:!1,paging:!1,searching:!1})},e.ta=function(t){var n,e=this;switch(t){case r.Positive:n=(0,a.pm)().AnalyzeView_Insight_Response_Sentiment_Positive;break;case r.Negative:n=(0,a.pm)().AnalyzeView_Insight_Response_Sentiment_Negative;break;case r.Neutral:n=(0,a.pm)().AnalyzeView_Insight_Response_Sentiment_Neutral;break;default:return null}var s="response-sentiment-insight-detail-button",c="response-sentiment-insight-detail-button-header";t===this.state.ActiveDetail&&(s=(0,u.j)(s,"selected"),c=(0,u.j)(c,"selected"));var l={ButtonStyle:0,HTMLAttributes:{className:s,onClick:function(){(0,f.$U)("DesignPage.Responses.ResponseSentimentInsight.SwitchSentiment",{SentimentType:t}),e.setState({ActiveDetail:t})}},Text:n},h=o.createElement(m.A,(0,i.pi)({},l));return o.createElement("div",{className:"response-sentiment-insight-detail-button-container"},o.createElement("div",{className:c}),h)},n.getOutstandingSentiments=function(t){var n=[{SentimentCount:t.NegativeResponses.length,SentimentType:r.Negative},{SentimentCount:t.NeutralResponses.length,SentimentType:r.Neutral},{SentimentCount:t.PositiveResponses.length,SentimentType:r.Positive}],e=(0,l.Ei)(s.max(n,(function(t){return t.SentimentCount})));return n.filter((function(t){return t.SentimentCount===e.SentimentCount})).map((function(t){return t.SentimentType}))},e._h=function(t){var n=this,e=(0,a.pm)().AnalyzeView_Insight_Response_Sentiment_Dropdown_Option;this.props.Insight.ResponseSentimentInsights.forEach((function(r){var i=r.TextQuestion;if(e.format(i.QuestionOrder,i.Title)===t)return(0,f.$U)("DesignPage.Responses.ResponseSentimentInsight.SwitchQuestion",{InsightScore:r.Score,QuestionId:r.TextQuestion.Id,QuestionIndex:r.TextQuestion.QuestionOrder,QuestionSentimentConfidence:r.TextQuestion.SentimentConfidence,QuestionTag:r.TextQuestion.Tag}),n.props.setCurrentViewInsight(r),void n.setState({ActiveInsight:r})}))},n}(v.N)},12180:function(t,n,e){"use strict";e.d(n,{W:function(){return a}});var r=e(59312),i=e(63804),o=e(7645),s=e(42605),u=e(40807),a=function(t){function n(n){var e=t.call(this,n)||this;return e.state={CurrentInsight:e.props.Insight.AllHandsTextClusterInsights[0],CurrentInsightIndex:0,SelectedTopic:"",ShowDetails:!1},e}(0,r.ZT)(n,t);var e=n.prototype;return e.shouldShowSourceQuestions=function(){return!1},e.insightViewSourceQuestions=function(){return null},e.updateContent=function(){},e.insightViewDescriptionDetail=function(){return i.createElement("div",{className:"all-hands-text-cluster-insight-container"},this.Hh(),this.jh())},e.initBar=function(){var t=this,n=this.Sh(),e=this.state.CurrentInsight.TextClusters[n[0]].length;setTimeout((function(){n.forEach((function(n,r){document.getElementById("topic-"+r).style.width=t.state.CurrentInsight.TextClusters[n].length/e*313+"px"}))}),100)},e.Hh=function(){if(!this.state.ShowDetails)return i.createElement("div",null,i.createElement("div",{className:"all-hands-text-cluster-insight-description"},this.$h()),i.createElement("div",{className:"all-hands-text-cluster-insight-detail"},this.Kh()),this.yh())},e.Kh=function(){var t=this,n=this.Sh();if(this.initBar(),!this.state.ShowDetails)return i.createElement("div",{className:"all-hands-text-cluster-insight-topic-list-container"},n.map((function(n,e){var r="all-hands-text-cluster-insight-topic-list-item-bar-item";return e<2&&(r="all-hands-text-cluster-insight-topic-list-item-bar-item-highlight"),i.createElement("div",{className:"all-hands-text-cluster-insight-topic-list-item",key:e,onClick:function(){t.setState({SelectedTopic:n,ShowDetails:!0})}},i.createElement("div",{className:"all-hands-text-cluster-insight-topic-list-item-title-container"},i.createElement("div",{className:"all-hands-text-cluster-insight-topic-list-item-title"},n)),i.createElement("div",{className:"all-hands-text-cluster-insight-topic-list-item-bar",id:"topic-"+e},i.createElement("div",{className:r})),i.createElement("div",{className:"all-hands-text-cluster-insight-topic-list-item-times"},(0,o.pm)().All_Hands_Text_Cluster_Insight_Selected_Topic_times.format(t.state.CurrentInsight.TextClusters[n].length)))})))},e.jh=function(){if(this.state.ShowDetails)return i.createElement("div",{className:"all-hands-text-cluster-insight-topic-detail-container"},i.createElement("div",{className:"all-hands-text-cluster-insight-topic-detail-title"},this.Ch(),i.createElement("div",{className:"all-hands-text-cluster-insight-topic-detail-selected-topic-name"},this.state.SelectedTopic),i.createElement("div",{className:"all-hands-text-cluster-insight-topic-detail-selected-topic-times"},(0,o.pm)().All_Hands_Text_Cluster_Insight_Selected_Topic_times.format(this.state.CurrentInsight.TextClusters[this.state.SelectedTopic].length))),i.createElement("div",{className:"all-hands-text-cluster-insight-topic-detail-selected-topic-comment"},i.createElement("div",{className:"all-hands-text-cluster-insight-topic-detail-all-details"},i.createElement("div",{className:"all-hands-text-cluster-insight-topic-detail-comment-title"},(0,o.pm)().All_Hands_Text_Cluster_Insight_All_Details_Title),this.state.CurrentInsight.TextClusters[this.state.SelectedTopic].map((function(t,n){return i.createElement("div",{className:"all-hands-text-cluster-insight-topic-detail-sentence",key:n},(0,o.pm)().All_Hands_Text_Cluster_Insight_Topic_Detail_Text.format(t))})))))},e.Ch=function(){var t=this,n={ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"all-hands-text-cluster-insight-topic-detail-back-button",onClick:function(){t.setState({ShowDetails:!1})}},FluentIcon:"Arrow Left",IconClassName:"forms-icon-size18x18"};return(0,s.F)(n)},e.$h=function(){var t,n=this.Sh(),e=this.state.CurrentInsight.TargetQuestion.Tag;if(1===n.length){switch(e){case"NegativeOpinion":t=(0,o.pm)().All_Hands_Text_Cluster_Insight_Title_Single_Negative;break;case"PositiveOpinion":t=(0,o.pm)().All_Hands_Text_Cluster_Insight_Title_Single_Positive;break;case"GeneralOpinion":default:t=(0,o.pm)().All_Hands_Text_Cluster_Insight_Title_Single_General}return t.format(n[0])}switch(e){case"NegativeOpinion":t=(0,o.pm)().All_Hands_Text_Cluster_Insight_Title_Negative;break;case"PositiveOpinion":t=(0,o.pm)().All_Hands_Text_Cluster_Insight_Title_Positive;break;case"GeneralOpinion":default:t=(0,o.pm)().All_Hands_Text_Cluster_Insight_Title_General}return t.format(n[0],n[1])},e.Sh=function(){var t=this.state.CurrentInsight.TextClusters,n=Object.keys(t).filter((function(n){return t[n].length>0}));return n.sort((function(n,e){return t[n].length-t[e].length})),n=n.reverse()},e.Nh=function(t){var n=this;this.setState({CurrentInsight:this.props.Insight.AllHandsTextClusterInsights[t],CurrentInsightIndex:t},(function(){n.setState({SelectedTopic:n.Sh()[0]})}))},e.yh=function(){var t={CurrentInsightIndex:this.state.CurrentInsightIndex,HandleInsightData:this.Nh,Questions:this.props.Insight.AllHandsTextClusterInsights.map((function(t){return t.TargetQuestion}))};return(0,u.T)(t)},n}(e(34990).N)},79068:function(t,n,e){"use strict";e.d(n,{N4:function(){return s},s$:function(){return u},_I:function(){return a}});var r=e(33967),i=e(83894),o=e(64290);function s(){return(0,o.hl)((function(){return!(0,r.x8)()}))}function u(){return(0,o.hl)((function(){return!(0,r.x8)()&&!(0,i.ro)()}))}function a(){return(0,o.hl)((function(){return(0,i.Wh)()||(0,i.Ak)()}))}},16717:function(t,n,e){"use strict";e.d(n,{U:function(){return s}});var r=e(63804),i=e(7645),o={};Object.defineProperty(o,"LocalizedStrings",{get:i.pm});var s=r.createContext(o)},62335:function(t,n,e){"use strict";e.d(n,{k:function(){return c},Y:function(){return l}});var r=e(59312),i=e(63804),o=e(69065),s=e(17290),u=e(93387),a=e(3424),c=function(t){function n(n){return t.call(this,n)||this}(0,r.ZT)(n,t);var e=n.prototype;return e.render=function(){var t=this.Xh(),n=this.props.displayText?this.props.displayText.toLocaleUpperCase():(0,a.M)({FluentIcon:"Person",HTMLAttributes:{className:"author-notification-icon"}}),e={backgroundColor:t.backgroundColor,color:t.textColor},r={onClick:function(t){(0,s.x)($(t.target))},"aria-label":this.props.ariaLabel||this.props.tooltip,className:"author-notification-content",style:e,title:this.props.tooltip};return(0,u.ax)({HTMLAttributes:r,ButtonStyle:1,Tooltip:this.props.tooltip,children:i.createElement("span",{"aria-hidden":!0},n)})},n.createColor=function(t){for(var e=0,r=t.length-1;r>=0;r--){var i=t.charCodeAt(r),o=r%8;e^=(i<<o)+(i>>8-o)}var s=e%n.COLOR_SWATCHES_LOOKUP.length;return n.COLOR_SWATCHES_LOOKUP[s]},e.Xh=function(){var t=this.props,e="",r="";t.backgroundColor&&(e=(0,o.hq)(t.backgroundColor)),t.textColor&&(r=(0,o.hq)(t.textColor));var i=t.email||t.name;return""!==r&&""!==e||!i||(e=e||n.createColor(i),r=r||(0,o.hq)((0,o.en)((0,o.$W)(e)))),{backgroundColor:e=e||n.defaultBackgroundColor,textColor:r=r||n.defaultTextColor}},n.COLOR_SWATCHES_LOOKUP=["#3765E4","#D83B01","#B91C49","#910A19","#E40089","#971497","#8150FD","#562685","#2C5797","#007B8A","#11723F","#6F292A","#A16412"],n.defaultBackgroundColor=n.COLOR_SWATCHES_LOOKUP[0],n.defaultTextColor="#FFFFFF",n}(e(23112).r);function l(t){return i.createElement(c,t)}},54164:function(t,n,e){"use strict";e.d(n,{c:function(){return v}});var r=e(66676),i=new RegExp("\\(([^)]*)\\)","gi"),o=new RegExp("(?:[\0-/:-@[-^`{-퟿-￿]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udbff](?![\udc00-\udfff])|(?:[^\ud800-\udbff]|^)[\udc00-\udfff]) ","gi"),s=new RegExp("\\s+","gi"),u=new RegExp("[ء-ي٠-٩]"),a=new RegExp("[ᄀ-ᇿ|㄰-㆏|ꥠ-꥿|가-힯|ힰ-퟿]"),c=new RegExp("[一-鿌㐀-䶵﨎﨏﨑﨓﨔﨟﨡﨣﨤﨧-﨩]|[\ud840-\ud868][\udc00-\udfff]|\ud869[\udc00-\uded6\udf00-\udfff]|[\ud86a-\ud86c][\udc00-\udfff]|\ud86d[\udc00-\udf34\udf40-\udfff]|\ud86e[\udc00-\udc1d]");function l(t,n){var e=t.replace(/\s/,"");return n?e[e.length-1]:e[0]}function f(t,n){var e=t.replace(/\s/,"");return e.length<=2?n?e[0]:e[e.length-1]:n?e.substr(0,2):e.substr(e.length-2,e.length)}function h(t,n){var e="",r=t.split(" ");return 2===r.length?(e+=r[0].charAt(0).toUpperCase(),e+=r[1].charAt(0).toUpperCase()):3===r.length?(e+=r[0].charAt(0).toUpperCase(),e+=r[2].charAt(0).toUpperCase()):0!==r.length&&(e+=r[0].charAt(0).toUpperCase()),n&&e.length>1?e.charAt(1)+e.charAt(0):e}function d(t){return t=(t=(t=(t=t.replace(i,"")).replace(o,"")).replace(s," ")).trim()}function m(t,n){return null==t?"":(arguments.length<2&&(n=(0,r.t6)()),t=d(t),u.test(t)?l(t,!!n):a.test(t)||c.test(t)?f(t,!!n):h(t,!!n))}function v(t,n,e){return m(t?t.trim():((n||"")+" "+(e||"")).trim())}},25038:function(t,n,e){"use strict";e.d(n,{NT:function(){return r},kl:function(){return i},wW:function(){return o},ZV:function(){return s}});e(64290);function r(t){return 3===t||4===t}function i(t){return 4===t}function o(t){return 3===t}function s(t){var n=t;return!(!n||6102!==n.innerCode&&6106!==n.innerCode)}},23112:function(t,n,e){"use strict";e.d(n,{r:function(){return s}});var r=e(59312),i=e(63804),o=e(27196),s=function(t){function n(n){var e,r,i=t.call(this,n)||this;return i.state={},r=e=i,u.forEach((function(t){var n=r[t];n&&(r[t]=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];try{return n.apply(e,r)}catch(n){return a(e,t,n),null}})})),i}return(0,r.ZT)(n,t),n.prototype.getHtmlElement=function(){return o.findDOMNode(this)},n}(i.Component),u=["componentWillMount","componentDidMount","componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","componentDidUpdate","componentWillUnmount","render"];function a(t,n,e){try{if(window.onerror){var r="React error in "+t.constructor.name+"."+n;e&&e.message&&(r+=": "+e.message),window.onerror(r,"",0,0,e)}}catch(t){}}},41360:function(t,n,e){"use strict";e.d(n,{z:function(){return s}});var r=e(59312),i=e(63804),o=e(78587),s=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,r.ZT)(n,t),n.prototype.render=function(){var t=this.props,n=t.src,e=(0,r._T)(t,["src"]);return i.createElement("img",(0,r.pi)({role:"presentation",src:(0,o.Jn)(n)},e))},n}(e(23112).r)},14113:function(t,n,e){"use strict";e.d(n,{r:function(){return I},v:function(){return C}});var r=e(59312),i=e(63804),o=e(94290),s=e(51531),u=e(66676),a=e(262),c=e(55411),l=e(10836),f=e(43367),h=e(42735),d=e(46008),m=e(64290),v=e(65863),p=e(16717),g=e(23112),b=e(34917),w=e(76029),y=e(70208),I=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.Yh=(0,m.md)((function(){return(0,l.cr)("FormsProEmbedCompactPlus")&&(0,d.f5)()})),n}(0,r.ZT)(n,t);var e=n.prototype;return e.render=function(){var t,n=this,e=this.props.TopExtraContent&&i.createElement("div",{className:"office-form-footer-block"},this.props.TopExtraContent),r=(0,a.j)("office-form-footer-container office-form-padding-align",this.props.HTMLAttributes&&this.props.HTMLAttributes.className),o=this.props.FooterText;(0,m.md)((function(){o=(0,h.e1)(n.props.FooterText)})),o=(0,f.rG)(o,!1),t=(0,m.md)((function(){return o?(0,v.q)({ContainsHtml:!0,RenderMode:"RichText",Text:o}):o||null}));var s=this.Yh&&!(0,l.cr)("FormsProCustomFooter"),u=this.Yh&&(0,l.cr)("FormsProCustomFooter");return i.createElement(p.U.Consumer,null,(function(o){var a=o.LocalizedStrings;return i.createElement("div",{className:"office-form-footer office-form-theme-footer",role:"contentinfo","data-id":n.props.SectionId},i.createElement("div",{className:r},e,(0,m.pd)((function(){return S(t||a.Response_Page_Footer_Statement_MSFT,t||a.Response_Page_Footer_Statement,n.props.FooterType)||t}),(function(){return!n.props.IsResponsePage&&(s?null:S(t||((0,c.cT)()?a.DesignPage_Footer_Default_Message:a.Response_Page_Footer_Statement_MSFT),t||((0,c.cT)()?a.DesignPage_Footer_Default_Message:a.Response_Page_Footer_Statement),n.props.FooterType?n.props.FooterType:"ShowStatement")||t)})),(0,m.pd)((function(){return n.td(a)}),(function(){return u?null:n.nd(a)})),function(){if((0,l.M0)())return i.createElement("div",{id:"form-bottom-sentinel",className:"office-form-bottom-sentinel"})}()))}))},e.td=function(t){var n=this;if(!(0,o.mF)()){var e=" | ";return i.createElement("div",{className:"office-form-footer-block"},C(t.Form_Footer_Powered),!(0,o.S0)()&&i.createElement(i.Fragment,null,e,i.createElement(b.q,{LocalizedStrings:t,IsAnonymous:n.props.FormMaster?n.props.FormMaster.Model.Settings.IsAnonymous:null}),e,i.createElement(y.I,{FormMaster:n.props.FormMaster,LocalizedStrings:t,ForceUseCommercialTermsLink:n.props.ForceUseCommercialTermsLink})),(0,u.WB)(this.props.LocaleId)&&e,(0,u.WB)(this.props.LocaleId)&&i.createElement(w.k,{LocalizedStrings:t}))}},e.nd=function(t){var n=" | ",e=!(0,l.cr)("FormsProHidePrivacyLink")||null==this.props.FooterText;if(this.Yh)return i.createElement("div",{className:"office-form-footer-block"},i.createElement(b.q,{LocalizedStrings:t,IsAnonymous:this.props.FormMaster?this.props.FormMaster.Model.Settings.IsAnonymous:null}));if((0,c.cT)()&&(0,l.cr)("CustomerVoiceUpdatePrivacyAndTou"))return i.createElement(b.q,{LocalizedStrings:t,IsAnonymous:this.props.FormMaster?this.props.FormMaster.Model.Settings.IsAnonymous:null,tabIndex:0,footerText:this.props.FooterText,localeId:this.props.LocaleId});var r=(0,c.cT)()?t.DesignPage_Footer_Powered:t.FormPro_Footer_Powered,o=i.createElement(b.q,{LocalizedStrings:t,IsAnonymous:this.props.FormMaster?this.props.FormMaster.Model.Settings.IsAnonymous:null,tabIndex:0});return i.createElement("div",{className:"office-form-footer-block"},C(r),n,e&&o,e&&n,i.createElement(y.I,{FormMaster:this.props.FormMaster,LocalizedStrings:t,tabIndex:0}),(0,u.WB)(this.props.LocaleId)&&n,(0,u.WB)(this.props.LocaleId)&&i.createElement(w.k,{LocalizedStrings:t}))},n}(g.r);function S(t,n,e){switch(e){case"ShowStatement":return i.createElement("div",{className:"office-form-footer-block"},(0,f.ue)(t));case"ShowStatementWithNotice":return i.createElement("div",{className:"office-form-footer-block"},(0,f.ue)(n));default:return null}}function C(t){return(0,s.o)()?(e=t,o={className:(0,s.o)()?"office-form-theme-spo-link":void 0,href:window.location.origin,target:"_blank"},i.createElement("div",{className:"office-form-footer-inline-without-margin"},i.createElement("a",(0,r.pi)({},o),e))):(n=t,i.createElement("div",{className:"office-form-footer-inline-without-margin"},n));var n,e,o}},34917:function(t,n,e){"use strict";e.d(n,{q:function(){return p}});var r=e(59312),i=e(63804),o=e(51531),s=e(66676),u=e(9947),a=e(72377),c=e(55411),l=e(10836),f=e(64534),h=e(64290),d=e(23112),m=e(14113),v=e(76029),p=function(t){function n(n){var e=t.call(this,n)||this;return e.ui=!1,e.state={PrivacyUrl:"https://go.microsoft.com/fwlink/?LinkId=521839"},e.ed=e.ed.bind(e),e}(0,r.ZT)(n,t);var e=n.prototype;return e.componentDidMount=function(){var t=this;this.ui=!0,a.Pv.Resolve("IBootEvent").addBootCompleteListener((function(){return t.ed()}))},e.componentWillUnmount=function(){this.ui=!1},e.render=function(){var t=this,n={className:(0,o.o)()?"office-form-theme-spo-link":void 0,href:this.state.PrivacyUrl,target:"_blank"},e="MSFT"!==(0,u.k0)().ring||this.props.IsAnonymous?this.state.PrivacyUrl?this.props.LocalizedStrings.Form_Footer_PrivacyStatement:(0,h.md)((function(){return!0}))&&(0,c.cT)()&&(0,l.cr)("CustomerVoiceUpdatePrivacyAndTou")?null:this.props.LocalizedStrings.Form_Footer_AnonymousPrivacyStatement:this.props.LocalizedStrings.Form_Footer_DataPrivacyNotice,a=e;if((0,h.md)((function(){a=t.props.LocalizedStrings.Response_Page_Footer_Open_In_New_Tab_Text_Terms_Privacy.format(e)})),(0,h.md)((function(){return!0}))&&(0,c.cT)()&&(0,l.cr)("CustomerVoiceUpdatePrivacyAndTou")){var f=!(0,l.cr)("FormsProHidePrivacyLink")||null==this.props.footerText,d=this.props.LocalizedStrings.DesignPage_Footer_Powered,p=null===e?null:i.createElement("div",{className:this.props.Multiline?"office-form-footer-block":"office-form-footer-inline"},this.state.PrivacyUrl?i.createElement("a",(0,r.pi)({},n,{"aria-label":a}),e):e);return i.createElement("div",{className:"office-form-footer-block"},(0,m.v)(d),f&&null!=e&&" | ",f&&p,(0,s.WB)(this.props.localeId)&&" | ",(0,s.WB)(this.props.localeId)&&i.createElement(v.k,{LocalizedStrings:this.props.LocalizedStrings}))}return i.createElement("div",{className:this.props.Multiline?"office-form-footer-block":"office-form-footer-inline"},this.state.PrivacyUrl?i.createElement("a",(0,r.pi)({},n,{"aria-label":a}),e):e)},e.ed=function(){var t=this;(0,f.pw)().then((function(n){t.ui&&t.setState({PrivacyUrl:n||""})}))},n}(d.r)},76029:function(t,n,e){"use strict";e.d(n,{l:function(){return s},k:function(){return u}});var r=e(59312),i=e(63804),o=e(30029);function s(t){return"Accessibilité"}var u=function(t){var n={href:i.useMemo(o.d,[]),target:"_blank"};return i.createElement("a",(0,r.pi)({},n),(t.LocalizedStrings,"Accessibilité"))}},93018:function(t,n,e){"use strict";e.d(n,{d:function(){return s}});var r=e(59312),i=e(63804),o=e(94290),s=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,r.ZT)(n,t),n.prototype.render=function(){return(0,o.Ig)()?i.createElement("div",{className:"image-alternative-text"},this.props.children):null},n}(e(23112).r)},932:function(t,n,e){"use strict";e.d(n,{$:function(){return l}});var r=e(59312),i=e(63804),o=e(262),s=e(55411),u=e(7645),a=e(23112),c=e(41360),l=function(t){function n(n){var e=t.call(this,n)||this;return e.rd=i.createRef(),e.state={ShowIR:!1},e.od=e.od.bind(e),e}(0,r.ZT)(n,t);var e=n.prototype;return e.render=function(){var t=this,n=this.state.ShowIR?"immersive-reader-focused":"";return i.createElement("div",{tabIndex:this.state.ShowIR?-1:0,onFocus:this.od,className:"immersive-reader-button-wrapper"},i.createElement("button",{className:(0,o.j)("immersive-reader-button-form",this.props.className,n),"data-locale":(0,s.Kc)()||navigator.language,"aria-label":(0,u.pm)().ImmersiveReaderButton_Hint,onClick:this.props.onClick,onBlur:function(){return t.setState({ShowIR:!1})},ref:this.rd},i.createElement(c.z,{src:this.props.whiteIcon?"/Images/IR_white_title.svg":"/Images/immersive-reader-icon_black.svg",alt:(0,u.pm)().ImmersiveReaderButton_Hint,title:(0,u.pm)().ImmersiveReaderButton_Hint,style:{verticalAlign:"middle"}})))},e.od=function(){var t=this;this.setState({ShowIR:!0},(function(){var n;null===(n=t.rd.current)||void 0===n||n.focus()}))},n}(a.r)},24742:function(t,n,e){"use strict";e.d(n,{E:function(){return a}});var r=e(59312),i=e(63804),o=e(77356),s=e(3424),u=e(65863),a=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.sd=i.createRef(),n}(0,r.ZT)(n,t);var e=n.prototype;return e.componentDidMount=function(){(0,o.z)($(this.sd.current))},e.render=function(){var t,n=this.props.Message,e=n;return"string"==typeof n&&(t={RenderMode:"RichText",Text:n,ContainsHtml:!0},e=(0,u.q)(t)),i.createElement("div",null,i.createElement("div",{className:"thank-you-page-confirm"},i.createElement(s.F,{FluentIcon:"Checkmark Circle",HTMLAttributes:{className:"office-form-theme-primary-color thank-you-page-font-icon"}}),i.createElement("span",{className:"thank-you-page-comfirm-text"},this.props.ConfirmText)),i.createElement("div",{className:"thank-you-page-container thank-you-page-message",ref:this.sd},e))},n}(e(23112).r)},55982:function(t,n,e){"use strict";e.d(n,{h:function(){return a}});var r=e(59312),i=e(63804),o=e(262),s=e(64290),u=e(3424),a=function(t){function n(n){var e=t.call(this,n)||this;return e.ud=e.ud.bind(e),e}(0,r.ZT)(n,t);var e=n.prototype;return e.render=function(){var t=this,n=this.props.Choice,e=this.props.ContainerClassName;this.props.IsChecked&&this.props.IsMobile&&(e=(0,o.j)(e,"active"));var u=(0,o.j)("office-form-question-choice-row",this.props.ClassNameForLabel),a=(0,s.pd)((function(){return n.Description}),(function(){return n.Description||t.props.LocalizedStrings.Quiz_Empty_Option_Label}));return i.createElement("div",{className:e},i.createElement("div",{className:this.props.IsSingleChoice?"radio":"checkbox"},i.createElement("label",{className:u},i.createElement("input",(0,r.pi)({"aria-checked":this.props.IsChecked,"aria-label":a,checked:this.props.IsChecked,disabled:this.props.Disabled,onChange:this.ud,type:this.props.IsSingleChoice?"radio":"checkbox",value:n.Description},this.props.HTMLPropsForInput)),this.props.children,this.ld())),this.fd())},e.ld=function(){var t,n;switch(this.props.AnswerType){case"Correct":n="Checkmark",t=this.props.IsMobile&&this.props.IsChecked?"image-button-checked-answerkey-mobile office-form-answerkey":"image-button-answerkey office-form-answerkey";break;case"Wrong":t=this.props.IsMobile?"image-button-checked-wrong-answer-mobile office-form-answerkey":"",n=this.props.IsMobile?"Dismiss":""}if(n)return(0,u.M)({FluentIcon:n,HTMLAttributes:{className:(0,o.j)(t,"forms-icon-size20x20"),role:"tooltip",title:this.props.ToolTipForAnswer}})},e.fd=function(){if(this.props.AnswerHint){var t=void 0;return t="Correct"===this.props.AnswerType?this.props.IsMobile?"validation-success-mobile":"validation-success":this.props.IsMobile?"validation-error-mobile":"validation-error",t=(0,o.j)("office-form-answerhint",t),i.createElement("div",{className:t},this.props.AnswerHint)}},e.ud=function(){this.props.onChange(this.props.Choice.Description)},n}(e(23112).r)},70907:function(t,n,e){"use strict";e.d(n,{e:function(){return j}});var r=e(59312),i=e(63804),o=e(36215),s=e(33967),u=e(29559),a=e(9947),c=e(262),l=e(81620),f=e(42605),h=e(49211),d=e(55411),m=e(10836),v=e(687),p=e(77356),g=e(7645),b=e(43367),w=e(37632),y=e(54496),I=e(72467),S=e(46008),C=e(70877),F=e(41448),N=e(22768),T=e(64541),k=e(67661),x=e(72374),P=e(90819),D=e(3920),E=e(502),R=e(155),L=e(19976),A=e(64290),q=e(40947),O=e(14106),M=e(3424),U=e(17764),V=e(65863),_=e(62335),G=e(54164),B=e(23112),z=e(49221),Q=e(93018),H=e(932),j=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.hd=i.createRef(),n.vd=9,n.gd=16,n.bd=400,n.wd=o.uniqueId("question"),n.yd=function(){var t={chunks:n.getFormattedDataForImmersiveReader(),title:""},e={uiLang:(0,d.Kc)()||navigator.language};(0,F.d8)().getImmersiveReaderToken().then((function(n){n&&ImmersiveReader&&ImmersiveReader.launchAsync(n,null,t,e)}))},n}(0,r.ZT)(n,t);var e=n.prototype;return e.componentWillMount=function(){var t=this;this.update=function(){return t.forceUpdate((function(){var n=t.props.onHeightChange;n&&n()}))};var n=this.props.Master,e=[k.x.Schema.HasQuestionMedia];e=(0,b.gi)(e),n.Question.Form.observe(this.update,e),n.observe(this.update),n.Question.observe(this.update),this.Sd=(0,L.a)(),this.Sd.observe(this.update,[this.Sd.Schema.FormsTenantSettings]);var r=(0,I.Cu)().Schema;n.Question.ImageInfoMaster.observe(this.update,[r.ResourceUrl,r.ContentType,r.OriginalFileName]),n.Question.ImageSettingsMaster.observe(this.update),this.Cd(this.props),(0,A.md)((function(){if((0,m.cr)("FormsProAnswerTag")){var n=t.questionLocalizedItemMaster,e=n&&n.Model,r=t.props.Master.Question.Model.FormsProRTQuestionTitle||t.props.Master.Question.Model.Title,i=t.props.Master.Question.Model.FormsProRTSubtitle||t.props.Master.Question.Model.Subtitle;e?(t.props.Master.Model.InitialFormsProLocalizedRuntimeTitle=e.formsprortlocaletitle||e.title||r,t.props.Master.Model.InitialFormsProLocalizedRuntimeSubtitle=e.formsprortlocalesubtitle||e.subtitle||i):(t.props.Master.Model.InitialFormsProLocalizedRuntimeTitle=void 0,t.props.Master.Model.InitialFormsProLocalizedRuntimeSubtitle=void 0)}t.props.Master.Question.Form.SettingMaster.observe(t.update)}))},e.componentWillReceiveProps=function(t){var n=this;this.Cd(t),(0,A.md)((function(){if((0,m.cr)("FormsProAnswerTag")){var t=n.questionLocalizedItemMaster,e=t&&t.Model,r=n.props.Master.Question.Model.FormsProRTQuestionTitle||n.props.Master.Question.Model.Title,i=n.props.Master.Question.Model.FormsProRTSubtitle||n.props.Master.Question.Model.Subtitle;e?(n.props.Master.Model.InitialFormsProLocalizedRuntimeTitle=e.formsprortlocaletitle||e.title||r,n.props.Master.Model.InitialFormsProLocalizedRuntimeSubtitle=e.formsprortlocalesubtitle||e.subtitle||i):(n.props.Master.Model.InitialFormsProLocalizedRuntimeTitle=void 0,n.props.Master.Model.InitialFormsProLocalizedRuntimeSubtitle=void 0)}}))},e.componentWillUnmount=function(){var t=this,n=this.props.Master;n.Question.ImageSettingsMaster.unobserve(this.update),n.Question.ImageInfoMaster.unobserve(this.update),n.Question.unobserve(this.update),n.unobserve(this.update),n.Question.Form.unobserve(this.update),this.Sd.unobserve(this.update),(0,A.md)((function(){n.Question.Form.SettingMaster.unobserve(t.update)})),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.update)},e.componentDidMount=function(){this.Nd()},e.componentDidUpdate=function(t,n){this.Nd()},e.render=function(){var t=this,n={className:"__question__ office-form-question",ref:this.hd};if("has-error"===this.getValidationStyle()||(0,O.tj)(this.props)){var e=this.props.IsMobile?"office-form-error-question-mobile":"office-form-error-question";n.className=(0,c.j)(n.className,e)}(0,A.md)((function(){if(null==t.props.Master.Model.Visible?n.hidden=!1:n.hidden=!t.props.Master.Model.Visible&&!!t.props.EnableShowHideQuestion,(0,m.cr)("FormsProQuestionVisibility")&&t.props.EnableShowHideQuestion){var e=t.props.Master.Model.Visible;n.hidden=null==e?!!t.props.Master.Question.Model.Hidden:!e}}));var o=this.Td(),s=null;return void 0!==o&&(n.className=(0,c.j)(n.className,"office-form-studentview-question"),s=i.createElement("div",{className:"office-form-feedback-marginbottom-box"})),i.createElement("div",(0,r.pi)({},n,{"data-id":this.props.Master.Question.Model.Id}),this.kd(),this.createQuestionContent(),o,s,(0,A.md)((function(){return(0,m.cr)("CVLeapFrogVisualRefresh")&&(0,b.$V)({questionId:t.props.Master.Question.Model.Id})})))},e.createWrongResultLabel=function(){return(0,O.Bz)(this.props)},e.createReactNodes=function(){throw Error("to be overridden.")},e.createQuestionTitleControls=function(){return i.createElement("div",{className:"form-question-title-controls"},(0,f.F)({Icon:"Up",IconClassName:"form-question-title-button"}),(0,f.F)({Icon:"Down",IconClassName:"form-question-title-button"}),(0,f.F)({Icon:"Copy",IconClassName:"form-question-title-button"}),(0,f.F)({Icon:"Delete",IconClassName:"form-question-title-button"}))},e.createQuestionContent=function(){var t=this,n={className:"office-form-question-content office-form-theme-focus-border"},e=this.props.HTMLAttributes;e&&(n=(0,y.p2)(e,n));var o=(0,c.j)("office-form-question-element",this.isImageLayout()?"with-image":"");(0,A.md)((function(){(0,m.cr)("CustomerVoiceCascadeQuestion")&&("Question.CascadeGroup"===t.props.Master.Question.Model.Type&&(o=(0,c.j)(o,"cv-cascade-render-dropdowns")));(0,m.cr)("CVLeapFrogChoiceQuestionNewUX")&&("Question.Choice"===t.props.Master.Question.Model.Type&&(o=(0,c.j)(o,"cv-choice-render-container")));(0,m.cr)("CVLeapFrogVisualRefresh")&&(o=(0,c.j)(o,"cv-question-render-container"))}));var s=null,u=null;return this.isRequiredQuestionError()&&(s=(0,U._)({HTMLAttributes:{className:"validation-error-message-label"},Label:this.props.LocalizedStrings.Required_Question_Error_Message}),(0,A.md)((function(){(0,m.cr)("CVLeapFrogVisualRefresh")&&(u=t.xd(),s=null)}))),i.createElement("div",(0,r.pi)({},n),this.createWrongResultLabel(),this.createTitleContainer(),u,i.createElement("div",{className:o},this.createReactNodes()),s)},e.isRequiredQuestionError=function(){if(!this.props.ShowValidationStyle)return!1;var t=this.props.Master,n=t.Question.verify(t.Model.Answer);return t.SubQuestionRuntimeMasters.forEach((function(t){t.Question.verify(t.Model.Answer)===x.ej.RequiredError&&(n=x.ej.RequiredError)})),n===x.ej.RequiredError},e.getValidationStyle=function(){if(!this.props.ShowValidationStyle)return"";var t=this.props.Master,n=t.Question.verify(t.Model.Answer);return t.SubQuestionRuntimeMasters.forEach((function(t){t.Question.verify(t.Model.Answer)===x.ej.RequiredError&&(n=x.ej.RequiredError)})),n===x.ej.Success?"has-success":"has-error"},e.getQuestionId=function(){return this.wd},e.getRequiredId=function(){return this.props.Master.Question.Model.Required?this.wd+"-required":void 0},e.getQuestionTypeId=function(){return this.wd+"-questiontype"},e.getElementProps=function(t){var n={"aria-describedby":this.getSubtitleId(),"aria-labelledby":(0,c.j)(this.getOrdinalId(),this.getTitleId(),this.Pd(),this.getRequiredId(),this.getQuestionTypeId())};return t?(0,y.p2)(t,n):n},e.getFormattedDataForImmersiveReader=function(){var t=this.props.Master.Question.Model,n=[];if(n.push({content:this.props.Ordinal+". "+t.Title+(t.Required?" *":"")+"\n"}),t.Point){var e=(0,O.OS)(this.props);n.push({content:e.props.children.toString()+"\n\n"})}else n.push({content:"\n"});if(t.Subtitle){var r=t.Subtitle;if("undefined"!=typeof MathJax){var i=MathJax.Hub.getAllJax(null),s=o.find(i,(function(n){return n.originalText===t.Subtitle}));if(s){var u=s.root&&s.root.toMathML&&s.root.toMathML();u&&(u=u.replace(/\n\s*/g,""),r="\x3c!--[if mathML]&#62;"+(0,l.F1)(u,!0)+"&#60;![endif]--\x3e")}}n.push({content:""+r,mimeType:"text/html"}),n.push({content:"\n\n"})}var a=document.createElement("i");return a.textContent=(0,l.F1)(this.props.LocalizedStrings.ImmersiveReader_InputAnswer,!0),n.push({content:a.outerHTML,mimeType:"text/html"}),n},e.xd=function(){var t=(0,U._)({HTMLAttributes:{className:"validation-error-message-label"},Label:this.props.LocalizedStrings.Required_Question_Error_Message}),n=(0,M.M)({IconName:"Error",className:"validation-error-message-icon"});return i.createElement("div",{className:"validation-error-container"},n,t)},e.Cd=function(t){var n=t.Master,e=t.LocaleId;this.questionLocalizedItemMaster&&(this.questionLocalizedItemMaster.unobserve(this.update),this.questionLocalizedItemMaster=void 0),e&&(this.questionLocalizedItemMaster=E.k.getQuestionResourceMaster(e,n.Question.Model.Id,n.Question.Form),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.update,[R.A.Schema.title,R.A.Schema.subtitle]))},e.Td=function(){var t=this.props.Master.SubQuestionRuntimeMasters,n=t[t.length-1],e=(n&&n.Model||this.props.Master.Model).AnswerEntity,r=null==e?void 0:e.Feedback;if(this.props.IsStudentViewMode&&r){var o={FluentIcon:"Chat",HTMLAttributes:{className:(0,c.j)("feedback-icon forms-icon-size16x16",(0,u.un)()?"edge":void 0,(0,u.w1)()?"ie":void 0),role:"presentation"}};return i.createElement("div",{className:"office-form-feedback-box"},(0,M.M)(o),i.createElement("div",{className:"office-form-feedback-content"},i.createElement(V.D,{Text:r,RenderMode:"RichText",ContainsHtml:!0})))}},e.createTitleLabel=function(){var t=this,n=this.props.Master.Question.Model,e=this.props.Master.Question.Form,r=this.questionLocalizedItemMaster,o=null==r?void 0:r.Model,s=this.props.Master.Question.Form.Model.HasQuestionMedia,u=1===n.SuspiciousEvidence||3===n.SuspiciousEvidence,a=u&&(0,g.pm)().Phishing_Question_Level_Message_Suspicous||"",c=(0,A.pd)((function(){return(0,T.wg)(null==o?void 0:o.title,null==o?void 0:o.formsprortlocaletitle)||(0,T.wg)(n.Title,n.FormsProRTQuestionTitle)}),(function(){return(0,m.cr)("FormsProAnswerTag")?t.props.Master.Model.FormsProRuntimeTitle||(null==o?void 0:o.formsprortlocaletitle)||(null==o?void 0:o.title)||n.FormsProRTQuestionTitle||n.Title:(null==o?void 0:o.formsprortlocaletitle)||(null==o?void 0:o.title)||n.FormsProRTQuestionTitle||n.Title}));c=(0,b.rG)(c,!1);var l=!this.props.HideMedia&&(n.ImageInfo&&n.ImageInfo.ResourceUrl||s)?"office-form-question-title with-image":"office-form-question-title",f=(0,h.w)(e,"ResponsePage.PollView"),d=!this.props.HideOrdinal&&(0,A.pd)((function(){return!(t.isImageLayout()||f)}),(function(){return!(t.isImageLayout()||f)&&(null==e.SettingMaster.Model.ShowQuestionNumbers||e.SettingMaster.Model.ShowQuestionNumbers)})),v={className:l,id:this.getTitleId()},p=n.Required?this.props.LocalizedStrings.Accessibility_RequiredAnswer:void 0,w=p&&i.createElement("div",{key:"accessibilityNode"},i.createElement("span",{className:"accessibility-reader-no-display",id:this.getRequiredId()},p)),y=this.createImmersiveReaderButton(),I=this.createQuestionTypeHint(),S={children:[y,w,I&&i.createElement("div",{key:"questionTypeNode"},i.createElement("span",{className:"accessibility-reader-no-display",id:this.getQuestionTypeId()},I)),(0,O.OS)(this.props)],HTMLAttributes:v,HtmlContent:!0,key:this.getQuestionId().toString(),Label:c,Ordinal:this.props.Ordinal,ShowOrdinal:d,ShowRequiredStar:n.Required,ShowWarningIcon:u,Theme:this.props.Theme,WarningIconTooltip:a};return(0,A.md)((function(){S.Ordinal=t.props.Master.Model.FormsProOrdinal||S.Ordinal})),this.getLabel(S)},e.getLabel=function(t){return(0,U._)(t)},e.createQuestionTypeHint=function(){var t=this.props.Master.Question.Model,n="";switch(t.Type){case"Question.Choice":n=t.ChoiceType===x.T6.MultiChoice?this.props.LocalizedStrings.QuestionType_MultiChoice:this.props.LocalizedStrings.QuestionType_SingleChoice;break;case"Question.DateTime":n=this.props.LocalizedStrings.QuestionType_DateTime;break;case"Question.Rating":n=this.props.LocalizedStrings.QuestionType_Rating;break;case"Question.TextField":n=t.Multiline?this.props.LocalizedStrings.QuestionType_MultiLineText:this.props.LocalizedStrings.QuestionType_SingleLineText;break;case"Question.Ranking":n=this.props.LocalizedStrings.QuestionType_Ranking;break;case"Question.MatrixChoiceGroup":n=this.props.LocalizedStrings.QuestionType_MatrixChoiceGroup}return n},e.createTitleOrdinal=function(){return i.createElement("div",{className:"office-form-question-ordinal office-form-theme-primary-background"},i.createElement("span",{id:this.getOrdinalId()},this.props.Ordinal))},e.createTitleContainer=function(){var t,n,e,o,s,a=this,l=this.props.Master.Question,f=l.Model,h=l.Form.Model.HasQuestionMedia,d={},p="office-form-question-subtitle",I=this.props.IsMobile||(0,S.rA)()||f.ImageSettings.Layout===D.RZ.Horizontal&&f.ImageSettings.Size===D.h2.Large,F=l.hasValidVideoUrl(),k=I||F;if(this.props.HideMedia||F||!(f.ImageInfo&&f.ImageInfo.ResourceUrl||h||f.ImageInfo.ImageProcessingStatus===P.nv.Uploading||f.ImageInfo.ImageProcessingStatus===P.nv.Picking)){if(!this.props.HideMedia&&F){var x=(0,u.tq)();p="office-form-question-subtitle with-video";var E=f.VideoInfo;d.className=(0,c.j)(d.className,"question-title-container office-form-theme-video-question-background"),(0,C.B9)(E.Url,l.Form)?s=i.createElement(z.k,{IsMobile:x,LocalizedStrings:this.props.LocalizedStrings,VideoUrl:E.Url}):n=i.createElement("div",{className:"office-form-question-video-container"},i.createElement("iframe",{allowFullScreen:!0,frameBorder:"0",height:this.calcVideoDisplayHeight(),sandbox:"allow-scripts allow-same-origin allow-popups allow-forms",src:E.Url,width:"100%","aria-label":(0,g.pm)().Linked_Video}))}}else{d.className="question-title-container office-form-theme-image-question-background",p="office-form-question-subtitle with-image";var R=I?"office-form-question-horizontal-large-image-container office-form-theme-image-container-border":"office-form-question-image-container office-form-theme-image-container-border";if(f.ImageInfo&&f.ImageInfo.ResourceUrl){var L=l.ImageSettingsMaster.validateImageSettings(),O={className:R,style:I?void 0:{width:"{0}px".format(L.ContainerWidth)}};f.ImageInfo.AltText&&(O=(0,y.p2)(O,{"aria-label":f.ImageInfo.AltText,id:this.Pd()}));var M=(0,q.B2)(f.ImageInfo);n=i.createElement("div",(0,r.pi)({},O),i.createElement(q.zg,{Image:l.ImageInfoMaster,ImageSettings:l.ImageSettingsMaster,ImageType:"Question"}),M,i.createElement(Q.d,null,this.props.Master.Question.ImageInfoMaster.Model.AltText))}else if(f.ImageInfo.ImageProcessingStatus===P.nv.Uploading||f.ImageInfo.ImageProcessingStatus===P.nv.Picking){O={className:R,style:{height:"{0}px".format((0,v.w_)()),width:"{0}px".format((0,v.Rr)())}};n=i.createElement("div",(0,r.pi)({},O),(0,q.B2)())}}if(this.isSubtitleLayout())if(f.IsMathQuiz&&!f.IsPlainTextInMathField){var V=(0,N.Rq)({DisableLinebreaks:this.props.DisableFormulaLinebreak,Formula:f.Subtitle,onRenderComplete:this.props.onHeightChange});e=i.createElement("div",{className:"office-form-question-formula"},V)}else{var _=null===(t=this.questionLocalizedItemMaster)||void 0===t?void 0:t.Model,G=(0,A.pd)((function(){return(0,T.wg)(null==_?void 0:_.subtitle,null==_?void 0:_.formsprortlocalesubtitle)||(0,T.wg)(f.Subtitle,f.FormsProRTSubtitle)}),(function(){var t=null;return t=(0,m.cr)("FormsProAnswerTag")?a.props.Master.Model.FormsProRuntimeSubtitle||(null==_?void 0:_.formsprortlocalesubtitle)||(null==_?void 0:_.subtitle)||f.FormsProRTSubtitle||f.Subtitle:(null==_?void 0:_.formsprortlocalesubtitle)||(null==_?void 0:_.subtitle)||f.FormsProRTSubtitle||f.Subtitle,(0,m.cr)("CVLeapFrogVisualRefresh")&&!t&&(t=a.props.LocalizedStrings.Designer_PlaceholderForQuestionSubtitle,p=(0,c.j)(p,"form-question-subtitle-placeholder")),t}));G=(0,b.rG)(G,!1),o=(0,U._)({HTMLAttributes:{className:f.FormsProRTSubtitle?(0,c.j)(p,"textformat-font"):p,id:this.getSubtitleId()},HtmlContent:!0,Label:G})}var B="question-title-box";return(0,A.md)((function(){B=(0,c.j)(B,h?"":"simplified-title-box")})),i.createElement("div",{className:B},i.createElement("div",(0,r.pi)({},d),this.props.ShowDesignInfo&&this.showTitleOrdinal()&&!k&&(0,A.md)((function(){return!(0,m.cr)("CVLeapFrogVisualRefresh")&&(0,w.kL)({questionId:a.props.Master.Question.Model.Id,media:!0,mediabelow:!k})})),k?void 0:n,k?void 0:s,this.showTitleOrdinal()?this.createTitleOrdinal():void 0,this.props.ShowDesignInfo&&this.showTitleOrdinal()&&k&&(0,A.md)((function(){return!(0,m.cr)("CVLeapFrogVisualRefresh")&&(0,w.kL)({questionId:a.props.Master.Question.Model.Id,media:!0,mediabelow:k})})),this.createTitleLabel(),o,k?n:void 0,k?s:void 0,e),this.props.ShowDesignInfo&&!this.showTitleOrdinal()&&(0,A.md)((function(){return!(0,m.cr)("CVLeapFrogVisualRefresh")&&(0,w.kL)({questionId:a.props.Master.Question.Model.Id})})),(0,A.md)((function(){return(0,m.cr)("CVLeapFrogVisualRefresh")&&a.createQuestionTitleControls()})))},e.showTitleOrdinal=function(){var t=this,n=this.props.Master.Question.Form;return(0,A.pd)((function(){return t.isImageLayout()}),(function(){return t.isImageLayout()&&(null==n.SettingMaster.Model.ShowQuestionNumbers||n.SettingMaster.Model.ShowQuestionNumbers)}))},e.createImmersiveReaderButton=function(){return(0,u.w1)()||(0,m._y)()||(0,s.x8)()||!this.props.ShouldShowImmersiveReaderButtons?null:i.createElement(H.$,{onClick:o.debounce(this.yd,this.bd,!0),whiteIcon:!1})},e.kd=function(){var t,n=this,e=this.props.Master.Question.Model;return e.CoAuthors&&e.CoAuthors.length>0?e.CoAuthors[e.CoAuthors.length-1].userId!==(0,a.k0)().userInfo.UserId&&(t=o.map(e.CoAuthors,(function(t){if(t.userId!==(0,a.k0)().userInfo.UserId){var e={ariaLabel:n.props.LocalizedStrings.DesignPage_NavBar_CoAuthor_Screen_Reader.format(t.displayName||t.userId,n.props.Ordinal||0),displayText:(0,G.c)(t.displayName,t.firstName,t.lastName),email:t.email,isCoAuthUser:!0,key:t.userId,name:t.displayName,tooltip:t.displayName||t.userId};return i.createElement(_.k,(0,r.pi)({},e))}}))):t=void 0,i.createElement("div",{className:"question-coAuthor-notification-container-render-mode","aria-live":"polite"},t)},e.calcVideoDisplayHeight=function(){if((0,u.tq)()){var t=$(window).width();return 0===t&&(t=document.body.scrollWidth),t/(this.gd/this.vd)}return(0,v.HR)()},e.getOrdinalId=function(){return this.isImageLayout()?this.wd+"-ordinal":void 0},e.getTitleId=function(){return this.wd+"-title"},e.getSubtitleId=function(){return this.isSubtitleLayout()?this.wd+"-subtitle":void 0},e.Pd=function(){return this.wd+"-image"},e.isImageLayout=function(){return this.props.Master.Question.Form.Model.HasQuestionMedia&&!this.props.HideMedia},e.isSubtitleLayout=function(){var t=this.props.Master.Question.Model;return(0,m.cr)("CVLeapFrogVisualRefresh")?t.ShowSubtitle:t.ShowSubtitle&&!!t.Subtitle},e.Nd=function(){var t=$(this.hd.current),n=t.find(".office-form-question-formula span"),e=t.find(".office-form-question-choice-formula span"),r=t.find(".design-formula-mixer span");(0,p.z)(t.find("span").not(n).not(e).not(r))},n}(B.r)},70208:function(t,n,e){"use strict";e.d(n,{I:function(){return f}});var r=e(59312),i=e(63804),o=e(58268),s=e(55411),u=e(88914),a=e(9743),c=e(64290),l=e(23112),f=function(t){function n(n){var e=t.call(this,n)||this;return e.state={TermUrl:""},e}(0,r.ZT)(n,t);var e=n.prototype;return e.componentDidMount=function(){var t;(0,c.md)((function(){(0,s.cT)()&&(0,u.s1)().then((function(n){t=n?"https://go.microsoft.com/fwlink/?linkid=2129962":"https://go.microsoft.com/fwlink/?linkid=2130334"}))})),t||(t=(0,o.YD)(),this.props.ForceUseCommercialTermsLink?t=(0,o.V9)():this.props.FormMaster&&(t=function(t){if(t.SyncContext!==a.y.AdminPhishingReviewForm&&(t.SyncContext===a.y.SharedTimeForm||t.Model.Settings.IsAnonymous||t.Model.Settings.NotRecordIdentity))return o.ZD;return o.dg}(this.props.FormMaster))),this.setState({TermUrl:t})},e.render=function(){var t=this,n=this.props.LocalizedStrings.TermsLink;(0,c.md)((function(){n=t.props.LocalizedStrings.Response_Page_Footer_Open_In_New_Tab_Text_Terms_Privacy.format(n)}));var e={href:this.state.TermUrl,target:"_blank",tabIndex:this.props.tabIndex,"aria-label":n};return i.createElement("a",(0,r.pi)({},e),this.props.LocalizedStrings.TermsLink)},n}(l.r)},90927:function(t,n,e){"use strict";e.d(n,{w:function(){return v}});var r=e(59312),i=e(63804),o=e(69065),s=e(51531),u=e(29559),a=e(9947),c=e(10836),l=e(7645),f=e(41317),h=e(43367),d=e(90710),m=e(64290),v=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.ui=!0,n.Dd=new Image,n}(0,r.ZT)(n,t);var e=n.prototype;return e.componentWillMount=function(){var t=this,n=this.props.ThemeMaster;n&&(this.Rd=function(n){n.NewValues.Name===(0,l.pm)().Customized_Theme_Name&&n.NewValues.BackgroundImage!==t.state.ImageUrl?t.setState({ImageUrl:n.NewValues.BackgroundImage,IsBackgroundImgCached:!1}):t.forceUpdate()},n.observe(this.Rd))},e.componentWillUnmount=function(){var t=this.props.ThemeMaster;this.ui=!1,t&&t.unobserve(this.Rd)},e.render=function(){var t,e=this,r=this.props.ThemeMaster;if(!(t=(0,s.o)()&&(0,a.k0)().themeInfo||(0,d.NW)().oembedocv&&(0,a.k0)().themeInfo?n.getSPOTheme((0,a.k0)().themeInfo):r&&r.Model))return null;var o=t.Name,f=t.PrimaryColor,v=t.SecondaryColor,p=t.BackgroundColor,g=t.BackgroundImage;(g=(0,h._w)(g))&&g.match("url((.*))")&&(g=g.substring(4,g.length-1)),o===(0,l.pm)().Customized_Theme_Name&&g&&(this.state.IsBackgroundImgCached||(this.Dd.src=g,this.Dd.onload=function(t){e.ui&&e.setState({ImageUrl:g,IsBackgroundImgCached:!0})},g+="_mo"));var b="";if(b+=".office-form-theme-primary-color { color:"+f+"; }",b+=".office-form-theme-secondary-color { color:"+v+"; }",b+=".office-form-theme-primary-background { background:"+f+"; color:#FFFFFF; }",b+=".office-form-theme-secondary-background { background:"+v+"; }",b+=".office-form-theme-primary-foreground, ",b+=".office-form-theme-primary-foreground a, ",b+=".office-form-theme-primary-foreground.rateit .rateit-selected, ",b+=".office-form-theme-primary-foreground.rateit .rateit-hover",b+="{ color:"+f+"; } ",b+=".office-form-theme-border-top { border-top-color:"+f+"; }",b+=".office-form-theme-border-bottom-for-mobile { border-bottom-color:"+f+"; }",b+=".office-form-theme-spinner { border-color:"+f+" #C7E0F4 #C7E0F4;}",b+=".office-form-theme-border { border-color:"+f+";}",b+=".office-form-theme-interactive-background.active { background-color:"+f+"; }",b+=".office-form-theme-interactive-background:hover { background-color:"+v+"; }",b+=".office-form-theme-interactive-background:focus { background-color:"+v+"; }",b+=".office-form-theme-interactive-background:active { background-color:"+v+"; }",b+=".office-form-theme-button-lightbackground { color:"+f+"; }",b+=".office-form-theme-button-lightbackground.active { background-color:"+v+"; }",b+=".office-form-theme-interactive-color { color:"+f+"; }",b+=".office-form-theme-interactive-color:hover { color:"+v+"; }",b+=".office-form-theme-interactive-color:focus { color:"+v+"; }",b+=".office-form-theme-interactive-color:active { color:"+v+"; }",b+=".office-form-theme-button { color: white; background:"+f+"; }",b+=".office-form-theme-button:hover { background:"+v+"; }",b+=".office-form-theme-button:focus { background:"+v+"; }",b+=".office-form-dark-theme-button {color:"+v+"}",b+=".office-form-dark-theme-button:hover { color:"+v+"; }",b+=".office-form-dark-theme-button:focus { color:"+v+"; }",b+=".office-form-theme-page-background-active.active { background :"+f+"; color: #FFFFFF; }",b+=".office-form-theme-page-foreground-active.active, ",b+=".office-form-theme-select-color.active *{ color: "+f+"; }",b+=".office-form-theme-toggle.active { background: "+f+"; border-color:"+f+"; }",b+=".office-form-theme-border { border-color:"+f+"; }",b+=".office-form-theme-outline { outline-color:"+f+"; }",b+=".office-form-theme-button-foreground.active,.office-form-theme-button-foreground.touch.active:hover { color: white; background: "+f+"; outline-color:"+f+"; }",b+=".office-form-theme-button-foreground.active:hover { background: "+v+"; outline-color:"+v+"; }",b+=".office-form-theme-quiz-point { color:"+v+"; }",b+=".office-form-theme-quiz-totalPoints-bar {color:"+f+"; }",b+=".office-form-theme-image-question-background, .office-form-theme-video-question-background { background-color: "+p+"; outline: 1px solid transparent; }",b+=".office-form-theme-image-container-border { border: 3px solid "+p+"; }",b+=".office-form-sortable-chosen .office-form-sort-item { background: "+f+"; color:white; }",b+=".office-form-theme-sort-item { color: white; background:"+f+"; }",b+=".office-form-theme-sort-item:hover { background:"+v+"; }",b+=".office-form-theme-focus-border .office-form-textfield-input:focus,.office-form-theme-focus-border .form-control:focus,.office-form-theme-focus-border .select-control:focus,.office-form-theme-focus-border .picker--focused .picker__holder:focus,.roosterjs-editor-box:focus { border-color: "+f+"; outline-color:"+f+"; }",b+=".office-form-theme-bgcolor-hover:hover { background:"+p+"; }",b+=".office-form-theme-button-color:hover *{ color:"+v+"; }",(0,m.md)((function(){(0,d.NW)().oembedocv&&(b+=".office-form-question-title { color:"+f+"; }",b+='input[type="radio"] { -webkit-appearance: none; -moz-appearance: none; appearance: none;display: inline-block; width: 20px; height: 20px; padding: 4px;background-clip: content-box; border: 0.1px solid #333333;border-radius: 50%;}',b+='input[type="radio"]:checked { background-color:'+f+";border: 0.1px solid "+f+";}",b+=".office-form-question-subtitle, .office-form-subtitle {display: none;}",b+=".office-form-content {padding-top: 0px !important;}",b+=".customer-voice .office-form-page-padding-preview {padding-left: 0px !important;}"),(0,d.NW)().maxwidth&&(b+=".customer-voice .office-form-page-padding-preview>div {max-width: "+(0,d.NW)().maxwidth+"% !important;}"),((0,c.cr)("CVLeapFrogChoiceQuestionNewUX")||(0,c.cr)("CVLeapFrogVisualRefresh"))&&(b+=".office-form-theme-primary-fill { fill:"+f+"; }"),(0,c.cr)("CVLeapFrogVisualRefresh")&&(b+=".office-form-theme-border-left { border-left-color:"+f+"; }",b+=".design-time-mixer:hover { border-left: 3px solid "+f+"; }",b+=".nps-control-table td { border-color:"+f+" !important; }",b+=".office-form-theme-primary-stroke { stroke:"+f+"; }")})),b+=".form-intelligence-question-row.office-form-intelligence-theme-li { outline: 1px solid "+v+"; background-color:"+p+";}.form-intelligence-question-row:hover {background-color:"+p+";}",b+=".form-intelligence-question-row.mobile-office-form-intelligence-theme-li { outline: 1px solid "+f+"; background-color:"+p+"; color:"+f+";}",b+=".office-form-insight-theme-control .simple-data-control-content { color : "+f+"; }",b+=".office-form-insight-theme-control .simple-data-control-description { color : "+f+"; }",b+=".office-form-insight-theme-control .simple-data-control-description:hover { color : "+v+"; }",b+=".office-form-insight-theme-control .simple-data-control-description:focus { color : "+v+"; }",b+=".office-form-insight-theme-control .simple-data-control-description:active { color : "+v+"; }",b+=".office-form-info-container .office-form-info-children.office-form-theme-spo-link { color: "+f+"; }",b+=".office-form-info-container .office-form-info-children.office-form-theme-spo-link:hover{color:"+v+"; }",b+=".office-form-spo-embed .office-form-footer-block .office-form-theme-spo-link { color: "+f+"; }",b+=".office-form-spo-embed .office-form-footer-block .office-form-theme-spo-link:hover { color: "+v+"; }",b+=".office-form-theme-spo-link { color:"+f+"; }",b+=".office-form-theme-spo-link:hover { color:"+v+"; }",f){var w=f;w.startsWith("#")&&(w=w.substring(1)),w.length>6&&(w=w.substring(0,6)),b+=".office-form-theme-progress-bar-background { background: #"+w+"0D; }"}return(0,s.o)()||(g?(b+=".thank-you-page-content { opacity:.97; }",b+=".introduction-for-responser-container { opacity:.97; }",(0,u.tq)()?(b+=".office-form-theme-page-background { background-color:"+p+"; }",b+=".office-form-theme-footer { background: rgba(255,255,255,.4); }"):(b+=".office-form-theme-page-background { background-image: url("+g+"); }",b+=".office-form-theme-footer { background: rgba(244,244,244,.8); }"),b+=".preview-mobile-container.office-form-theme-page-background { background:"+p+"; }",b+=".preview-mobile-container .office-form-theme-footer { background: rgba(255,255,255,.4); }"):(b+=".office-form-theme-footer { background : rgba(255,255,255,.4); }",b+=".office-form-theme-page-background { background-color:"+p+"; }")),b+=".office-form-theme-shadow { box-shadow: 0 0.8px 1.8px 0 rgba(0, 0, 0, 0.132), 0 0.15px 0.45px 0 rgba(0, 0, 0, 0.132); }",o===(0,l.pm)().Customized_Theme_Name&&(b+=".office-form-body { opacity: 0.97; }"),b+=(0,h.u1)(t),i.createElement("style",null,b)},n.getSPOTheme=function(t){var n=(0,o.sL)(t);return{BackgroundColor:(0,o.zn)(n),BackgroundImage:null,Name:f.FP,PrimaryColor:n,SecondaryColor:(0,o.Mk)(n),Thumbnail:null}},n}(e(23112).r)},49221:function(t,n,e){"use strict";e.d(n,{k:function(){return o}});var r=e(63804),i=e(3424);function o(t){var n=r.createRef(),e=r.createRef(),o=t.IsMobile,s=t.VideoUrl,u=o?"mobile-youtube":"pc-youtube";return u=t.InDesignMode?"design-question-title-youtube-placeholder "+u:"office-form-title-youtube-placeholder "+u,r.createElement("div",{className:u},r.createElement("div",{className:"question-title-youtube-title"},r.createElement("a",{className:"question-title-youtube-link",href:s,rel:"noreferrer",target:"_blank"},s)),r.createElement("div",{className:"question-title-youtube-tip"},r.createElement("span",{className:"question-title-youtube-tip-text"},t.LocalizedStrings.DesignPage_Youtube_Disabled_Launch_Tip),!o&&r.createElement(i.F,{FluentIcon:"Info",HTMLAttributes:{className:"forms-icon-size12x12 question-title-youtube-tip-icon",onMouseOver:function(){var t=$(n.current&&n.current.getHtmlElement()),r=$(e.current);t&&r&&r.css({left:t.offset().left+t.width()/2,top:t.offset().top+t.width()/2})}},ref:n}),r.createElement("span",{className:"question-title-youtube-hover-tip ms-Icon",ref:e},t.LocalizedStrings.DesignPage_Youtube_Disabled_Hover_Tip)))}},17111:function(t,n,e){"use strict";function r(t,n,e,r){var i=new Clipboard(t);return i.on("success",(function(t){n(),r&&t.clearSelection()})),i.on("error",(function(){e()})),i}e.d(n,{w:function(){return r}})},63481:function(t,n,e){"use strict";e.d(n,{su:function(){return o},mZ:function(){return s},b6:function(){return u},cz:function(){return a},r8:function(){return c},nP:function(){return l},Vh:function(){return f}});var r,i=e(36215);e(56117);function o(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];if(t&&document.activeElement&&t.contains(document.activeElement)){var r=$(":focusable");n&&n.forEach((function(t){r=r.not((function(n,e){return t.contains(e)}))}));var i=r.index(document.activeElement);if(!(i<0)){for(var o=i+1;o<r.length;++o){var s=r[o];if(!t.contains(s)&&!d(s))return void r[o].focus()}for(o=i-1;o>=0;--o){s=r[o];if(!t.contains(s)&&!d(s))return void r[o].focus()}}}}function s(t){$(t).on("keydown",h)}function u(t){$(t).off("keydown",h)}function a(t,n){r||(r={}),r[t]||delete r[t],r[t]=n}function c(t){r&&r[t]&&(r[t](),delete r[t])}function l(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];var r=$(t).find(":focusable");n&&n.forEach((function(t){r=r.not((function(n,e){return t.contains(e)}))})),r[r.length-1].focus()}function f(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];var r=$(t).find(":focusable");n&&n.forEach((function(t){r=r.not((function(n,e){return t.contains(e)}))})),r.length>0&&r[0].focus()}function h(t){if(9===t.keyCode){t.stopPropagation(),t.preventDefault();var n=$(this),e=i.union(n.filter(":focusable").toArray(),n.find(":focusable").toArray()),r=e.indexOf(document.activeElement);if(!(r<0)){var o=i.union(e.slice(r+1),e.slice(0,r));t.shiftKey&&o.reverse(),o.push(e[r]);var s=i.find(o,(function(t){return!d(t)}));s&&s.focus()}}}function d(t){var n=Number(t.getAttribute("tabindex"));return!isNaN(n)&&n<0}},87278:function(t,n,e){"use strict";e.d(n,{L:function(){return s}});var r=e(59312),i=e(2289),o=e(55890);function s(){var t=Date.now();O365Shell.NFD.OnFeedbackMetadataRequested((function(n,e){var s=(0,i.p)();return s.createScreenshot(document.body,{backgroundColor:"#ffffff"}).then((function(t){var n=t.toDataURL("image/jpeg");e(n)})),n.options=(0,r.pi)((0,r.pi)((0,r.pi)({},n.options||{}),s.initOptions),{userVoiceEnabled:!1,disableIncludeScreenshot:!1,disableScreenshotPreview:!0}),(0,o.$U)("DesignPage.RenderOCVFeedback",{duration:Date.now()-t}),n})),window.O365Shell.NFD.OpenFeedback(),(0,o.$U)("DesignPage.Feedback.Navigate")}},73546:function(t,n,e){"use strict";e.d(n,{j:function(){return i}});var r=e(72377);function i(){return r.Pv.Resolve("ILogger")}},72377:function(t,n,e){"use strict";e.d(n,{Pv:function(){return o}});var r=function(){function t(){this.Ld=!1,this.Ad=!1}var n=t.prototype;return n.UsingSingleton=function(t){return this.qd(t,!0)},n.UsingFactory=function(t){return this.qd(t,!1)},n.Create=function(){return this.Ld?(this.Md||(this.Md=this.Ud()),this.Md):this.Ud()},n.qd=function(t,n){return this.Ld=n,this.Vd=t,this},n.Ud=function(){if(this.Ad)throw Error("Circular dependency detected ");this.Ad=!0;var t=this.Vd();return this.Ad=!1,t},t}(),i=function(){function t(){this._d={}}var n=t.prototype;return n.Add=function(t,n){this._d[t]=n},n.Get=function(t){return this._d[t]},t}(),o=new(function(){function t(){this.Bd=new i}var n=t.prototype;return n.Resolve=function(t){var n,e=this.Bd.Get(t);if(!e)throw Error("Failed to resolve "+t+", make sure you have registered it by calling Register()");try{n=e.Create()}catch(n){throw Error("Exception when resolving "+t+": "+n)}return n},n.Register=function(t){var n=new r;return this.Bd.Add(t,n),n},t}())},52272:function(t,n,e){"use strict";e.d(n,{f:function(){return o}});var r=e(10836),i={ur:"اُردو",ht:"Kreyòl ayisyen",bn:"বাংলা","bn-IN":"বাংলা"};function o(t){return(0,r.cr)("CustomerVoiceCustomLanguageNYC")&&i[t]||t}},61634:function(t,n,e){"use strict";var r,i;e.d(n,{eG:function(){return r},CP:function(){return o}}),function(t){t.Home="Home",t.AllProjects="AllProjects",t.ProjectCreation="ProjectCreation",t.SurveyDesigner="SurveyDesigner",t.ReportView="ReportView",t.SatisfactionMetricView="SatisfactionMetricView",t.AlertsView="AlertsView",t.AdminView="AdminView"}(r||(r={})),function(t){t[t[void 0]=0]="undefined",t[t.NPS=1]="NPS",t[t.CSAT=2]="CSAT",t[t.Sentiment=3]="Sentiment",t[t.Scoring=4]="Scoring"}(i||(i={}));var o,s,u;!function(t){t[t.Survey=1]="Survey",t[t.Report=2]="Report"}(o||(o={})),function(t){t[t.FetchNotStarted=0]="FetchNotStarted",t[t.Fetching=1]="Fetching",t[t.Fetched=2]="Fetched",t[t.NoData=3]="NoData"}(s||(s={})),function(t){t.Sentiment="sentiment",t.Nps="nps",t.Csat="csat",t.Scoring="scoring"}(u||(u={}))},82641:function(t,n,e){"use strict";var r=/('[^']*'|"[^"]*")/g,i=/('[^']*'|"[^"]*"|d{1,2}|M{1,2}|y{2,4}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|t{2})/g;function o(t,n){var e=t.toString();if(t<0)return e;if(n&&n>e.length)for(;n>e.length;)e="0"+e;return e}function s(t){return r.test(t)?t.substr(1,t.length-2):t}function u(t,n,e){var r={};return null==t||null==n||null==e?r:(n.split(i).forEach((function(n){var i;switch(n){case"d":case"dd":case"M":case"MM":case"h":case"hh":case"H":case"HH":case"m":case"mm":case"s":case"ss":i=2;case"yy":case"yyy":case"yyyy":i=i||4,r[n]=function(t,n){n=n||t.length;var e=t.match(/^\d+/g),r=e&&e[0];return r?r.length<=n?r:r.substr(0,n):""}(t,i),i=r[n].length;break;case"tt":i=0;var o=t.toUpperCase();o.startsWith(e.DateTimeFormat.AMDesignator.toUpperCase())?i=e.DateTimeFormat.AMDesignator.length:o.startsWith(e.DateTimeFormat.PMDesignator.toUpperCase())?i=e.DateTimeFormat.PMDesignator.length:(o.startsWith("AM")||o.startsWith("PM"))&&(i=2),r[n]=t.substr(0,i);break;default:i=0,n=s(n),t.startsWith(n)&&(i=n.length)}t=t.slice(i)})),t.length>0?{}:r)}function a(t,n){var e=parseInt(t.HH||t.H),r=parseInt(t.hh||t.h||t.time||12);if(isNaN(e)&&!isNaN(r)&&r>=1&&r<=12)if(null==t.tt)t.time||(e=0);else switch(t.tt.toUpperCase()){case"AM":case n.DateTimeFormat.AMDesignator.toUpperCase():e=r%12;break;case"PM":case n.DateTimeFormat.PMDesignator.toUpperCase():e=r%12+12}var i=parseInt(t.mm||t.m||t.time||0),o=parseInt(t.ss||t.s||0);return isNaN(e)||isNaN(i)?NaN:1e3*(60*(60*e+i)+o)}Date.prototype.toFormatString=function(t,n){var e=this;return null==e||null==t||null==n?null:t.split(i).map((function(t){switch(t){case"d":case"dd":return o(e.getDate(),t.length);case"ddd":return n.DateTimeFormat.AbbreviatedDayNames[e.getDay()];case"M":case"MM":return o(e.getMonth()+1,t.length);case"MMM":return n.DateTimeFormat.AbbreviatedMonthNames[e.getMonth()];case"yy":var r=e.getFullYear(),i=o(r,4);return r>n.Calendar.TwoDigitYearMax-100&&r<=n.Calendar.TwoDigitYearMax?i.slice(2):i;case"yyy":case"yyyy":case"yyyyy":return o(e.getFullYear(),t.length);case"H":case"HH":return o(e.getHours(),t.length);case"h":case"hh":return o((e.getHours()+11)%12+1,t.length);case"m":case"mm":return o(e.getMinutes(),t.length);case"s":case"ss":return o(e.getSeconds(),t.length);case"t":case"tt":var u=e.getHours()<12?n.DateTimeFormat.AMDesignator:n.DateTimeFormat.PMDesignator;return 1===t.length?u.charAt(0):u;default:return s(t)}})).join("")},Date.prototype.toDateShortString=function(t){return this.toFormatString(t.DateTimeFormat.ShortDatePattern,t)},Date.prototype.toTimeShortString=function(t){return this.toFormatString(t.DateTimeFormat.ShortTimePattern,t)};var c=e(9947);Date.parseDate=function(t,n,e){var r=u(t,n,e),i=parseInt(r.yyyy||r.yyy),o=parseInt(r.yy);if(isNaN(i)&&!isNaN(o))if(o>=100)i=o;else{var s=(0,c.k0)().cultureInfo.Calendar.TwoDigitYearMax%100;i=o<=s?(0,c.k0)().cultureInfo.Calendar.TwoDigitYearMax-s+o:(0,c.k0)().cultureInfo.Calendar.TwoDigitYearMax-s-100+o}var l=parseInt(r.MM||r.M),f=r.MMM;isNaN(l)&&f&&(l=e.DateTimeFormat.AbbreviatedMonthNames.indexOf(f)+1);var h=parseInt(r.dd||r.d),d=a(r,e);if(!(isNaN(i)||isNaN(l)||isNaN(h)||isNaN(d))){var m=new Date(i,l-1,h,0,0,0,d);if(m.getFullYear()===i&&m.getMonth()+1===l&&m.getDate()===h)return m}return null},Date.parseTime=function(t,n,e){var r=u(t,n,e);return r.time=!0,a(r,e)},"name"in Function.prototype||Object.defineProperty(Function.prototype,"name",{get:function(){var t=/function\s([^(]{1,})\(/.exec(this.toString());return t&&t.length>1?t[1].trim():""}});var l=e(93641),f=e.n(l);!function(){var t;if(void 0!==e.g)t=e.g;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;if(n){var r=null;try{r=Object.prototype.toString.call(n.resolve())}catch(t){}if("[object Promise]"===r&&!n.cast&&void 0!==n.prototype.finally)return}t.Promise=f().Promise}(),String.prototype.format||(String.prototype.format=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this.replace(/{(\d+)}/g,(function(n,e){return void 0!==t[e]?t[e]:n}))}),String.prototype.includes||(String.prototype.includes=function(t,n){return void 0===n&&(n=0),-1!==this.indexOf(t,n)}),String.prototype.trimEnd=function(t){for(var n=this,e=n.length;--e>=0&&!(t.indexOf(n.charAt(e))<0););return n.substr(0,e+1)},String.prototype.startsWith=function(t){if(null==t||0===t.length)return!0;var n=this;return!(null==n||n.length<t.length)&&t===n.substr(0,t.length)},String.prototype.endsWith=function(t){if(null==t||0===t.length)return!0;var n=this;return!(null==n||n.length<t.length)&&t===n.substr(n.length-t.length,t.length)},String.prototype.replaceAll=function(t,n){return this.replace(new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),n)},Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t,n){for(var e=0;e<this.length;e++)if(t.call(n,this[e],e,this))return this[e]},configurable:!0,writable:!0});window.Forms={Mru:{},PrintTemplate:{}},window.FormsPro={};var h=e(4851);new Map;function d(t){return new Promise((function(n){if("serviceWorker"in navigator&&navigator.serviceWorker.controller){var e=new MessageChannel;return e.port1.onmessage=function(t){var r;e.port1.close(),e.port2.close(),n(null===(r=t.data)||void 0===r?void 0:r.payload)},navigator.serviceWorker.controller.postMessage(t,[e.port2]),setTimeout((function(){e.port1.close(),e.port2.close(),n(void 0)}),2e3)}n(null)})).catch((function(){}))}var m=e(55890),v=(0,h.Rm)((function(){self.formsModuleResolveErrorCallback=function(t){try{(0,m.zU)("Velocity_Issue_InvalidModuleId",{moduleId:t}),(n="StaticResource",d({type:"clearcache",payload:n})).then((function(){(0,m.$U)("ServiceWorker_ClearJsCssCache")})).catch((function(){}))}catch(t){}var n}})),p=e(72377),g=e(57411),b=e(88914),w=e(99019),y=e(55411),I=e(61734),S=e(13877),C=e(93592),F="officeforms.userAccountNameKey";var N,T,k,x=e(59312),P=function(t){function n(n){var e=t.call(this,n)||this;return e.name="AuthNoStorageError",e}return(0,x.ZT)(n,t),n}(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,x.ZT)(n,t),n}(Error)),D=e(94016),E=function(){function t(){}var n=t.prototype;return n.getFormApiToken=function(){return(0,D.LP)(N)},n.handleAuthForContentPage=function(t){var n=this;return T||(T=R().then((function(e){if(e.HasUserSignedIn)A();else if(t)return n.redirectToLogin()}))),T},n.handleAuthForAddinPage=function(){return T||(T=R().then((function(t){if(!t.HasUserSignedIn)throw new Error(null);A()}))),T},n.hasUserLoggedIn=function(){return!!N.getCachedUser()},n.isValid=function(){return!(0,y.hj)()},n.redirectToLogin=function(){if(N.login(),k)return k;throw Error("redirectForAuthContextLogin not called.")},n.refreshToken=function(){},n.signIn=function(){return this.redirectToLogin()},n.signOut=function(){return N.config.postLogoutRedirectUri=window.location.href,N.logOut(),Promise.resolve()},t}();function R(){var t=(0,S.y1)(),n=(0,S.f)();if(t||(0,m.$U)("Auth.LocalStorageNotSupported",{supportsSessionStorage:n}),!t&&!n)return Promise.reject(new P("local storage or session storage can't be used"));var e,r=(e=(0,S.ns)().getItem(F))&&JSON.parse(e),i="response_mode=form_post&msafed=0";r&&(i+="&username="+(r=JSON.stringify(r)));var o=window.location.origin,s={cacheLocation:t?"localStorage":"sessionStorage",clientId:(0,I.Bs)(),displayCall:L,extraQueryParameter:i,instance:(0,I.W6)(),postLogoutRedirectUri:o,redirectUri:o,tenant:""},u=new AuthenticationContext(s),a=u.isCallback(window.location.hash);return u.handleWindowCallback(),a?new Promise((function(){})):(N=u).getCachedUser()?new Promise((function(t){N.acquireToken((0,I.Bs)(),(function(n,e){var r=!n&&!!e;r?"live.com"===N.getCachedUser().profile.idp&&(N.clearCache(),r=!1,(0,m.zU)("UnexpectedLiveId")):N.clearCache();t({HasUserSignedIn:r,UserSignedInBefore:!0})}))})):Promise.resolve({HasUserSignedIn:!1,UserSignedInBefore:!1})}function L(t){if(k)throw Error("login in progress.");(0,C.mj)(t),k=new Promise((function(t,n){window.setTimeout(n,3e3)}))}function A(){var t=N.getCachedUser();if(t){var n=t.profile.oid,e=(0,c.k0)();e.userInfo={DisplayName:t.profile.name,Email:t.profile.unique_name,GivenName:t.profile.given_name||t.profile.name&&t.profile.name.split(" ")[0],IsMsa:!1,PUID:n.replace(/-/g,"").substring(16),TenantId:t.profile.tid,Upn:t.profile.upn,UserId:n,Language:""},(0,c.$Q)(e)}}var q,O=function(){function t(){}var n=t.prototype;return n.getFormApiToken=function(){return(0,D.LP)()},n.handleAuthForContentPage=function(t){},n.handleAuthForAddinPage=function(){},n.hasUserLoggedIn=function(){return!!(0,c.k0)().userInfo.UserId},n.isValid=function(){return(0,y.hj)()},n.redirectToLogin=function(){return(0,C.mj)((0,C.Gh)()),new Promise((function(){}))},n.refreshToken=function(){return(0,D.g$)()},n.signIn=function(){return this.redirectToLogin()},n.signOut=function(){return(0,C.gB)((0,c.k0)().signOutLink)},t}(),M=function(){function t(){}var n=t.prototype;return n.getFormApiToken=function(){return this.zd().getFormApiToken()},n.handleAuthForContentPage=function(t){return this.zd().handleAuthForContentPage(t)},n.handleAuthForAddinPage=function(){return this.zd().handleAuthForAddinPage()},n.hasUserLoggedIn=function(){return this.zd().hasUserLoggedIn()},n.isValid=function(){return this.zd().isValid()},n.redirectToLogin=function(){return this.zd().redirectToLogin()},n.refreshToken=function(){return this.zd().refreshToken()},n.signIn=function(){return this.zd().signIn()},n.signOut=function(){return this.zd().signOut()},n.zd=function(){return this.Qd||((0,y.hj)()?this.Qd=new O:this.Qd=new E),this.Qd},t}(),U=function(){function t(t){this.Hd=null,this.jd=t?t.concat():[new M]}var n=t.prototype;return n.signIn=function(){return this.$d().then((function(t){return t.signIn()}))},n.getFormApiToken=function(){return this.$d().then((function(t){return t.getFormApiToken()}))},n.handleAuthForContentPage=function(t){return this.$d().then((function(n){return n.handleAuthForContentPage(t)}))},n.handleAuthForAddinPage=function(){return this.$d().then((function(t){return t.handleAuthForAddinPage()}))},n.hasUserLoggedIn=function(){var t=this.Wd();return t&&t.hasUserLoggedIn()},n.redirectToLogin=function(){return this.$d().then((function(t){return t.redirectToLogin()}))},n.refreshToken=function(){return this.$d().then((function(t){return t.refreshToken()}))},n.signOut=function(){return this.$d().then((function(t){return t.signOut()}))},n.$d=function(){var t=this;if(this.Hd)return this.Hd;var n=function(e){var r=t.jd[e];return r?r.isValid()?Promise.resolve(r):n(e+1):Promise.reject(new Error("No valid authenticator"))};return this.Hd=n(0),this.Hd},n.Wd=function(){return this.jd.filter((function(t){return t.isValid()}))[0]},t}(),V=e(33967),_=e(90710),G=function(){function t(t){var n=t.flights,e=void 0===n?"":n;this.Jd={},et(),""!==e&&(this.Xd=J(e)),""===e&&(this.Yd=J((0,c.k0)().flights))}var n=t.prototype;return n.isEnabled=function(t){return this.Zd(t)},n.isEnabled_Deprecated=function(t){return this.Zd(t)},n.setFlights=function(t){this.Xd=J(t)},n.Zd=function(t){var n=z[t];switch("tenant"===n&&(this.Xd||W(t),n="environment"),n){case"environment":if(t in this.Jd)return this.Jd[t];break;case"deprecated":this.Xd||W(t);break;default:throw Error("Checking uninitialized flight "+t+".")}var e=this.tm(t);return"environment"===n&&(this.Jd[t]=e),e},n.tm=function(t){var n=this;if(Q[t]&&Q[t].some((function(t){return n.Zd(t)})))return!1;if(H[t]&&!H[t].every((function(t){return n.Zd(t)})))return!1;var e=t.toUpperCase(),r=function(){if(K)return K;var t={};if(!(0,V.yv)()||(0,V.Gd)()){var n="fo",e=(0,_.NW)()[n];Array.isArray(e)&&(e=e[e.length-1]),e&&e.split(";").forEach((function(n){"!"!==n[0]?t[n.toUpperCase()]=!0:(n=n.substr(1).toUpperCase(),t[n]=!1)}))}return K=t,t}();if(e in r)return r[e];var i=this.Xd||this.Yd;return t in i?i[t]:B[t]},t}(),B={},z={},Q={},H={};function j(){q=function(){switch((0,V.kD)()){case"DevHost":return 1;case"Daily":case"Drill":case"Pilot":case"Trial":case"ProDaily":case"CVDaily":return 2;case"Weekly":case"Hotfix":return 3;case"Int":case"MSInt":case"CVInt":return 4;case"WWProd":case"MSProd":case"ProTip":case"CVProd":case"CVTip":case"CVFastfood":case"USGovProd":case"USDoDProd":case"USGovGccProd":case"USNat":case"USSec":default:return 5}}()}function W(t){var n=new Error('Checking flight "'+t+'" before ready.');(0,m.zU)("UnstableFlightChecking",{flightName:t,flightType:z[t],stack:n.stack})}function J(t){var n={};return t&&t.split(";").forEach((function(t){"!"!==t[0]?n[t]=!0:(t=t.substr(1),n[t]=!1)})),n}var K=null;function X(t,n){B[t]=tt(n),z[t]="environment"}function Y(t,n){B[t]=tt(n),z[t]="tenant"}function Z(t,n){B[t]=tt(n),z[t]="deprecated"}function tt(t){return t>=(q||j(),q)}var nt=function(t,n){H[t]=n},et=(0,h.Rm)((function(){var t;Z("TestDeprecatedFlight",0),X("TestEnvironmentFlight",5),X("TestEnvironmentFlight_Blocker",0),Y("TestTenantFlight",5),Y("ResponseInApp",4),Z("DisableBrandingForMSA",0),Z("FormInsight",4),Z("PartialPut",1),X("AutoPinWordCloudInsight",4),X("ChangeToNormalFPSForAdminUnblockSurvey",4),X("CustomerVoiceBlackList",0),X("DisableRecordNameForTenant",0),X("DisableRedirect",0),X("DistributionDialog",5),X("EnableCustomerVoice",5),X("EnableNewDesignPage",4),X("EnableNewDesignPageM2",4),X("EnableNewDesignPageMultilingual",4),X("EnableNewDesignPageQuiz",4),X("EnableNewDesignPageSetting",4),X("EnableSuperL1",0),X("EstimationTimeUIFix",4),X("FeedbackLoopComponent",4),X("FirstReleaseClientEnabled",0),X("FixEslintPostMessageError",4),X("FixEslintTeamsPostMessageError",4),X("FixFluidPollRefresh",5),X("FluentDatePicker",4),X("FluentRating",4),X("FluidCategoryLoopPoll",5),X("FluidClosePollInFormsSide",0),X("FluidFormErrorView",5),X("FluidHistorySuggestion",0),X("FluidPollRemoveResponder",5),X("GetDriveItemFromFormApi",4),X("GetInsightNewApi",0),X("GetInsightPerResponseChange",4),X("GetRealtimeInsights",4),X("ImageManualReload",4),X("IncreaseTeamsPollMaxOptionCount",5),X("MobileQuestionCalloutBugfix",4),X("NewFluidPollCard",0),X("PPTContentAddinSSOComputer",0),X("PPTContentAddinWelcomePage",0),X("PollOptionSuggestion",4),X("PollQuestionSuggestion",4),X("ProRedirectInWeb",0),X("RichTextEditorV2",0),X("SendAndShareStage1",4),X("SendAndShareStage2",0),X("SensitiveInfoCheckForAllForms",4),X("SensitiveInfoCheckInResponsePage",4),X("ServiceWorkerEnabled",0),X("TeamsBubbleEnableCrossEnvCheck",5),X("TeamsPollNPS",4),X("TeamsPollUseCombinedCreate",5),X("TeamsResponseDetailsTaskModule",4),X("UnregisterServiceWorker",0),X("UseAriaEUCollector",0),X("UserAccountLanguageTelemetry",0),X("WarmToCold",4),X("WordCloudPoll",4),X("WordCloudPollResponseDetail",4),Y("AssignmentsIFrameLimitParentHeaders",4),Y("BaseProFRE",0),Y("DesignerFileUpload",2),Y("EnableAnonymousUploadLink",0),Y("FormsProAvailableTeachingCallout",0),Y("HideReportAbuse",0),Y("IntelligenceExpDemoTenantTest",0),Y("QuickPollDisableEws",0),Y("SuspiciousForm",4),Y("NextButtonLiveRegion",4),X("FormsPro",0),X("FormsProSignupInformationPage",0),X("FormsProTIP",0),Y("CDSFileUploadSecurityAlertText",0),Y("CKEditiorHtmlSource",0),Y("CustomerVoiceAutomation",0),Y("CustomerVoiceAutomateSurveyReminder",0),Y("CustomerVoiceCascadeLocale",0),Y("CustomerVoiceCascadeQuestion",0),Y("CustomerVoiceCDSFileDownload",0),Y("CustomerVoiceCDSFileUpload",0),Y("CustomerVoiceCDSOptimization",1),Y("CustomerVoiceCustomLanguage",0),Y("CustomerVoiceCustomLanguageNYC",0),Y("CustomerVoiceCustomLanguageV2",0),Y("CustomerVoiceMultilingualLocalesIncreasedLimit",0),Y("CustomerVoiceEmailTemplateBulkUpload",0),Y("CustomerVoiceEmbedCancelButton",0),Y("CustomerVoiceExportFromCDS",0),Y("CustomerVoiceExtendedLikert",0),Y("CustomerVoiceEventsWithData",0),Y("CustomerVoiceFileUpload",0),Y("CustomerVoiceFileUploadAnonymous",0),Y("CustomerVoiceIntegrations",1),Y("CustomerVoiceInviteBulkDelete",0),Y("CustomerVoiceInviteMigrationUI",0),Y("CustomerVoiceInviteMigrationDeletion",0),Y("CustomerVoiceLoggedInUserSendEmail",0),Y("CustomerVoicePreviewEmbed",4),Y("CustomerVoiceResposnePreviewURLRedirect",0),Y("CustomerVoiceSharingV2",0),Y("CustomerVoiceSharingV2AllProject",0),Y("CustomerVoiceSharingV2AllProjectNewColumn",0),Y("CustomerVoiceSharingV2BlockSurvey",0),Y("CustomerVoiceSPOFileUpload",0),Y("CustomerVoiceSurveyMove",0),Y("CustomerVoiceSurveyReminder",0),Y("CustomerVoiceToyotaCustomFont",0),Y("CustomerVoiceToyotaCustomEmailFont",0),Y("CustomerVoiceVoluntarySurveyReminder",0),Y("CustomerVoiceUpdatePrivacyAndTou",0),Y("CVAdvBranchingImprovements",0),Y("CVAutoNavigateAutoSubmit",0),Y("CVExportProjectToOtherTenants",0),Y("CVFiltersOtherOption",0),Y("CVHighCharts",0),Y("CVSatisfactionMetricsDrilldown",0),Y("CVSatisfactionMetricsReportsRedesign",0),Y("CVFusionTextAnalytics",0),Y("CVHighChartsDateCasacde",0),Y("CVInviteStatusReason",0),Y("CVLeapFrogChoiceQuestionNewUX",0),Y("CVLeapFrogChoiceQuestionRandomization",0),Y("CVLeapFrogVisualRefresh",0),Y("CVLongTermReporting",0),Y("CVMultipleResponseDelete",0),Y("CVOptimizeHomePagePerf",0),Y("CVPartialResponse",0),Y("CVProjectOperationsV2",0),Y("CVRatingQuestionSorting",0),Y("CVRestrictSurveyAccess",0),Y("CVRightRespondentDetails",0),Y("CVSectionBranchingShowHide",0),Y("CVSimplifiedBranching",0),Y("CVSMQuestionDeletion",0),Y("CVManageProjects",0),Y("DummyCascadeChart",0),Y("FormsProAnswerTag",1),Y("FormsProCSAT",0),Y("FormsProCSATSimulate",0),Y("FormsProChatDistributeChannel",0),Y("FormsProCustomCss",0),Y("FormsProCustomDomain",0),Y("FormsProCustomFooter",0),Y("FormsProCustomResponsesPage",0),Y("FormsProDemoView",0),Y("FormsProEmbedCodeToHive",0),Y("FormsProEmbedCompactPlus",0),Y("FormsProRemoveEmbedLink",0),Y("FormsProEnableSurveyMove",0),Y("FormsProGCC",0),Y("FormsProHideFooter",0),Y("FormsProHidePrivacyLink",0),Y("FormsProHighCharts",0),Y("FormsProInviteSingleSelection",0),Y("FormsProMSRewardsIntegration",4),Y("FormsProMultilingualLocalesIncreasedLimit",0),Y("FormsProNotifyAdmin",0),Y("FormsProQuestionVisibility",5),Y("FormsProRTECharLimit",0),Y("FormsProSampleFormOnClient",0),Y("FormsProSurveyPermissions",4),Y("FormsProTrial",0),Y("FormsProTrialExpiration",0),Y("OverSurveyManagement",0),Y("PartialResponseSettingDefaultValueOn",0),Y("PauseAndResumeSettingDefaultValueOn",0),nt("CustomerVoiceSPOFileUpload",["CustomerVoiceFileUpload"]),nt("CustomerVoiceCDSFileDownload",["CustomerVoiceFileUpload"]),nt("CustomerVoiceCDSFileUpload",["CustomerVoiceFileUpload"]),nt("CustomerVoiceFileUploadAnonymous",["CustomerVoiceFileUpload"]),nt("PartialResponseSettingDefaultValueOn",["CVPartialResponse"]),Y("CustomerVoiceQuestionLibrary",0),Y("CVDepartmentalCapacity",0),Y("CVBranchingOptimization",0),Y("CKEditorAttributeValidation",0),Y("CVResponsePreviewPagePromises",0),Y("CVSurveyDeletionWithBranchingPopup",0),t=["TestEnvironmentFlight_Blocker"],Q["TestTenantFlight"]=t,nt("BaseProFRE",["ProRedirectInWeb"]),nt("TestTenantFlight",["TestEnvironmentFlight"])})),rt=function(){function t(t){t=t||{},this.nm=new U(t.authenticators),this.rm=new G({}),t.addinAccessTokenGetter&&(0,w.Q)(t.addinAccessTokenGetter)}var n=t.prototype;return Object.defineProperty(n,"AuthContext",{get:function(){return this.nm},enumerable:!1,configurable:!0}),Object.defineProperty(n,"Flighting",{get:function(){return this.rm},enumerable:!1,configurable:!0}),Object.defineProperty(n,"RetryingRecoverableError",{get:function(){return this.im},set:function(t){this.im=t},enumerable:!1,configurable:!0}),t}(),it=e(75827),ot=e(10836),st=e(86353),ut=e(94290),at=e(43209),ct=e(56010),lt=e(29559),ft=e(41480),ht=e(83894),dt=function(){function t(){this.om=[]}var n=t.prototype;return n.setFunctionToCall=function(t){var n=this;if(this.sm!==t)if(this.sm=t,t){var e=this.om;delete this.om,e&&e.length&&e.forEach((function(t){return n.sm.apply(void 0,t)}))}else this.om=this.om||[]},Object.defineProperty(n,"queue",{get:function(){return this.sm?this.sm:this.um},enumerable:!1,configurable:!0}),n.um=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.om.push(t)},t}(),mt=e(85708),vt=e(916);function pt(t){t+="=";var n=document.cookie.split(";").filter((function(n){return n.indexOf(t)>=0}));if(n.length>0){var e=n[0].trim();return e.substring(t.length,e.length)}return null}var gt=function(){function t(){this.am=null}var n=t.prototype;return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},n.getMuid=function(){return this.am},n.ensureMuid=function(){var n=this;return null==this.lm&&(this.lm=new Promise((function(e){var r=pt("MUID");if(r)return n.am=r,void e(n.am);var i=new vt.o("Function.GetMuid");i.start(),t.loadMuid((function(){null!=(r=pt("MUID"))?(n.am=r,e(n.am),i.end({resultType:"Success"})):(e(),i.end({resultType:navigator.cookieEnabled?"Failure":"ExpectedFailure"}))}))}))),this.lm},t.loadMuid=function(t){var n=(0,V._7)();if(n){var e=document.createElement("img");e.style.display="none",e.src=n+"/c.gif",e.hidden=!0,e["aria-hidden"]="true",e.onload=e.onerror=t}else t()},t.instance=null,t}(),bt=e(2775);function wt(){return window.shellInfo}function yt(){var t,n=window.navigator;return window.URL&&"serviceWorker"in n&&function(){var t=!0;try{new Function("async () => {}")()}catch(n){t=!1}return t}()&&"function"==typeof(null===(t=n.serviceWorker)||void 0===t?void 0:t.register)}function It(){var t=(0,c.k0)();return!!(t&&t.swCacheApiEnabled)}function St(){var t=(0,_.NW)().fsw,n=wt();return!("0"===t||!n)&&n.swEnabled}var Ct,Ft,Nt=e(28087),Tt=e(64290),kt=e(44644),xt=function(){return"".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12)},Pt=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return{name:t,value:n,delta:0,entries:[],id:xt(),isFinal:!1}},Dt=function(t,n){try{if(PerformanceObserver.supportedEntryTypes.includes(t)){var e=new PerformanceObserver((function(t){return t.getEntries().map(n)}));return e.observe({type:t,buffered:!0}),e}}catch(t){}},Et=!1,Rt=!1,Lt=function(t){Et=!t.persisted},At=function(){addEventListener("pagehide",Lt),addEventListener("beforeunload",(function(){}))},qt=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Rt||(At(),Rt=!0),addEventListener("visibilitychange",(function(n){var e=n.timeStamp;"hidden"===document.visibilityState&&t({timeStamp:e,isUnloading:Et})}),{capture:!0,once:n})},Ot=function(t,n,e,r){var i;return function(){e&&n.isFinal&&e.disconnect(),n.value>=0&&(r||n.isFinal||"hidden"===document.visibilityState)&&(n.delta=n.value-(i||0),(n.delta||n.isFinal||void 0===i)&&(t(n),i=n.value))}},Mt=function(){return void 0===Ct&&(Ct="hidden"===document.visibilityState?0:1/0,qt((function(t){var n=t.timeStamp;return Ct=n}),!0)),{get timeStamp(){return Ct}}},Ut=function(){return Ft||(Ft=new Promise((function(t){return["scroll","keydown","pointerdown"].map((function(n){addEventListener(n,t,{once:!0,passive:!0,capture:!0})}))}))),Ft};function Vt(t){"undefined"!=typeof PerformanceObserver&&(function(t){var n,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=Pt("CLS",0),i=function(t){t.hadRecentInput||(r.value+=t.value,r.entries.push(t),n())},o=Dt("layout-shift",i);o&&(n=Ot(t,r,o,e),qt((function(t){var e=t.isUnloading;o.takeRecords().map(i),e&&(r.isFinal=!0),n()})))}(t),function(t){var n=Pt("FID"),e=Mt(),r=function(t){t.startTime<e.timeStamp&&(n.value=t.processingStart-t.startTime,n.entries.push(t),n.isFinal=!0,o())},i=Dt("first-input",r),o=Ot(t,n,i);i?qt((function(){i.takeRecords().map(r),i.disconnect()}),!0):window.perfMetrics&&window.perfMetrics.onFirstInputDelay&&window.perfMetrics.onFirstInputDelay((function(t,r){r.timeStamp<e.timeStamp&&(n.value=t,n.isFinal=!0,n.entries=[{entryType:"first-input",name:r.type,target:r.target,cancelable:r.cancelable,startTime:r.timeStamp,processingStart:r.timeStamp+t}],o())}))}(t),function(t){var n,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=Pt("LCP"),i=Mt(),o=function(t){var e=t.startTime;e<i.timeStamp?(r.value=e,r.entries.push(t)):r.isFinal=!0,n()},s=Dt("largest-contentful-paint",o);if(s){n=Ot(t,r,s,e);var u=function(){r.isFinal||(s.takeRecords().map(o),r.isFinal=!0,n())};Ut().then(u),qt(u,!0)}}(t),function(t){var n,e=Pt("TTFB");n=function(){try{var n=performance.getEntriesByType("navigation")[0]||function(){var t=performance.timing,n={entryType:"navigation",startTime:0};for(var e in t)"navigationStart"!==e&&"toJSON"!==e&&(n[e]=Math.max(t[e]-t.navigationStart,0));return n}();e.value=e.delta=n.responseStart,e.entries=[n],e.isFinal=!0,t(e)}catch(t){}},"complete"===document.readyState?setTimeout(n,0):addEventListener("pageshow",n)}(t),function(t){var n,e=Pt("FCP"),r=Mt(),i=Dt("paint",(function(t){"first-contentful-paint"===t.name&&t.startTime<r.timeStamp&&(e.value=t.startTime,e.isFinal=!0,e.entries.push(t),n())}));i&&(n=Ot(t,e,i))}(t))}var _t="Office Forms BrowserApp",Gt="Office FormsPro BrowserApp",Bt="properties",zt="page_type",Qt="source_application",Ht="UserInfo.IdType",jt="UserInfo.Id",$t="user_role",Wt="user_type";function Jt(){var t=(0,kt.P)();return"OneNoteUwp"===t||"PowerPointTaskpane"===t||""===window.location.host}function Kt(){switch((0,V.kD)()){case"Int":case"MSInt":case"CVInt":return"Int";case"WWProd":case"USGovProd":case"MSProd":case"ProTip":case"CVProd":return"Prod";default:return"DevEnv"}}function Xt(t){return isNaN(t)?"0":t.toString()}function Yt(t,n){return(0,x.mG)(this,void 0,void 0,(function(){var e,r,i,o,s,u,a;return(0,x.Jh)(this,(function(l){switch(l.label){case 0:return e=(0,c.k0)(),a={BuildVersion:e.version,EcsConfigIds:(0,st.DP)(),EcsFirstRelease:(0,st.dm)(),IsFirstRelease:(0,it.$O)(),IsMobile:(0,lt.tq)(),IsSwSupported:yt(),JQueryLoaded:!!window.$,Referrer:document.referrer&&(0,Nt.Lp)(document.referrer),SessionRing:Kt(),SessionUrlPath:window.location.origin+window.location.pathname,SwEnabled:St()||It(),SwReload:e.IsSwReload||!1},[4,d({type:"version"})];case 1:return a.SwVersion=l.sent(),a.UserAgent=navigator.userAgent,r=a,(0,bt.l7)(r,n()),t.properties&&(i=JSON.parse(t.properties),(0,bt.l7)(r,i)),o=(0,kt.P)(),s=navigator.connection,u=(0,ct.hp)(),o&&(r.Origin=o),s&&(r.Connection={downLink:s.downLink||-1,effectiveType:s.effectiveType||"unsupported",rtt:s.rtt||-1}),u&&(r.StartPageRoute=u),r.IsMobile&&(r.IsMobileView=(0,lt.lZ)()),t.eventName=t.eventType,t.duration=0,t.properties=JSON.stringify(r),t.timeStamp=(0,mt.dg)(),[2]}}))}))}var Zt=function(){function t(t,n,e,r,i,o){var s=this;this.fm=function(t){return(0,x.mG)(s,void 0,void 0,(function(){return(0,x.Jh)(this,(function(n){switch(n.label){case 0:return"session_start"!==t.eventType?[3,2]:[4,Yt(t,this.hm)];case 1:return n.sent(),[3,3];case 2:"engagement_event"===t.eventType&&(0,lt.tq)()&&function(t){var n={},e={};t.properties&&(n=JSON.parse(t.properties)),(0,bt.l7)(e,n,{IsMobileView:(0,lt.tq)()}),t.properties=JSON.stringify(e)}(t),n.label=3;case 3:return this.vm(t),[2]}}))}))},this.gm=(0,ft.k)(),this.bm=n,this.wm=t,this.ym=e,this.Im=o,this.Sm=r,this.hm=i,setTimeout((function(){gt.getInstance().ensureMuid().then((function(){s.ee()}))}))}var n=t.prototype;return n.logData=function(n){t.BUFFER.queue(n)},n.flush=function(t){this.wm.flush(t)},n.ee=function(){return(0,x.mG)(this,void 0,Promise,(function(){var n,e=this;return(0,x.Jh)(this,(function(r){switch(r.label){case 0:return this.Cm=(0,V.Fc)().toUpperCase(),this.Fm=function(){switch((0,at.C2)()){case"Design":return 0;case"Response":return 1;case"Analyze":return 3;case"TeamsConfig":return 4;default:return 2}}(),this.Nm=0,this.Tm=window.location.pathname.toLowerCase(),(0,V.Zr)()&&"OneNoteUwp"!==(0,kt.P)()?(this.Sm().then((function(t){return e.Nm=t})).finally((function(){e.bm.then((function(){e.wm.initialize(),t.BUFFER.setFunctionToCall(e.fm)}))})),[3,4]):[3,4];case 1:return n=this,[4,this.Sm()];case 2:return n.Nm=r.sent(),[4,this.wm.initialize()];case 3:r.sent(),t.BUFFER.setFunctionToCall(this.fm),this.Im&&this.Im(),r.label=4;case 4:return Vt((function(t){var n=t.name,e=t.value,r=t.delta,i=t.id,o=t.isFinal;(0,m.$U)("Perf.WebVitals",{name:n,value:e,delta:r,id:i,isFinal:o})})),[2]}}))}))},n.vm=function(t){var n=p.Pv.Resolve("IAWTEventProperties");n.setName(t.eventType),n.setProperty("event_name",t.eventName),n.setProperty("event_correlation_id",t.eventCorrelationId),n.setProperty("duration",Xt(t.duration)),n.setProperty("timestamp",Xt(t.timeStamp)),n.setProperty(Bt,t.properties);var e=(0,ut.rh)();e&&n.setProperty("integration_appid",e);var r=(0,ut.XF)();r&&n.setProperty("integration_host",r),t.eventName&&t.eventName.indexOf("IntelligenceStatistic")>=0||t.withoutUserInfo?this.km(n):this.xm(n)},n.km=function(t){Jt()||(t.setProperty(Qt,(0,Tt.pd)((function(){return _t}),(function(){return Gt}))),t.setProperty($t,this.Fm),t.setProperty(Wt,this.Nm),t.setProperty(zt,this.Tm),this.wm.logEvent(t))},n.xm=function(t){var n,e;if(!Jt()){var r=(0,c.k0)().userInfo,i=r.UserId,o=r.TenantId,s=null===(e=null===(n=t.getPropertyMap())||void 0===n?void 0:n.properties)||void 0===e?void 0:e.value,u=this.Pm(s),a=u[0],l=u[1];if(a?t.setProperty(Bt,l):a=this.ym(),a&&t.setProperty("form_id",a),t.setProperty(Qt,(0,Tt.pd)((function(){return _t}),(function(){return Gt}))),t.setProperty("user_id",i),t.setProperty("user_tenant_id",o),t.setProperty($t,this.Fm),t.setProperty(Wt,this.Nm),t.setProperty("session_id",this.gm),t.setProperty(zt,this.Tm),t.setProperty("server_build_version",(0,c.k0)().serverBuild),t.setProperty("client_build_version",(wt()||(0,c.k0)()).clientBuild),t.setProperty("server_dc",(0,c.k0)().datacenter),t.setProperty("server_ring",(0,c.k0)().ring),(0,c.k0)()&&(0,c.k0)().serverInfoFromPageHeaders&&(t.setProperty("server_instance",(0,c.k0)().serverInfoFromPageHeaders.serverInstance),t.setProperty("routing_build",(0,c.k0)().serverInfoFromPageHeaders.routingBuild),t.setProperty("routing_dc",(0,c.k0)().serverInfoFromPageHeaders.routingDataCenter),t.setProperty("routing_instance",(0,c.k0)().serverInfoFromPageHeaders.routingInstance)),o)if(o.toUpperCase()===this.Cm){var f=(0,c.k0)().userInfo.PUID;t.setProperty(jt,f),t.setProperty(Ht,"MSAPUID")}else t.setProperty(jt,i),t.setProperty(Ht,"UserObjectId"),t.setProperty("UserInfo.OMSTenantId",o);else i||t.setProperty("MUID",gt.getInstance().getMuid());0,this.wm.logEvent(t)}},n.Pm=function(t){if(t&&"string"==typeof t)try{var n=JSON.parse(t),e=null==n?void 0:n.form_id;return n.hasOwnProperty("form_id")&&(delete n.form_id,t=JSON.stringify(n)),[e,t]}catch(t){}return[null,t]},t.BUFFER=new dt,t}(),tn=function(){function t(){this.Ht=!1}var n=t.prototype;return n.initialize=function(){var t=function(){var t={disableCookiesUsage:!0};switch((0,V.kD)()){case"USGovProd":t.collectorUri="https://tb.pipe.aria.microsoft.com/Collector/3.0";break;case"USDoDProd":t.collectorUri="https://pf.pipe.aria.microsoft.com/Collector/3.0";break;case"USNat":t.collectorUri="https://collector.azure.eaglex.ic.gov/Collector/3.0/";break;case"USSec":t.collectorUri="https://collector.azure.microsoft.scloud/Collector/3.0/";break;default:(0,V.Wr)()&&(0,ot.cr)("UseAriaEUCollector")&&(t.collectorUri="https://eu-mobile.events.data.microsoft.com/Collector/3.0/")}return t}(),n=function(t){switch((0,V.kD)()){case"Int":case"MSInt":case"CVInt":return"79beea9c4fdb49a5adab4843729e1fa0-19b42cd4-5bd4-4bf8-8e49-05dc0f7f97f8-7484";case"WWProd":case"MSProd":case"ProTip":case"CVTip":case"CVProd":case"CVFastfood":return(0,ht.ro)()||t()?"5f4ebf0f9a11474199e89f94bc7e2f50-61b8420a-22b1-4220-b531-4a4b96e4edb9-7406":(0,at._B)()?"d34df8693d35452c98f0e1cdfde6d6a8-44cd1abe-6b6d-4edc-a342-46ba159633a4-7645":(0,Tt.pd)((function(){return"2ddc7e5f54754fc68f3ae1c5b7f3eb20-1883aa8c-4c7b-42d1-b3d6-c9cdb5956783-7092"}),(function(){return"34574250afbe400d814cda5bafaabbbf-e8b2d8de-469a-4779-8134-0c3b0fa0d78e-7592"}));case"USGovGccProd":return(0,Tt.pd)((function(){return"aa96061debfd4ec7b9704f62060b4ca6-a498d428-fdba-43da-bc8b-4fe51865cb7f-7984"}),(function(){return"d4551187b06a470980076d381efaa944-55338c41-3ed1-4be7-86ae-f6f2d022aa9a-7049"}));case"USGovProd":return"577e32a3275e48c5a639a92c9a8af033-4028cb75-b5f4-4ad0-835e-0e26d79ff209-6823";case"USDoDProd":return"291cebec6b9a4cbf9489bc8cf3a0cc50-06f4c682-bd49-4f88-a8c2-ac582180b7f9-7725";case"USNat":return"847cac884ec7438c803f8fc375832d7f-8af022cb-395a-4731-b40b-aade0142f724-7321";case"USSec":return"fb4a5e0bc6e5481a8790cf380d1b1058-eaf2bb92-036c-4ff5-984e-ad0782620010-7469";default:return"e132e188c609439ab47cd7b06511fc0a-433f81b3-fab9-415a-882a-ba9e2f91abea-6917"}}(g.M5);AWTLogManager.initialize(n,t),this.Dm=AWTLogManager.getLogger(n),this.Ht=!0},n.flush=function(t){this.Ht?AWTLogManager.flush(t):t()},n.logEvent=function(t){var n;null===(n=this.Dm)||void 0===n||n.logEvent(t)},t}(),nn=e(94978),en={engagement_event:"no_EngagementName",error_event:"no_ErrorName",formspro_event:"formspro_event",nav_perf_event:"no_NavPerfName",qos_event:"no_QosName",session_start:"session_start"},rn={engagement_event:on,error_event:on,experiment_event:on,formspro_event:on,nav_perf_event:function(t){var n=on(t);t.extraData&&(!function(t){if(sn){var n=0;"hidden"===sn.initialVisibility?n=sn.initializeTime.getTime():sn.visiToggleTime&&(n=sn.visiToggleTime.getTime());var e="VisiToggled";t.extraData[e]=n,sn.stop(),sn=null}}(t),n.properties=JSON.stringify(t.extraData));return n},qos_event:function(t){var n=t.eventName||en[t.eventType];"string"!=typeof n&&(n="");var e={duration:t.duration,eventCorrelationId:t.correlationId,eventName:n.replace(" ",""),eventType:t.eventType,properties:"",timeStamp:(0,mt.dg)()};t.extraData&&(e.properties=JSON.stringify(t.extraData));return e},session_start:function(t){var n;return on((0,x.pi)((0,x.pi)({},t),{correlationId:t.correlationId||(null===(n=(0,c.k0)().serverInfoFromPageHeaders)||void 0===n?void 0:n.serverCorrelationId)}))}};function on(t){var n=t.eventName||en[t.eventType];"string"!=typeof n&&(n="");var e={eventCorrelationId:t.correlationId,eventName:n.replace(" ",""),eventType:t.eventType,properties:"",timeStamp:(0,mt.dg)()};return t.extraData&&(e.properties=JSON.stringify(t.extraData)),e}var sn=new(function(){function t(){this.initialVisibility=document.visibilityState,this.initializeTime=new Date,this.Em=this.Em.bind(this),document.addEventListener("visibilitychange",this.Em)}var n=t.prototype;return n.stop=function(){document.removeEventListener("visibilitychange",this.Em)},n.Em=function(){this.visiToggleTime=new Date},t}()),un=e(79552),an=e(65861),cn=e(70699),ln=function(){function t(t){var n=this;this.logData=function(t,e){if(!function(t){return-1!==((0,nn.Gw)("DisabledEventNames")||[]).indexOf(t.eventName)}(t)){var r,i=rn[t.eventType];if(i)r=i(t);else r=on({eventName:"no_ErrorName",eventType:"error_event",extraData:{initData:t,message:"Unsupported event"}});r.properties=function(t){if("string"==typeof t){var n=t.toLowerCase();return n.indexOf("auth_upn=")<0&&n.indexOf("token=")<0&&n.indexOf("bearer ")<0&&n.indexOf("authorization=")<0?t:t?'{"log":"[Sanitized log]"}':""}}(r.properties),n.Lm.logData((0,bt.l7)(r,{withoutUserInfo:e}))}},this.Lm=t}var n=t.prototype;return n.logFormsProEvent=function(t){t.eventInfo.timeStamp=Date.now()-60*(new Date).getTimezoneOffset()*1e3,(0,Tt.md)((function(){t.eventInfo.Geo=(0,cn.sy)()}));var n={eventName:t.type,eventType:"formspro_event",extraData:t.eventInfo};this.Lm.logData(on(n))},n.sendTeamsAppInitializationCompleteSignal=function(t){(0,ut.Kw)()&&(t?(0,un.xP)(t)?microsoftTeams.appInitialization.notifySuccess():microsoftTeams.appInitialization.notifyFailure({message:(0,an.e)(t),reason:"Other"}):microsoftTeams.appInitialization.notifySuccess())},t}();function fn(){var t=(0,c.k0)();return{IsCdnEnabled:t.isCdnEnabled,IsAFDEnabled:t.isAFDEnabled,IsCandidateForLightResponsePage:t.isCandidateForLightResponsePage,LightMode:t.lightMode,NoLightReason:t.noLightReason,IsIntegration:t.isIntegration,IntegrationHost:t.isOembedSPO?"SPO":t.integrationHost,IsFirstReleaseEnabled:(0,ot.g)()}}function hn(){if((0,ot.cr)("UserAccountLanguageTelemetry")){var t=(0,c.k0)();return{UserAccountLanguage:t.userInfo?t.userInfo.Language:"",Flights:fn()}}return{Flights:fn()}}var dn=e(97058);var mn=e(9743),vn=e(67661),pn=e(26203),gn=e(39923),bn=e(81291),wn={HeaderBackgroundImage:gn.J4.string({IsLocalField:!0}),Name:gn.J4.string(),HeaderBackgroundThumbnail:gn.J4.string({IsLocalField:!0}),BackGroundPositionX:gn.J4.string({IsLocalField:!0}),BackGroundPositionY:gn.J4.string({IsLocalField:!0}),BackGroundPositionZ:gn.J4.string({IsLocalField:!0}),LogoPositionX:gn.J4.string({IsLocalField:!0}),LogoPositionY:gn.J4.string({IsLocalField:!0}),TitlePositionX:gn.J4.string({IsLocalField:!0}),TitlePositionY:gn.J4.string({IsLocalField:!0}),LogoSize:gn.J4.string({IsLocalField:!0})},yn=function(t){function n(n){var e=t.call(this,n)||this;if(n.MasterTreeReady){var r=vn.x.Schema;n.MasterTreeReady.then((function(){return e.Form.fieldsReady([r.HeaderTheme])})).then((function(){return e.Form.ensureFieldsReady([r.HeaderBGImage,r.BackGroundPositionX,r.BackGroundPositionY,r.BackGroundPositionZ,r.ThemeHeaderBackgroundImageURL,r.LogoPositionX,r.LogoPositionY,r.TitlePositionX,r.TitlePositionY,r.LogoSize])})).then((function(){return e.ee()}))}return e}(0,x.ZT)(n,t);var e=n.prototype;return Object.defineProperty(e,"Form",{get:function(){return this.Parent},enumerable:!1,configurable:!0}),e.getHeaderUploadedImageCustomThemeName=function(){var t=this.Form.Model;return{HeaderBackgroundImage:t.HeaderBGImage.ResourceUrl,Name:bn.x9,HeaderBackgroundThumbnail:null,BackGroundPositionX:t.BackGroundPositionX||"0px",BackGroundPositionY:t.BackGroundPositionY||"0px",BackGroundPositionZ:t.BackGroundPositionZ||"auto",LogoPositionX:t.LogoPositionX||bn.D4.Left,LogoPositionY:t.LogoPositionY||bn.cL.Mid,TitlePositionX:t.TitlePositionX||bn.D4.Left,TitlePositionY:t.TitlePositionY||bn.cL.Mid,LogoSize:t.LogoSize||bn.O8.Medium}},e.getNoBackGroundImageCustomThemeName=function(){var t=this.Form.Model;return{HeaderBackgroundImage:null,Name:bn.VK,HeaderBackgroundThumbnail:null,BackGroundPositionX:t.BackGroundPositionX||"0px",BackGroundPositionY:t.BackGroundPositionY||"0px",BackGroundPositionZ:t.BackGroundPositionZ||"auto",LogoPositionX:t.LogoPositionX||bn.D4.Left,LogoPositionY:t.LogoPositionY||bn.cL.Mid,TitlePositionX:t.TitlePositionX||bn.D4.Left,TitlePositionY:t.TitlePositionY||bn.cL.Mid,LogoSize:t.LogoSize||bn.O8.Medium}},e.getCompactHeaderCustomThemeName=function(){var t=this.Form.Model;return{HeaderBackgroundImage:t.ThemeHeaderBackgroundImageURL,Name:bn.Ic,HeaderBackgroundThumbnail:null,BackGroundPositionX:t.BackGroundPositionX||"0px",BackGroundPositionY:t.BackGroundPositionY||"0px",BackGroundPositionZ:t.BackGroundPositionZ||"auto",LogoPositionX:t.LogoPositionX||bn.D4.Left,LogoPositionY:t.LogoPositionY||bn.cL.Mid,TitlePositionX:t.TitlePositionX||bn.D4.Left,TitlePositionY:t.TitlePositionY||bn.cL.Mid,LogoSize:t.LogoSize||bn.O8.Medium}},e.getHeaderPredefinedImageCustomThemeName=function(){var t=this.Form.Model,n=t.HeaderTheme;return{HeaderBackgroundImage:n.HeaderBackgroundImage||t.ThemeHeaderBackgroundImageURL,Name:bn.rV,HeaderBackgroundThumbnail:n.HeaderBackgroundThumbnail,BackGroundPositionX:n.BackGroundPositionX||t.BackGroundPositionX||"0px",BackGroundPositionY:n.BackGroundPositionY||t.BackGroundPositionY||"0px",BackGroundPositionZ:n.BackGroundPositionZ||t.BackGroundPositionZ||"auto",LogoPositionX:n.LogoPositionX||t.LogoPositionX||bn.D4.Left,LogoPositionY:n.LogoPositionY||t.LogoPositionY||bn.cL.Mid,TitlePositionX:n.TitlePositionX||t.TitlePositionX||bn.D4.Left,TitlePositionY:n.TitlePositionY||t.TitlePositionY||bn.cL.Mid,LogoSize:n.LogoSize||t.LogoSize||bn.O8.Medium}},e.Am=function(){if(this.Form.SyncContext===mn.y.ResponseTimeForm){var t=this.Model.HeaderBackgroundImage;t&&(t=t.indexOf("lists.office")>-1?"HiveHeaderImage":"OOBHeaderImage"),(0,m.$U)("CV_HeaderTheme.Information",{headerImage:t,isheaderON:this.Form.isFieldReady(this.Form.Schema.HeaderEnabled)?this.Form.Model.HeaderEnabled?this.Form.Model.HeaderEnabled:"true":"notReady"})}},e.ee=function(){var t=this;this.addRule({Name:"calculate header theme basing on name",onChange:function(n){n.BeingDeleted||t.qm()}});var n=vn.x.Schema;this.Form.observe((function(){return t.qm()}),[n.HeaderBGImage.ResourceUrl,n.BackGroundPositionX,n.BackGroundPositionY,n.BackGroundPositionZ,n.LogoPositionX,n.LogoPositionY,n.TitlePositionX,n.TitlePositionY,n.LogoSize,n.ThemeHeaderBackgroundImageURL]),this.qm()},e.qm=function(){var t=this,n=this.Model.Name,e=!1;switch(n){case bn.x9:this.setData(this.getHeaderUploadedImageCustomThemeName());break;case bn.rV:this.setData(this.getHeaderPredefinedImageCustomThemeName());break;case bn.Ic:this.setData(this.getCompactHeaderCustomThemeName());break;case bn.VK:this.setData(this.getNoBackGroundImageCustomThemeName());break;default:var r=(0,c.k0)().headerThemeConfig;if(r&&"object"==typeof r&&r[n]&&"object"==typeof r[n])return void this.setData(r[n]);e=!0,this.Om(n).then((function(n){t.setData(n),t.Am()}))}e||this.Am()},e.Om=function(t){return this.Form.SyncContext!==mn.y.ResponseTimeForm?(0,bn.BM)(t):(0,bn.lx)(t)},n}(pn.d.createObjectMasterClass("SurveyHeaderTheme",wn));var In=function(){function t(){}return t.prototype.getMixinHeaderThemeMaster=function(){return t.HeaderThemeMasterClass||(t.HeaderThemeMasterClass=yn),t.HeaderThemeMasterClass},t}(),Sn=function(){function t(){}return t.prototype.getMixinHeaderThemeMaster=function(){return null},t}(),Cn=e(36215),Fn=e.n(Cn),Nn=e(64459),Tn=e(37076),kn=e(97265),xn=e(21607),Pn=e(72467),Dn=e(72317),En=e(27349),Rn=[],Ln=["LastEmbedConfig","formsProConfiguredPipes","FormsProBranchRules","mfpBranchingData","formsProEmbedCode","conditionalThankyouMessage","headerOtherInfo","footerText","alias"],An=[],qn=["FormsProSmileyList"];function On(t){var n=null;switch(t.entityType){case 1:n=(0,Tt.pd)((function(){return Rn}),(function(){return Ln}));break;case 2:n=(0,Tt.pd)((function(){return An}),(function(){return qn}));break;default:return}n&&t.data&&"object"==typeof t.data&&n.forEach((function(n){t.data[n]&&(t.data[n+"@odata.type"]="#String")}))}var Mn=e(72275),Un=e(60591),Vn=e(68289),_n=e(77209),Gn="questions",Bn="localeResource",zn=function(){function t(t,n){this.serviceUrl=t,this.ownerServiceUrl=n,this.partialUpdateHttpMethod=(0,Dn.a)().Flighting.isEnabled_Deprecated("PartialPut")?"PUT":"PATCH"}var n=t.prototype;return t.getQueryParameters=function(t,n,e){if(!n)return t+"$expand="+Gn;var r="$select="+(n=Cn.union(["id"],n)).join(","),i={permissions:"permissions",questions:"questions($expand=choices)",permissionTokens:"permissionTokens"},o=n.map((function(t){return i[t]})).filter((function(t){return t}));return o.length&&(r+="&$expand="+o.join(",")),e&&(r+="&$filter="+e.name+"+"+e.operator+"+"+e.value),r&&t+r},n.getImmersiveReaderToken=function(){var t=(0,g.x_)(),n=this.getSurveyWebServiceUrl()+"decomposition/GetImmersiveReaderToken?formId="+t;return this.sendRequest({method:"GET",qosEventName:"Decomposition.GetImmersiveReaderToken",requestUri:n}).then((function(t){if(t)return t;throw new Error("Failed to get ImmersiveReader token via GetTokenForResource")}))},n.getPrivacySettings=function(t,n,e){var r={};return t&&(r.ownerTenantId=t),n&&(r.currentUserTenantId=n),e&&(r.isAnonymous=e),this.sendRequest({method:"GET",qosEventName:"Function.GetPrivacy",requestUri:this.getSurveyWebServiceUrl()+"privacy?"+$.param(r)})},n.reportAbuse=function(t){return this.sendRequest({data:t,method:"POST",qosEventName:"OnlineSafety.ReportAbuse",qosExtraData:{Category:t.Category},requestUri:this.getSurveyWebServiceUrl()+"contentvalidation/report"+window.location.search})},n.getRuntimeResponses=function(t,n){var e=n?"&$filter=responder+eq+'"+encodeURIComponent(n.replace(/\'/g,"''"))+"'":"",r=this.getSurveyWebOwnerServiceUrl();return this.sendRequest({qosEventName:"RuntimeResponses.Get",requestUri:""+r+"forms('"+t+"')/"+"runtimeresponses?$expand=comments"+e})},n.getRuntimeResponse=function(t,n){var e=(0,_.NW)(),r={};return e.GetResponseToken&&(r.GetResponseToken=e.GetResponseToken),this.sendRequest({headers:r,qosEventName:"RuntimeResponse.Get",requestUri:this.getSurveyWebOwnerServiceUrl()+"light/"+"forms('"+t+"')/"+"runtimeresponses("+n+")?$expand=comments"})},n.submitFormResponse=function(t,n){var e=(0,Tn.kc)(t),r="AAD";return null==e.OrgId?r="Unknown":e.OrgId.toLowerCase()===(0,V.Fc)()&&(r="MSA"),this.sendRequest({data:n,method:"POST",qosEventName:"Response.Submit",qosExtraData:{OwnerSource:r},requestUri:""+this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/responses"})},n.getToken=function(){return(0,Dn.a)().AuthContext.getFormApiToken()},n.getRuntimeForm=function(n,e){var r=this.getSurveyWebOwnerServiceUrl()+"light/"+"runtimeForms('"+n+"')";return r+=t.getQueryParameters("?",e),this.sendRequest({qosEventName:"ResponseForm.Get",requestUri:r},{hasPrefetch:!0})},n.getResponseDetailRuntimeForm=function(n,e){var r=(0,_.NW)();if(r.GetResponseToken&&r.rid){var i={GetResponseToken:r.GetResponseToken},o=this.getSurveyWebOwnerServiceUrl()+"light/responseDetailRuntimeForms('"+n+"')/"+r.rid;return o+=t.getQueryParameters("?",e),this.sendRequest({headers:i,qosEventName:"QosEvent.ServiceEndpoints.Form.GetResponseDetailRuntimeForm",requestUri:o})}return Promise.resolve(null)},n.getLocaleResource=function(t,n){var e=this.getMultilingualBaseUrl(t)+"/'"+n+"'",r=(0,Tt.md)((function(){return(0,_.NW)().vt}));return this.sendRequest({headers:{ValidationToken:r||""},method:"GET",qosEventName:"Locale.Get",requestUri:e})},n.createUploadSession=function(t,n,e){var r=""+this.getSurveyWebOwnerServiceUrl()+"runtimeForms('"+t+"')/"+"questions('"+n+"')/CreateUploadSession";return this.sendRequest({data:{value:e},method:"POST",qosEventName:"Question.CreateUploadSession",requestUri:r})},n.cancelOrDeleteUploadFile=function(t){return this.sendRequest({method:"DELETE",qosEventName:"FileUpload.CancelOrDeleteUploadFile",requestUri:t})},n.getUserInfo=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"userInfo",method:"GET",qosEventName:"Function.GetUserInfo"},{disableRequestRingHeader:!0})},n.getSharedForm=function(t){return this.sendRequest({body:'{"value" : "'+(0,_.NW)().sharetoken+'"}',headers:{"Content-Type":"application/json;odata.metadata=minimal"},isSensitiveUri:!0,method:"GET",qosEventName:"SharedForm.Get",requestUri:this.getSurveyWebOwnerServiceUrl()+"GetSharedForm(formid='"+t+"',token='"+(0,_.NW)().sharetoken+"')"})},n.getDataClassificationLabelDetail=function(t,n){return this.Mm({method:"GET",qosEventName:"Function.GetDataClassificationLabelDetails",requestUri:this.getSurveyWebServiceUrl()+"/dataClassificationLabelInfo/"+t+"/"+encodeURIComponent(n)})},n.getMultilingualBaseUrl=function(t){return""+this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/"+Bn},n.getSurveyWebOwnerServiceUrl=function(){return this.ownerServiceUrl},n.getSurveyWebServiceUrl=function(){return this.serviceUrl},n.getFormApiBaseServiceUrl=function(){return(0,Vn.v)()+"formapi/api"},n.sendRequest=function(t,n,e){var r=this;return this.getToken().then((function(i){return t.headers=$.extend(!0,t.headers,r.getCommonHeaders(i)),On(t),(0,En.lW)(t,n,e).then((function(t){return(0,Mn.D3)(t).value}),Mn.W3)}))},n.sendRequestWithCount=function(t,n,e){var r=this,i={Forms:[],TotalFormCount:0};return this.getToken().then((function(o){return t.headers=$.extend(!0,t.headers,r.getCommonHeaders(o)),On(t),(0,En.lW)(t,n,e).then((function(t){var n=(0,Mn.D3)(t);return i.Forms=n.value,i.TotalFormCount=n.count,i}),Mn.W3)}))},n.getCommonHeaders=function(n){var e={Accept:"application/json",AnalyzerToken:(0,_.NW)().AnalyzerToken,Authorization:(0,_n.U)(n),ShareInvitationKey:(0,_.$p)().Token||(0,_.NW)().Token||(0,_.NW)().sharetoken,__RequestVerificationToken:(0,c.k0)().antiForgeryToken};return(0,Tt.md)((function(){var t={ContextParams:(0,c.k0)().contextParams,ParentSurveyId:(0,_.NW)().parentSurveyId,ParentResponseId:(0,_.NW)().parentResponseId,ValidationToken:(0,_.NW)().vt,RegardingParams:(0,_.NW)().rg};e=Cn.extend({},e,t)})),e=Cn.extend({},e,t.customizedHeaders)},n.Mm=function(t,n){return t.headers=$.extend(!0,t.headers,this.getCommonHeaders("")),On(t),(0,En.lW)(t,n).then(Mn.EI,Mn.W3)},t.customizedHeaders={},t}(),Qn="analysisForms",Hn="forms",jn="runtimeForms",$n="questions",Wn="descriptiveQuestions",Jn="choices",Kn="responses",Xn="comments",Yn="permissions",Zn="responderPermissions",te="permissionTokens",ne="sharedWithMeForms",ee="GetAggregateQuizData",re="GetAggregateSurveyData",ie="CopyToUser";function oe(t){function n(){var t=(0,Pn.f5)();return!(!t||!t.Model.FormMaster||t.Model.FormMaster.Model.OwnerId!==(0,c.k0)().userInfo.UserId)}function r(){(0,m.JG)({eventInfo:{Component:"FormAPI_fetchOwnerUserType",message:"Failed to fetch user type",pageName:"DesignPage",tenantId:(0,c.k0)().userInfo.TenantId,userId:(0,c.k0)().userInfo.UserId},type:"MFPUI_UserTypeFetchFailed"})}function i(t){var n=null;if(t&&t.settings){if((0,Tt.md)((function(){return"survey"===t.type})))return"Survey";var e=null;try{e=JSON.parse(t.settings)}catch(t){}if("poll"===t.type||t.category&&t.category.indexOf("Poll")>=0)return"Poll";e&&void 0!==e.IsQuizMode&&(n=e.IsQuizMode?"Quiz":"Form")}return n||void 0}function o(){switch((0,ut.XF)()){case"TeamsApproval":return"approval";case"TeamsReports":return"reports";default:return""}}return function(t){function s(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var r=t.apply(this,n)||this;return r.Um="aadFormLauncher",r.Vm="msaFormLauncher",r}(0,x.ZT)(s,t);var u=s.prototype;return s.addDefaultHeader=function(t,n){null===zn.customizedHeaders&&(zn.customizedHeaders={}),zn.customizedHeaders[t]=n},u.getForms=function(t,n){var e=this.getSurveyWebOwnerServiceUrl()+"light/";return e+=Hn+zn.getQueryParameters("?",t,n),this.sendRequest({requestUri:e,qosEventName:"Forms.Get"})},u.hardDeleteForms=function(t){var n=this.getSurveyWebOwnerServiceUrl()+"light/deleteForms";return this.sendRequest({requestUri:n,method:"POST",data:t,qosEventName:"Forms.HardDeleteForms"})},u.getFormsSharedWithCurrentUser=function(){var t=this.getSurveyWebOwnerServiceUrl()+ne;return this.sendRequest({requestUri:t,qosEventName:"Forms.Get.SharedWithMe"})},u.getFormsSharedWithCurrentUserPro=function(t,n){var e=t?"?$skip="+n+"&$top="+(0,cn.NA)():"?$top="+(0,cn.NA)()+"&$count=true",r=this.getSurveyWebOwnerServiceUrl()+"light/"+ne+e;return this.sendRequestWithCount({requestUri:r,qosEventName:"Forms.Get.SharedWithMe"})},u.getCachedSimpleForms=function(t,n){var e=""+this.serviceUrl+t+"/users/"+n+"/memorybasedforms";return this.sendRequest({requestUri:e,qosEventName:"Forms.GetCachedSimpleForms"})},u.getDesignForm=function(t,n){var e=this.getSurveyWebOwnerServiceUrl()+"light/";e+="forms('"+t+"')",e+=zn.getQueryParameters("?",n);var r={FormType:o()};return this.sendRequest({requestUri:e,qosEventName:"DesignForm.Get",qosExtraData:r})},u.getAnalysisTimeForm=function(t){var n=this.getSurveyWebOwnerServiceUrl()+"light/"+"analysisForms('"+t+"')?$expand=questions($expand=choices)";return this.sendRequest({requestUri:n,method:"GET",qosEventName:"AnalysisForm.Get"})},u.createOD4BSessionTempFolder=function(t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+jn+"('"+t+"')/Microsoft.FormServices.CreateOneDriveSessionTempFolder",method:"POST",qosEventName:"Form.CreateOD4BSessionTempFolder"}).then((function(t){return t?t.itemId:Promise.reject(new Error("Failed to create OneDriveForBusiness session temp folder."))}))},u.deleteSharedWithMeLink=function(t){var n=this.getSurveyWebServiceUrl()+"light/sharedWithMeForms('"+t+"')";return this.sendRequest({requestUri:n,method:"DELETE",qosEventName:"Forms.DeleteSharedWithMe"})},u.changeSharingStatus=function(t,n){var e=n?"On":"Off";return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/Microsoft.FormServices.Turn"+e+"AllowCopySetting",method:"POST",qosEventName:n?"FormDefinition.TurnOnFormSharing":"FormDefinition.TurnOffFormSharing"})},u.createPermissionLink=function(t,n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/"+Yn,method:"POST",data:n,qosEventName:"FormDefinition.CreateFormPermissionLink",qosExtraData:{specificShare:"User"===n.type||"Group"===n.type}})},u.deletePermissionLink=function(t,n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/"+"permissions('"+n+"')",method:"DELETE",qosEventName:"FormDefinition.DeleteFormPermissionLink"})},u.createResponderPermissionLink=function(t,n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/"+Zn,method:"POST",data:n,qosEventName:"FormDefinition.CreateResponderFormPermissionLink",qosExtraData:{type:n.type}})},u.deleteResponderPermissionLink=function(t,n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/"+"responderPermissions('"+n+"')",method:"DELETE",qosEventName:"FormDefinition.DeleteResponderFormPermissionLink"})},u.getFormPermissions=function(t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/"+Yn,method:"GET",qosEventName:"FormDefinition.GetFormPermissions"})},u.createPermissionToken=function(t,n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/"+te,method:"POST",data:n,qosEventName:"FormDefinition.CreateFormPermissionToken"})},u.getOrCreateFormPermissionToken=function(t,n,e){var r={};return(0,ut.Kw)()&&(r["x-ms-form-request-source"]="ms-teams"),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/Microsoft.FormServices.GetOrCreatePermissionToken",method:"POST",headers:r,data:{type:n,name:e},qosEventName:"Form.GetOrCreatePermissionToken"})},u.deletePermissionToken=function(t,n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/"+"permissionTokens('"+n+"')",method:"DELETE",qosEventName:"FormDefinition.DeleteFormPermissionToken"})},u.getIdentityProviderType=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"authinfo/idptype?username="+encodeURIComponent(t),method:"GET",qosEventName:"Form.GetIdentityProviderType"}).then((function(t){return t.ProviderType}))},u.createForm=function(t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Hn,method:"POST",data:t,headers:this._m(),qosEventName:"Form.Create",entityType:1,qosExtraData:{FormType:i(t)}})},u.createFormByDefinition=function(t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/"+Hn,method:"POST",data:t,headers:this._m(),qosEventName:"Form.Create",entityType:1,qosExtraData:{FormType:i(t),IsLight:!0}})},u.updateForm=function(t,e){return(0,Tt.md)((function(){var t=(0,kn.GW)(),i=new Error;if((0,m.JG)({type:"MFPUI_PatchFormIsNull",eventInfo:{tenantId:(0,c.k0)().userInfo.TenantId,requestId:t,Component:"FormUpdate",sessionId:(0,ft.k)(),mfpStack:i.stack,formObject:e}}),!e.ownerUserType&&n()){var o=(0,Pn.f5)();(0,b.Ng)().then((function(t){t&&o.Model.FormMaster.Model.OwnerUserType!==t.toString()&&(e.ownerUserType=t.toString(),o.bulkEdit((function(n){n.FormMaster.Model.OwnerUserType=t.toString()})))})).catch((function(){r()}))}})),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')",method:this.partialUpdateHttpMethod,data:e,qosEventName:"Form.Update",qosExtraData:{SoftDeleted:e.softDeleted},entityType:1},{disableRetry:1===e.softDeleted})},u.postFormShareAction=function(t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/"+"forms('"+t+"')/shareaction",method:"POST",qosEventName:"Form.PostShareAction"})},u.createFormImageFromUrl=function(t,n,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/"+n,method:"POST",data:e,qosEventName:"logo"===n?"FormImage.CreateFromUrl":"ThemeImage.CreateFromUrl",qosExtraData:{FormProperty:n}})},u.deleteForm=function(t,n,e){void 0===n&&(n=""),void 0===e&&(e="");var r=(0,Tt.pd)((function(){}),(function(){return{BusinessCdsId:n,BusinessCdsRegion:e}}));return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')",method:"DELETE",data:r,qosEventName:"Form.Delete"})},u.dupFormForExcel=function(t,n){var e={id:t,xlWorkbookId:n};return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Hn,method:"POST",data:e,qosEventName:"Excel.DuplicateFormForExcel"})},u.copyForm=function(t,n,e,r){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/"+"forms('"+t+"')/"+ie,method:"POST",data:{formId:t,newOwnerId:n,newTenantId:e,isNewOwnerGroup:r},qosEventName:"Function.CopyForm",qosExtraData:{FormId:t,NewOwnerId:n,IsNewOwnerGroup:r}},{disableRetry:!0}).then((function(t){return{id:t.id,title:t.title,createdDate:t.createdDate,modifiedDate:t.modifiedDate,settings:t.settings,xlWorkbookId:t.xlWorkbookId,ownerId:t.ownerId,ownerTenantId:t.ownerTenantId,category:t.category,otherInfo:t.otherInfo,background:t.background,softDeleted:t.softDeleted,type:t.type,fileUploadFormInfo:t.fileUploadFormInfo,status:t.status,version:t.version}}))},u.copyFormWithPatchProperties=function(t,n,e,r,i){if((0,Tt.md)((function(){return!0}))){var o={formId:t,newOwnerId:n,newTenantId:e,isNewOwnerGroup:r};return(0,y.y)()&&(o={formId:t,newOwnerId:n,newTenantId:e,isNewOwnerGroup:r,patchProperties:i}),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/"+"forms('"+t+"')/"+ie,method:"POST",data:o,qosEventName:"Function.CopyForm",qosExtraData:{FormId:t,NewOwnerId:n,IsNewOwnerGroup:r}},{disableRetry:!0}).then((function(t){return{id:t.id,title:t.title,createdDate:t.createdDate,modifiedDate:t.modifiedDate,settings:t.settings,xlWorkbookId:t.xlWorkbookId,ownerId:t.ownerId,ownerTenantId:t.ownerTenantId,category:t.category,otherInfo:t.otherInfo,background:t.background,softDeleted:t.softDeleted,type:t.type,fileUploadFormInfo:t.fileUploadFormInfo,status:t.status,version:t.version,cvSimplifiedBranchingSupported:t.cvSimplifiedBranchingSupported,mfpBranchingData:t.mfpBranchingData}}))}},u.copyFormBySharingLink=function(t,n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/"+"forms('"+t+"')/CopyBySharingLink",method:"POST",headers:{ShareInvitationKey:n},data:{formId:t,sharingToken:n},qosEventName:"Function.CopyBySharingLink",qosExtraData:{FormId:t}})},u.moveForm=function(t,n,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/"+"forms('"+t+"')/MoveForm",method:"POST",data:{newOwnerId:n,isNewOwnerGroup:e},qosEventName:"Function.MoveForm",qosExtraData:{FormId:t,NewOwnerId:n,IsNewOwnerGroup:e,IsDelegateMode:(0,ut.lS)()}})},u.postRecentForm=function(t,n){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"recent/forms/"+t,data:n,method:"POST",qosEventName:"Function.PostRecentForm"})},u.getRecentForms=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"recent/forms"+(null==t?"":"?ownerType="+encodeURIComponent(t)),method:"GET",qosEventName:"Function.GetRecentForms"})},u.removeRecentForm=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"recent/forms/"+t,method:"DELETE",qosEventName:"Function.RemoveRecentForm"})},u.updateExperienceType=function(t,n,e){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+t+"/users/"+n+"/experiencetype/"+e+"/UpdateExperienceType",method:"POST",qosEventName:"Function.UpdateExperienceType"})},u.updateLastUsedEnv=function(t,n,e){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+t+"/users/"+n+"/UpdateLastUsedEnv",data:e,method:"POST",qosEventName:"Function.UpdateLastUsedEnv"})},u.updateFormsProLicense=function(t,n){var e="";t||(e="FORMS_PRO");var r="";return r="UpdateFormsProUserLicenses(licenseNames='{0}',isOptOutAction={1})".format(e,n?"true":"false"),this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+r,method:"DELETE",qosEventName:"Function.UpdateFormsProLicense"})},u.updateRecentForm=function(t,n){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"recent/forms/"+t+"?title="+encodeURIComponent(n),method:"PUT",qosEventName:"Function.UpdateRecentForm"})},u.getFormsTenantSettings=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"GetFormsTenantSettings",method:"GET",qosEventName:"Function.GetFormsTenantSettings"})},u.getUserReputationTier=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"userReputationTier",method:"GET",qosEventName:"Function.GetUserReputationTier"})},u.getFormCreatorPhotoDefinition=function(t){return this.Gm({requestUri:this.getSurveyWebServiceUrl()+"light/GetFormCreatorDefinition('"+t+"','')",method:"GET",qosEventName:"Function.GetFormCreatorPhotoDefinition"})},u.getFormCreatorPhotoValue=function(t){return this.Gm({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+"light/GetFormCreatorPhotoValue('"+t+"','')/$value",method:"GET",qosEventName:"Function.GetFormCreatorPhotoValue"})},u.getCurrentUserPhotoValue=function(){return this.Gm({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+"GetCurrentUserPhotoValue",method:"GET",qosEventName:"Function.GetCurrentUserPhotoValue"})},u.getDataClassificationLabels=function(){return this.sendRequest({method:"GET",requestUri:this.getSurveyWebServiceUrl()+"GetDataClassificationLabels",qosEventName:"Function.GetDataClassificationLabels"})},u.getFormQuestion=function(t,n,e){var r=this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/"+"questions('"+n+"')";return e&&(r=r+"?$select="+e.toString()),this.sendRequest({requestUri:r,qosEventName:"Question.Get"})},u.createFormQuestion=function(t,n,e,r){var i=this,o=(0,x.pi)({IsQuiz:n.isQuiz,QuestionId:n.id,QuestionType:n.type},e),s={requestUri:this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/"+$n,method:"POST",data:n,qosEventName:"Question.Create",qosExtraData:o,entityType:2};return(0,Tt.md)((function(){i.Bm(t),i.zm()})),r?this.Gm(s,{},r):this.sendRequest(s)},u.createQuestionImageFromUrl=function(t,n,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/"+"questions('"+n+"')/image",method:"POST",data:e,qosEventName:"QuestionImage.CreateFromUrl",qosExtraData:{QuestionId:n}})},u.updateFormQuestion=function(t,n,e,r,i){var o=this,s=this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/"+"questions('"+n+"')",u=(0,x.pi)({QuestionType:e},i);return(0,Tt.md)((function(){o.Bm(t)})),this.sendRequest({requestUri:s,method:this.partialUpdateHttpMethod,data:r,qosEventName:"Question.Update",qosExtraData:u,entityType:2},{disableLog:!0})},u.deleteFormQuestion=function(t,n,e,r){var i=this,o=(0,x.pi)({QuestionType:e,QuestionId:n},r);return(0,Tt.md)((function(){i.Bm(t),i.zm()})),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/"+"questions('"+n+"')",method:"DELETE",qosEventName:"Question.Delete",qosExtraData:o})},u.zm=function(){(0,Tt.md)((function(){var t=(0,Pn.f5)().Model.FormMaster;t.SettingMaster.Model.PauseAndResumeSurvey&&t.bulkEdit((function(t){t.SurveyLastModifiedAt=(new Date).toUTCString()}))}))},u.Bm=function(t){var e=this;if(t&&n()){var i=(0,Pn.f5)();(0,b.Ng)().then((function(n){if(n&&i.Model.FormMaster.Model.OwnerUserType!==n.toString()){var r={};r.ownerUserType=n.toString(),i.bulkEdit((function(t){t.FormMaster.Model.OwnerUserType=n.toString()})),e.updateForm(t,r)}})).catch((function(){r()}))}},u.getFormDescriptiveElement=function(t,n,e){var r=this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/"+"descriptiveQuestions('"+n+"')";return e&&(r=r+"?$select="+e.toString()),this.sendRequest({requestUri:r,qosEventName:"DescriptiveElement.Get"})},u.createFormDescriptiveElement=function(t,n,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/"+Wn,method:"POST",data:n,qosEventName:"DescriptiveElement.Create",qosExtraData:(0,x.pi)({QuestionId:n.id,QuestionType:n.type},e)})},u.updateFormDescriptiveElement=function(t,n,e,r,i){var o=this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/"+"descriptiveQuestions('"+n+"')";return this.sendRequest({requestUri:o,method:this.partialUpdateHttpMethod,data:r,qosEventName:"DescriptiveElements.Update",qosExtraData:(0,x.pi)({QuestionType:e},i)},{disableLog:!0})},u.deleteFormDescriptiveElement=function(t,n,e,r){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/"+"descriptiveQuestions('"+n+"')",method:"DELETE",qosEventName:"DescriptiveElement.Delete",qosExtraData:(0,x.pi)({QuestionType:e},r)})},u.createQuestionChoice=function(t,n,e){var r=this,i=this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/"+"questions('"+n+"')/"+Jn;return(0,Tt.md)((function(){r.zm()})),this.sendRequest({requestUri:i,method:"POST",data:e,qosEventName:"Choice.Create"})},u.getQuestionChoice=function(t,n,e){var r=this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/"+"questions('"+n+"')/"+"choices("+e+")";return this.sendRequest({requestUri:r,method:"GET",qosEventName:"Choice.Get"})},u.updateQuestionChoice=function(t,n,e,r){var i=this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/"+"questions('"+n+"')/"+"choices("+e+")";return this.sendRequest({requestUri:i,method:this.partialUpdateHttpMethod,data:r,qosEventName:"Choice.Update"})},u.deleteQuestionChoice=function(t,n,e){var r=this,i=this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/"+"questions('"+n+"')/"+"choices("+e+")";return(0,Tt.md)((function(){r.zm()})),this.sendRequest({requestUri:i,method:"DELETE",qosEventName:"Choice.Delete"})},u.getFormResponses=function(t,n,e,r){var i=["$expand=comments"];n&&i.push("$filter={0}+{1}+{2}".format(n.name,n.operator,n.value)),e>=0&&r>=0&&i.push("$top={0}&$skip={1}".format(e,r));var o=i.filter((function(t){return!!t})).join("&");o=o&&"?"+o;var s=this.getSurveyWebOwnerServiceUrl()+"light/";return this.sendRequest({requestUri:s+Hn+"('"+t+"')/"+Kn+o,qosEventName:Cn.any(i,(function(t){return-1===t.indexOf("$filter")}))?"Responses.Get":"Responses.Get.Filter"})},u.getAnalysisTimeResponses=function(t,n,e){var r=this.getSurveyWebOwnerServiceUrl()+Qn+"('"+t+"')/"+"responses?$expand=comments";return n>=0&&e>=0&&(r+="&$top={0}&$skip={1}".format(n,e)),this.sendRequest({requestUri:r,method:"GET",qosEventName:"AnalysisTimeResponses.Get"})},u.getFormsResponseCount=function(){return this.Gm({requestUri:this.getSurveyWebServiceUrl()+"light/GetRespCounts()",method:"GET",qosEventName:"Function.GetFormsResponseCount"})},u.getFormResponseCount=function(t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/"+"responses/$count",qosEventName:"ResponseCount.Get"},{disableLog:!0})},u.deleteFormResponses=function(t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/"+Kn,method:"DELETE",qosEventName:"Responses.Delete"})},u.deleteFormResponse=function(t,n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/"+"responses("+n+")/",method:"DELETE",qosEventName:"Response.Delete"})},u.deleteFormInvites=function(t,n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/"+"forms('"+t+"')/invites",method:"DELETE",data:n,qosEventName:"Invites.Delete"})},u.addFormResponseComment=function(t,n,e){var r={feedback:e.feedback,score:e.score,questionId:e.questionId};return e.id&&(r.id=e.id),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/"+"responses("+n+")/"+Xn,method:"POST",data:r,qosEventName:"Comment.Add"})},u.addFormResponseComments=function(t,n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"batch/"+"forms('"+t+"')/"+Xn,method:"POST",data:n,qosEventName:"Comments.Add"})},u.setResponseReleaseDate=function(t,n,e){var r={releaseDate:e};return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/"+"responses("+n+")",method:this.partialUpdateHttpMethod,data:r,qosEventName:"Response.Update"})},u.createExportFile=function(t){var n=this;return this.getToken().then((function(e){var r,i="cdb-export-iframe",o=function(t){var n=document.getElementById(t);return n&&n.parentNode.removeChild(n),(n=document.createElement("iframe")).id=t,n.name=t,n.hidden=!0,n}(i);if((r=document.createElement("form")).style.display="none",r.method="POST",r.action=n.getSurveyWebServiceUrl()+Hn+"('"+t+"')/Microsoft.FormServices.CreateExportFile",r.target=i,null!==e){var s=document.createElement("input");s.type="hidden",s.name="Authorization",s.value="Bearer "+e,r.appendChild(s)}if(null!==(0,c.k0)().antiForgeryToken){var u=document.createElement("input");u.type="hidden",u.name="__RequestVerificationToken",u.value=(0,c.k0)().antiForgeryToken,r.appendChild(u)}document.body.appendChild(o),$(o).on("load",(function(){o.contentDocument.body.appendChild(r)})),r.submit()}))},u.downloadExcelFile=function(t,n,r){var i=this,o=new vt.o("Function.DownloadExcel");o.start();var s=3,u=this._m(),a=this.Qm({formid:t,timezoneOffset:u.__TimezoneOffset,__TimezoneId:u.__TimezoneId,minResponseId:n,maxResponseId:r}),c=function(){return i.getToken().then((function(t){var n=$.extend(!0,{},i.getCommonHeaders(t));n["x-correlationid"]=o.CorrelationId,n["x-usersessionid"]=(0,ft.k)();var r=Date.now();return(0,En.MM)({requestUri:a,headers:n}).then((function(t){return(0,x.mG)(i,void 0,void 0,(function(){var n,r;return(0,x.Jh)(this,(function(i){switch(i.label){case 0:return(r=Cn.find(Cn.keys(t.headers),(function(t){return"content-disposition"===t.toLowerCase()})))&&(n=t.headers[r].split("filename*=UTF-8''")[1]),n?[4,e.e(3424).then(e.t.bind(e,2926,23))]:[2,Promise.reject({message:"No file name in header",response:{statusCode:t.statusCode}})];case 1:return(0,i.sent().default)(t.body,decodeURIComponent(n)),o.end({resultType:"Success"}),[2]}}))}))})).catch((function(t){var n,e=t&&t.response&&t.response.body,u=t&&t.response&&t.response.statusCode;if(!e){var l=i.Hm(u,t.message,a,r);throw o.end({resultType:l.failureType,extraData:{ServiceError:l}}),l}return(n=e,new Promise((function(t,e){var r=new FileReader;r.onload=function(){return t(r.result)},r.onerror=e,r.readAsText(n)}))).then((function(t){var n=i.Hm(u,t,a,r);if((711===n.innerCode||701===n.innerCode)&&s>0)return s--,void(0,Dn.a)().AuthContext.refreshToken().then(xn.Yq).then((function(){return c()})).catch(C.sl);throw o.end({resultType:n.failureType,extraData:{ServiceError:n}}),n}))}))}))};return c()},u.Hm=function(t,n,e,r){var i="ExpectedFailure",o={statusCode:t,sourceUrl:e,innerCode:10203,innerMessage:n,failureType:"Failure"},s=(0,Nn.d)(n);switch(s&&s.error&&(o.innerCode=parseInt(s.error.code),o.innerMessage=s.error.message,o.failureType=s.error["@ms.form.error.type"]),t){case 503:Date.now()-r>2e4?(o.innerMessage="ConnectionClosedByClient",o.innerCode=10210):o.innerCode=15001,o.failureType=i;break;case 429:o.innerMessage="TooManyRequest",o.innerCode=10208,o.failureType=i,n.includes("ManyRequestPerVM")&&(o.innerMessage="ManyRequestPerVM",o.innerCode=10209);case 0:case 502:case 504:o.innerMessage="NetworkIssue",o.innerCode=15001,o.failureType=i;break;case 307:case 403:o.innerMessage="Blocked",o.innerCode=10207,o.failureType=i;break;default:if(void 0===t){n&&n.indexOf("Loading chunk")>=0&&(o.failureType=i)}}return o},u.getShellServiceInfo=function(t){var n,e=this,r=(0,S.G)();return(n=r.getItem(this.Um))?Promise.resolve(JSON.parse(n)):this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"GetShellServiceInfo(culture='{0}')".format(t),method:"GET",qosEventName:"Function.GetShellServiceInfo"}).then((function(t){return r.setItem(e.Um,JSON.stringify(t)),t}))},u.getConsumerShellServiceInfo=function(t){var n,e=this;return(n=(0,S.G)().getItem(this.Vm))?Promise.resolve(JSON.parse(n)):this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"GetConsumerShellServiceInfo(culture='{0}')".format(t),method:"GET",qosEventName:"Function.GetConsumerShellServiceInfo"}).then((function(t){return window.sessionStorage.setItem(e.Vm,JSON.stringify(t)),t}))},u.getShellNavBarData=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"GetShellServiceInfo(culture='{0}')".format(t),method:"GET",qosEventName:"QosEvent.ServiceEndpoints.Function.GetShellNavBarData"})},u.getOrNewExcelInOneDrive=function(t,n){var e=this.getSurveyWebOwnerServiceUrl()+"GetOrNewExcelInOneDrive(formid='"+t+"',forcereexport='"+n+"')";return this.sendRequest({requestUri:e,method:"GET",headers:this._m(),qosEventName:"Action.OpenExcelInOneDrive"})},u.refreshUserInfo=function(){return this.sendRequest({method:"GET",requestUri:this.getSurveyWebServiceUrl()+"refreshUserInfo",qosEventName:"Function.RefreshUserInfo"})},u.getUserFeatureSettings=function(){return this.Gm({requestUri:this.getSurveyWebServiceUrl()+"userfeaturesettings",method:"GET",qosEventName:"Function.GetUserFeatureSettings"})},u.updateUserFeatureSettings=function(t){return this.Gm({data:JSON.stringify(t),requestUri:this.getSurveyWebServiceUrl()+"userfeaturesettings",method:"PATCH",qosEventName:"Function.UpdateUserFeatureSettings"})},u.getXlWorkbookId=function(t){var n=this.getSurveyWebServiceUrl()+"GetXlWorkbookId(formid='"+t+"')";return this.sendRequest({requestUri:n,method:"GET",headers:this._m(),qosEventName:"Action.GetXlWorkbookId"})},u.isMemberOf=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"light/IsMemberOf('"+t+"')",method:"GET",qosEventName:"Function.IsMemberOf"},{disableXMsHeader:!0})},u.browseImage=function(t,n,e){var r={resourceId:t,itemCount:n,skipToken:e};return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/browseimage",method:"POST",data:r,qosEventName:"Decomposition.BrowseImage"})},u.getToken=function(){return(0,Dn.a)().AuthContext.getFormApiToken()},u.searchImage=function(t,n,e,r,i){var o={query:t,itemCount:e,lcid:(0,c.k0)().cultureInfo.Name.toLowerCase(),parameters:{license:n},skipToken:r.toString(),url:i};return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/searchimage",method:"POST",data:o,qosEventName:"Decomposition.SearchImage"})},u.getCdbToken=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/getTokenForResource?resourceType=CollabDB",method:"GET",qosEventName:"Decomposition.GetCdbToken"}).then((function(t){if(t)return t;throw new Error("Failed to get CDB token via GetTokenForResource")}))},u.getOD4BToken=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/getTokenForResource?resourceType=MSGraph",method:"GET",qosEventName:"Decomposition.GetOD4BToken"}).then((function(t){if(t)return"Bearer "+t;throw new Error("Failed to get OneDriveForBusiness token via GetTokenForResource")}))},u.getOCPSToken=function(){var t=new vt.o("Decomposition.GetOCPSToken");return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/getTokenForResource?resourceType=OCPS",method:"GET",qosEventName:"Decomposition.GetOCPSToken"},{},t).then((function(n){if(n)return{token:""+n.replace(/['"]+/g,""),CorrelationId:t.CorrelationId};throw new Error("Failed to get OCPS token via GetTokenForResource")}))},u.getFormsProToken=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/getTokenForResource?resourceType=FormsPro",method:"GET",qosEventName:"Decomposition.GetFormsProToken"}).then((function(t){if(t)return"Bearer "+t;throw new Error("Failed to get FormsPro token via GetTokenForResource")}))},u.unblockPhishingForm=function(t){return this.sendRequest({requestUri:this.$m(t)+"/unblock",method:"PATCH",qosEventName:"AdminPage.UnblockPhishingForm"})},u.confirmPhishingForm=function(t){return this.sendRequest({requestUri:this.$m(t)+"/confirmPhishing",method:"PATCH",qosEventName:"AdminPage.ConfirmPhishingForm"})},u.deleteEvilForm=function(t){return this.sendRequest({requestUri:this.$m(t),method:"DELETE",qosEventName:"AdminPage.DeleteEvilForm"})},u.getAdminPhishingReviewForm=function(t,n){var e=this.$m(t);return e+=zn.getQueryParameters("?",n),this.sendRequest({requestUri:e,method:"GET",qosEventName:"AdminPage.GetPhisingReviewForm"})},u.createAdminPhishingReviewPermissionLink=function(t,n){return this.sendRequest({requestUri:this.$m(t)+"/permissions",method:"POST",data:n,qosEventName:"AdminPage.CreateFormPermissionLink"})},u.getRestrictedUser=function(t){return this.sendRequest({requestUri:this.Wm(t),method:"GET",qosEventName:"AdminPage.GetRestrictedUser"})},u.unblockRestrictedUser=function(t){return this.sendRequest({requestUri:this.Wm(t),method:"DELETE",qosEventName:"AdminPage.UnblockRestrictedUser"})},u.getGroups=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"groups",method:"GET",qosEventName:"Groups.Get"})},u.getGroupId=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"groupinfo/getgroupid?onedriveweburl="+encodeURIComponent(t),method:"GET",qosEventName:"Form.GetGroupId"})},u.getGroup=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"groups('"+t+"')",method:"GET",qosEventName:"Group.Get"})},u.getGroupOwners=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"groups('"+t+"')/owners",method:"GET",qosEventName:"Group.GetOwners"})},u.getGroupMembers=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"groups('"+t+"')/members",qosEventName:"Group.GetMembers"})},u.getGroupPhotoDefinition=function(t){return this.Gm({requestUri:this.getSurveyWebServiceUrl()+"groups('"+t+"')/photo",method:"GET",qosEventName:"Group.GetPhotoDefinition"})},u.getGroupPhotoValue=function(t){return this.Gm({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+"groups('"+t+"')/photo/$value",method:"GET",qosEventName:"Group.GetPhotoValue"})},u.getUserPhotoValue=function(t){return this.Gm({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+"light/users/"+t+"/photo/$value",method:"GET",qosEventName:"User.GetPhotoValue"})},u.getGroupMemberPhotoDefinition=function(t,n){return this.Gm({requestUri:this.getSurveyWebServiceUrl()+"groups('"+t+"')/members('"+n+"')/photo",method:"GET",qosEventName:"Group.GetMemberPhotoDefinition"})},u.getGroupMemberPhotoValue=function(t,n){return this.Gm({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+"groups('"+t+"')/members('"+n+"')/photo/$value",method:"GET",qosEventName:"Group.GetMemberPhotoValue"})},u.getAnalysisSurveyData=function(t,n){var e=this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/"+re;return null!=n&&""!==n&&(e=this.getSurveyWebOwnerServiceUrl()+"light/forms('"+t+"')/GetAggregateSurveyData?"+n),this.sendRequest({requestUri:e,qosEventName:"Analysis.AggregateSurveyData"})},u.getFilteredResponseCount=function(t,n){var e=this.getSurveyWebOwnerServiceUrl()+"light/forms('"+t+"')/responses/$count?"+n;return this.sendRequest({requestUri:e,qosEventName:"Analysis.FilteredResponseCount"})},u.getAnalysisQuizData=function(t){var n=this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/"+ee;return this.sendRequest({requestUri:n,qosEventName:"Analysis.AggregateQuizData"})},u.getResultSharingAnalysisSurveyData=function(t){var n=this.getSurveyWebOwnerServiceUrl()+Qn+"('"+t+"')/"+re;return this.sendRequest({requestUri:n,qosEventName:"Analysis.ResultSharingAggregateSurveyData"})},u.getResultSharingAnalysisQuizData=function(t){var n=this.getSurveyWebOwnerServiceUrl()+Qn+"('"+t+"')/"+ee;return this.sendRequest({requestUri:n,qosEventName:"Analysis.ResultSharingAggregateQuizData"})},u.getInsights=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"insights/getinsights?formId="+encodeURIComponent(t),method:"GET",qosEventName:"Form.GetInsights"})},u.getFormsWithToken=function(t,n,e){void 0===t&&(t=!1);var r=this.getSurveyWebServiceUrl()+Hn+zn.getQueryParameters("?",n);return this.Gm({requestUri:r,qosEventName:"Forms.Get"},{skipExpiredTokenCheck:!!e},e)},u.createFormWithToken=function(t,n){return this.Gm({requestUri:this.getSurveyWebServiceUrl()+Hn,method:"POST",data:t,headers:this._m(),qosEventName:"Form.Create",qosExtraData:{FormType:i(t)},entityType:1},{},n)},u.checkAnonymousAccess=function(t){var n=this.getSurveyWebOwnerServiceUrl()+"light/"+"runtimeForms('"+t+"')";return(0,En.lW)({requestUri:n,headers:[]},{disableLog:!0,skipExpiredTokenCheck:!0}).then((function(){return!0}),(function(t){var n=(0,Un.Q)(t);if(401===n.statusCode)return!1;throw n}))},u.getMeetingInfo=function(t){var n=this.getSurveyWebServiceUrl()+"light/meetingInfo?meetingId="+t;return this.sendRequest({requestUri:n,method:"GET",qosEventName:"MeetingInfo.GetMeetingInfo"})},u.getInactiveUserByIdOrEmail=function(t){var n=this.getSurveyWebServiceUrl()+"deleteduserinfo/byidemail/"+encodeURIComponent(t);return this.sendRequest({requestUri:n,isSensitiveUri:!0,method:"GET",qosEventName:"InactiveUserByIdOrEmail.Get"})},u.getUserSettings=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"userSettings",method:"GET",qosEventName:"UserSettings.Get"})},u.updateUserSettings=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"userSettings",method:this.partialUpdateHttpMethod,data:t,qosEventName:"UserSettings.Update"}).then((function(){return null}))},u.getAllLocaleResources=function(t){var n=this.getMultilingualBaseUrl(t);return this.sendRequest({requestUri:n,method:"GET",qosEventName:"Locale.GetAll"})},u.createLocaleItem=function(t,n){return this.sendRequest({requestUri:this.getMultilingualBaseUrl(t),method:"POST",data:n,qosEventName:"LocaleItem.Create"})},u.updateLocaleItem=function(t,n){var e=this.getMultilingualBaseUrl(t)+"/'"+n.locale+"'/";return e+=n.questionId?"question/'"+n.questionId+"'/'":"form/'",e+=n.elementKey+"'",this.sendRequest({requestUri:e,method:this.partialUpdateHttpMethod,data:{ElementValue:n.elementValue},qosEventName:"LocaleItem.Update"})},u.deleteLocale=function(t,n){return this.sendRequest({requestUri:this.getMultilingualBaseUrl(t)+"/'"+n+"'",method:"DELETE",qosEventName:"Locale.Delete"})},u.copyLocaleResources=function(t,n){var e=this.getSurveyWebOwnerServiceUrl()+"batch/"+"forms('"+t+"')/"+Bn;return this.sendRequest({requestUri:e,method:"POST",data:n,qosEventName:"LocaleItem.Copy"})},u.getSuspiciousEvidence=function(t){var n=this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/GetSuspiciousEvidence";return this.sendRequest({requestUri:n,method:"GET",qosEventName:"SuspiciousEvidence.Get"})},u.notifyAdminForApproval=function(t){var n=this.getSurveyWebOwnerServiceUrl()+Hn+"('"+t+"')/NotifyAdminForApproval";return this.sendRequest({requestUri:n,method:"POST",qosEventName:"Function.NotifyAdminForApproval"})},u.getOrCreateShortUrl=function(t,n){var e=this.getSurveyWebOwnerServiceUrl()+"light/"+"forms('"+t+"')/shortUrls/"+n;return this.sendRequest({requestUri:e,method:"PUT",qosEventName:"ShortUrl.GetOrCreate",qosExtraData:{LinkType:n}})},u.getCSVInfo=function(t){var n=this.Jm(t.$formId)+"GetCSVInfoList";return this.sendRequest({requestUri:n,method:"GET",headers:this._m(),qosEventName:"ResponsesPage.GetCSVInfo"})},u.getCSVDownloadLink=function(t){var n=this.Jm(t.$formId)+"DownloadCSVFile/"+t.$fileName;return this.sendRequest({requestUri:n,method:"GET",headers:this._m(),qosEventName:"ResponsesPage.GetCSVDownloadLink"})},u.deleteCSVFile=function(t){var n=this.Jm(t.$formId)+"DeleteCSVFile/"+t.$fileName;return this.sendRequest({requestUri:n,method:"DELETE",qosEventName:"ResponsesPage.DeleteCSVFile"})},u.generateCSVFile=function(t){var n=this.Jm(t.$formId)+"GenerateCSVFile";return this.sendRequest({requestUri:n,method:"PUT",headers:this._m(),qosEventName:"ResponsesPage.GenerateCSVFile"})},u.getArchiveAndActiveResponseCount=function(t){var n=(0,Tn.kc)(t.$formId),e=n.OwnerId,r=n.OrgId,i=n.IsGroupOwner,o=this.getFormApiBaseServiceUrl()+"/"+r+"/"+(i?"groups":"users")+"/"+e+"/light/forms('"+t.$formId+"')/Responses/archiveandacitvecount";return this.sendRequest({requestUri:o,method:"GET",qosEventName:"Function.GetArchiveAndActiveResponseCount"})},u.Gm=function(t,n,e){var r=this;return Promise.resolve(e||this.getToken()).then((function(e){return t.headers=$.extend(!0,t.headers,r.getCommonHeaders(e)),On(t),(0,En.lW)(t,n).then((function(t){return(0,Mn.EI)(t)}),Mn.W3)}))},u._m=function(){var t,n="undefined"!=typeof Intl?Intl.DateTimeFormat():null,e=null===(t=null==n?void 0:n.resolvedOptions())||void 0===t?void 0:t.timeZone;return{__TimezoneOffset:(new Date).getTimezoneOffset().toString(),__TimezoneId:e||""}},u.Qm=function(t){return this.Xm()+"formapi/DownloadExcelFile.ashx?"+$.param(t)},u.Xm=function(){return this.serviceUrl.slice(0,-12)},u.$m=function(t){return this.getSurveyWebOwnerServiceUrl()+"admin/"+"forms('"+t+"')"},u.Wm=function(t){return this.getSurveyWebOwnerServiceUrl()+"admin/RestrictedUsers/"+t},u.Jm=function(t){var n=(0,Tn.kc)(t),e=n.OwnerId,r=n.OrgId,i=n.IsGroupOwner;return this.getFormApiBaseServiceUrl()+"/"+r+"/"+(i?"groups":"users")+"/"+e+"/forms('"+t+"')/"},u.Ym=function(t,n){void 0===n&&(n=!1);var e=(0,Tn.kc)(t),r=e.OwnerId,i=e.OrgId,o=e.IsGroupOwner;return this.getFormApiBaseServiceUrl()+"/"+i+"/"+(o?"groups":"users")+"/"+r+"/forms('"+t+"')/notificationsettings"},u.Zm=function(t,n){var e=(0,x.pi)({},n);return e.FormId=t,e.InvitationList&&(e.InvitationList=JSON.stringify(e.InvitationList)),e},u.getNotificationSettings=function(t){return this.sendRequest({requestUri:this.Ym(t),method:"GET",qosEventName:"SmartNotification.GetNotificationSettings"}).then((function(t){return t.InvitationList&&(t.InvitationList=(0,Nn.d)(t.InvitationList)),t})).catch((function(){return null}))},u.updateNotificationSettings=function(t,n){return this.sendRequest({requestUri:this.Ym(t),method:"PATCH",qosEventName:"SmartNotification.PatchNotificationSettings",data:this.Zm(t,n)})},u.createNotificationSettings=function(t,n){return this.sendRequest({requestUri:this.Ym(t,!0),method:"POST",qosEventName:"SmartNotification.PostNotificationSettings",data:this.Zm(t,n)})},s}(t)}var se,ue=function(){function t(){}return t.prototype.getMixinFormApi=function(){return t.FormApiClass||(t.FormApiClass=oe(zn)),t.FormApiClass},t}();!function(t){t[t.NotStarted=0]="NotStarted",t[t.Loading=1]="Loading",t[t.Loaded=2]="Loaded",t[t.Failed=3]="Failed"}(se||(se={}));var ae=e(61634),ce={Action:gn.J4.reference(),AllFormList:gn.J4.collectionOf(gn.J4.reference()),AllFormListLoadState:gn.J4.reference(),AllSharedFormList:gn.J4.collectionOf(gn.J4.reference()),Analysis:gn.J4.boolean(),BranchingElementId:gn.J4.string(),CdsInfoAvailableInUrl:gn.J4.boolean(),CdsList:gn.J4.reference(),CdsValidationMap:gn.J4.reference(),CopyFormId:gn.J4.string(),CriticalError:gn.J4.reference(),CurrentProject:gn.J4.reference(),CustomerVoiceDefaultEmailTemplates:gn.J4.reference(),CustomerVoiceDefaultETsLoadState:gn.J4.reference(),CustomerVoiceEmailTemplates:gn.J4.reference(),CustomerVoiceView:gn.J4.reference(),AllProjects:gn.J4.reference(),AlertRules:gn.J4.reference(),SMList:gn.J4.reference(),ProjectMetrics:gn.J4.reference(),FilterObj:gn.J4.reference(),CurrentAggregateThemeList:gn.J4.reference(),DataIdeas:gn.J4.boolean(),DefaultCdsId:gn.J4.string(),DefaultCdsInfoLoadState:gn.J4.reference(),DefaultCdsUrl:gn.J4.string(),DelegateInactiveUser:gn.J4.reference(),EnvironmentListLoadState:gn.J4.reference(),ErrorBarMessage:gn.J4.string(),ErrorLevel:gn.J4.reference(),ExecuteDownloadExcel:gn.J4.boolean(),ExperienceType:gn.J4.reference(),FlexPane:gn.J4.reference(),ForceDesktopView:gn.J4.boolean(),FormCollectionType:gn.J4.reference(),FormId:gn.J4.string(),FormList:gn.J4.collectionOf(gn.J4.reference()),FormListLoadState:gn.J4.reference(),FormMaster:gn.J4.reference(),FormsProToken:gn.J4.string(),FormsTenantSettings:gn.J4.reference(),Grading:gn.J4.reference(),GroupMaster:gn.J4.reference(),GroupMruFormListLoadState:gn.J4.reference(),Host:gn.J4.string(),InfoBarMessageType:gn.J4.string(),IntelligenceSuggestionStatus:gn.J4.reference(),IsDefaultCds:gn.J4.boolean(),LastActiveTime:gn.J4.number(),LastUsedEnv:gn.J4.reference(),Locale:gn.J4.string(),MeetingInfo:gn.J4.reference(),pendingCalls:gn.J4.reference(),PlaceholderList:gn.J4.collectionOf(gn.J4.reference()),PopupDialog:gn.J4.reference(),Preview:gn.J4.reference(),PreviousFlexPane:gn.J4.reference(),RecycleBin:gn.J4.collectionOf(gn.J4.reference()),RelativeScrolHeight:gn.J4.number(),ResponsePipeData:gn.J4.reference(),Scenario:gn.J4.string(),SearchContent:gn.J4.string(),SectionElementId:gn.J4.string(),SelectedCdsId:gn.J4.string(),SelectedCdsRegion:gn.J4.string(),SelectedCdsUrl:gn.J4.string(),SelectedPortalForm:gn.J4.reference(),SenderList:gn.J4.reference(),SharedWithMeFormList:gn.J4.collectionOf(gn.J4.reference()),SharedWithMeFormListLoadState:gn.J4.reference(),SharingToken:gn.J4.string(),ShouldDisableAllClick:gn.J4.boolean(),ShowBlockUsingFormsWarningPage:gn.J4.boolean(),ShowExcelSurveyIntroductionDialog:gn.J4.boolean(),ShowGroupListInPortal:gn.J4.boolean(),ShowShimmer:gn.J4.boolean(),ShowXLUnsyncedDialog:gn.J4.boolean(),Store:gn.J4.boolean(),TenantCountryCode:gn.J4.string(),Title:gn.J4.string(),Token:gn.J4.string(),TopView:gn.J4.reference(),UserActivities:gn.J4.reference(),ValidationChecked:gn.J4.reference(),XlWorkbookId:gn.J4.string(),SurveyReportId:gn.J4.string(),ResponseList:gn.J4.reference(),LastPageIndex:gn.J4.number(),Designer:gn.J4.boolean(),DesignerCalloutType:gn.J4.reference(),RandomizationCalloutType:gn.J4.reference(),SidePaneVisible:gn.J4.boolean(),NavPanelOpen:gn.J4.boolean(),CurrentAlert:gn.J4.reference(),CurrentAlertlist:gn.J4.reference(),ShowCVSimplifiedEditor:gn.J4.string(),OpenBranchingPanel:gn.J4.boolean(),isAllProjectListLoaded:gn.J4.boolean(),AddSimplifiedLogic:gn.J4.reference(),RespondentList:gn.J4.reference(),ResponseMap:gn.J4.reference(),ResponseCount:gn.J4.number(),FilteredResponseCount:gn.J4.number(),DeletedResponseCount:gn.J4.number(),UserTenantLevelSetting:gn.J4.reference(),UserCVLicense:gn.J4.boolean()},le=function(t){function n(){var n=t.call(this)||this;return n.tv=n.tv.bind(n),n.bulkEdit((function(){var t=n.Model;t.Analysis=!1,t.BranchingElementId=null,t.IntelligenceSuggestionStatus={QuestionSuggestion:"Default",ThemeSuggestion:"Default",EstimatedTime:"Default"},t.DataIdeas=!1,t.IntelligeceQuestionSuggestionStatus="Default",t.PopupDialog="None",t.Store=!1,t.Grading=null,t.FormListLoadState="NotStarted",t.SharedWithMeFormListLoadState="NotStarted",t.GroupMruFormListLoadState="NotStarted",t.FormCollectionType="OwnedForms",t.MeetingInfo=null,t.SectionElementId=null,n.Model.LastActiveTime=Date.now(),(0,Tt.md)((function(){t.CdsList=[],t.FirstLoading=!0,t.SelectedCdsId=null,t.CdsInfoAvailableInUrl=!1,t.LastUsedEnv=null,t.CdsValidationMap={},t.IsDefaultCds=!0,t.AllFormListLoadState="NotStarted",t.DefaultCdsInfoLoadState="NotStarted",t.DefaultCdsId="",t.DefaultCdsUrl="",t.TenantCountryCode="",t.ValidationChecked="Pending",t.ResponsePipeData=[],t.UserActivities=[],t.Project=null,t.ShowShimmer=!0,t.CustomerVoiceView=ae.eG.Home,t.CustomerVoiceDefaultEmailTemplates=[],t.CustomerVoiceDefaultETsLoadState=se.NotStarted,t.CustomerVoiceEmailTemplates=[],t.SurveyReportId=null,t.ResponseList=[],t.TextResponseList=[],t.LastPageIndex=0,t.Designer=!0,t.DesignerCalloutType="LeftNavigation",t.RandomizationCalloutType="RandomizationInitialTeachingDialog",t.SidePaneVisible=!!(0,ot.cr)("CVHighCharts"),t.NavPanelOpen=!1,t.CurrentAlert=null,t.CurrentAlertList=[],t.CurrentAggregateThemeList=[],t.ShowCVSimplifiedEditor=null,t.OpenBranchingPanel=!1,t.AddSimplifiedLogic="None",t.RespondentList=[],t.TextRespondentList=[],t.ResponseMap=new Map,t.TextResponseMap=new Map,t.ResponseCount=0,t.FilteredResponseCount=0,t.DeletedResponseCount=0,t.isAllProjectListLoaded=!1})),t.CopyFormId=null,t.SharingToken=null,t.FormsTenantSettings={bingImageSearch:!1,externalCollaboration:!0,externalSendForm:!0,externalShareCollaboration:!0,externalShareResult:!0,externalShareTemplate:!0,InOrgSurveyIncentive:!0,recordIdentityByDefault:!0,OverSurveyManagement:!1,OverSurveyManagementDays:0,allowRecordIdentity:!0,allowFileUpload:!0,RestrictSurveyAccessEnabled:!1}})),n.rv(),n}(0,x.ZT)(n,t);var e=n.prototype;return n.getInstance=function(){return this.instance||(this.instance=new n),this.instance},e.rv=function(){var t=this;["mousedown","keydown","touchstart"].forEach((function(n){return document.addEventListener(n,t.tv,!0)}))},e.tv=function(){var t=Date.now();this.Model.LastActiveTime<t-1e3&&(this.Model.LastActiveTime=Date.now())},n}(pn.d.createObjectMasterClass("DesignPageUxState",ce)),fe=e(25366),he=e(72374),de=e(90819),me=e(3920),ve={Action:gn.J4.reference(),Analysis:gn.J4.boolean(),BottomView:gn.J4.reference(),DesignerView:gn.J4.reference(),CopyFormId:gn.J4.string(),CriticalError:gn.J4.reference(),ErrorBarMessage:gn.J4.string(),ErrorLevel:gn.J4.reference(),FormCollectionType:gn.J4.reference(),FormId:gn.J4.string(),FormList:gn.J4.collectionOf(gn.J4.reference()),FormListLoadState:gn.J4.reference(),FormMaster:gn.J4.reference(),FormsTenantSettings:gn.J4.reference(),InfoBarMessageType:gn.J4.string(),LastActiveTime:gn.J4.number(),Locale:gn.J4.string(),QuestionId:gn.J4.string(),QuestionInDesign:gn.J4.reference(),SelectedPortalForm:gn.J4.reference(),SharingToken:gn.J4.string(),ShouldDisableAllClick:gn.J4.boolean(),ShowHeadBar:gn.J4.boolean(),ShowSavingSpinner:gn.J4.boolean({IsLocalField:!0}),SurveyResults:gn.J4.boolean(),Title:gn.J4.string(),Token:gn.J4.string()},pe=function(t){function n(){var n=t.call(this)||this;return n.tv=n.tv.bind(n),n.bulkEdit((function(t){t.Action="None",t.BottomView="None",t.DesignerView="None",t.FormListLoadState="NotStarted",t.FormCollectionType="OwnedForms",t.QuestionId=null,t.ShowHeadBar=!0,t.ShowSavingSpinner=!1,n.Model.LastActiveTime=Date.now(),t.FormsTenantSettings={bingImageSearch:!1,externalCollaboration:!0,externalSendForm:!0,externalShareCollaboration:!0,externalShareResult:!0,externalShareTemplate:!0,InOrgSurveyIncentive:!0,recordIdentityByDefault:!0,OverSurveyManagement:!1,OverSurveyManagementDays:0,allowRecordIdentity:!0,allowFileUpload:!0,RestrictSurveyAccessEnabled:!1}})),n.addRule({InterestedFields:[n.Schema.FormMaster],Name:"ClearRouting",onChange:function(t){n.Model.FormMaster||n.ov()}}),n.addRule({InterestedFields:[n.Schema.QuestionInDesign],Name:"DesignQuestion",onChange:function(t){n.Model.QuestionInDesign?n.Model.QuestionId=n.Model.QuestionInDesign.Model.Id:n.Model.QuestionId=null}}),n.rv(),n}(0,x.ZT)(n,t);var e=n.prototype;return n.getInstance=function(){return this.instance||(this.instance=new n),this.instance},e.ov=function(){var t=this;this.bulkEdit((function(){var n=t.Model;n.FormMaster=void 0,n.Analysis=!1,n.BottomView="None",n.DesignerView="None",n.QuestionId=null,n.ShowHeadBar=!0,n.SurveyResults=!1}))},e.rv=function(){var t=this;["mousedown","keydown","touchstart"].forEach((function(n){return document.addEventListener(n,t.tv,!0)}))},e.tv=function(){var t=Date.now();this.Model.LastActiveTime<t-1e3&&(this.Model.LastActiveTime=Date.now())},n}(pn.d.createObjectMasterClass("MobileDesignPageUxState",ve)),ge=e(63804),be=e(7645),we=e(40554),ye=e(23112),Ie=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,x.ZT)(n,t),n.prototype.render=function(){var t={ButtonsProps:[{ClassName:"upload-question-cancel-continue-button",ConveyDescription:!0,GlyphButtonStyle:"Horizontal",Key:"deleteItem",onClick:this.props.clickContinueButton,Text:(0,be.pm)().UploadFile_Dialog_Continue_Button,Title:(0,be.pm)().UploadFile_Dialog_Continue_Text}],ClassName:"upload-question-button-container",Description:this.props.description,FluentIcon:"Folder",IconClassName:"forms-icon-size36x36 upload-question-icon-class",ShowDialog:!0,TrapFocus:!1};return ge.createElement("div",{className:"upload-question-confirm-dialog"},(0,we.s)(t))},n}(ye.r);function Se(t){return function(t){function n(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var r=t.apply(this,n)||this;return r.initializing?r.initializing.resolve():(0,m.$U)("ResponsePage.FormMasterMixin.initializing.undefined",{formMasterAttrs:Object.keys(r),isBasicLoaded:!(!window.$||!window._)}),r}return(0,x.ZT)(n,t),n}(t)}var Ce=e(48333);var Fe=e(37890),Ne=e(41293),Te=e(62132),ke=e(62662),xe=e(41448),Pe=function(){function t(){this.uv={}}var n=t.prototype;return t.createNotificationProvider=function(n,e,r){return this.notificationProvider||(this.notificationProvider=new t),this.notificationProvider},n.close=function(t){this.uv[t]&&(this.uv[t].close(),delete this.uv[t])},n.open=function(t,n){if(!t)return Promise.reject("PushNotification has no formId.");this.close(t);var e=(0,Tn.kc)(t);return this.cv(t,n,e)},n.cv=function(t,n,e,r){return this.uv[t]=new De(xe.VY.getInstance().getCollabDBServiceUrl(),e.OrgId,e.OwnerId,e.TableId,e.IsGroupOwner,e.ContainerId,r),this.uv[t].open(n)},t}(),De=function(){function t(t,n,e,r,i,o,s){this.lv=(0,kn.GW)(),this.fv=!0,this.hv=null,this.dv=0,this.mv=Ee.MaxRetryCount;var u=t.trimEnd("/");s&&(u=Ee.ComposedCDBRealtimeSliceFormat.format(s,u)),this.vv=!1;var a=(0,nn.vj)("RealtimeAzureConnectionPercentage",0);if(a>=0&&a<=100){var c=this.pv(e+r);this.vv=Math.abs(c)%100<a}this.vv?this.gv=(i?Ee.CDBRealtimeAzureUrlForGroupsFormat:Ee.CDBRealtimeAzureUrlForUsersFormat).format(u,n,e,r):this.gv=(i?Ee.CDBRealtimeUrlForGroupsFormat:Ee.CDBRealtimeUrlForUsersFormat).format(u,n,e,r),this.bv=o}var n=t.prototype;return n.reconnect=function(){this.hv.stop(),this.hv.start()},n.close=function(){var t=this;this.fv=!0;var n=function(){4!==t.hv.state&&t.wv(Ee.UserHubName,Ee.Leave).finally((function(){t.hv.stop(!0,!0)}))};null!=this.hv&&(0===this.hv.state||2===this.hv.state?this.hv.stateChanged(n):n())},n.open=function(t){var n,e=this;return this.Iv(this.gv),(t=Cn.clone(t)).onFormUpdated&&this.Sv(Ee.TableDefinitionHubName,Ee.TableUpdated,(function(n,e){t.onFormUpdated(Re.toFormUpdatePayload(e),Re.toUserPayload(e._modifiedBy))})),t.onFormElementAdded&&this.Sv(Ee.TableDefinitionHubName,Ee.ColumnAdded,(function(n,e){"Comments"!==n.propertyName&&"ReleaseDate"!==n.propertyName&&"FormsProData"!==n.propertyName&&t.onFormElementAdded(Re.toFormElementPayload(e),Re.toUserPayload(e._modifiedBy))})),t.onFormElementDeleted&&this.Sv(Ee.TableDefinitionHubName,Ee.ColumnDeleted,(function(n,e){t.onFormElementDeleted(n.propertyName,Re.toUserPayload(e._modifiedBy))})),t.onFormElementUpdated&&this.Sv(Ee.TableDefinitionHubName,Ee.ColumnUpdated,(function(n,e){t.onFormElementUpdated(n.propertyName,Re.toFormElementUpdatePayload(e),Re.toUserPayload(e._modifiedBy))})),t.onChoiceAdded&&this.Sv(Ee.TableDefinitionHubName,Ee.ChoiceAdded,(function(n,e){t.onChoiceAdded(n.propertyName,Re.toChoicePayload(n,e),Re.toUserPayload(e._modifiedBy))})),t.onChoiceDeleted&&this.Sv(Ee.TableDefinitionHubName,Ee.ChoiceDeleted,(function(n,e){t.onChoiceDeleted(n.propertyName,n.choiceId,Re.toUserPayload(e._modifiedBy))})),t.onChoiceUpdated&&this.Sv(Ee.TableDefinitionHubName,Ee.ChoiceUpdated,(function(n,e){t.onChoiceUpdated(n.propertyName,n.choiceId,Re.toChoicePayload(n,e),Re.toUserPayload(e._modifiedBy))})),t.onResponseAdded&&this.Sv(Ee.TableDataHubName,Ee.RowAdded,(function(n,e){t.onResponseAdded(Re.toResponsePayload(e))})),t.onResponseDeleted&&this.Sv(Ee.TableDataHubName,Ee.RowDeleted,(function(n,e){t.onResponseDeleted(Number(n._id),{modifiedBy:Re.toUserPayload(e._modifiedBy),modifiedDateTime:new Date(e._modifiedBy.ModifiedDateTime)})})),t.onResponsesAllDeleted&&this.Sv(Ee.TableDataHubName,Ee.RowsAllDeleted,(function(n,e){t.onResponsesAllDeleted({modifiedBy:Re.toUserPayload(e._modifiedBy),modifiedDateTime:new Date(e._modifiedBy.ModifiedDateTime)})})),t.onResponseUpdated&&this.Sv(Ee.TableDataHubName,Ee.RowUpdated,(function(n,e){t.onResponseUpdated(Number(n._id),Re.toResponseUpdatePayload(e))})),t.onCommentAdded&&this.Sv(Ee.TableDataHubName,Ee.RelatedRecordAdded,(function(n,e,r){Re.isCommentPayload(n)&&t.onCommentAdded(Number(n.rowId),Re.toCommentPayload(r),{modifiedBy:Re.toUserPayload(e.modifiedBy),modifiedDateTime:new Date(e.modifiedDateTime)})})),t.onCommentDeleted&&this.Sv(Ee.TableDataHubName,Ee.RelatedRecordDeleted,(function(n,e,r){Re.isCommentPayload(n)&&t.onCommentDeleted(Number(n.rowId),Number(n.id),{modifiedBy:Re.toUserPayload(e.modifiedBy),modifiedDateTime:new Date(e.modifiedDateTime)})})),t.onLocaleResourceAdded&&this.Sv(Ee.TableDefinitionHubName,Ee.LocaleResourceAdded,(function(n,r){if(r){var i=r.localeResources;i.forEach((function(t){t.elementKey=e.Cv(t.elementKey)})),t.onLocaleResourceAdded(i,Re.toUserPayload(r._modifiedBy))}})),t.onLocaleResourceUpdated&&this.Sv(Ee.TableDefinitionHubName,Ee.LocaleResourceUpdated,(function(n,r){if(r){var i=Cn.clone(r);delete i._modifiedBy,i.elementKey=e.Cv(i.elementKey),t.onLocaleResourceUpdated(i,Re.toUserPayload(r._modifiedBy))}})),t.onLocaleResourceDeleted&&this.Sv(Ee.TableDefinitionHubName,Ee.LocaleResourceDeleted,(function(n,e){e&&t.onLocaleResourceDeleted(e,Re.toUserPayload(e._modifiedBy))})),t.onUserConnected&&this.Sv(Ee.UserHubName,Ee.UserConnected,(function(n,e){t.onUserConnected(Re.toUserPayload(n))})),t.onUserDisconnected&&this.Sv(Ee.UserHubName,Ee.UserDisconnected,(function(n,e){t.onUserDisconnected(Re.toUserPayload(n))})),this.Sv(Ee.TableDefinitionHubName,Ee.ForceReconnect,(function(){e.reconnect()})),this.hv.starting((function(){(0,m.$U)("DataProvider.RealtimeClient.Connection.Starting",{clientId:e.getClientId(),connectionId:e.hv.id,host:(0,Nt.Lp)(e.gv),azureSignalr:e.vv})})),this.hv.connectionSlow((function(){(0,m.$U)("DataProvider.RealtimeClient.Connection.Slow",{clientId:e.getClientId(),connectionId:e.hv.id,host:(0,Nt.Lp)(e.gv),azureSignalr:e.vv}),t.onConnectionSlow&&t.onConnectionSlow()})),this.hv.error((function(r){(0,m.$U)("DataProvider.RealtimeClient.Connection.Error",{clientId:e.getClientId(),connectionId:e.hv.id,host:(0,Nt.Lp)(e.gv),azureSignalr:e.vv,error:e.Fv(r)}),n={errorObject:r},t.onConnectionError&&t.onConnectionError(r)})),this.hv.reconnecting((function(){(0,m.$U)("DataProvider.RealtimeClient.Connection.Reconnecting",{clientId:e.getClientId(),connectionId:e.hv.id,host:(0,Nt.Lp)(e.gv),azureSignalr:e.vv}),t.onConnectionReconnecting&&t.onConnectionReconnecting()})),this.hv.reconnected((function(){(0,m.$U)("DataProvider.RealtimeClient.Connection.Reconnected",{clientId:e.getClientId(),connectionId:e.hv.id,host:(0,Nt.Lp)(e.gv),azureSignalr:e.vv}),t.onConnectionReconnected&&t.onConnectionReconnected(void 0)})),this.hv.disconnected((function(){if((0,m.$U)("DataProvider.RealtimeClient.Connection.Disconnected",{clientId:e.getClientId(),connectionId:e.hv.id,remainingRetryCount:e.mv,host:(0,Nt.Lp)(e.gv),azureSignalr:e.vv,lastError:n&&e.Fv(n.errorObject)}),e.mv-- >0){e.dv++;var r={reconnectingCount:e.dv,refreshToken:n&&n.errorObject&&n.errorObject.context&&401===n.errorObject.context.status,retryCount:Ee.MaxRetryCount-e.mv,onSuccess:t.onConnectionReconnected,onError:t.onConnectionFailed};e.Nv(r).then((function(){n=void 0})).catch((function(){}))}else(0,m.$U)("DataProvider.RealtimeClient.Connection.Failed",{clientId:e.getClientId(),connectionId:e.hv.id,lastError:n&&e.Fv(n.errorObject),host:(0,Nt.Lp)(e.gv),azureSignalr:e.vv}),t.onConnectionDisconnected&&t.onConnectionDisconnected()})),(0,ke.Au)()&&(this.hv.logging=!0,this.hv.received((function(t){var n=new Date;console.log("[%s] %s: Received message: {%s}",n.toTimeString(),e.lv,JSON.stringify(t))}))),this.fv=!1,this.Nv({onSuccess:t.onConnectionStarted,onError:t.onConnectionFailed})},n.getClientId=function(){return this.lv},n.pv=function(t){return t.split("").reduce((function(t,n){return(t<<5)-t+n.charCodeAt(0)|0}),0)},n.Cv=function(t){switch(t){case"thankyoumessage":return"thankYouMessage";case"formclosemessage":return"formCloseMessage";case"leftdescription":return"leftDescription";case"rightdescription":return"rightDescription";case"formsprortlocaleldescription":return"formsprortlocaleldescription";case"formsprortlocalerdescription":return"formsprortlocalerdescription";case"formsprocustomplaceholder":return"formsprocustomplaceholder";case"footertext":return"footerText";case"conditionalthankyoumessage":return"conditionalThankyouMessage";default:return t}},n.Iv=function(t){this.hv=$.hubConnection(t,{useDefaultPath:!1}),this.hv.createHubProxy(Ee.TableDefinitionHubName),this.hv.createHubProxy(Ee.TableDataHubName),this.hv.createHubProxy(Ee.UserHubName),this.hv.qs={},this.Tv()},n.kv=function(t){if(null==this.hv)throw Error("Realtime connection has not been created yet.");var n=this.hv.proxies[t.toLocaleLowerCase()];if(null==n)throw Error("Cannot find hub proxy {0}".format(t));return n},n.xv=function(t){var n=this;return xe.VY.getInstance().createDataProvider().getCdbToken().then((function(t){var e=t,r="Bearer ";e&&e.startsWith(r)&&(e=e.substring(r.length)),n.hv.accessToken=e}))},n.Tv=function(){this.bv&&"0"!==this.bv&&(this.hv.qs=(0,x.pi)((0,x.pi)({},this.hv.qs),{ContainerId:this.bv}))},n.wv=function(t,n){for(var e,r=this,i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];if(this.Dv()){var s=new vt.o("Connection.InvokeRemoteMethod");return s.start(),(0,Fe.Px)((e=this.kv(t)).invoke.apply(e,(0,x.ev)([n],i))).then((function(t){return s.end({resultType:"Success",extraData:{clientId:r.getClientId(),connectionId:r.hv.id,host:(0,Nt.Lp)(r.gv),azureSignalr:r.vv,methodName:n}}),t}),(function(t){return s.end({resultType:r.Dv()?"Failure":"ExpectedFailure",extraData:{clientId:r.getClientId(),connectionId:r.hv.id,host:(0,Nt.Lp)(r.gv),azureSignalr:r.vv,methodName:n,error:r.Fv(t)}}),t}))}return Promise.reject("Realtime connection has not been established yet.")},n.Dv=function(){return null!=this.hv&&1===this.hv.state},n.Sv=function(t,n,e){e&&this.kv(t).on(n,e)},n.Fv=function(t){return t&&JSON.stringify(t,["message","description","transport"])},n.Nv=function(t){var n=this;if(this.fv)return Promise.reject("Connection disposed");var e=new Promise((function(e,r){var i=new vt.o("Connection.ConnectToCDBSignalR"),o=function(){i.end({resultType:"Success",extraData:{clientId:n.getClientId(),connectionId:n.hv.id,host:(0,Nt.Lp)(n.gv),azureSignalr:n.vv,reconnectingCount:t.reconnectingCount,retryCount:t.retryCount}}),n.mv=Ee.MaxRetryCount,n.wv(Ee.UserHubName,Ee.Join),n.wv(Ee.UserHubName,Ee.GetActiveUsers).then((function(t){e(t)}),(function(t){r(t)}))},s=function(e){i.end({resultType:"Failure",extraData:{clientId:n.getClientId(),connectionId:n.hv.id,host:(0,Nt.Lp)(n.gv),azureSignalr:n.vv,reconnectingCount:t.reconnectingCount,retryCount:t.retryCount,connectionError:e.source?n.Fv(e):void 0,serviceError:e.source?void 0:JSON.stringify(e,["message","statusCode","statusText","innerCode"])}}),r(e)};i.start(),n.xv(t.refreshToken).then((function(){return n.hv.start().then(o,s)}),(function(t){s(t),(0,m.$U)("DataProvider.RealtimeClient.Connection.Failed",{clientId:n.getClientId(),connectionId:n.hv.id,host:(0,Nt.Lp)(n.gv),azureSignalr:n.vv,lastError:n.Fv(t)})}))}));return t.onSuccess&&e.then((function(n){return t.onSuccess(n)})),t.onError&&e.catch((function(n){return t.onError(n)})),e},t}(),Ee=function(){function t(){}return t.TableDefinitionHubName="TableDefinitionChangeHub",t.TableDataHubName="TableChangeHub",t.UserHubName="TableActivityHub",t.TableUpdated="tableDefinitionUpdated",t.ColumnAdded="columnDefinitionAdded",t.ColumnDeleted="columnDefinitionDeleted",t.ColumnUpdated="columnDefinitionUpdated",t.ChoiceAdded="choiceAdded",t.ChoiceUpdated="choiceUpdated",t.ChoiceDeleted="choiceDeleted",t.RowAdded="rowAdded",t.RowDeleted="rowDeleted",t.RowsAllDeleted="rowsAllDeleted",t.RowUpdated="rowUpdated",t.RelatedRecordAdded="relatedRecordAdded",t.RelatedRecordDeleted="relatedRecordDeleted",t.LocaleResourceAdded="localeResourceAdded",t.LocaleResourceUpdated="localeResourceUpdated",t.LocaleResourceDeleted="localeResourceDeleted",t.ForceReconnect="forceReconnect",t.UserConnected="userConnected",t.UserDisconnected="userDisconnected",t.GetActiveUsers="GetActiveUsers",t.Join="Join",t.Leave="Leave",t.MaxRetryCount=3,t.ComposedCDBRealtimeSliceFormat="{0}.{1}:797",t.ComposedCDBRealtimeAzureSliceFormat="{0}.{1}:779",t.CDBRealtimeUrlForUsersFormat="https://{0}/realtime/beta/{1}/users/{2}/tables/{3}/$notifications",t.CDBRealtimeUrlForGroupsFormat="https://{0}/realtime/beta/{1}/groups/{2}/tables/{3}/$notifications",t.CDBRealtimeAzureUrlForUsersFormat="https://{0}/realtimeazure/beta/{1}/users/{2}/tables/{3}/$azurenotifications",t.CDBRealtimeAzureUrlForGroupsFormat="https://{0}/realtimeazure/beta/{1}/groups/{2}/tables/{3}/$azurenotifications",t}(),Re=function(){function t(){}t.prototype;return t.toFormUpdatePayload=function(n){return n&&t.normalize({id:void 0,tableId:n.id,title:n.displayName,createdBy:n.createBy,modifiedDate:n.dateTimeLastUpdated,description:n.description,settings:n.formSettings,otherInfo:n.otherInfo,questions:void 0,header:t.toImagePayload(n.header),logo:t.toImagePayload(n.logo),background:t.toImagePayload(n.background),thankYouMessage:n.thankYouMessage,version:n.version,xlWorkbookId:n.xlWorkbookId,xlExportingTag:n.xlExportingTag,xlFileUnSynced:n.xlFileUnSynced,xlUnsyncedReason:n.xlUnsyncedReason,permissionTokens:t.toPermissionTokenPayload(n.permissionTokens),onlineSafetyLevel:n.onlineSafetyLevel,reputationTier:t.toReputationTier(n.onlineSafetyLevel),formsProRTTitle:n.formsProRTTitle,formsProRTDescription:n.formsProRTDescription})},t.toFormElementPayload=function(n){return n&&{id:n.propertyName,title:n.description||n.title||n.displayName,defaultValue:n.defaultValue,subtitle:n.subtitle,required:n.required,type:n.questionType,questionInfo:n.questionInfo,order:n.order,version:void 0,modifiedDate:n.questionModifiedDate,status:n.status,image:t.toImagePayload(n.image),isQuiz:n.isQuiz,titleHasPhishingKeywords:n.titleHasPhishingKeywords,subtitleHasPhishingKeywords:n.subtitleHasPhishingKeywords,formsProRTQuestionTitle:n.formsProRTQuestionTitle,formsProRTSubtitle:n.formsProRTSubtitle,choices:n.choices,groupId:n.columnGroupName,fileUploadSPOInfo:n.fileUploadSPOInfo&&JSON.parse(n.fileUploadSPOInfo),questionTagForIntelligence:n.questionTagForIntelligence,insightsInfo:n.insightsInfo,isFromSuggestion:n.isFromSuggestion}},t.toChoicePayload=function(n,e){return e&&t.normalize({id:n.choiceId,customProperties:e.customProperties,description:e.description,displayText:e.displayText,formsProDisplayRTText:e.formsProDisplayRTText,key:e.key,order:e.order})},t.toFormElementUpdatePayload=function(n){return t.normalize(t.toFormElementPayload(n))},t.toUserPayload=function(t){return{userId:t.Id||t.userId,displayName:t.DisplayName||t.displayName,firstName:t.FirstName||t.firstName,lastName:t.LastName||t.lastName,email:t.Email||t.email}},t.toImagePayload=function(t){return t?null==t.ResourceId||null!=t.ResourceUrl?{altText:t.AltText,contentType:t.ContentType,fileIdentifier:t.FileIdentifier,originalFileName:t.OriginalFileName,resourceId:t.ResourceId,resourceUrl:t.ResourceUrl}:void(0,m.zU)("InvalidCdbImagePayload"):t},t.toPermissionTokenPayload=function(t){return t?JSON.parse(t).map((function(t){return{principalId:t.PrincipalId,name:t.Name,type:t.Type}})):t},t.toResponsePayload=function(n){return null==n?n:{id:null==n._id?void 0:Number(n._id),startDate:n.StartDate,submitDate:n.SubmitDate,responder:n.Responder,responderName:n.ResponderName,answers:t.toAnswers(n),quizResult:void 0,releaseDate:n.ReleaseDate}},t.toAnswers=function(t){var n=Cn.difference(Object.keys(t).filter((function(t){return"_"!==t[0]})),["SubmitDate","ResponderName","Responder","StartDate","Comments_comments","Comments","ReleaseDate"]);return JSON.stringify(n.map((function(n){return{questionId:n,answer1:t[n]}})))},t.toResponseUpdatePayload=function(n){var e=t.normalize(t.toResponsePayload(n));return delete e.answers,e},t.isCommentPayload=function(t){return t&&"Comments_comments"===t.propertyName},t.toCommentPayload=function(n){return n&&{id:n.id,feedback:n.text,score:n.number,questionId:n.columnReference,createdDateTime:n.createdDateTime,createdBy:t.toUserPayload(n.createdBy)}},t.toReputationTier=function(t){return 0===t?1:80&t?4:8&t?0:2&t||16&t?3:128&t?2:1},t.normalize=function(t){var n=t;for(var e in n)void 0===n[e]&&delete n[e];return n},t}(),Le=e(73293),Ae=e(96680),qe=e(93271),Oe=e(91091);var Me=e(687),Ue=e(22810),Ve=e(81380),_e=e(82963),Ge=e(74871),Be=e(82205),ze=e(41275);e(39271);var Qe,He=e(85866),je=e(51586),$e=e(50434);!function(t){t[t.None=0]="None",t[t.MoveInProgress=1]="MoveInProgress",t[t.CvsScanAllowed=2]="CvsScanAllowed"}(Qe||(Qe={}));var We=e(69260),Je=e(64966),Ke=e(20469);var Xe=e(63797),Ye=e(22617);var Ze=e(15934),tr=e(1014),nr=e(36837);function er(){var t,n,e=vn.x;return(0,Tt.md)((function(){e=FormsPro.ProFormsMasterMixin(vn.x)})),t="exporting",n=3e5,e=Se(e=function(t){return function(t){function n(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i=t.apply(this,e)||this;return i.Ev(),i.ar(),i.Model.YouTubeMessageBarState=null,n.DesignOnlyRules.forEach((function(t){return i.addRule(t)})),(0,me.CU)(i,vn.x.Schema.Logo,vn.x.Schema.LogoInfo),i}(0,x.ZT)(n,t);var e=n.prototype;return e.isCurrentUserFormOwnerOrGroupMember=function(){return this.Rv},e.ensureReadyToDesign=function(){var t=this;return this.ensureFieldsReady((0,Ae.E3)()).then((function(n){return null==t.Rv&&t.Lv(),n}))},e.ensureReadyToAdminPhishingReview=function(){var t=(0,Ae.Co)();return t.push(this.Schema.CreatedBy),this.ensureFieldsReady(t)},e.reachedQuestionNumberLimitation=function(){return this.formElementManager.QuestionMasters.filter((function(t){return"Question.MatrixChoiceGroup"!=t.Model.Type})).length>=(0,Me.gX)()},e.searchResponseById=function(t){var n=this,e={name:"id",operator:"eq",value:t};return this.Synchronizer.existingInDataSource().then((function(){return(0,_e.aj)(n,1,0,e)})).then((function(t){return t&&t[0]}))},e.syncFormResponses=function(){var t=this;return this.responsesQueryJob&&this.responsesQueryJob.states()===Fe.Cb.Pending||(this.responsesQueryJob=new Fe.bC(this.Synchronizer.existingInDataSource().then((function(){var n=[vn.x.Schema.Questions];n.push(vn.x.Schema.Settings);var e=t.ensureFieldsReady(n);return Promise.all([(0,_e.aj)(t),e]).then((function(n){var e=n[0];n[1],t.updatingResponsesFromServer=!0,t.bulkEdit((function(){t.Model.Responses=t.normalizeResponses(e),t.Synchronizer.onSourceDataReceived({rowCount:e.length})})),t.updatingResponsesFromServer=!1}))})))),this.responsesQueryJob.promise()},e.syncFormResponsesByPaging=function(t,n){var e=this;return this.getFormResponsesByPaging(t,n).then((function(t){e.updatingResponsesFromServer=!0,e.Model.BufferResponses=t,e.updatingResponsesFromServer=!1}))},e.getFormResponsesByPaging=function(t,n){var e=this,r=[vn.x.Schema.Questions];r.push(vn.x.Schema.Settings);var i=this.ensureFieldsReady(r),o=this.Synchronizer.existingInDataSource().then((function(){return(0,_e.aj)(e,t,n)}));return Promise.all([o,i]).then((function(t){var n=t[0];return t[1],e.normalizeResponses(n)}))},e.getFormResponsesCountByAPICall=function(){var t=this;return this.Synchronizer.existingInDataSource().then((function(){return(0,Ve.rl)(t)})).then((function(n){t.Model.ResponsesCount=n}))},e.deleteAllResponses=function(){var t=this;return this.Synchronizer.existingInDataSource().then((function(){return(0,_e._n)(t)})).then((function(){var n={Responses:[],ResponsesCount:0};t.updatingResponsesFromServer=!0,t.setData(n),t.updatingResponsesFromServer=!1}))},e.deleteBufferResponse=function(t){var n=this;return this.Synchronizer.existingInDataSource().then((function(){return(0,_e.q4)(n.Model.Id,[t])})).then((function(){var e=pn.d.getCollectionMasterFromModel(n.Model.BufferResponses),r=e.getItemWithKeyFields({Id:t});r&&n.bulkEdit((function(){e.itemsDeletedInSource([r]),--n.Model.ResponsesCount}))}))},e.resetBranchInfo=function(){this.FormElementManager.AllElementMasters.forEach((function(t){return t.resetBranchInfo()}))},e.formOwnedByMe=function(){return this.Model.OwnerId&&this.Model.OwnerId===(0,c.k0)().userInfo.UserId},e.fileUploadAnonymousDisabled=function(){return!(0,ot.cr)("EnableAnonymousUploadLink")&&!!Cn.find(this.Model.Questions,(function(t){return"Question.FileUpload"===t.Type}))},e.ar=function(){var t=this;(0,Be.vG)(this),this.qv="Idle",this.Ov="Idle",this.Uv="Idle",this.fieldsReady([vn.x.Schema.Questions]).then((function(){var n=pn.d.getCollectionMasterFromModel(t.Model.Questions);(0,Be.v)(n,n.Schema[0].IntegratedSavingState,(function(n){t.qv=n,t.updateIntegratedSavingState()}))})),this.fieldsReady([vn.x.Schema.DescriptiveElements]).then((function(){var n=pn.d.getCollectionMasterFromModel(t.Model.DescriptiveElements);(0,Be.v)(n,n.Schema[0].IntegratedSavingState,(function(n){t.Uv=n,t.updateIntegratedSavingState()}))}));var n=pn.d.getCollectionMasterFromModel(this.Model.ResponseModels);(0,Be.v)(n,n.Schema[0].IntegratedSavingState,(function(n){t.Ov=n,t.updateIntegratedSavingState()})),this.updateIntegratedSavingState()},e.updateIntegratedSavingState=function(){var t=this;if(this.syncBlocker.states()===Fe.Cb.Pending)return this.Model.IntegratedSavingState="NotStarted",void this.syncBlocker.promise().then((function(){return t.updateIntegratedSavingState()}));var n=[this.Model.SavingState,this.qv,this.Ov],e=vn.x.Schema;this.isFieldReady(e.DescriptiveElements)&&n.push(this.Uv),this.isFieldReady(e.Logo)&&n.push(this.Model.Logo.SavingState),this.isFieldReady(e.Background)&&n.push(this.Model.Background.SavingState),(0,Tt.md)((function(){t.isFieldReady(e.HeaderBGImage)&&n.push(t.Model.HeaderBGImage.SavingState)})),this.Model.IntegratedSavingState=(0,Be.IM)(n)},Object.defineProperty(n,"DesignOnlyRules",{get:function(){if(!n.designOnlyRules){var t=vn.x.Schema,e=pn.d.getSubFieldSchemas(t).filter((function(t){return!pn.d.getFieldSchemaInfo(t).Attributes.IsLocalField})),r=[t.Background.SavingState,t.Logo.SavingState,t.SavingState];(0,Tt.md)((function(){r=[t.Background.SavingState,t.Logo.SavingState,t.HeaderBGImage.SavingState,t.SavingState]})),n.designOnlyRules=[{Name:"IntegrateSavingState",InterestedFields:r,onChange:function(t){return t.Master.updateIntegratedSavingState()}},{Name:"Modified",InterestedFields:Cn.without(e,t.SoftDeleted),onChange:function(n){if(!n.BeingDeleted&&!Cn.contains(n.FieldSchemas,t.Modified)){var r=n.Master;Cn.contains(n.FieldSchemas,t.ModifiedDate)?r.Model.Modified=r.Model.ModifiedDate:r.isFieldReady(t.Modified)&&Cn.intersection(n.FieldSchemas,e).map(pn.d.getFieldSchemaInfo).map((function(t){return t.Name})).some((function(t){return t in n.OldValues}))&&(r.Model.Modified=(new Date).toISOString())}}},{Name:"RowCount",InterestedFields:[t.RowCount],onChange:function(t){if(!t.BeingDeleted){var n=t.Master.Model;n.ResponsesCount=n.RowCount}}},{Name:"SerializeSettings",InterestedFields:[vn.x.Schema.Settings],onChange:function(t){if(!t.BeingDeleted){var n=t.Master.Model;n.SerializedSettings=Ge.w.serialize(n.Settings)}}},{Name:"SerializePredefinedResponses",InterestedFields:[vn.x.Schema.PredefinedResponses],onChange:function(t){if(!t.BeingDeleted){var n=t.Master.Model;n.SerializedPredefinedResponses=(0,Ae.eT)(n.PredefinedResponses)}}},{Name:"DeleteResponseModels",InterestedFields:[t.Responses],onChange:function(t){var n=t.Master,e=pn.d.getCollectionMasterFromModel(n.Model.Responses),r=[],i=[];t.SubChanges.filter((function(t){return t.Master===e})).forEach((function(t){return t.RemovedModels.forEach((function(t){var e=n.getResponseModelById(t.Id);e?r.push(e):i.push(t.Id)}))}));var o=pn.d.getCollectionMasterFromModel(n.Model.ResponseModels);n.updatingResponsesFromServer?o.itemsDeletedInSource(r):(o.deleteItems(r),(0,ze.q4)(n,i))}},{Name:"ResponsesCount",InterestedFields:[t.ResponsesCount],onChange:function(n){var e=n.Master;e.isFieldReady(t.ResponsesCount)&&-1===e.Model.ResponsesCount&&(e.Model.ResponsesCount=null)}},{Name:"ResponseModel Change",InterestedFields:[t.ResponseModels],onChange:function(t){var n=t.Master,e=pn.d.getCollectionMasterFromModel(n.Model.ResponseModels),r=pn.d.getCollectionMasterFromModel(n.Model.Responses);t.SubChanges.filter((function(t){return t.Master===e})).forEach((function(t){t.SubChanges.forEach((function(t){var n=Cn.indexOf(r.Model,t.Master.Model);n>=0&&r.markAsChanged(n)}))}))}}]}return n.designOnlyRules},enumerable:!1,configurable:!0}),e.Ev=function(){this.isFieldReady(vn.x.Schema.RowCount)&&(this.Model.ResponsesCount=this.Model.RowCount)},e.Lv=function(){var t=this;this.Rv=this.Model.Permissions&&this.Model.Permissions.length<=1||!this.isGroupForm&&this.formOwnedByMe(),this.isGroupForm&&!this.Rv&&(0,Ue.o6)(this.Model.OwnerId).then((function(n){t.Rv=n.value.length>0}))},n}(t)}(e=function(t){return function(t){function n(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(this,n)||this}(0,x.ZT)(n,t);var e=n.prototype;return e.createLocale=function(t,n){var e={localeId:t,localeName:n};pn.d.Collection.addItems(this.Model.LocaleList,[e]),(0,Oe.an)(e,this)},e.deleteLocale=function(t){var n=pn.d.Collection.getItemWithKeyFields(this.Model.LocaleList,{localeId:t});n&&(pn.d.Collection.deleteItems(this.Model.LocaleList,[n]),(0,Oe.tc)(t,this))},e.getAllLocaleResources=function(){return(0,Ve.o7)(this.Model.Id).getAllLocaleResources(this.Model.Id).then((function(t){return(0,Oe.n$)(t)}))},n}(t)}(e=function(t){return function(t){function n(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(this,n)||this}(0,x.ZT)(n,t);var e=n.prototype;return e.setResponseComment=function(t,n){var e=this.Vv(t);e&&(e.Model.Feedback=n,this._v(e.Model))},e.setAnswerGrading=function(t,n,e,r){var i=this.Vv(t);i&&(i.setAnswerGrading(n,e,r),this._v(i.Model))},e.setReleaseDate=function(t,n){var e=this.Vv(t);e&&(e.Model.ReleaseDate=n,this._v(e.Model))},e.Vv=function(t){var n=this,e=this.getResponseModelById(t);if(!e){var r=this.Model.Responses,i=Cn.findIndex(r,(function(n){return n.Id===t}));if(i<0)return!1;this.bulkEdit((function(){e=pn.d.Collection.itemsAddedInSource(n.Model.ResponseModels,[r[i]])[0],r[i]=e}))}return(0,ze._p)(e)},e._v=function(t){if((0,ut.GF)()&&(0,ut.CE)()&&this.IsAssignmentForm&&(0,ot.cr)("AssignmentsIFrameLimitParentHeaders")){var n=Cn.reduce(t.Answers,(function(t,n){return t+(n.Score||0)}),0);(0,ot.cr)("FixEslintTeamsPostMessageError")?window.parent.postMessage({eventName:"FormGradingChangePerformed",responseId:t.Id,responder:t.Responder,responseScore:n,feedback:t.Feedback,isReturned:"0001-01-01T00:00:00Z"!==t.ReleaseDateAsString},"https://assignments.onenote.com"):window.parent.postMessage({eventName:"FormGradingChangePerformed",responseId:t.Id,responder:t.Responder,responseScore:n,feedback:t.Feedback,isReturned:"0001-01-01T00:00:00Z"!==t.ReleaseDateAsString},"*")}},n}(t)}(e=function(t){return function(t){function n(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(this,n)||this}(0,x.ZT)(n,t);var e=n.prototype;return e.triggerShareAction=function(){if(!this.Gv&&(0,c.k0)().userInfo.IsMsa&&0==(this.Model.Flags&Qe.CvsScanAllowed)){this.Gv=!0,xe.VY.getInstance().createDataProvider().postFormShareAction(this.Model.Id);var t=JSON.parse(this.Model.OtherInfo);t&&t.hasOwnProperty("TemplateId")&&(0,m.$U)("MyTemplate.PostShare",{TemplateTitle:t.TemplateId},null,!0)}},e.appendPermission=function(t){for(var n=this.Model.Permissions,e=function(e){if("OrgLink"===n[e].Type||"Link"===n[e].Type||"ShareToPeople"===n[e].Type){var r=n[e],i=(0,Je.pg)(r),o=i.Model.Type;return i.Model.Type=t,{value:i.Synchronizer.flush().then((function(){return r.PrincipalId})).catch((function(t){throw i.Model.Type=o,t}))}}},r=0;r<n.length;r++){var i=e(r);if("object"==typeof i)return i.value}var o=pn.d.Collection.addItems(n,[(0,Je.yN)(t)]),s=(0,Je.pg)(o[0]);return s.Synchronizer.existingInDataSource().then((function(){return s.Model.PrincipalId}))},e.appendSpecificPeoplePermissions=function(t){var n=this.Model.Permissions,e=pn.d.Collection.addItems(n,t).map(Je.pg).map((function(t){return t.Synchronizer.existingInDataSource().catch((function(e){var r=Cn.find(n,(function(n){return n.PrincipalId===t.Model.PrincipalId}));throw pn.d.Collection.deleteItems(n,[r]),e}))}));return Promise.all(e).then((function(){}))},e.removeLinkPermission=function(){var t=this.Bv();return this.removePermissions(t)},e.removePermissions=function(t){pn.d.Collection.deleteItems(this.Model.Permissions,t);var n=t.map(Je.pg).map((function(t){return t.Synchronizer.deletedFromDataSource()}));return Promise.all(n).then((function(){}))},e.canEditPermissionTokenByCoauthor=function(){return!Cn.some(this.Model.Permissions,(function(t){return"ShareToPeople"===t.Type}))},e.getPermissionToken=function(){var t=this;return this.Synchronizer.existingInDataSource().then((function(){var n=t.Bv().map(Je.pg);return 0!==n.length?n[0].Synchronizer.existingInDataSource().then((function(){return n[0].Model.PrincipalId})):null}))},e.refreshPermissions=function(){var t=this;return new Promise((function(n,e){return t.Synchronizer.query([vn.x.Schema.Permissions]).then(n,e)}))},e.getUserOrGroupPermissions=function(){return Cn.filter(this.Model.Permissions,(function(t){return"Failed"!==t.SavingState&&("User"===t.Type||"Group"===t.Type)}))},e.refreshResponderPermissions=function(){var t=this;return new Promise((function(n,e){return t.Synchronizer.query([vn.x.Schema.ResponderPermissions]).then(n,e)}))},e.appendResponderPermissionLink=function(){var t=this.Model.ResponderPermissions,n=pn.d.Collection.addItems(t,[(0,Ke.kF)("SpecificResponder")]),e=(0,Ke.cp)(n[0]);return e.Synchronizer.existingInDataSource().then((function(){return e.Model.PrincipalId}))},e.appendSpecificResponderPermissions=function(t){var n=this.Model.ResponderPermissions,e=pn.d.Collection.addItems(n,t).map(Ke.cp).map((function(t){return t.Synchronizer.existingInDataSource().catch((function(e){var r=Cn.find(n,(function(n){return n.PrincipalId===t.Model.PrincipalId}));throw pn.d.Collection.deleteItems(n,[r]),e}))}));return Promise.all(e).then((function(){}))},e.getUserOrGroupPermissionsInResponder=function(){return Cn.filter(this.Model.ResponderPermissions,(function(t){return"Failed"!==t.SavingState&&("User"===t.Type||"Group"===t.Type)}))},e.getResponderPersonas=function(){var t=this.getUserOrGroupPermissionsInResponder();return t=Cn.filter(t,(function(t){return(0,Ke.cp)(t).isFieldReady(Ke.Qq.Schema.PrincipalName)})),Cn.map(t,(function(t){return{id:t.PrincipalId,optionalText:t.Type,primaryText:t.PrincipalName,secondaryText:t.PrincipalEmailAddress}}))},e.getResponderEmailList=function(){if(2!==this.getResponseCollectionType())return Promise.resolve(null);var t=pn.d.convertToArray(this.getUserOrGroupPermissionsInResponder()).map((function(t){return(0,We.Kw)("User"===t.Type?"User":"Group",t.PrincipalId)}));return Promise.all(t).then((function(t){return encodeURIComponent(t.filter((function(t){return t.Mail})).map((function(t){return t.Mail})).join(";"))})).catch((function(){return null}))},e.removeResponderPermissionLink=function(){var t=this,n=this.zv();return this.removeResponderPermissions(n).then((function(){return t.refreshResponderPermissions()}))},e.removeResponderPermissions=function(t){pn.d.Collection.deleteItems(this.Model.ResponderPermissions,t);var n=t.map(Ke.cp).map((function(t){return t.Synchronizer.deletedFromDataSource()}));return Promise.all(n).then((function(){}))},e.getResponseCollectionType=function(){var t=this.SettingMaster.Model,n=(0,Pn.f5)().Model.FormsTenantSettings,e=t.IsAnonymous,r=n&&!n.externalSendForm,i=0;if((!e||r)&&this.isFieldReady(vn.x.Schema.ResponderPermissions)){var o=this.Model.ResponderPermissions;i=Cn.find(o,(function(t){return"SpecificResponder"===t.Type}))?2:1}return i},e.zv=function(){return Cn.filter(this.Model.ResponderPermissions,(function(t){return"SpecificResponder"===t.Type}))},e.Bv=function(){return Cn.filter(this.Model.Permissions,(function(t){return"Link"===t.Type||"OrgLink"===t.Type||"ShareToPeople"===t.Type}))},n}(t)}(e=function(t){return function(t){function n(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var r=t.apply(this,n)||this;r.Qv=!1;var i=r.Synchronizer;return i.observe((function(t){var n=i.Model.UpdateError;n&&r.Hv(n)}),[i.Schema.UpdateError]),r}(0,x.ZT)(n,t);var e=n.prototype;return e.duplicateForm=function(t,n){var e=this;return this.ensureFieldsReady((0,Ae.DV)()).then((function(){var r=Cn.clone(e.getSnapshotToCopy());return r.OwnerId=t.OwnerId,r.OwnerTenantId=t.OwnerTenantId,r.Title=n,r.Settings=Cn.clone(r.Settings),r.Settings.AllowCopy=!1,r.Settings.ShareToken=null,(0,je.jg)(r,t.IsGroupForm)}))},e.ensureCreationDone=function(){var t=this,n=this.getImageMaster(vn.x.Schema.Background),e=this.getImageMaster(vn.x.Schema.Logo),r=this.getImageMaster(vn.x.Schema.HeaderBGImage),i=(0,x.ev)([n.Synchronizer.flush(),e.Synchronizer.flush().then((function(){return t.Synchronizer.flush()}))],this.formElementManager.AllElementMasters.map((function(t){return t.ensureCreationDone()})));return(0,Tt.md)((function(){i=(0,x.ev)([n.Synchronizer.flush(),r.Synchronizer.flush(),e.Synchronizer.flush().then((function(){return t.Synchronizer.flush()}))],t.formElementManager.AllElementMasters.map((function(t){return t.ensureCreationDone()})))})),Promise.all(i).then((function(){}))},e.ensureReadyForMruCard=function(){var t=vn.x.Schema;return this.ensureFieldsReady([t.Title,t.ModifiedDate,t.Settings,t.XlWorkbookId,t.OwnerId,t.OwnerTenantId,t.Category,t.OtherInfo,t.Theme,t.RowCount,t.SoftDeleted])},e.moveToRecycleBin=function(){var t=this;return this.bulkEdit((function(){t.Model.MovingToRecycleBin=!0,t.Model.SoftDeleted=He.d.SoftDeleted})),this.Synchronizer.flush().then((function(){t.Model.MovingToRecycleBin=!1}))},e.jv=function(t){var n=this;this.Model.MovingToRecycleBin&&this.isSoftDeleted()&&(0,un.xP)(t)&&(6102===t.innerCode||6100===t.innerCode)&&this.bulkEdit((function(){return n.Model.SoftDeleted=He.d.Normal}))},e.isNotSoftDeleted=function(){return!this.isFieldReady(this.Schema.SoftDeleted)||this.Model.SoftDeleted===He.d.Normal},e.isSoftDeleted=function(){return!!this.isFieldReady(this.Schema.SoftDeleted)&&this.Model.SoftDeleted===He.d.SoftDeleted},e.getQuestionError=function(){return(0,$e.KR)(this)},Object.defineProperty(e,"IsSharedForm",{get:function(){return this.Qv},set:function(t){this.Qv=t},enumerable:!1,configurable:!0}),e.Hv=function(t){this.jv(t)},n}(t)}(e=function(t){return function(t){function n(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var r=t.apply(this,n)||this;return r.$v=[],r.Wv=Promise.resolve(),r}(0,x.ZT)(n,t);var e=n.prototype;return e.startReceivingNotifications=function(){var t=this,n=vn.x.Schema;return this.Model.RtcStatus=1,this.ensureFieldsReady([n.Id,n.OwnerId,n.OwnerTenantId,n.TableId]).then((function(){2!=t.Model.RtcStatus&&t.Kv()}))},e.stopReceivingNotifications=function(){var t=this;this.existingOnServerSide().then((function(){Pe.createNotificationProvider(t.DataProviderType,t.Model.OwnerTenantId,t.Model.OwnerId).close(t.Model.Id),t.Model.RtcStatus=3,t.responsesQueryJob=null,(0,Te.E)().removeAllUsers()}))},e.refreshFormResponsesCount=function(){var t=this;return this.Synchronizer.query([vn.x.Schema.ResponsesCount]).then((function(){t.Model.LastSyncTime=Date.now()}))},e.Xv=function(t,n){if(Te.j.isValidUser(n)){var e=this.getElementById(t);e&&e.updateCoAuthors(n)}},e.Kv=function(){var t=this,n=Pe.createNotificationProvider(this.DataProviderType,this.Model.OwnerTenantId,this.Model.OwnerId),e=0,r=Promise.resolve(),i=function(){var n=++e;r.then((function(){n===e&&(r=t.refreshFormResponsesCount())}))},o=(0,nn.vj)("GetAggregateInterval",2e4),s=!1,u=function(){s||(s=!0,window.setTimeout((function(){s=!1,t.refreshFormResponsesCount()}),o))},a=function(){t.Synchronizer.query((0,Ae.E3)())},c=(0,g.M5)(),l={onConnectionStarted:function(n){t.Yv(n),n&&n.length>1&&a(),t.Model.RtcStatus=2,t.Model.LastSyncTime=Date.now()},onConnectionFailed:function(n){t.Model.LastSyncTime=Date.now()},onConnectionReconnected:function(n){t.Yv(n),n&&n.length>1&&a(),t.Model.LastSyncTime=Date.now()},onConnectionDisconnected:function(){t.Model.RtcStatus=3,t.Model.LastSyncTime=Date.now()},onResponseAdded:function(n){t.bulkEdit((function(){t.Model.Settings.IsQuizMode?u():i()}))},onResponseDeleted:function(n){t.bulkEdit((function(){t.Model.Settings.IsQuizMode?u():i()}))},onResponsesAllDeleted:function(){t.bulkEdit((function(){t.Model.Settings.IsQuizMode?u():i()}))},onFormElementAdded:c?null:function(n,e){var r=t.getElementById(n.id);if(r instanceof(0,Pn.zE)()){var i=n;i.choices||(i.choices=[]),r.Synchronizer.onSourceDataReceived(n)}else r instanceof Le.Jv?r.Synchronizer.onSourceDataReceived(n):t.Wv=(0,Fe.Bx)(t.Wv.then((function(){fe.H.isDescriptiveElement(n.type)?pn.d.Collection.itemsAddedInSource(t.Model.DescriptiveElements,[pn.d.convertFromSourceData(n,Le.Jv.Schema)]):pn.d.Collection.itemsAddedInSource(t.Model.Questions,[pn.d.convertFromSourceData(n,(0,Pn.zE)().Schema)])})));t.Xv(n.id,e),t.Yv([e])},onFormElementDeleted:c?null:function(n,e){t.Wv=(0,Fe.Bx)(t.Wv.then((function(){var e=t.getElementById(n);if(e instanceof he.MF){var r=e.SubQuestionMasters.concat(e);pn.d.Collection.itemsDeletedInSource(t.Model.Questions,r.map((function(t){return t.Model})))}else e instanceof Le.Jv&&pn.d.Collection.itemsDeletedInSource(t.Model.DescriptiveElements,[e.Model])}))),t.Yv([e])},onFormElementUpdated:c?null:function(n,e,r){var i=t.getElementById(n);i&&((i instanceof he.MF||i instanceof Le.Jv)&&i.Synchronizer.onSourceDataReceived(e),t.Xv(n,r),t.Yv([r]))},onChoiceAdded:c?null:function(n,e,r){var i=t.getQuestionById(n);if(i){var o;if(e.key){if(!i.getChoiceByKey(e.key)){var s=pn.d.convertFromSourceData(e,qe.r.Schema);pn.d.Collection.itemsAddedInSource(i.Model.ChoiceGroup,[s])}o=Promise.resolve()}else{var u=Cn.map(i.Model.ChoiceGroup,(function(t){return pn.d.getObjectMasterFromModel(t).Synchronizer.existingInDataSource()}));o=Promise.all(u).then((function(){if(!i.getChoiceById(e.id)&&-1===pn.d.Collection.getIndexWithKeyFields(i.Model.ChoiceGroup,{Id:e.id})){var t=pn.d.convertFromSourceData(e,qe.r.Schema);pn.d.Collection.itemsAddedInSource(i.Model.ChoiceGroup,[t])}}))}o.then((function(){t.Xv(n,r),t.Yv([r])}))}},onChoiceDeleted:c?null:function(n,e,r){var i=t.getQuestionById(n);if(i){var o=i.getChoiceById(e);o&&(o.Synchronizer.onDeletedInDataSource(),t.Yv([r]))}},onChoiceUpdated:c?null:function(n,e,r,i){var o=t.getQuestionById(n);if(o){var s=o.getChoiceById(e);s&&(s.Synchronizer.onSourceDataReceived(r),t.Xv(n,i),t.Yv([i]))}},onUserConnected:c?null:function(n){t.Yv([n])},onUserDisconnected:c?null:function(n){t.Zv([n])},onFormUpdated:function(n,e){var r=Cn.map(t.Model.PermissionTokens,(function(t){return pn.d.getObjectMasterFromModel(t).Synchronizer.existingInDataSource()}));Promise.all(r).then((function(){t.Synchronizer.onSourceDataReceived(n),t.Yv([e])}))},onLocaleResourceAdded:c?null:function(n,e){t.bulkEdit((function(){Cn.forEach(n,(function(n){if("localename"===n.elementKey){var e={localeId:n.locale,localeName:n.elementValue};-1===pn.d.Collection.getIndexWithKeyFields(t.Model.LocaleList,{localeId:e.localeId})&&(pn.d.Collection.itemsAddedInSource(t.Model.LocaleList,[e]),(0,Oe.an)(e,t))}else t.tp(n)})),e&&t.Yv([e])}))},onLocaleResourceUpdated:c?null:function(n,e){var r=pn.d.Collection.getItemWithKeyFields(t.Model.LocaleList,{localeId:n.locale});if(r){if("localename"===n.elementKey){var i={localeName:n.elementValue};pn.d.getObjectMasterFromModel(r).Synchronizer.onSourceDataReceived(i);var o=pn.d.Collection.getItemWithKeyFields(t.Model.LocalizedResources,{localeId:n.locale});o&&pn.d.getObjectMasterFromModel(o).Synchronizer.onSourceDataReceived(i)}else t.tp(n);e&&t.Yv([e])}},onLocaleResourceDeleted:c?null:function(n,e){if(n.hasOwnProperty("locale")){var r=n.locale,i=pn.d.Collection.getItemWithKeyFields(t.Model.LocaleList,{localeId:r});i&&pn.d.Collection.itemsDeletedInSource(t.Model.LocaleList,[i])}else if(n.hasOwnProperty("propertyName")){var o=n.propertyName;Cn.forEach(t.Model.LocalizedResources,(function(t){var n=pn.d.Collection.getItemWithKeyFields(t.questionResources,{questionId:o});n&&pn.d.getObjectMasterFromModel(n).Synchronizer.onDeletedInDataSource()}))}else(0,Ne._y)("Not supposed to happen.");e&&t.Yv([e])}};n.open(this.Model.Id,l)},e.tp=function(t){if(t.elementKey.startsWith("choiceid_")){var n=Cn.find(this.Model.LocalizedResources,(function(n){return n.localeId==t.locale}));if(n){var e=Cn.find(n.questionResources,(function(n){return n.questionId==t.propertyName}));if(e){var r=pn.d.getObjectMasterFromModel(e),i=t.elementKey.substring("choiceid_".length),o=r.getChoiceLocalizedMaster(i),s={choiceId:i,description:t.elementValue,key:o.Model.key};o.Synchronizer.onSourceDataReceived(s)}}}else switch(t.elementKey){case"title":case"subtitle":case"formsprortlocaletitle":case"formsprortlocalesubtitle":"_id"===t.propertyName?this.np(t.locale,t.elementKey,t.elementValue):this.ep(t.locale,t.propertyName,t.elementKey,t.elementValue);break;case"thankYouMessage":case"formCloseMessage":case"footerText":case"conditionalThankyouMessage":"_id"===t.propertyName?this.np(t.locale,t.elementKey,t.elementValue):(0,Ne._y)("Not supposed to happen. Should be form level property.");break;case"leftDescription":case"rightDescription":case"formsprortlocaleldescription":case"formsprortlocalerdescription":case"formsprocustomplaceholder":case"option":"_id"===t.propertyName?(0,Ne._y)("Not supposed to happen. Should be question level property."):this.ep(t.locale,t.propertyName,t.elementKey,t.elementValue);break;default:(0,Ne._y)("Not supposed to happen. Unknown element key")}},Object.defineProperty(e,"DataProviderType",{get:function(){return this.isGroupForm?3:2},enumerable:!1,configurable:!0}),e.np=function(t,n,e){var r=Cn.find(this.Model.LocalizedResources,(function(n){return n.localeId==t}));if(r){var i=pn.d.getObjectMasterFromModel(r),o={localeId:t};o[n]=e,i.Synchronizer.onSourceDataReceived(o)}},e.ep=function(t,n,e,r){var i=Cn.find(this.Model.LocalizedResources,(function(n){return n.localeId==t}));if(i){var o=Cn.find(i.questionResources,(function(t){return t.questionId==n}));if(o){var s=pn.d.getObjectMasterFromModel(o),u={localeId:t};u[e]=r,s.Synchronizer.onSourceDataReceived(u)}}},e.getQuestionSyncBlocker=function(t){return this.$v.push((0,Fe.Bx)(t)),this.Wv},e.existingOnServerSide=function(){return this.Synchronizer.existingInDataSource()},e.Yv=function(t){var n=this;t&&t.length>0&&t.forEach((function(t){(0,Te.E)().addOrUpdateUser(t),n.Model.CoAuthors=null}))},e.Zv=function(t){var n=this;t.length>0&&t.forEach((function(t){(0,Te.E)().removeUser(t),n.Model.CoAuthors=null}))},n}(t)}(e=function(e){function r(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=e.apply(this,t)||this;return r.observe((function(){r.ensureFieldsReady([vn.x.Schema.XlExportingTag]).then((function(){return r.Model.XlExportingLocalTag=r.Model.XlExportingTag.toLocaleLowerCase()}))}),[vn.x.Schema.XlExportingTag]),r}(0,x.ZT)(r,e);var i=r.prototype;return i.downloadExcelFile=function(t,n){return(0,Ve.lb)(this,t,n)},i.SetToExporting=function(){var n=this;this.ensureFieldsReady([vn.x.Schema.XlExportingLocalTag]).then((function(){n.Model.XlExportingLocalTag=t}))},i.IsExporting=function(){var e,r=this,i=0;if(this.isFieldReady(vn.x.Schema.XlExportingLocalTag)&&this.Model.XlExportingLocalTag&&this.Model.XlExportingLocalTag.indexOf(t)>=0)try{var o=JSON.parse(this.Model.XlExportingLocalTag),s=Date.parse(o.starttime.toUpperCase());e=(i=(new Date).getTime()-s)<n}catch(t){e=!0}else e=!1;return e?this.rp=this.rp||window.setTimeout((function(){r.Model.XlExportingLocalTag="timeout"}),n-i):window.clearTimeout(this.rp),e},i.IsExportingFailed=function(){return this.Model.XlExportingLocalTag.toLocaleLowerCase().indexOf("failed")>=0},r}(e))))))))}function rr(){return Se(function(t){function n(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var r=t.apply(this,n)||this,i=r.originalInitialData;return r.duplicatingImage&&r.Synchronizer.existingInDataSource().then((function(){return r.op(i)})),r}(0,x.ZT)(n,t);var e=n.prototype;return e.addImage=function(t){var n,e,r=this,i=new vt.o("Image.Add");if(i.start(),t.File)e="File",n=function(){return r.sp(t.File,(0,Me.vM)(),(0,Me.HJ)())};else{if(!t.FromUrl)throw Error("Invalid picked image result.");e="FromUrl",n=function(){return r.up(t.FromUrl.Url,t.FromUrl.Size,t.FromUrl.Width,t.FromUrl.Height)}}return this.Model.ImageProcessingStatus=de.nv.Picking,this.Synchronizer.existingInDataSource().then(n).then((function(){r.Model.AltText=null,i.end({resultType:"Success",extraData:{imageSource:e}})})).catch((function(){i.end({resultType:"Failure",extraData:{imageSource:e}})}))},e.getImageErrorMessage=function(){switch(this.Model.ErrorType){case de.dL.NoError:return null;case de.dL.SizeTooLarge:return(0,be.pm)().Error_Message_5208;case de.dL.InvalidType:return(0,be.pm)().Error_Message_5209;case de.dL.BrokenImage:return(0,be.pm)().ImagePicker_Broken_Image;case de.dL.ServerError:return this.ap();case de.dL.DeleteFailError:return(0,be.pm)().Image_Delete_Fail}},e.clear=function(){var t=this,n=this.Model;return n.ResourceUrl?n.IsPredefined?(this.setData({AltText:null,ContentType:null,FileIdentifier:null,OriginalFileName:null,ResourceId:null,ResourceUrl:null,IsPredefined:!1,UploadParameters:null,ErrorType:de.dL.NoError,ResponseError:null,ImageProcessingStatus:de.nv.Idle,Width:null,Height:null}),Promise.resolve()):(this.bulkEdit((function(){n.ImageProcessingStatus=de.nv.Deleting,n.UploadParameters={Delete:!0}})),this.lp((function(){return t.setData((0,de.w9)())}))):Promise.resolve()},e.updateSettings=function(t,n){this.getSettingsMaster()&&this.getSettingsMaster().updateWith(this.Model,t,n)},e.op=function(t){var n=this;if(this.Model.ResourceUrl){var e=t.AltText,r=this.getSettingsMaster(),i={};r&&(i=Cn.clone(r.getSnapshot())),this.Synchronizer.existingInDataSource().then((function(){return n.up(t.ResourceUrl,0,i?i.NaturalWidth:(0,Me.vM)(),i?i.NaturalHeight:(0,Me.HJ)())})).then((function(){n.Model.AltText=e,r&&(delete i.NaturalHeight,delete i.NaturalWidth,r.setData(i))}))}},e.up=function(t,n,e,r){var i=this;(0,m.$U)("DesignPage.ImageLayout.ImageSize",{width:e,height:r});var o=this.Model;return this.bulkEdit((function(){var s=(0,de.bN)(e,r,800,600);return o.ErrorType=i.dp(n),o.ErrorType!==de.dL.NoError?(o.ImageProcessingStatus=de.nv.Idle,Promise.reject(o.ErrorType)):(i.resetStatus(de.nv.Picking),o.UploadParameters={Url:t,Size:n},i.lp(void 0,s.width,s.height))}))},e.sp=function(t,n,e){var r=this,i=this.Model;return this.bulkEdit((function(){var n=r.dp(t.size,t.type);return n===de.dL.NoError?(r.resetStatus(de.nv.Uploading),i.UploadParameters={ImageFile:t},r.lp()):(i.ErrorType=n,i.ImageProcessingStatus=de.nv.Idle,Promise.reject(i.ErrorType))}))},e.lp=function(t,n,e){var r=this;return this.Synchronizer.flush().finally((function(){return r.Model.ImageProcessingStatus=de.nv.Idle})).catch((function(){})).then(t).then((function(){return r.updateSettings(n,e)})).catch((function(t){r.vp()}))},e.ap=function(){var t=this.Model,n=t.ResponseError&&t.ResponseError.innerCode;return(0,Ye.D)(""+n)||(0,be.pm)().Image_Upload_Fail},e.dp=function(t,n,e,r){var i=de.dL.NoError;return t>(0,Me.yi)()&&(i=de.dL.SizeTooLarge),n&&$.inArray(n,(0,Xe.un)())<0&&(i=de.dL.InvalidType),i},e.vp=function(){this.setData((0,de.w9)(),pn.d.getSubFieldSchemas(de.Xf.Schema)),this.updateSettings()},n}(de.Xf))}function ir(){return Se(function(t){function n(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i=t.apply(this,e)||this;return(0,Be.vG)(i),i.updateIntegratedSavingState(),n.DesignOnlyRules.forEach((function(t){return i.addRule(t)})),i}(0,x.ZT)(n,t);var e=n.prototype;return Object.defineProperty(n,"DesignOnlyRules",{get:function(){if(!n.designOnlyRules){var t=he.MF.Schema;n.designOnlyRules=[{Name:"block id changes",InterestedFields:[t.Id],onChange:function(t){var n,e=t.Master.Model,r=e.Id,i=t.OldValues.Id;e.Id=i;try{throw Error("Changing question id")}catch(t){n=t}(0,m.zU)("UpdatingQuestionId",{newId:r,oldId:i,stack:n.stack})}},{Name:"update CombinedTitle",InterestedFields:[t.Title,t.IsMathQuiz,t.Subtitle],onChange:function(t){return(0,nr.k)(t.Master.Model)}},{Name:"update Title",InterestedFields:[t.CombinedTitle],onChange:function(t){return(0,nr.S)(t.Master.Model)}},{Name:"IntegrateSavingState",InterestedFields:[t.ImageInfo.SavingState,t.SavingState],onChange:function(t){return t.Master.updateIntegratedSavingState()}},{Name:"IsQuiz",InterestedFields:[t.IsQuiz],onChange:function(t){var n=t.Master.Model;n.IsQuiz||(n.IsMathQuiz=null,pn.d.convertToArray(n.Choices).forEach((function(t){t.IsAnswerKey=null})))}},{Name:"IsMathQuiz",InterestedFields:[t.IsMathQuiz],onChange:function(t){var n=t.Master.Model;n.IsMathQuiz||(n.IsMathQuiz=null,n.IsPlainTextInMathField=null,n.IsMathInputDefault=null,n.InputSwitcherDisabled=null,n.LastMathMLFormula=null,n.MathAriaLabels=null,n.MathTemplateID=null)}},{Name:"NumberValidationRule",InterestedFields:[t.IsNumber],onChange:function(t){var n=t.Master.Model;n.IsNumber?null==n.NumberValidationRule&&(n.NumberValidationRule=he.pW.None):(n.NumberValidationRule=null,(0,Tt.md)((function(){n.FormsProValidationType=null})))}},{Name:"JustifyNumberBoundaries",InterestedFields:[t.NumberValidationRule],onChange:function(t){return t.Master.justifyNumberBoundaries()}}]}return n.designOnlyRules},enumerable:!1,configurable:!0}),e.ensureCreationDone=function(){var t=this;return this.ImageInfoMaster.Synchronizer.flush().then((function(){return t.Synchronizer.flush()}))},e.setVideoUrl=function(t,n){var e=this.Model.VideoInfo;pn.d.getObjectMasterFromModel(e).bulkEdit((function(){e.Url=(0,tr.Qn)(t,(0,ft.k)()),e.Title="",e.Author="",e.Thumbnail_url="",e.OriginalWidth=459,e.OriginalHeight=256,e.ShowWarningBar=n&&(0,Ze.M4)(t)}))},e.clearVideoInfo=function(){this.Model.VideoInfo={}},e.addSubQuestion=function(t){t.GroupId=this.Model.Id,t.Required=this.Model.Required,this.Form.FormElementManager.insertElementAfter(t,this)},e.deleteSubQuestion=function(t){this.Form.getQuestionById(t).Deleted=!0},e.updateCoAuthors=function(t){var n=this,e=pn.d.getCollectionMasterFromModel(this.Model.CoAuthors),r=Cn.filter(this.Model.CoAuthors,(function(n){return t.userId===n.userId}))[0],i=function(){r&&e.deleteItems([r]),t.userId in n.coAuthorTimers&&(clearTimeout(n.coAuthorTimers[t.userId]),delete n.coAuthorTimers[t.userId])};e.bulkEdit((function(){i(),r=pn.d.Collection.addItems(n.Model.CoAuthors,[t])[0]})),this.coAuthorTimers[t.userId]=window.setTimeout(i,1e4)},e.hasSectionBranching=function(){var t=this.Model;return Cn.map(t.Choices,(function(t){return t.BranchInfo})).concat([t.BranchInfo,t.BranchInfoForOtherChoice]).map(pn.d.getObjectMasterFromModel).some((function(t){return t.hasSectionBranching()}))},e.needObserveSettings=function(){return"Question.FileUpload"===this.Model.Type},e.getErrorMessage=function(){var t=this,n=this.Model.FileUploadSPOInfo;return(0,Tt.md)((function(){(0,ot.cr)("CustomerVoiceCDSFileUpload")&&t.Form.isFieldReady(vn.x.Schema.FileUploadStorage)&&"cds"===t.Form.Model.FileUploadStorage&&(n=null)})),this.Synchronizer.Model.CreationError?this.getCreationError():(null==n?void 0:n.errorCode)?(0,$e.nX)(n.errorCode):(null==n?void 0:n.linkInfo)?(0,$e.uV)(Number(n.linkInfo),!1):(null==n?void 0:n.anonymousLinkInfo)&&this.Form.SettingMaster.Model.IsAnonymous?(0,$e.uV)(Number(n.anonymousLinkInfo),!0):void 0},e.getCreationError=function(){var t,n=null===(t=this.Synchronizer.Model)||void 0===t?void 0:t.CreationError,e=null==n?void 0:n.innerMessage,r=null==n?void 0:n.innerCode;if("6614"==r){var i=e.match(/disableReason:([-0-9]*);/);if(i){var o=Number(i[1]);return(0,$e.uV)(o,!1)}}else if(r)return(0,$e.nX)(r);return null},e.updateIntegratedSavingState=function(){this.isFieldReady(he.MF.Schema.ImageInfo)?this.Model.IntegratedSavingState=(0,Be.IM)([this.Model.ImageInfo.SavingState,this.Model.SavingState]):this.Model.IntegratedSavingState=this.Model.SavingState},n}(he.MF))}function or(){return function(t){function n(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(this,n)||this}(0,x.ZT)(n,t);var e=n.prototype;return e.appendElement=function(t,n){var e=this,r=[];t.Id||((t=Cn.clone(t)).Id=this.pp());var i=this.getAllElements(),o=i.length>0?i[i.length-1].Order:fe.H.QuestionOrderFloor;if(t.Order=o+fe.H.QuestionOrderDefaultStep,n&&(r=n.map((function(n,r){return(n=Cn.clone(n)).Id=e.pp(),n.GroupId=t.Id,n.Order=t.Order+(r+1)*fe.H.QuestionOrderDefaultStep,n}))),fe.H.isDescriptiveElement(t.Type)){var s=pn.d.Collection.addItems(this.formMaster.Model.DescriptiveElements,[t]);return(0,Le.PQ)(s[0])}var u=[t];return u=u.concat(r),s=pn.d.Collection.addItems(this.formMaster.Model.Questions,u),(0,he.vV)(s[0])},e.duplicateElement=function(t){var n=t.getSnapshotWithoutBranchInfo();delete n.Id;var e=t.SubQuestionMasters.map((function(t){var n=t.getSnapshotWithoutBranchInfo();return delete n.Id,delete n.GroupId,delete n.QuestionInfo,n}));return this.insertElementAfter(n,t,e)},e.duplicateSectionAndSubElements=function(t){var n=this,e=this.findQuestionsInSection(t,!0),r=Cn.find(this.SectionMasters,(function(n){return n.Model.Order>t.Model.Order})),i=t.Model.Order,o=t.Model.Order+fe.H.QuestionOrderDefaultStep*(e.length+1);e.length>0&&(i=Cn.last(e).Model.Order),r&&(o=r.Model.Order);var s=(o-i)/(e.length+2),u=Cn.clone(t.getSnapshot());u.Id=this.pp(),u.Order=i+s,u.FormsProRTQuestionTitle&&(u.FormsProRTQuestionTitle=(0,be.pm)().Title_For_Duplicate_Section.format(u.FormsProRTQuestionTitle)),u.Title=(0,be.pm)().Title_For_Duplicate_Section.format(u.Title);var a,c=[{newId:u.Id,oldId:t.Model.Id}],l=[];return e&&e.forEach((function(t,e){var r=Cn.clone(t.getSnapshot());switch(r.Id=n.pp(),r.Order=u.Order+s*(e+1),l.push(r),r.Type){case"Question.MatrixChoiceGroup":a=r.Id;break;case"Question.MatrixChoice":r.GroupId=a}c.push({newId:r.Id,oldId:t.Model.Id})})),this.formMaster.bulkEdit((function(){pn.d.Collection.addItems(n.formMaster.Model.DescriptiveElements,[u]),pn.d.Collection.addItems(n.formMaster.Model.Questions,l)})),(0,Oe.fK)(t.Form.Model.LocalizedResources,c),this.getDescriptiveElementMasterById(u.Id)},e.deleteFormQuestion=function(t){pn.d.Collection.itemsDeletedInSource(t.Form.Model.Questions,t.SubQuestionMasters.map((function(t){return t.Model}))),t.Deleted=!0},e.deleteSectionAndSubElements=function(t){var n=this,e=this.findQuestionsInSection(t);this.formMaster.bulkEdit((function(){e.forEach((function(t){return n.deleteFormQuestion(t)})),t.Deleted=!0}))},e.moveElementDown=function(t){var n=this,e=this.TopElementMasters,r=Cn.indexOf(e,t);if(r!==e.length-1){var i=e[r+1],o=i instanceof he.MF&&i.SubQuestionMasters.length>0?i.SubQuestionMasters[i.SubQuestionMasters.length-1].Model.Order:i.Model.Order,s=o+fe.H.QuestionOrderDefaultStep;r+1<e.length-1&&(s=e[r+2].Model.Order);var u=t.SubQuestionMasters.map((function(t){return t.Model}));this.formMaster.bulkEdit((function(){return n.gp(t.Model,u,o,s)}))}},e.moveElementUp=function(t){var n=this,e=this.TopElementMasters,r=Cn.indexOf(e,t);if(!(r<=0)){var i=fe.H.QuestionOrderFloor,o=e[r-1],s=Cn.indexOf(this.AllElementMasters,o);s>0&&(i=this.AllElementMasters[s-1].Model.Order);var u=e[r-1].Model.Order,a=t.SubQuestionMasters.map((function(t){return t.Model}));this.formMaster.bulkEdit((function(){return n.gp(t.Model,a,i,u)}))}},e.moveSectionTo=function(t,n){var e,r=this,i=fe.H.QuestionOrderFloor,o=this.SectionMasters,s=Cn.indexOf(o,t),u=Cn.indexOf(o,n),a=Cn.last(this.HeaderTopQuestionMasters);a&&(i=a.Model.Order);var c=this.findQuestionsInSection(t,!0).map((function(t){return t.Model}));if(s>u)e=n.Model.Order,u>0&&(i=o[u-1].Model.Order,(l=this.findQuestionsInSection(o[u-1])).length>0&&(i=Cn.max(Cn.map(l,(function(t){return t.Model.Order})))));else{if(!(s<u))return;var l=this.findQuestionsInSection(n);i=o[u].Model.Order,l.length>0&&(i=Cn.max(Cn.map(l,(function(t){return t.Model.Order})))),e=i+fe.H.QuestionOrderDefaultStep*(c.length+1),u+1<o.length&&(e=o[u+1].Model.Order)}this.formMaster.bulkEdit((function(){return r.bp(t.Model,c,i,e)}))},e.insertElementAfter=function(t,n,e){var r=this;t=Cn.clone(t);var i=[];e&&(i=e.map(Cn.clone));var o=this.getAllElements(),s=fe.H.QuestionOrderFloor,u=s+fe.H.QuestionOrderDefaultStep;if(n){n instanceof he.MF&&n.SubQuestionMasters.length>0&&(n=n.SubQuestionMasters[n.SubQuestionMasters.length-1]);var a=Cn.indexOf(o,n.Model);a!==o.length-1?(s=n.Model.Order,u=o[a+1].Order):(s=n.Model.Order,u=n.Model.Order+fe.H.QuestionOrderDefaultStep)}else o.length>0&&(u=o[0].Order);if(this.gp(t,i,s,u),t.Id||(t.Id=this.pp(),i.forEach((function(n){n.Id=r.pp(),n.GroupId=t.Id}))),fe.H.isDescriptiveElement(t.Type)){var c=pn.d.Collection.addItems(this.formMaster.Model.DescriptiveElements,[t]);return(0,Le.PQ)(c[0])}var l=[t];return l=l.concat(i),c=pn.d.Collection.addItems(this.formMaster.Model.Questions,l),(0,he.vV)(c[0])},e.pp=function(){return"r"+(0,kn.GW)().replace(/-/g,"")},e.gp=function(t,n,e,r){var i=this,o=(r-e)/(n.length+2);t.Order=e+o,n.forEach((function(n,e){n.Order=t.Order+o*(e+1)})),(0,Tt.md)((function(){var t;(null===(t=i.formMaster)||void 0===t?void 0:t.SettingMaster.Model.PauseAndResumeSurvey)&&i.formMaster.bulkEdit((function(t){t.SurveyLastModifiedAt=(new Date).toUTCString()}))}))},e.bp=function(t,n,e,r){var i=(r-e)/(n.length+2);t.Order=e+i,n.forEach((function(n,e){n.Order=t.Order+i*(e+1)}))},n}(fe.H)}function sr(){return function(t){function n(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(this,n)||this}(0,x.ZT)(n,t);var e=n.prototype;return e.updateWith=function(t,n,e){var r=this;this.bulkEdit((function(){r.clear(),r.initImageSetting(t,n,e)}))},e.initImageSetting=function(t,n,e){var r=this,i=this.Model;this.bulkEdit((function(){null==i.Layout&&(t.ResourceUrl||t.ImageProcessingStatus!==de.nv.Idle?(i.NaturalWidth=t.Width||n,i.NaturalHeight=t.Height||e,r.yp(),r.Cp()):r.clear())}))},e.onImageStyleChange=function(t){var n=this,e=this.Model;e.Size!==t&&this.bulkEdit((function(){e.Size=t,n.Cp()}))},e.clear=function(){return this.setData({},pn.d.getSubFieldSchemas(this.Schema))},e.yp=function(){var t=this.Model;if(this.IsFormLogo)t.Size=me.h2.Small;else{var n=t.NaturalHeight/t.NaturalWidth;t.Layout=n>1?me.RZ.Vertical:n<1?me.RZ.Horizontal:me.RZ.Square,t.Size=n<.5?me.h2.Large:me.h2.Small}},e.Cp=function(){var t=this.Model,n=this.getDefaultImageSettings();for(var e in n)t[e]=Math.round(n[e])},n}(me.Vj)}function ur(){return function(t){function n(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var r=t.apply(this,n)||this;return r.addRule({InterestedFields:[r.Schema.FormMaster],Name:"ClearRouting",onChange:function(t){r.Model.FormMaster||r.ov()}}),r.addRule({InterestedFields:[r.Schema.FlexPane],Name:"RecordFlexPaneType",onChange:function(t){r.Model.PreviousFlexPane=t.OldValues.FlexPane}}),r}(0,x.ZT)(n,t);var e=n.prototype;return n.getInstance=function(){return this.instance||(this.instance=new n),this.instance},e.designForm=function(t){var e=n.getInstance(),r=e.Model;(0,m.$U)("DesignPage.Form.Navigate",{isGroupForm:t.IsGroupForm,myForm:t.Model.OwnerId===(0,c.k0)().userInfo.UserId}),e.bulkEdit((function(){r.Analysis=!1,r.Grading=null,r.FormId=null,r.FormMaster=t,t.IsGroupForm||(r.GroupMaster=null),t.existingOnServerSide().then((function(){r.FormMaster===t&&(r.FormId=t.Model.Id)}))}))},e.copyBySharingLinkFinished=function(t){var n=this;window.history.replaceState({},"","#FormId="+t.Model.Id),this.bulkEdit((function(){var e=n.Model;e.CopyFormId=null,e.SharingToken=null,e.FormId=null==t?void 0:t.Model.Id,e.FormMaster=t}))},e.shouldShowDesignView=function(){var t=this.Model;return!!(t.FormId||t.CopyFormId||t.FormMaster)},e.showTopView=function(t,n){this.Model.TopView=t,this.topViewCloseCallback=n},e.hideTopView=function(){this.Model.TopView="None"},e.resetTopViewCloseCallback=function(){var t=this.topViewCloseCallback;return this.topViewCloseCallback=void 0,t},e.collapseFlexPaneIfNeeded=function(t){var e=n.getInstance().Model,r=e.FlexPane;if("None"!==r){var i="flex-pane-container-"+r,o=document.getElementById(i);o&&!o.contains(t)&&(e.FlexPane="None")}},e.getUniqueFormName=function(t,e){void 0===e&&(e=!1);var r=n.getInstance(),i=[];if(e)i=r.Model.GroupMaster.FormMasters.filter((function(t){return!t.Deleted})).map((function(t){return t.Model.Title}));else{i=pn.d.convertToArray(r.Model.FormList).map((function(t){return t.Model.Title}));var o=pn.d.convertToArray(r.Model.PlaceholderList).map((function(t){return t.Title}));i=i.concat(o)}return(0,Ce.o)(t,(0,be.pm)().Designer_Title_autoRenameFormat,i)},e.ov=function(){var t=this;this.bulkEdit((function(){var n=t.Model;n.FormMaster=void 0,n.DataIdeas=!1,n.Analysis=!1,n.BranchingElementId=null,n.SectionElementId=null,n.Store=!1,n.Grading=null,n.Preview=null,n.FlexPane="None"}))},n}(le)}var ar=function(){function t(){}var n=t.prototype;return n.getMixinFormMaster=function(){return t.FormMasterClass||(t.FormMasterClass=er()),t.FormMasterClass},n.getMixinImageInfoMaster=function(){return t.ImageInfoMasterClass||(t.ImageInfoMasterClass=rr()),t.ImageInfoMasterClass},n.getMixinQuestionMaster=function(){return t.QuestionMasterClass||(t.QuestionMasterClass=ir()),t.QuestionMasterClass},n.getMixinFormApi=function(){return t.FormApiClass||(t.FormApiClass=oe(zn)),t.FormApiClass},n.getMixinFormElementManager=function(){return t.FormElementManagerClass||(t.FormElementManagerClass=or()),t.FormElementManagerClass},n.getMixinImageSettingsMaster=function(){return t.ImageSettingsMasterClass||(t.ImageSettingsMasterClass=sr()),t.ImageSettingsMasterClass},n.getMixinDesignPageUxStateMaster=function(){return t.DesignPageUxStateMasterClass||(t.DesignPageUxStateMasterClass=ur()),t.DesignPageUxStateMasterClass},n.getMobileDesignPageUxStateMaster=function(){return pe},n.getFileUploadConfirmDialog=function(){return Ie},t}(),cr=e(41350),lr=function(){function t(){this.Np=new cr.Y,this.Tp=!1}var n=t.prototype;return n.addBootCompleteListener=function(t){this.Tp?t():this.Np.register(t)},n.raiseBootComplete=function(){this.Tp=!0,this.Np.trigger(),this.Np.clear()},t}();var fr=e(78587),hr=e(65863),dr=e(82802),mr=e(52272),vr=e(32782),pr=e(29295);function gr(){return(0,x.mG)(this,void 0,void 0,(function(){return(0,x.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(6346).then(e.bind(e,6814))];case 1:return[2,{default:t.sent().CascadeRenderer}]}}))}))}function br(t){var n=(0,pr.J)(br,gr);return ge.createElement(vr.Z,null,ge.createElement(n,(0,x.pi)({},t)))}function wr(){return(0,x.mG)(this,void 0,void 0,(function(){return(0,x.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(3745).then(e.bind(e,92832))];case 1:return[2,{default:t.sent().ConditionalThankyouContainer}]}}))}))}function yr(t){if(!t.formLocalizedItemMaster||!t.formMaster.Model.ConditionalThankyouMessage)return null;var n=(0,pr.J)(yr,wr);return ge.createElement(vr.Z,null,ge.createElement(n,(0,x.pi)({},t)))}function Ir(){return(0,x.mG)(this,void 0,void 0,(function(){return(0,x.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(1963).then(e.bind(e,41963))];case 1:return[2,{default:t.sent().CVChoiceRenderer}]}}))}))}function Sr(t){var n=(0,pr.J)(Sr,Ir);return ge.createElement(vr.Z,null,ge.createElement(n,(0,x.pi)({},t)))}function Cr(){return(0,x.mG)(this,void 0,void 0,(function(){return(0,x.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(274).then(e.bind(e,34301))];case 1:return[2,{default:t.sent().FileUploadRenderer}]}}))}))}function Fr(t){var n=(0,pr.J)(Fr,Cr);return ge.createElement(vr.Z,null,ge.createElement(n,(0,x.pi)({},t)))}function Nr(){return(0,x.mG)(this,void 0,void 0,(function(){return(0,x.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(7264).then(e.bind(e,13732))];case 1:return[2,{default:t.sent().HeaderThemeRender}]}}))}))}function Tr(t){var n=(0,pr.J)(Tr,Nr);return ge.createElement(vr.Z,null,ge.createElement(n,(0,x.pi)({},t)))}function kr(){return(0,x.mG)(this,void 0,void 0,(function(){return(0,x.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(8951).then(e.bind(e,28951))];case 1:return[2,{default:t.sent().CVQuestionRendererFooter}]}}))}))}function xr(t){var n=(0,pr.J)(xr,kr);return ge.createElement(vr.Z,null,ge.createElement(n,(0,x.pi)({},t)))}var Pr=e(76795),Dr=e(42304),Er=e(58680),Rr=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,x.ZT)(n,t);var e=n.prototype;return n.getElementTypeName=function(){return"Question.FileUpload"},n.createDefaultDefinition=function(){return{Type:n.getElementTypeName(),Title:(0,be.pm)().Question_DefaultTitle,HasSpecificFileType:!1,FileTypes:{Word:!0,Excel:!0,PowerPoint:!0,PDF:!0,Image:!0,Video:!0,Audio:!0},QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1,MaxFileCount:1,MaxFileSize:$e.EE[Object.keys($e.EE)[0]]}},e.verify=function(t){return this.Model.Required&&!t?he.ej.RequiredError:he.ej.Success},e.getTypeDisplayName=function(){return(0,be.pm)().QuestionType_UploadFile},n}(Er.P),Lr=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,x.ZT)(n,t);var e=n.prototype;return n.getElementTypeName=function(){return"Question.MatrixChoice"},e.verify=function(t){return!this.Model.Required||t&&0!==t.length?he.ej.Success:he.ej.RequiredError},e.getTypeDisplayName=function(){return"MatrixChoice"},e.getNormalizedAnswer=function(t){return t},n}(Er.P),Ar=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,x.ZT)(n,t);var e=n.prototype;return n.getElementTypeName=function(){return"Question.MatrixChoiceGroup"},n.createDefaultDefinition=function(){var t=[{Description:(0,be.pm)().Designer_Choices_DefaultDescription.format(1),IsGenerated:!0,Id:1,Order:1},{Description:(0,be.pm)().Designer_Choices_DefaultDescription.format(2),IsGenerated:!0,Id:2,Order:2},{Description:(0,be.pm)().Designer_Choices_DefaultDescription.format(3),IsGenerated:!0,Id:3,Order:3},{Description:(0,be.pm)().Designer_Choices_DefaultDescription.format(4),IsGenerated:!0,Id:4,Order:4},{Description:(0,be.pm)().Designer_Choices_DefaultDescription.format(5),IsGenerated:!0,Id:5,Order:5}];return{Type:n.getElementTypeName(),Title:(0,be.pm)().Question_DefaultTitle,ChoiceGroup:t,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1}},n.createSubQuestionsDefinition=function(){return[{Title:(0,be.pm)().Desinger_Likert_DefaultDescription.format(1),Type:"Question.MatrixChoice"},{Title:(0,be.pm)().Desinger_Likert_DefaultDescription.format(2),Type:"Question.MatrixChoice"}]},e.verify=function(t){return he.ej.Success},e.getTypeDisplayName=function(){return(0,be.pm)().QuestionType_Likert},e.hasAnswer=function(){return!1},n}(Er.P),qr=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,x.ZT)(n,t);var e=n.prototype;return n.getElementTypeName=function(){return"Question.NPS"},n.createDefaultDefinition=function(){return{Type:n.getElementTypeName(),Title:(0,be.pm)().NPS_DefaultTitle,LeftDescription:(0,be.pm)().NPS_LeftDescription,RightDescription:(0,be.pm)().NPS_RightDescription,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1}},e.verify=function(t){return this.Model.Required&&!t&&0!==t?he.ej.RequiredError:he.ej.Success},e.getTypeDisplayName=function(){return(0,be.pm)().QuestionType_NPS},e.isNumberType=function(){return!0},n}(Er.P),Or=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,x.ZT)(n,t);var e=n.prototype;return n.getElementTypeName=function(){return"Question.Ranking"},n.createDefaultDefinition=function(){var t=[{Description:(0,be.pm)().Designer_Choices_DefaultDescription.format(1),Order:1,Key:(0,kn.GW)()},{Description:(0,be.pm)().Designer_Choices_DefaultDescription.format(2),Order:2,Key:(0,kn.GW)()},{Description:(0,be.pm)().Designer_Choices_DefaultDescription.format(3),Order:3,Key:(0,kn.GW)()}];return{Type:n.getElementTypeName(),Title:(0,be.pm)().Question_DefaultTitle,AllowMultipleValues:!0,ChoiceGroup:t,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1}},e.verify=function(t){return!this.Model.Required||t&&0!==t.length?he.ej.Success:he.ej.RequiredError},e.getTypeDisplayName=function(){return(0,be.pm)().QuestionType_Ranking},e.isCorrectAnswer=function(t){var n=this;if(!t)return!1;var e,r=JSON.parse(this.Model.GradingBasis);e=Cn.isString(t)?JSON.parse(t):Cn.map(Cn.sortBy(t,(function(t){return t.answerOrder})),(function(t){return t.id}));var i=Cn.map(r,(function(t){return Cn.findWhere(n.Model.ChoiceGroup,{Key:t}).Id}));return e.length===i.length&&Cn.isEqual(i,e)},e.createQuizResult=function(t){if(this.Model.IsQuiz)return{IsAnswerCorrect:this.isCorrectAnswer(t),GradingBasis:this.Model.GradingBasis}},e.autoGradeAnswer=function(t){var n=this.Model.Point||0;t.Score=this.isCorrectAnswer(t.Answer)?n:0,t.IsAutoGraded=!0},e.autoGradeWithQuizResult=function(t,n){return n?n.IsAnswerCorrect?this.Model.Point:0:null},e.getNormalizedAnswer=function(t){return t||[]},e.hasCorrectAnswers=function(t){return!0},e.redressGradingBasis=function(){var t=this;this.Master.fieldsReady([(0,Pn.zE)().Schema.ChoiceGroup,(0,Pn.zE)().Schema.GradingBasis]).then((function(){var n=pn.d.convertToArray(t.Master.Model.ChoiceGroup).sort((function(t,n){return t.Order-n.Order})).map((function(t){return t.Key}));t.Master.Model.GradingBasis=JSON.stringify(n)}))},n}(Er.P),Mr=e(5438),Ur=e(93224),Vr=e(18145),_r=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,x.ZT)(n,t);var e=n.prototype;return n.getElementTypeName=function(){return"Question.CascadeGroup"},n.createDefaultDefinition=function(){return{Type:n.getElementTypeName(),Title:(0,be.pm)().Question_DefaultTitle,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1,CascadeFileName:""}},n.createSubQuestionsDefinition=function(){var t,n=[];for(t=1;t<=(0,Vr.hu)();++t){var e={Title:(0,be.pm)().Desinger_Cascade_DefaultDescription.format(t),Type:"Question.CascadeLevel",CascadeLevel:t};n.push(e)}return n},n.supportMobileDesign=function(t){return!n.hasInvalidSettingOnMobile(t)},e.verify=function(t){return this.Model.Required&&!t?he.ej.RequiredError:he.ej.Success},e.getTypeDisplayName=function(){return(0,be.pm)().QuestionCategory_Cascade},n}(Er.P),Gr=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,x.ZT)(n,t);var e=n.prototype;return n.getElementTypeName=function(){return"Question.CascadeLevel"},e.verify=function(t){return!this.Model.Required||t&&0!==t.length?he.ej.Success:he.ej.RequiredError},e.getTypeDisplayName=function(){return"CascadeLevel"},e.getNormalizedAnswer=function(t){return t},n}(Er.P);var Br=e(262),zr=e(58537),Qr=e(42605);var Hr=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.kp=ge.createRef(),n}(0,x.ZT)(n,t);var e=n.prototype;return e.render=function(){var t=Cn.extend({},this.props.HTMLAttributes,{id:"preview-setting-pane",role:"tablist",onKeyUp:this.xp.bind(this)});return t.className=(0,Br.j)("preview-setting-pane",t.className),ge.createElement("div",t,this.createViewModeButtons())},e.createViewModeButtons=function(){return[this.Pp(zr.w.Desktop,"Desktop",(0,be.pm)().Response_Preview_DeviceType_Desktop,(0,be.pm)().Response_Preview_DeviceType_Desktop_ScreenReader),this.Pp(zr.w.Mobile,"Phone",(0,be.pm)().Response_Preview_DeviceType_Mobile,(0,be.pm)().Response_Preview_DeviceType_Mobile_ScreenReader)]},e.Pp=function(t,n,e,r){var i=this,o="preview-mode-button office-form-theme-button-color office-form-theme-select-color",s=t===this.props.Value,u={"aria-label":r,className:s?o+" active":o,onClick:function(){i.props.onValueChange(t),(0,m.$U)("DesignPage.PreView.Navigate",{previewMode:zr.w[t]})},"aria-selected":s,role:"tab",ref:s?null:this.kp};return(0,Qr.F)({ButtonStyle:1,HTMLAttributes:u,FluentIcon:n,IconClassName:(0,ut.QR)()?"forms-icon-size16x16":"forms-icon-size20x20",key:zr.w[t],Text:e,TextClassName:"preview-mode-button-text"})},e.xp=function(t){var n;switch(t.keyCode){case 37:case 38:case 39:case 40:this.props.Value===zr.w.Desktop?this.props.onValueChange(zr.w.Mobile):this.props.onValueChange(zr.w.Desktop),null===(n=this.kp.current)||void 0===n||n.focus()}},n}(ye.r);var jr=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(0,x.ZT)(n,t);var e=n.prototype;return e.createViewModeButtons=function(){var t=(0,ot.cr)("CVLeapFrogVisualRefresh"),n=[this.Dp(zr.w.Desktop,!t&&"TVMonitor",(0,be.pm)().CustomerVoice_Preview_DeviceType_Desktop,(0,be.pm)().CustomerVoice_Preview_DeviceType_Desktop_ScreenReader,t&&"Desktop"),this.Dp(zr.w.Mobile,!t&&"MobileSelected",(0,be.pm)().Response_Preview_DeviceType_Mobile,(0,be.pm)().Response_Preview_DeviceType_Mobile_ScreenReader,t&&"Phone")];return(0,ot.cr)("CustomerVoicePreviewEmbed")&&n.push(this.Dp(zr.w.Embed,"Info",(0,be.pm)().PIVOT_LABEL_EMBED,(0,be.pm)().PIVOT_LABEL_EMBED_TOOLTIP)),n},e.Dp=function(t,n,e,r,i){var o=this,s={ButtonStyle:1,HTMLAttributes:{"aria-label":r,className:"cvpreview-mode-button",onClick:function(){o.props.onValueChange(t),(0,m.$U)("DesignPage.PreView.Navigate",{previewMode:zr.w[t]})},"aria-selected":t===this.props.Value,role:"tab"},Icon:n,FluentIcon:i,IconClassName:"forms-icon-size20x20  cvpreview-mode-button-icon",key:zr.w[t],Text:e,TextClassName:"preview-mode-button-text"};if((0,ot.cr)("CVLeapFrogVisualRefresh")){var u=t===this.props.Value;s.IconClassName=(0,Br.j)("forms-icon-size20x20",u&&"office-form-theme-primary-color"),s.TextClassName=(0,Br.j)("cv-preview-mode-button-text",u&&"office-form-theme-primary-color")}return(0,Qr.F)(s)},n}(Hr),$r=e(17309),Wr=e(77356),Jr=e(77309),Kr=function(t){function n(n){var e=t.call(this,n)||this;return e.sd=ge.createRef(),e.Ep="",e.Rp="",e.Ap=function(){if(e.Ep=e.props.ConfirmText,e.Rp=e.props.Message,e.props.FormMaster){var t=e.props.FormMaster;if(t.isFieldReady(t.Schema.PipesDetails)&&t.Model.PipesDetails){var n;n=JSON.parse(t.Model.PipesDetails),Cn.forEach(n,(function(t){t.defaultValue&&(e.Ep=e.Ep.replace("{{"+t.pipeName+"}}",t.defaultValue),e.Rp=e.Rp.replace("{{"+t.pipeName+"}}",t.defaultValue))}))}}},e.Ep=n.ConfirmText,e.Rp=n.Message,e}(0,x.ZT)(n,t);var e=n.prototype;return e.componentDidMount=function(){(0,Wr.z)($(this.sd.current))},e.render=function(){var t;this.Ap();var n=this.Rp;t={RenderMode:"RichText",Text:this.Rp,ContainsHtml:!0},n=(0,hr.q)(t);var e=(0,hr.q)({ContainsHtml:!0,RenderMode:"RichText",Text:this.Ep});return ge.createElement(Jr.L,{Role:"Log",LazyRendering:!1},ge.createElement("div",{className:"thank-you-page-confirm"},ge.createElement("span",{className:"custom-thank-you-page-comfirm-text"},e)),ge.createElement("div",{className:"thank-you-page-container thank-you-page-message",ref:this.sd,tabIndex:-1},n))},n}(ye.r),Xr=function(){function t(){}var n=t.prototype;return n.createPreviewSettingPane=function(t){return function(t){return ge.createElement(jr,t)}(t)},n.addHeaderFontToSchemas=function(t){var n=[vn.x.Schema.HeaderFont];return t.push.apply(t,n),t},n.addSurveyFontToSchemas=function(t){var n=[vn.x.Schema.SurveyFont];return t.push.apply(t,n),t},n.getModifiedTextField=function(t,n){if(!t||""===t.trim())return t;var e=(0,Pn.f5)();if(e&&e.Model&&e.Model.FormMaster){var r=e.Model.FormMaster;if(r&&n&&r.isFieldReady(r.Schema.HeaderFont)||!n&&r.isFieldReady(r.Schema.SurveyFont)){var i=n?r.Model.HeaderFont:r.Model.SurveyFont,o=(0,dr.p)(t,i,null);t=Tt.Xw.sanitizeRichTextHTML(o)}}return t},n.getFooterElement=function(t){if("string"==typeof t){var n=this.getModifiedTextField(t,!1);return(0,hr.q)({ContainsHtml:!0,RenderMode:"RichText",Text:n})}return t},n.getLazyLoadThemes=function(){return e.e(8093).then(e.t.bind(e,98180,19)).then((function(t){return t.default}))},n.getDefaultTheme=function(){return{BackgroundColor:"#E9F0FE",BackgroundImage:null,Name:"CV_Blue",PrimaryColor:"#2266E3",SecondaryColor:"#1F5BCC",Thumbnail:(0,fr.Jn)("/Images/CustomerVoice/blue-thumbnail.png")}},n.getThemeBackground=function(t){var n,e;return(null===(e=null===(n=(0,Pn.f5)())||void 0===n?void 0:n.Model)||void 0===e?void 0:e.FormMaster)?(0,Pn.f5)().Model.FormMaster.Model.Background.ResourceUrl:t},n.getThemeStyle=function(t){var n="";return t&&t.PrimaryColor?(n+=".cv-design-theme-footer-edit-style { border-top-color:"+t.PrimaryColor+"; }",n+=".form-designer-title-view:hover { background-color:"+t.SecondaryColor+"; }",n+=".form-designer-title-view:active { background-color:"+t.SecondaryColor+"; }",n+=".form-designer-title-view:focus { background-color:"+t.SecondaryColor+"; }",(0,ot.cr)("CVLeapFrogVisualRefresh")?n+=".office-form-textfield .cke_textarea_inline { outline: none; }\n                       .office-form-textfield .cke_textarea_inline:focus { border-bottom: 2px solid "+t.PrimaryColor+"; }":n+=".office-form-textfield .cke_textarea_inline { outline: 1px solid "+t.PrimaryColor+"; }",n+=".form-control:not([disabled]):focus { border-color: "+t.PrimaryColor+"; }",n+=".condition-tku-body .design-time-editing { border-color: "+t.PrimaryColor+"; }",n+=".inlinebr-select-control:active, .inlinebr-select-control:focus { border-color: "+t.PrimaryColor+"; }",n+=".inlinebr-textreader-anchor:active, .inlinebr-textreader-anchor:focus { border-color: "+t.PrimaryColor+"; }"):n},n.getMediaPickerPaneText=function(){return ge.createElement("span",{className:"media-select-text"},(0,be.pm)().ImagePicker_Insert_Media_Text)},n.areImageUploadButtonsEnabled=function(){return!1},n.getMediaPickerPaneTitle=function(){var t;return t="MediaSelect"===(0,Pn.f5)().Model.PreviousFlexPane?(0,be.pm)().ImagePicker_Insert_Mdeia_button:(0,be.pm)().Logo_Panel_Title,ge.createElement("div",{className:"image-picker-panel-title"},t)},n.getMediaPickerPaneInfoContent=function(){if("MediaSelect"!==(0,Pn.f5)().Model.PreviousFlexPane){var t=(0,be.pm)().Logo_Panel_Content;return ge.createElement("div",{className:"image-picker-panel-info-content"},t)}return null},n.getImagePickerLocalContainerClassName=function(){return"cv-image-picker-local-switch-button"},n.getFlexPaneWidth=function(){return 480},n.getErrorPage=function(){return(0,x.mG)(this,void 0,Promise,(function(){return(0,x.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(8653).then(e.bind(e,95586))];case 1:return[2,{default:t.sent().ErrorPage}]}}))}))},n.callUpdatePR=function(t,n,e,r,i,o){$r.bX.callUpdatePausedResponse(n,e,r,t,i,o)},n.callGetPausedResponse=function(t,n){return(0,$r.nE)(t,n)},n.callSetLocaleItem=function(t,n,e,r){$r.bX.setLocaleItem(t,n,e,r)},n.callDeletePausedResponse=function(t,n){(0,$r.F9)(t,n)},n.callUpdatePRForTextQuestion=function(t,n,e,r,i){$r.bX.updatePausedResponseForTextQuestion(t,n,e,r,i)},n.getConditionalThankyouControl=function(t){return yr(t)},n.derivedThankYouMessageKey=function(t,n,r){return(0,x.mG)(this,void 0,Promise,(function(){var i;return(0,x.Jh)(this,(function(o){switch(o.label){case 0:return[4,e.e(8653).then(e.bind(e,51229))];case 1:return i=o.sent().default,[2,Promise.resolve(i(t,n,r))]}}))}))},n.getMessageContent=function(t){return ge.createElement(Kr,t)},n.createHeaderThemeRenderer=function(t){return Tr(t)},n.createFileUploadQuestionRenderer=function(t){return Fr(t)},n.createCascadeQuestionRenderer=function(t){return br(t)},n.createChoiceQuestionRenderer=function(t){return Sr(t)},n.getQuestionDelegatorClass=function(t){return function(t){switch(t){case"Question.Choice":return Pr.L;case"Question.TextField":return Ur.nv;case"Question.DateTime":return Dr.o;case"Question.Rating":return Mr.i;case"Question.Ranking":return Or;case"Question.MatrixChoice":return Lr;case"Question.MatrixChoiceGroup":return Ar;case"Question.NPS":return qr;case"Question.FileUpload":return Rr;case"Question.CascadeLevel":return Gr;case"Question.CascadeGroup":return _r;default:throw Error(t+" is not supported")}}(t)},n.getCustomLanguageFriendlyName=function(t){return(0,mr.f)(t)},n.getQuestionRendererFooter=function(t){return xr(t)},t}();var Yr=e(84950),Zr=function(){function t(){this.qp=[],this.Op="",this.Mp=""}var n=t.prototype;return n.addUserActionSignal=function(t,n,e,r){var i=this;if(void 0===r&&(r=!1),!(0,V.x8)()){var o=(0,g.x_)();if(o){var s={UserActionName:t,UserActionType:n,InteractiveContent:e?JSON.stringify(e):"",SessionId:(0,ft.k)()},u=(0,Pn.f5)().Model;if(u&&u.FormMaster&&u.FormMaster.Model)(function(t){return t.fieldsReady([vn.x.Schema.Title,vn.x.Schema.Questions]).then((function(){var n,e=pn.d.convertToArray(t.Model.Questions)||[],r=[];e.forEach((function(t){var n=[],e=t.ChoiceGroup;(pn.d.convertToArray(e).map(qe.k)||[]).forEach((function(t){if(t.isFieldReady(t.Schema.Id)&&t.isFieldReady(t.Schema.Description)&&t.isFieldReady(t.Schema.Order)){var e={DisplayText:t.Model.Description,ChoiceId:t.Model.Id.toString(),ChoiceOrder:t.Model.Order};n.push(e)}}));var i={QuestionId:t.Id,QuestionTitle:t.Title,QuestionType:t.Type,QuestionInfo:t.QuestionInfo,QuestionOrder:t.Order,QuestionSubtitle:t.Subtitle,Choices:n,Required:t.Required,IsQuiz:t.IsQuiz};r.push(i)}));var i=null===(n=t.FormElementManager)||void 0===n?void 0:n.SectionMasters;i&&i.length>0&&i.forEach((function(t){r.push({QuestionId:t.Model.Id,QuestionTitle:t.Model.Title,QuestionType:t.Model.Type,QuestionInfo:t.Model.QuestionInfo,QuestionOrder:t.Model.Order,QuestionSubtitle:t.Model.Subtitle})}));var o={FormTitle:t.Model.Title,FormType:t.Model.Type,FormDescription:t.Model.Description,Questions:r};return JSON.stringify(o)}))})(u.FormMaster).then((function(t){var n,u,a=(0,nn.vj)("UserActionSignalMaxQueueLength",10),c=(new Date).toUTCString();if(s.UpdateActionUTCTime=[],i.Op===o||""===i.Op){var l=i.Up(s),f=null!=e&&((null===(n=e.AdoptedCandidates)||void 0===n?void 0:n.length)>0||(null===(u=e.Candidates)||void 0===u?void 0:u.length)>0);if(l&&!f){var h=l.UpdateActionUTCTime;h.push(c),s.UpdateActionUTCTime=h}else s.UpdateActionUTCTime.push(c),i.qp.push(s);var d=0;i.qp.forEach((function(t){d+=t.UpdateActionUTCTime.length})),i.Op=o,i.Mp=t,(r||d>=a)&&((0,Yr.qe)(o,i.qp,t),i.Vp())}else(0,Yr.qe)(i.Op,i.qp,i.Mp),i.Vp(o,t,[]),s.UpdateActionUTCTime.push(c),i.qp.push(s)}))}}},n.Vp=function(t,n,e){void 0===t&&(t=""),void 0===n&&(n=""),void 0===e&&(e=[]),this.Op=t,this.Mp=n,this.qp=e},n.Up=function(t){return this.qp&&Fn().find(this.qp,(function(n){return n.UserActionName===t.UserActionName&&n.UserActionType===t.UserActionType}))},t}();var ti=e(80820),ni=e(41317);function ei(){return(0,x.mG)(this,void 0,void 0,(function(){return(0,x.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(274).then(e.bind(e,13785))];case 1:return[2,{default:t.sent().FileUploadRenderer}]}}))}))}function ri(t){var n=(0,pr.J)(ri,ei);return ge.createElement(vr.Z,null,ge.createElement(n,(0,x.pi)({},t)))}var ii=e(24742),oi=e(81620),si=e(29952),ui=e(49211),ai=e(43367),ci=e(46008),li=e(22768),fi=e(64541),hi=e(155),di=e(22530),mi=e(17764),vi=e(61111),pi=e(20572),gi=e(55982),bi=e(70907),wi="6c660282-db72-436c-87bb-8272cba504d3",yi=function(t){function n(n){var e=t.call(this,n)||this;e.Gp=ge.createRef(),e.Bp=(0,kn.GW)();var r=e.zp(),i=e.Qp(),o=e.Hp();return e.state={ChoiceOptions:i,IsOtherOptionSelected:!!r.OtherAnswer,LocalizedOptions:e.questionLocalizedItemMaster&&e.questionLocalizedItemMaster.Model.option,OptionsOrder:o,OrderedChoices:Cn.map(o,(function(t){return i[t]})),OtherOptionText:r.OtherAnswer,ReachMaxLengthLimit:!1,SelectedOptions:r.SelectedOptions},e.$f=e.$f.bind(e),e.jp=e.jp.bind(e),e.Wp=e.Wp.bind(e),e.Jp=e.Jp.bind(e),e.Kp=e.Kp.bind(e),e.Xp=e.Xp.bind(e),e}(0,x.ZT)(n,t);var e=n.prototype;return e.componentDidMount=function(){var n=this;t.prototype.componentDidMount.call(this),this.props.Master.Question.observe(this.Wp),(this.props.ShowQuizResult||this.props.IncrementalLoadFormsEnabled)&&this.props.Master.observe(this.Kp,[di.r.Schema.Answer]),(0,Tt.md)((function(){n.props.Master.observe(n.Kp,[di.r.Schema.Answer])})),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.Jp,[hi.A.Schema.choicesV1]);var e=[];e=(0,ai.gi)(e),this.props.Master.Question.Form.observe(this.update,e)},e.componentWillUnmount=function(){var n=this;this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.Jp),this.props.Master.Question.Form.unobserve(this.update),this.props.Master.Question.unobserve(this.Wp),(this.props.ShowQuizResult||this.props.IncrementalLoadFormsEnabled)&&this.props.Master.unobserve(this.Kp,[di.r.Schema.Answer]),(0,Tt.md)((function(){n.props.Master.unobserve(n.Kp,[di.r.Schema.Answer])})),t.prototype.componentWillUnmount.call(this)},e.componentWillReceiveProps=function(n){var e=this;this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.Jp),t.prototype.componentWillReceiveProps.call(this,n),this.questionLocalizedItemMaster&&(this.questionLocalizedItemMaster.observe(this.Jp,[hi.A.Schema.choicesV1]),(0,Tt.md)((function(){e.Yp(e.props.Master.Model.Answer)})))},e.shouldComponentUpdate=function(t,n){var e=!Cn.isEqual(t,this.props),r=!Cn.isEqual(n,this.state);return e||r},e.createReactNodes=function(){var t=this.props.Master.Question,n=t.Model,e=n.ChoiceType===he.T6.SingleChoice;return this.props.IsPrintViewDesignTime||this.props.ExpandAll||!t.showAsDropdown()||n.IsQuiz&&this.props.ShowQuizResult?[this.createChoices(e),this.getErrorMessageLabel()]:[this.Zp()]},e.getFormattedDataForImmersiveReader=function(){var n=t.prototype.getFormattedDataForImmersiveReader.call(this),e=null,r=document.createElement("ul");return Cn.forEach(this.state.OrderedChoices,(function(t){var n=document.createElement("li"),i=null;if(t.IsMathOption&&"undefined"!=typeof MathJax){e=e||MathJax.Hub.getAllJax(null);var o=Cn.find(e,(function(n){return n.originalText===t.Description}));if(o){var s=o.root&&o.root.toMathML&&o.root.toMathML();s&&(s=s.replace(/\n\s*/g,""),i="\x3c!--[if mathML]&#62;"+(0,oi.F1)(s,!0)+"&#60;![endif]--\x3e")}}if(i)n.innerHTML=i;else{var u=document.createTextNode(t.Description);n.appendChild(u)}r.appendChild(n)})),r.appendChild(document.createElement("br")),n.splice(n.length-1,0,{content:r.outerHTML,mimeType:"text/html"}),n},e.Kp=function(){var t=this.zp(),n=!!t.OtherAnswer,e=this.props.Master.Question.Model.ChoiceType===he.T6.SingleChoice;(0,Tt.hl)((function(){e&&(n=!!t.OtherAnswer&&0===t.SelectedOptions.length)})),this.setState({IsOtherOptionSelected:n,OtherOptionText:t.OtherAnswer,SelectedOptions:t.SelectedOptions})},e.Yp=function(t){if((0,ot.cr)("FormsProAnswerTag")){var n=Cn.findIndex(this.props.Master.Question.Model.Choices,(function(n){return n.Description===t}));if(n>-1){var e=this.questionLocalizedItemMaster,r=void 0;if(e){var i=e.getChoiceV1LocalizedMaster(n);r=i&&i.Model.description,r=i.Model.formsProDisplayRTText||r,this.props.Master.Model.SelectedChoice=r}else this.props.Master.Model.SelectedChoice=t}}},e.tg=function(){var t,n=this,e=[],r=this.props.Master.Question.Model.ChoiceType===he.T6.SingleChoice,i=this.state.SelectedOptions;i&&i.forEach((function(t){return e.push(t)}));var o=this.state.OtherOptionText;if((0,Tt.pd)((function(){n.state.IsOtherOptionSelected&&o&&-1===e.indexOf(o)&&e.push(o)}),(function(){n.state.IsOtherOptionSelected&&!(0,ci.le)(o)&&-1===e.indexOf(o)&&e.push(o)})),r)t=e[0];else if(e.length){var s=this.ng(e);t=JSON.stringify(s)}(0,Tt.md)((function(){n.Yp(t)})),this.props.Master.Model.Answer=t},e.createChoices=function(t){var e=this,r=this.props.Master.Question.Model,i=this.state.OrderedChoices.length+(r.AllowOtherAnswer?1:0),o=this.props.Master.Question.Form,s=(0,ui.w)(o,"ResponsePage.PollView"),u=(0,Br.j)(this.props.IsMobile&&!s?"office-form-question-choice-mobile office-form-theme-page-background-active":"office-form-question-choice"),a=this.state.OrderedChoices.map((function(r,o){var s,a,c=-1!==e.state.SelectedOptions.indexOf(r.Description),l=e.props.Master.Question.Model.IsQuiz?"office-form-question-choice-quiz-row":"";if(e.props.Master.Question.Model.IsMathQuiz&&r.IsMathOption){var f=(0,li.Rq)({DisableLinebreaks:e.props.DisableFormulaLinebreak,Formula:r.Description,onRenderComplete:e.props.onHeightChange}),h="office-form-question-choice-formula";(0,lt.vh)()&&(h+=" formula-renderer-container-safari9"),a=ge.createElement("div",{className:h},f)}else{l=(0,Br.j)(l,"office-form-question-choice-text-row");var d=null===(s=e.questionLocalizedItemMaster)||void 0===s?void 0:s.getChoiceV1LocalizedMaster(e.state.OptionsOrder[o]),m=(0,fi.wg)(r.Description,r.FormsProDisplayRTText);d&&(m=(0,fi.wg)(d.Model.description,d.Model.formsProDisplayRTText)||m),(0,Tt.md)((function(){e.questionLocalizedItemMaster||(e.props.Master.Model.SelectedChoice=e.props.Master.Model.Answer)}));var v={Text:(0,ai.rG)(m,!1),ContainsHtml:!0,RenderMode:"RichText"};a=ge.createElement("span",{className:"office-form-question-choice-text-span"},(0,hr.q)(v))}var p,g=n.getAnswerKeyMark(e.props,r,c);switch(g){case"Correct":p=e.props.LocalizedStrings.Quiz_CorrectAnswer;break;case"Wrong":p=e.props.LocalizedStrings.Quiz_WrongAnswer}var b={name:e.Bp};return t&&Cn.extend(b,{"aria-posinset":o+1,"aria-setsize":i}),ge.createElement(gi.h,{AnswerHint:n.getAnswerHintLabel(e.props,r,c),AnswerType:g,ToolTipForAnswer:p,Choice:r,ClassNameForLabel:l,ContainerClassName:u,Disabled:e.props.Disabled,HTMLPropsForInput:b,IsChecked:c,IsMobile:e.props.IsMobile,IsSingleChoice:t,key:o,LocalizedStrings:e.props.LocalizedStrings,onChange:e.$f},a)})),c=this.getElementProps({key:"choicequestion-choices",role:t?"radiogroup":"group"});return ge.createElement("div",(0,x.pi)({},c),a,this.eg(t))},e.eg=function(t){var n=this.props.Master.Question.Form,e=(0,ui.w)(n,"ResponsePage.PollView");if(this.props.Master.Question.Model.AllowOtherAnswer){var r={className:this.props.IsMobile&&!e?"office-form-other-answer-mobile":"office-form-other-answer",key:"other-answer"};return ge.createElement("div",(0,x.pi)({},r),ge.createElement("div",{className:"radio"},ge.createElement("label",null,this.ig(t),this.og())))}},e.ig=function(t){var n=this.state.ChoiceOptions,e={"aria-label":this.props.LocalizedStrings.Response_Page_OtherAnswerTitle,checked:this.state.IsOtherOptionSelected,disabled:this.props.Disabled,name:t?this.Bp:void 0,onChange:this.jp,ref:"otherAnswerInput",role:"checkbox",type:"checkbox",value:this.state.OtherOptionText||""};return t&&(e.role="radio",e.type="radio",e["aria-posinset"]=n.length+1,e["aria-setsize"]=n.length+1,(0,Tt.md)((function(){e["aria-checked"]=e.checked}))),ge.createElement("input",(0,x.pi)({},e))},e.jp=function(){var t=this,n=this.state.IsOtherOptionSelected,e=Cn.clone(this.state.SelectedOptions);if(!n){this.props.Master.Question.Model.ChoiceType===he.T6.SingleChoice&&(e=[]);var r=this.Gp.current;r&&r.focus()}this.setState({IsOtherOptionSelected:!n,SelectedOptions:e},(function(){return t.tg()}))},e.og=function(){var t={"aria-label":this.props.LocalizedStrings.Response_Page_OtherAnswerTitle,className:"office-form-other-answer-textbox"},n=this.props.IsPrintViewDesignTime?"":this.props.LocalizedStrings.Designer_OtherAnswer,e={AutoSelection:!0,Disabled:this.props.Disabled,HTMLAttributes:{className:"inline-display office-form-other-answer-margin-left-mobile"},MaxLength:(0,Me.kA)(),onValueChange:this.Xp,Options:{HTMLPropsForInnerElement:t},Placeholder:n,ref:this.Gp,Value:this.state.OtherOptionText||""},r=this.props.IsPrintViewDesignTime&&ge.createElement("div",{className:"print-choice-other-answer-hint"},this.props.LocalizedStrings.Designer_OtherAnswer);return ge.createElement("div",{className:"office-form-other-answer-inline"},(0,pi.ZA)(e),r)},e.Xp=function(t){var n=this,e=this.state.SelectedOptions;this.props.Master.Question.Model.ChoiceType===he.T6.SingleChoice&&(e=[]),this.setState({IsOtherOptionSelected:!!t,OtherOptionText:t,SelectedOptions:e},(function(){return n.tg()}))},e.Wp=function(){var t=this.zp();this.setState({ChoiceOptions:this.Qp(),OptionsOrder:this.Hp(),OrderedChoices:this.sg(),OtherOptionText:t.OtherAnswer,SelectedOptions:t.SelectedOptions})},e.Jp=function(){this.setState({LocalizedOptions:this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.Model.option})},e.$f=function(t){var n=this,e=Cn.clone(this.state.SelectedOptions),r=this.props.Master.Question.Model.ChoiceType===he.T6.SingleChoice,i=this.state.IsOtherOptionSelected,o=!1;if(r){if(t===e[0])return;i=!1,e=[t]}else{var s=e.indexOf(t);-1===s?e.push(t):e.splice(s,1),o=JSON.stringify(e).length>Pr.L.MaxAnswerLength}this.setState({IsOtherOptionSelected:i,ReachMaxLengthLimit:o,SelectedOptions:e,OtherOptionText:r?"":this.state.OtherOptionText},(function(){return n.tg()}))},e.getErrorMessageLabel=function(){if(this.state.ReachMaxLengthLimit)return(0,mi._)({Alert:!0,HTMLAttributes:{className:"validation-error-message-label",role:"alert"},key:"textquestion-errorlabel",Label:this.props.LocalizedStrings.Error_Message_Question_Reach_Limit})},e.Zp=function(){var t,n,e=this,r=this.props.Master,i=r.Question.Model,o=this.state.OrderedChoices.map((function(t,n){var r,i=null===(r=e.questionLocalizedItemMaster)||void 0===r?void 0:r.getChoiceV1LocalizedMaster(e.state.OptionsOrder[n]);return{DisplayName:(0,fi.wg)(null==i?void 0:i.Model.description,null==i?void 0:i.Model.formsProDisplayRTText)||(0,fi.wg)(t.Description,t.FormsProDisplayRTText),Key:pn.d.getObjectMasterFromModel(t).getInstanceId(),Value:t.Description}})),s=r.Model.Answer;i.AllowOtherAnswer&&o.push(this.ug()),this.state.IsOtherOptionSelected&&(s=wi),!this.props.ShowDesignInfo&&this.state.IsOtherOptionSelected&&(t=this.ag()),n=function(t){return e.cg(t)};var u=(0,si.Oy)()?this.props.LocalizedStrings.Question_Choice_Placeholder:this.props.LocalizedStrings.Dropdown_DefaultHint,a=(0,vi.E)({AllowWrap:!0,HTMLAttributes:this.getElementProps({className:"office-form-question-dropdown",disabled:this.props.Disabled,title:i.Hint||u}),Label:i.Hint||u,key:"choicequestion-dropdown",onValueChange:n,Placeholder:i.Hint||u,SelectOptions:o,Value:s,NeedScroll:this.props.IsMobile});return ge.createElement("div",{className:this.getValidationStyle()},a,t)},e.cg=function(t){var n=this,e=t===wi,r=e?[]:[t];(0,Tt.pd)((function(){n.setState({IsOtherOptionSelected:e,SelectedOptions:r},(function(){return n.tg()}))}),(function(){n.setState({IsOtherOptionSelected:e,OtherOptionText:n.state.OtherOptionText||(e?"":void 0),SelectedOptions:r},(function(){return n.tg()}))}))},e.ug=function(){return{DisplayName:this.props.LocalizedStrings.Designer_OtherAnswer,Key:wi,Value:wi}},e.ag=function(){var t=this,n=(0,si.Oy)()?this.props.LocalizedStrings.Question_TextFiled_Placeholder:this.props.LocalizedStrings.TextField_DefaultPlaceholder,e={"aria-label":n,className:"office-form-other-answer-textbox"},r={AutoFocus:!0,Disabled:this.props.Disabled,HTMLAttributes:{className:"office-form-other-answer office-form-dropdown-other-answer"},onValueChange:function(n){t.setState({OtherOptionText:n,SelectedOptions:[]},(function(){return t.tg()}))},Options:{HTMLPropsForInnerElement:e},Placeholder:n,ref:this.Gp,Value:this.state.OtherOptionText};return(0,pi.ZA)(r)},e.ng=function(t){var n=this.props.Master.Question.Model.Choices,e=Cn.map(n,(function(t){return t.Description}));return t.sort((function(t,n){return e.indexOf(t)-e.indexOf(n)}))},n.isQuizResultAnswerKey=function(t,n){if(!t||!t.IsAnswerKeys)return!1;var e=t.Choices;return!!e&&t.IsAnswerKeys[e.indexOf(n.Description)]},n.getAnswerKeyMark=function(t,e,r){var i=t.Master,o=i.Model.QuizResult,s=i.Question,u=n.isQuizResultAnswerKey(o,e);return e.IsAnswerKey&&t.ShowDesignInfo&&s.Model.IsQuiz||u?"Correct":r&&o&&o.IsAnswerKeys&&o.IsAnswerKeys.some((function(t){return t}))&&!u?"Wrong":"Normal"},n.getAnswerHintLabel=function(t,n,e){var r=t.Master.Model.QuizResult;if(!t.ShowDesignInfo&&e&&r){var i=r.Choices,o=i?i.indexOf(n.Description):-1;return r.AnswerHints&&r.AnswerHints[o]}},e.Qp=function(){var t=this.props.Master.Question.Model;return this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.getChoiceV1LocalizedMaster(t.Choices.length-1),pn.d.convertToArray(t.Choices)},e.sg=function(){var t=this;return Cn.map(this.state.OptionsOrder,(function(n){return t.state.ChoiceOptions[n]}))},e.Hp=function(){for(var t=this.props.Master.Question.Model,n=[],e=0;e<t.Choices.length;e++)n[e]=e;return this.props.ShowQuizResult||!t.ShuffleOptions||this.props.DisableShuffle?n:Cn.shuffle(n)},e.zp=function(){var t,n=this.props.Master,e=n.Model,r=n.Question.Model,i=r.ChoiceType===he.T6.SingleChoice,o=[],s=(0,Pr.P)(e.Answer,r).SelectedOptions;s.length>0&&(i?[e.Answer]:s).forEach((function(n){-1!==Cn.findIndex(r.Choices,(function(t){return t.Description===n}))?o.push(n):r.AllowOtherAnswer&&(t=n)}));return{OtherAnswer:t,SelectedOptions:o}},n}(bi.e),Ii=function(){function t(){}var n=t.prototype;return n.createPreviewSettingPane=function(t){return function(t){return ge.createElement(Hr,t)}(t)},n.addHeaderFontToSchemas=function(t){return t},n.addSurveyFontToSchemas=function(t){return t},n.getModifiedTextField=function(t,n){return t},n.getFooterElement=function(t){return t},n.getLazyLoadThemes=function(){return e.e(5985).then(e.t.bind(e,51276,19)).then((function(t){return t.default}))},n.getDefaultTheme=function(){return{BackgroundColor:ti.lP,BackgroundImage:null,Name:ni.kC,PrimaryColor:ti.tu,SecondaryColor:ti.oc,Thumbnail:(0,fr.Jn)("/Images/Theme/new-teal-thumbnail.png")}},n.getThemeBackground=function(t){return t},n.getThemeStyle=function(t){return""},n.getMediaPickerPaneText=function(){return null},n.areImageUploadButtonsEnabled=function(){return!0},n.getMediaPickerPaneTitle=function(){return null},n.getMediaPickerPaneInfoContent=function(){return null},n.getImagePickerLocalContainerClassName=function(){return null},n.getFlexPaneWidth=function(){return 600},n.getErrorPage=function(){return(0,x.mG)(this,void 0,void 0,(function(){return(0,x.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(8653).then(e.bind(e,70397))];case 1:return[2,{default:t.sent().ErrorPage}]}}))}))},n.callUpdatePR=function(t,n,e,r,i,o){return null},n.callGetPausedResponse=function(t,n){return Promise.resolve(null)},n.callSetLocaleItem=function(t,n,e,r){return null},n.callDeletePausedResponse=function(t,n){return null},n.callUpdatePRForTextQuestion=function(t,n,e,r,i){return null},n.getConditionalThankyouControl=function(t){return null},n.createHeaderThemeRenderer=function(t){return null},n.derivedThankYouMessageKey=function(t,n,e){return(0,x.mG)(this,void 0,Promise,(function(){return(0,x.Jh)(this,(function(t){return[2,Promise.resolve("")]}))}))},n.getMessageContent=function(t){return ge.createElement(ii.E,t)},n.createFileUploadQuestionRenderer=function(t){return ri(t)},n.createCascadeQuestionRenderer=function(t){return null},n.getQuestionDelegatorClass=function(t){return function(t){switch(t){case"Question.Choice":return Pr.L;case"Question.TextField":return Ur.nv;case"Question.DateTime":return Dr.o;case"Question.Rating":return Mr.i;case"Question.Ranking":return Or;case"Question.MatrixChoice":return Lr;case"Question.MatrixChoiceGroup":return Ar;case"Question.NPS":return qr;case"Question.FileUpload":return Rr;default:throw Error(t+" is not supported")}}(t)},n.getCustomLanguageFriendlyName=function(t){return t},n.createChoiceQuestionRenderer=function(t){return ge.createElement(yi,t)},n.getQuestionRendererFooter=function(t){return null},t}();var Si=e(2328);var Ci=e(27196),Fi=e(7899),Ni=e(77494),Ti=e(25664),ki=e(30521),xi=e(51531),Pi=e(66676),Di=e(45351),Ei=e(77288),Ri=e(16717),Li=e(34917),Ai=e(76029),qi=e(70208),Oi=e(90927);var Mi,Ui,Vi,_i,Gi=function(t){function n(n){var e=t.call(this,n)||this;return e.state={ShowPhishingWarningBar:!0,ShowReportPage:!1},e.lg=e.lg.bind(e),e.fg=e.fg.bind(e),window.addEventListener("resize",Ni.Tl),e}(0,x.ZT)(n,t);var e=n.prototype;return e.componentWillUnmount=function(){window.removeEventListener("resize",Ni.Tl)},e.render=function(){var t=(0,xi.o)()?"office-analysis-page office-form-spo-embed":"office-analysis-page";return this.state.ShowReportPage?ge.createElement("div",{className:t+" office-form-theme-page-background",role:"main"},ge.createElement("div",{className:"form-content-container"},ge.createElement("div",{className:"office-form-content office-form-page-padding"},ge.createElement(Oi.w,{ThemeMaster:this.props.Form.ThemeMaster}),(0,Di.Z)({FormMaster:this.props.Form,LocalizedStrings:(0,be.pm)()})))):ge.createElement("div",{className:t,role:"main"},ge.createElement("div",{className:"analysis-page-container office-form-theme-page-background"},this.hg(),this.mg()))},e.hg=function(){var t=this;if(this.state.CriticalError)return null;var n=(0,Ei.r)({Form:this.props.Form,isDesignTimeView:!1,showErrorPage:function(n){t.setState({CriticalError:n})}}),e=(0,xi.o)(),r=!e&&ge.createElement("div",{className:"analysis-page-bar office-form-theme-primary-background"}),i=" | ",o=!e&&ge.createElement(Ri.U.Consumer,null,(function(n){var e=n.LocalizedStrings;return ge.createElement("div",{className:"analysis-page-footer-container align-center"},ge.createElement("div",{className:"office-form-footer-block"},ge.createElement("a",{href:window.location.origin,rel:"noreferrer",target:"_blank"},e.Form_Footer_Powered),i,ge.createElement(Li.q,{LocalizedStrings:e,IsAnonymous:t.props.Form?t.props.Form.Model.Settings.IsAnonymous:null}),i,ge.createElement(qi.I,{LocalizedStrings:e}),(0,Pi.WB)()&&i,(0,Pi.WB)()&&ge.createElement(Ai.k,{LocalizedStrings:e})))}));return ge.createElement("div",{className:"analysis-page-content office-form-page-padding"},ge.createElement("div",{className:"analysis-page-items"},r,n,o))},e.lg=function(){this.setState({ShowReportPage:!0})},e.fg=function(){this.setState({ShowPhishingWarningBar:!1})},e.mg=function(){return this.state.CriticalError?(0,ki.a)({Error:this.state.CriticalError,IsAnalysisPage:!0}):null},n}(ye.r);function Bi(t){(0,be.ay)().then((function(){Ci.render((0,ki.a)({Error:t,IsAnalysisPage:!0}),document.getElementById("content-root")),(0,m.O7)(t)})),(0,Ni.Hr)(t)}function zi(){var t=function(t){var n=(0,Tn.kc)(t);if(!t||null==n.OwnerId){return Bi({innerCode:1001,type:"ExpectedFailure"}),null}return new((0,Pn.Ed)())(mn.y.AnalysisTimeForm,{ExistingInDataSource:!0,InitialData:{Id:t,OwnerId:n.OwnerId,OwnerTenantId:n.OrgId,TableId:n.TableId}},n.IsGroupOwner,!1)}((0,_.NW)().id);if(t){(0,g.p3)((function(){return t.Model.Id})),(0,g.EA)((function(){return t}));var n=function(t){return(0,Ve.lK)(t).getAnalysisTimeForm((0,_.NW)().id).then((function(n){t.Synchronizer.onSourceDataReceived(n)})).catch((function(t){if(t&&639===t.innerCode){var n=(0,oi.y)(window.location.href,"id",t.innerMessage);n!==window.location.href&&(0,C.gB)(n)}throw t}))}(t);Promise.all([n,(0,Fi.y)("JQuery_RateIt"),(0,be.ay)()]).catch(Bi).then((function(){return(0,Ti.kf)("survey"===t.Model.Type)})).then((function(){var n,e={Form:t,HTMLAttributes:{className:"analysis-page office-form-theme-page-background"}};Ci.render((n=e,ge.createElement(Gi,(0,x.pi)({},n))),document.getElementById("content-root")),(0,m.$U)("AnalysisPage.Analysis.Navigate"),(0,m.O7)(),(0,Ni.x4)(t)}))}}p.Pv.Register("IPageContext").UsingSingleton((function(){return new rt(Mi)})),p.Pv.Register("IAWTEventProperties").UsingFactory((function(){return new AWTEventProperties})),p.Pv.Register("IFormsLogManager").UsingSingleton((function(){return new tn})),p.Pv.Register("IAWTLogger").UsingSingleton((function(){return new Zt(p.Pv.Resolve("IFormsLogManager"),Promise.resolve(),g.x_,b.Ng,hn)})),p.Pv.Register("ILogger").UsingSingleton((function(){return new ln(p.Pv.Resolve("IAWTLogger"))})),p.Pv.Register("ILazyLoadResourceStringsFunc").UsingSingleton((function(){return dn.f})),v(),(0,Dn.a)().Flighting.setFlights((0,c.k0)().flights),p.Pv.Register("IMixin").UsingSingleton((function(){return new ar})),p.Pv.Register("IFormApiMixin").UsingSingleton((function(){return new ue})),Ui=new lr,p.Pv.Register("IBootEvent").UsingSingleton((function(){return Ui})),Vi=Promise.resolve($),_i=function(){return Vi},p.Pv.Register("IThirdPartyRateIt").UsingSingleton(_i),p.Pv.Register("IThirdPartyLinkify").UsingSingleton(_i),p.Pv.Register("IThirdPartyDateTimePicker").UsingSingleton(_i),p.Pv.Register("IFormUserContextActionSignal").UsingSingleton((function(){return new Zr})),p.Pv.Register("ITemplateQuestions").UsingSingleton(Si.TK),(0,y.cT)()?(p.Pv.Register("ICustomerVoiceUxFactory").UsingSingleton((function(){return new Xr})),p.Pv.Register("ICVMixin").UsingSingleton((function(){return new In}))):(p.Pv.Register("ICustomerVoiceUxFactory").UsingSingleton((function(){return new Ii})),p.Pv.Register("ICVMixin").UsingSingleton((function(){return new Sn}))),(0,Dn.a)().AuthContext.handleAuthForContentPage(!1).then((function(){(0,m.t0)(),zi()})).catch(Bi)},59312:function(t,n,e){"use strict";e.d(n,{ZT:function(){return i},pi:function(){return o},_T:function(){return s},mG:function(){return u},Jh:function(){return a},pr:function(){return c},ev:function(){return l}});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(t,n)};function i(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}var o=function(){return(o=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)};function s(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(e[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)n.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(e[r[i]]=t[r[i]])}return e}function u(t,n,e,r){return new(e||(e=Promise))((function(i,o){function s(t){try{a(r.next(t))}catch(t){o(t)}}function u(t){try{a(r.throw(t))}catch(t){o(t)}}function a(t){var n;t.done?i(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(s,u)}a((r=r.apply(t,n||[])).next())}))}function a(t,n){var e,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=n.call(t,s)}catch(t){o=[6,t],r=0}finally{e=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}Object.create;function c(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var r=Array(t),i=0;for(n=0;n<e;n++)for(var o=arguments[n],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function l(t,n){for(var e=0,r=n.length,i=t.length;e<r;e++,i++)t[i]=n[e];return t}Object.create},19749:function(t){"use strict";t.exports=CKEDITOR},63804:function(t){"use strict";t.exports=React},27196:function(t){"use strict";t.exports=ReactDOM},36215:function(t){"use strict";t.exports=_}},o={};function s(t){var n=o[t];if(void 0!==n)return n.exports;var e=o[t]={exports:{}};return i[t]||self.formsModuleResolveErrorCallback&&self.formsModuleResolveErrorCallback(t),i[t].call(e.exports,e,e.exports,s),e.exports}s.m=i,t=[],s.O=function(n,e,r,i){if(!e){var o=1/0;for(c=0;c<t.length;c++){e=t[c][0],r=t[c][1],i=t[c][2];for(var u=!0,a=0;a<e.length;a++)(!1&i||o>=i)&&Object.keys(s.O).every((function(t){return s.O[t](e[a])}))?e.splice(a--,1):(u=!1,i<o&&(o=i));u&&(t.splice(c--,1),n=r())}return n}i=i||0;for(var c=t.length;c>0&&t[c-1][2]>i;c--)t[c]=t[c-1];t[c]=[e,r,i]},s.F={},s.E=function(t){Object.keys(s.F).map((function(n){s.F[n](t)}))},s.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(n,{a:n}),n},e=Object.getPrototypeOf?function(t){return Object.getPrototypeOf(t)}:function(t){return t.__proto__},s.t=function(t,r){if(1&r&&(t=this(t)),8&r)return t;if("object"==typeof t&&t){if(4&r&&t.__esModule)return t;if(16&r&&"function"==typeof t.then)return t}var i=Object.create(null);s.r(i);var o={};n=n||[null,e({}),e([]),e(e)];for(var u=2&r&&t;"object"==typeof u&&!~n.indexOf(u);u=e(u))Object.getOwnPropertyNames(u).forEach((function(n){o[n]=function(){return t[n]}}));return o.default=function(){return t},s.d(i,o),i},s.d=function(t,n){for(var e in n)s.o(n,e)&&!s.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:n[e]})},s.f={},s.e=function(t){return Promise.all(Object.keys(s.f).reduce((function(n,e){return s.f[e](t,n),n}),[]))},s.u=function(t){return"union.chunk."+({274:"question.fileupload",362:"cvsearchboxcontrol",535:"json_teams_featured_templates",757:"ribbon_editor",997:"officebrowserfeedback",1245:"branchingpanel",1383:"cascadedesigner",1778:"fluent",2149:"insight",2541:"quiz",3042:"question.nps",3424:"file-saver",3708:"json_msa_templates",3745:"cv_condtku",3860:"satisfactionmetricspane",4016:"surveyindividualviewcontainerv2",4600:"math",4904:"intelligence",5066:"question.rating",5514:"json_templates",5967:"question.ranking",5985:"json_themes",6228:"panelcontrol",6346:"question.cascade",6794:"alertpagecontainer",6862:"recyclebin",7166:"ir",7264:"cvheadertheme",7544:"authoringpagecontainer",7548:"qwapagecontainer",7647:"question.likert",8093:"json_cv_themes",8207:"specificsharing",8653:"postsubmit",8678:"shareform",9048:"customervoiceintroduction",9305:"json_intelligence_scenario_templates",9410:"json_intelligence_useractionsignals",9428:"powerbicontainer",9852:"phishing",9969:"question.datetime"}[t]||t)+"."+{274:"a52bb5e",362:"8c9135f",535:"d181ec5",757:"64ddae4",997:"c064957",1245:"2538953",1383:"c966e9a",1778:"e42a2a9",1963:"8de9a22",2149:"6611c85",2541:"5077f16",3042:"c6b72b9",3424:"f60fb7e",3708:"ef56916",3745:"7d279e1",3860:"00f4ec8",4016:"57c2ca0",4600:"a3e166c",4904:"10edc2a",5066:"087a9c2",5514:"427fd7f",5967:"656506c",5985:"6fae941",6228:"ede1beb",6346:"8e7cde4",6794:"63fb440",6862:"9ba6346",7166:"e09abc4",7264:"3c62295",7544:"eeaba40",7548:"6e4413b",7647:"1c3da07",8093:"170463c",8207:"24a64e7",8653:"ef67cae",8678:"45e721b",8951:"0bd0138",9048:"14aa16f",9305:"6f5b212",9410:"20a8a1a",9428:"e0bd0ab",9852:"1ca3cec",9969:"c8d95b2"}[t]+".js"},s.miniCssF=function(t){},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),s.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},r={},s.l=function(t,n,e,i){if(r[t])r[t].push(n);else{var o,u;if(void 0!==e)for(var a=document.getElementsByTagName("script"),c=0;c<a.length;c++){var l=a[c];if(l.getAttribute("src")==t){o=l;break}}o||(u=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,s.nc&&o.setAttribute("nonce",s.nc),o.src=t),r[t]=[n];var f=function(n,e){o.onerror=o.onload=null,clearTimeout(h);var i=r[t];if(delete r[t],o.parentNode&&o.parentNode.removeChild(o),i&&i.forEach((function(t){return t(e)})),n)return n(e)},h=setTimeout(f.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=f.bind(null,o.onerror),o.onload=f.bind(null,o.onload),u&&document.head.appendChild(o)}},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.j=2071,s.p="",function(){document.currentScript&&document.currentScript.src;var t=function(){if(t.p)return t.p;var n,e,r=window.shellInfo,i=!1;if(r)i=!!(e=r.cdnEndpoint);else{var o=window.OfficeFormServerInfo||{};e=JSON.parse(decodeURIComponent(o.webSettings||"{}")).CdnEndPoint,i=o.isCdnEnabled}return n=i&&e?e+"/scripts/dists/":location.protocol+"//"+location.host+"/Scripts/dists/",t.p=n,t.isCdnEnabled=i,t.p};t.p=null,window.setPublicPath=t}(),window.replaceChunkSrc=function(t){t=t.toLowerCase();var n=window.OfficeFormServerInfo||window.shellInfo;return n&&n.ring&&!window.setPublicPath.isCdnEnabled?t+"?ring="+n.ring:t};var u,a,c,l,f,h=s.u;s.u=function(t){return function(t){try{if("function"!=typeof replaceChunkSrc)throw new Error("WebpackRequireFrom: 'replaceChunkSrc' is not a function or not available at runtime. See https://github.com/agoldis/webpack-require-from#troubleshooting");var n=replaceChunkSrc(t);if(!n||"string"!=typeof n)throw new Error("WebpackRequireFrom: 'replaceChunkSrc' does not return string. See https://github.com/agoldis/webpack-require-from#troubleshooting");return n}catch(n){return console.error(n),t}}(h(t))},u=s.u,a=s.e,c=new Map,l=new Map,s.u=function(t){var n=u(t),e=n.indexOf("?")>-1;return n+(c.has(t)?(e?"&":"?")+c.get(t):"")},s.e=function(t){return a(t).catch((function(n){var e=l.has(t)?l.get(t):2;if(e<1){var r=u(t);throw n.message="Loading chunk "+t+" failed after 2 retries.\n("+r+")",n.request=r,n}return new Promise((function(n){setTimeout((function(){var r="cache-bust=true&retry-attempt="+(2-e+1);c.set(t,r),l.set(t,e-1),n(s.e(t))}),0)}))}))},Object.defineProperty(s,"p",{get:function(){try{if("function"!=typeof setPublicPath)throw new Error("WebpackRequireFrom: 'setPublicPath' is not a function or not available at runtime. See https://github.com/agoldis/webpack-require-from#troubleshooting");return setPublicPath()}catch(t){return console.error(t),""}},set:function(t){console.warn("WebpackRequireFrom: something is trying to override webpack public path. Ignoring the new value"+t+".")}}),function(){var t={2071:0};s.f.j=function(n,e){var r=s.o(t,n)?t[n]:void 0;if(0!==r)if(r)e.push(r[2]);else{var i=new Promise((function(e,i){r=t[n]=[e,i]}));e.push(r[2]=i);var o=s.p+s.u(n),u=new Error;s.l(o,(function(e){if(s.o(t,n)&&(0!==(r=t[n])&&(t[n]=void 0),r)){var i=e&&("load"===e.type?"missing":e.type),o=e&&e.target&&e.target.src;u.message="Loading chunk "+n+" failed.\n("+i+": "+o+")",u.name="ChunkLoadError",u.type=i,u.request=o,r[1](u)}}),"chunk-"+n,n)}},s.F.j=function(n){if(!s.o(t,n)||void 0===t[n]){t[n]=null;var e=document.createElement("link");s.nc&&e.setAttribute("nonce",s.nc),e.rel="prefetch",e.as="script",e.href=s.p+s.u(n),document.head.appendChild(e)}},s.O.j=function(n){return 0===t[n]};var n=function(n,e){var r,i,o=e[0],u=e[1],a=e[2],c=0;for(r in u)s.o(u,r)&&(s.m[r]=u[r]);if(a)var l=a(s);for(n&&n(e);c<o.length;c++)i=o[c],s.o(t,i)&&t[i]&&t[i][0](),t[o[c]]=0;return s.O(l)},e=self.webpackChunk=self.webpackChunk||[];e.forEach(n.bind(null,0)),e.push=n.bind(null,e.push.bind(e))}(),f={6228:[997,8653,2541,4016],7544:[997,8653,2541,4016],8653:[8653,2541],9852:[997]},s.f.prefetch=function(t,n){Promise.all(n).then((function(){var n=f[t];Array.isArray(n)&&n.map(s.E)}))},s.O(0,[2071],(function(){s.E(997),s.E(8653)}),5);var d=s.O(void 0,[5527],(function(){return s(82641)}));d=s.O(d)}();