!function(T){function A(e){var t=e.originalEvent.changedTouches[0],a="";switch(e.type){case"touchmove":a="mousemove";break;case"touchend":a="mouseup";break;default:return}var i=document.createEvent("MouseEvent");i.initMouseEvent(a,!0,!0,window,1,t.screenX,t.screenY,t.clientX,t.clientY,!1,!1,!1,!1,0,null),t.target.dispatchEvent(i),e.preventDefault()}T.rateit={aria:{resetLabel:"reset rating",ratingLabel:"rating",ratingDescription:""},index:1},T.fn.rateit=function(E,M){function D(e){return e.charAt(0).toUpperCase()+e.substr(1)}var I={},L="init";if(0===this.length)return this;var e=T.type(E);if("object"==e||null==E)I=T.extend({},T.fn.rateit.defaults,E);else{if("string"==e&&"reset"!==E&&void 0===M)return this.data("rateit"+D(E));"string"==e&&(L="setvalue")}return this.each(function(){var n=T(this),l=function(e,t){var a,i;return null!=t&&(a="aria-value"+("value"==e?"now":e),null!=(i=n.find(".rateit-range")).attr(a)&&i.attr(a,t)),arguments[0]="rateit"+D(e),n.data.apply(n,arguments)};if("reset"==E){var e,t=l("init");for(e in t)n.data(e,t[e]);l("backingfld")&&("SELECT"==(a=T(l("backingfld")))[0].nodeName&&"index"===a[0].getAttribute("data-rateit-valuesrc")?a.prop("selectedIndex",l("value")):a.val(l("value")),a.trigger("change"),a[0].min&&(a[0].min=l("min")),a[0].max&&(a[0].max=l("max")),a[0].step&&(a[0].step=l("step"))),n.trigger("reset")}n.hasClass("rateit")||n.addClass("rateit");var a,i,r,s,o="rtl"!=n.css("direction");function d(e,t){if(!l("init"))throw"Can't set value before init";var a;"readonly"!=e||1!=t||l("readonly")||(n.find(".rateit-range").unbind(),l("wired",!1)),"value"==e&&(t=null==t?l("min"):Math.max(l("min"),Math.min(l("max"),t))),l("backingfld")&&("SELECT"==(a=T(l("backingfld")))[0].nodeName&&"index"===a[0].getAttribute("data-rateit-valuesrc")?"value"==e&&a.prop("selectedIndex",t):"value"==e&&a.val(t),"min"==e&&a[0].min&&(a[0].min=t),"max"==e&&a[0].max&&(a[0].max=t),"step"==e&&a[0].step&&(a[0].step=t)),l(e,t)}if("setvalue"==L)if("object"==T.type(M))for(var m in M)d(m,M[m]);else d(E,M);l("init")||(l("mode",l("mode")||I.mode),l("icon",l("icon")||I.icon),l("iconforempty",l("iconforempty")||I.iconforempty),l("min",isNaN(l("min"))?I.min:l("min")),l("max",isNaN(l("max"))?I.max:l("max")),l("step",l("step")||I.step),l("readonly",void 0!==l("readonly")?l("readonly"):I.readonly),l("resetable",void 0!==l("resetable")?l("resetable"):I.resetable),l("backingfld",l("backingfld")||I.backingfld),l("starwidth",l("starwidth")||I.starwidth),l("starheight",l("starheight")||I.starheight),l("marginleft",l("marginleft")||I.marginleft),l("marginright",l("marginright")||I.marginright),l("value",Math.max(l("min"),Math.min(l("max"),isNaN(l("value"))?isNaN(I.value)?I.min:I.value:l("value")))),l("ispreset",void 0!==l("ispreset")?l("ispreset"):I.ispreset),l("backingfld")&&(((a=T(l("backingfld")).hide()).attr("disabled")||a.attr("readonly"))&&l("readonly",!0),"INPUT"==a[0].nodeName&&("range"!=a[0].type&&"text"!=a[0].type||(l("min",parseInt(a.attr("min"))||l("min")),l("max",parseInt(a.attr("max"))||l("max")),l("step",parseInt(a.attr("step"))||l("step")))),"SELECT"==a[0].nodeName&&1<a[0].options.length?("index"===a[0].getAttribute("data-rateit-valuesrc")?(l("min",isNaN(l("min"))?Number(a[0].options[0].index):l("min")),l("max",Number(a[0].options[a[0].length-1].index)),l("step",Number(a[0].options[1].index)-Number(a[0].options[0].index))):(l("min",isNaN(l("min"))?Number(a[0].options[0].value):l("min")),l("max",Number(a[0].options[a[0].length-1].value)),l("step",Number(a[0].options[1].value)-Number(a[0].options[0].value))),1==(s=a.find("option[selected]")).length&&("index"===a[0].getAttribute("data-rateit-valuesrc")?l("value",s[0].index):l("value",s.val()))):l("value",a.val())),h="DIV"==n[0].nodeName?"div":"span",i=T.rateit.index++,s=(r=T.rateit.aria.ratingDescription?'<div id="rateit-description-{{index}}" style="display:none">'+T.rateit.aria.ratingDescription+"</div>":"")?'aria-describedby="rateit-description-{{index}}" ':"",s='<button id="rateit-reset-{{index}}" type="button" data-role="none" class="rateit-reset" aria-label="'+T.rateit.aria.resetLabel+'" aria-controls="rateit-range-{{index}}"><span></span></button>'+r+'<{{element}} id="rateit-range-{{index}}" class="rateit-range" tabindex="0" role="slider" aria-label="'+T.rateit.aria.ratingLabel+'" '+s+'aria-owns="rateit-reset-{{index}}" aria-valuemin="'+l("min")+'" aria-valuemax="'+l("max")+'" aria-valuenow="'+l("value")+'"><{{element}} class="rateit-empty"></{{element}}><{{element}} class="rateit-selected"></{{element}}><{{element}} class="rateit-hover"></{{element}}></{{element}}>',n.append(s.replace(/{{index}}/gi,i).replace(/{{element}}/gi,h)),o||(n.find(".rateit-reset").css("float","right"),n.find(".rateit-selected").addClass("rateit-selected-rtl"),n.find(".rateit-hover").addClass("rateit-hover-rtl")),"font"==l("mode")?n.addClass("rateit-font").removeClass("rateit-bg"):n.addClass("rateit-bg").removeClass("rateit-font"),l("init",JSON.parse(JSON.stringify(n.data()))));var h="font"==l("mode");h||n.find(".rateit-selected, .rateit-hover").height(l("starheight"));var u=n.find(".rateit-range");if(h){var c,g=l("max")-l("min"),v=T(),f=T();function p(e){var t=T("<span></span>").text(l("icon")).css("margin",e),e=T("<span></span>").text(l("iconforempty")).css("margin",e);v=v.add(t),f=f.add(e)}if(x=o?(c="0 "+l("marginright")+"px 0 "+l("marginleft")+"px","0 "+l("marginleft")+"px"):(h=l("marginright"),c="0 "+(x=l("marginleft"))+"px 0 "+h+"px","0 "+x+"px"),1==g)p(x);else for(var b=0;b<g-1;b++)p(c);1<g&&p(x),u.find(".rateit-selected, .rateit-hover").html(v),u.find(".rateit-empty").html(f)}else u.width(l("starwidth")*(l("max")-l("min"))).height(l("starheight"));var x,w="rateit-preset"+(o?"":"-rtl");l("ispreset")?n.find(".rateit-selected").addClass(w):n.find(".rateit-selected").removeClass(w),o?(n.find(".rateit-reset").css("float","left"),n.find(".rateit-selected").removeClass("rateit-selected-rtl"),n.find(".rateit-hover").removeClass("rateit-hover-rtl")):(n.find(".rateit-reset").css("float","right"),n.find(".rateit-selected").addClass("rateit-selected-rtl"),n.find(".rateit-hover").addClass("rateit-hover-rtl")),null!=l("value")&&(x=l("value")-l("min"),n.find(".rateit-selected").width(C(n.width(),x,!0)));var y=n.find(".rateit-reset");!0!==y.data("wired")&&y.bind("click",function(e){e.preventDefault(),y.blur();e=T.Event("beforereset");if(n.trigger(e),e.isDefaultPrevented())return!1;n.rateit("value",null),n.trigger("reset")}).data("wired",!0);function N(e,t){var a="rtl"!=n.css("direction"),i=(t.changedTouches?t.changedTouches[0]:t).pageX-T(e).offset().left;a||(i=u.width()-i),i>u.width()&&(i=u.width()),i<0&&(i=0);var r=l("marginleft"),t=l("marginright"),e=l("starwidth"),a=r+e+t,t=Math.floor(i/a);return Math.ceil(t+Math.min(Math.max(i-t*a-r,0),e)/e)*(1/l("step"))}function C(e,t,a){var i,r,n=Math.floor(t),s=l("starwidth");o?(i=l("marginleft"),r=l("marginright")):(r=l("marginleft"),i=l("marginright"));var d=0;n<t&&(d=i+s*(t-n));d=(i+s+r)*n+d;return a?d:Math.min(e,d)}function k(e){var t=T.Event("beforerated");return n.trigger(t,[e]),!t.isDefaultPrevented()&&(l("value",e),l("backingfld")&&("SELECT"==a[0].nodeName&&"index"===a[0].getAttribute("data-rateit-valuesrc")?T(l("backingfld")).prop("selectedIndex",e):T(l("backingfld")).val(e)).trigger("change"),l("ispreset")&&(u.find(".rateit-selected").removeClass(w),l("ispreset",!1)),u.find(".rateit-hover").hide(),u.find(".rateit-selected").width(C(u.width(),e)).show(),n.trigger("hover",[null]).trigger("over",[null]).trigger("rated",[e]),!0)}l("readonly")?y.hide():(l("resetable")||y.hide(),l("wired")||(u.bind("touchmove touchend",A),u.mousemove(function(e){var t,a=N(this,e);t=a,e=C(u.width(),t*l("step")),(a=u.find(".rateit-hover")).data("width")!=e&&(u.find(".rateit-selected").hide(),a.width(e).show().data("width",e),t=[t*l("step")+l("min")],n.trigger("hover",t).trigger("over",t))}),u.mouseleave(function(e){u.find(".rateit-hover").hide().width(0).data("width",""),n.trigger("hover",[null]).trigger("over",[null]),u.find(".rateit-selected").show()}),u.mouseup(function(e){e=N(this,e)*l("step")+l("min");k(e),u.blur()}),u.keyup(function(e){38!=e.which&&e.which!=(o?39:37)||k(Math.min(l("value")+l("step"),l("max"))),40!=e.which&&e.which!=(o?37:39)||k(Math.max(l("value")-l("step"),l("min")))}),l("wired",!0)),l("resetable")&&y.show()),u.attr("aria-readonly",l("readonly"))})},T.fn.rateit.defaults={min:0,max:5,step:.5,mode:"font",icon:"â˜…",iconforempty:"@",starwidth:16,starheight:16,readonly:!1,resetable:!0,ispreset:!1,marginleft:5,marginright:5},T(function(){T("div.rateit, span.rateit").rateit()})}(jQuery);